define("dataFixer/helpers/CompsMigrationHelper",["lodash","coreUtils"],function(e,t){"use strict";function n(e){this.migrationMap=e}return n.prototype.getComponentData=function(e,t){return t.dataQuery&&e.data.document_data[t.dataQuery.replace("#","")]},n.prototype.setComponentData=function(n,i,r,o){var a=i.dataQuery||e.get(o,[i.id,"dataQuery"])||t.guidUtils.getUniqueId("dataItem","-");a=a.replace("#",""),i.dataQuery="#"+a,r.id=a,n.data.document_data[a]=r,e.set(o,[i.id,"dataQuery"],a)},n.prototype.deleteComponentData=function(e,t){var n=t.dataQuery&&t.dataQuery.replace("#","");n&&e.data.document_data[n]&&delete e.data.document_data[n]},n.prototype.getComponentDesignData=function(e,t){return t.designQuery&&e.data.design_data[t.designQuery.replace("#","")]},n.prototype.deleteComponentDesignData=function(e,t){var n=t.designQuery&&t.designQuery.replace("#","");n&&e.data.design_data[n]&&delete e.data.design_data[n]},n.prototype.getComponentProperties=function(e,t){return t.propertyQuery&&e.data.component_properties[t.propertyQuery.replace("#","")]},n.prototype.deleteComponentProperties=function(e,t){var n=t.propertyQuery&&t.propertyQuery.replace("#","");n&&e.data.component_properties[n]&&delete e.data.component_properties[n],t.propertyQuery&&delete t.propertyQuery},n.prototype.setComponentDesignData=function(n,i,r,o){var a=i.designQuery||e.get(o,[i.id,"designQuery"])||t.guidUtils.getUniqueId("dataItem","-");if(a=a.replace("#",""),i.designQuery="#"+a,r.id=a,e.isObject(r.background)){var s=e.clone(r.background);s.id=(s.id||t.guidUtils.getUniqueId("dataItem","-")).replace("#",""),r.background="#"+s.id,n.data.design_data[s.id]=s}n.data.design_data[a]=r,e.set(o,[i.id,"designQuery"],i.designQuery)},n.prototype.setComponentProperties=function(n,i,r,o){var a=i.propertyQuery||e.get(o,[i.id,"propertyQuery"])||t.guidUtils.getUniqueId("propItem","-");a=a.replace("#",""),i.propertyQuery=a,r.id=a,n.data.component_properties[a]=r,e.set(o,[i.id,"propertyQuery"],a)},n.prototype.migrateComps=function(t,n,i,r){e.forEach(r,function(e){this.migrationMap[e.componentType]&&this.migrationMap[e.componentType].call(this,t,n,i,e),this.migrateComps(t,n,i,e.components)}.bind(this))},n.prototype.migratePage=function(e){var t=e.structure;if(t){var n={},i=t.components||t.children,r=t.mobileComponents;i&&this.migrateComps(e,n,!1,i),r&&this.migrateComps(e,n,!0,r)}},n}),define("dataFixer/maps/galleryTypes",[],function(){"use strict";return{"wysiwyg.viewer.components.MatrixGallery":{propType:"MatrixGalleryProperties"},"wysiwyg.viewer.components.PaginatedGridGallery":{propType:"PaginatedGridGalleryProperties"},"wysiwyg.viewer.components.SliderGallery":{propType:"SliderGalleryProperties"},"wysiwyg.viewer.components.SlideShowGallery":{propType:"SlideShowGalleryProperties"},"tpa.viewer.components.Masonry":{propType:"MasonryProperties"},"tpa.viewer.components.Accordion":{propType:"AccordionProperties"},"tpa.viewer.components.Impress":{propType:"ImpressProperties"},"tpa.viewer.components.Freestyle":{propType:"FreestyleProperties"},"tpa.viewer.components.Collage":{propType:"CollageProperties"},"tpa.viewer.components.Honeycomb":{propType:"HoneycombProperties"},"tpa.viewer.components.StripShowcase":{propType:"StripShowcaseProperties"},"tpa.viewer.components.StripSlideshow":{propType:"StripSlideshowProperties"},"tpa.viewer.components.Thumbnails":{propType:"ThumbnailsProperties"},"wysiwyg.viewer.components.tpapps.TPA3DGallery":{propType:"SlideShowGalleryProperties"},"wysiwyg.viewer.components.tpapps.TPA3DCarousel":{propType:"SlideShowGalleryProperties"}}}),define("dataFixer/plugins/galleriesMobileTypeFixer",["lodash","dataFixer/helpers/CompsMigrationHelper","dataFixer/maps/galleryTypes"],function(e,t,n){"use strict";function i(e,t,i,r){if(i){var o=t[r.id];if(o.componentType!==r.componentType){var a=o.componentType;r.componentType=a;var s=this.getComponentProperties(e,r),u=n[a].propType;!a||s&&s.type===u||(r.propertyQuery=o.propertyQuery)}}else t[r.id]=r}return{exec:function(r){var o=e.mapValues(n,function(){return i});new t(o).migratePage(r)}}}),define("dataFixer/plugins/pageTopFixer",[],function(){"use strict";return{exec:function(e){e.structure=e.structure||{},e.structure.layout=e.structure.layout||{},e.structure.layout.y=0}}}),define("dataFixer/helpers/runOnAllCompsRecursively",["lodash"],function(e){"use strict";function t(n,i){e.forEach(n,function(n){e.forEach(i,function(e){e(n)}),n.components&&t(n.components,i)})}return t}),define("dataFixer/plugins/masterPageFixer",["lodash","experiment","dataFixer/helpers/runOnAllCompsRecursively"],function(e,t,n){"use strict";function i(e){e.SITE_STRUCTURE&&(e.masterPage=e.SITE_STRUCTURE),e.masterPage||(e.masterPage={}),e.masterPage.id="masterPage",delete e.SITE_STRUCTURE}function r(t){return 0===e.get(t,"layout.width")}function o(t){return 0===e.get(t,"layout.height")}function a(t){r(t)&&e.set(t,"layout.width",100),o(t)&&e.set(t,"layout.height",100)}function s(t){e.forEach(t,function(t){e.forEach(e.get(t,"layout.anchors"),function(e){switch(t.id){case"SITE_FOOTER":"BOTTOM_PARENT"===e.type&&(e.distance=0);break;case"PAGES_CONTAINER":"BOTTOM_TOP"===e.type&&e.locked&&e.distance>=70&&(e.originalValue=0,e.locked=!1)}})})}function u(t,i){var s=!1;if(e.forEach(["SITE_HEADER","SITE_FOOTER"],function(n){var a=e.find(t,{id:n});r(a)&&(s=!0),o(a)&&(e.set(a,"layout.height",100),s=!0),e.set(a,"layout.width",i)}),s){var u=e.reject(t,{id:"PAGES_CONTAINER"});n(u,[a])}}function c(n,i){if(!t.isOpen("sv_fixedMobileHeader",{rendererModel:i})){var r=e.find(n,{id:"SITE_HEADER"});e.set(r,["layout","fixedPosition"],!1)}var o=e.find(n,{id:"SITE_FOOTER"});e.set(o,["layout","fixedPosition"],!1)}function p(t,n,i){var r=t.children,o=t.mobileComponents,a=e.get(n,"masterPage.renderModifiers.siteWidth",980);d(r),u(r,a),d(o),u(o,320),c(o,i),s(o)}function d(t){e.forEach(l,function(n){if(!e.find(t,{id:n.id})){var i=e.find(t,{componentType:n.componentType});i&&(i.id=n.id)}})}var l=[{componentType:"wysiwyg.viewer.components.PagesContainer",id:"PAGES_CONTAINER"},{componentType:"wysiwyg.viewer.components.FooterContainer",id:"SITE_FOOTER"},{componentType:"wysiwyg.viewer.components.HeaderContainer",id:"SITE_HEADER"}];return{exec:function(e,t,n,r,o,a,s){return e.structure&&"Document"===e.structure.type&&(e.structure.id="masterPage",e.structure.componentType="mobile.core.components.MasterPage",i(e.data.document_data),p(e.structure,e.data.document_data,s)),e}}}),define("dataFixer/plugins/menuFixer",["lodash"],function(e){"use strict";function t(n){return e.reduce(n.items,function(e,n){return e.push(n.refId),n.items&&n.items.length?e.concat(t(n)):e},[])}function n(e){return t(e.MAIN_MENU)}function i(t,n){var i=t.items[n];i.items&&i.items.length>0&&e.forEach(i.items,function(e,n){t.items.push(e),delete i.items[n]}),i.items=[],t.items.splice(n,1)}function r(t,n){var i={};return e.find(t.items,function(t,r){return i.topIndex=r,e.find(t.items,function(e,t){if(e.refId===n)return i.subIndex=t,!0})}),i}function o(t,n){var o=e.findIndex(t.items,{refId:n});if(o>=0)i(t,o);else{var a=r(t,n);t.items[a.topIndex].items.splice(a.subIndex,1)}}function a(t,n){var i=t.MAIN_MENU;e.forEach(n,function(e){e||o(i,e)}),e.pull(n,"",void 0)}function s(t,n,i){e.forEach(n,function(n){e.includes(i,n.slice(1))||o(t.MAIN_MENU,n)})}function u(t,n,i){var r=t.MAIN_MENU,o=0===r.items.length;if(!!t.CUSTOM_MAIN_MENU){if(o)return;delete t.CUSTOM_MAIN_MENU,delete t.CUSTOM_MENUS}e.forEach(i,function(t){if(!e.includes(n,"#"+t)){n.push("#"+t);var i={items:[],refId:"#"+t};r.items.push(i)}})}function c(e){return e.replace("#","")}function p(t,n){t&&t.mainPage&&!e.includes(n,c(t.mainPage))&&(t.mainPage="#"+n[0])}function d(e,t){return!e[c(t)]}function l(t){var n=e.get(t,["CUSTOM_MAIN_MENU","items"]);n&&e.some(n,e.partial(d,t))&&(delete t.CUSTOM_MAIN_MENU,delete t.CUSTOM_MENUS)}function m(t){return"Document"===e.get(t,"structure.type")}function g(e,t){var i=n(e);l(e),a(e,i),s(e,i,t),u(e,i,t),p(e.masterPage,t)}return{exec:function(e,t){var n=e.data.document_data;m(e)&&(n.MAIN_MENU=n.MAIN_MENU||{items:[],type:"Menu",id:"MAIN_MENU",metaData:{}},t&&g(n,t))}}}),define("dataFixer/plugins/customSiteMenuFixer",["lodash","dataFixer/plugins/menuFixer"],function(e,t){"use strict";function n(t,n){return e.map(t,function(e){return i(n,e)})}function i(e,t){var i=v+y++,o=e[t.refId.replace("#","")];return e[i]={id:i,label:o.title,isVisible:!o.hidePage,isVisibleMobile:void 0!==o.mobileHidePage?!o.mobileHidePage:!o.hidePage,items:n(t.items,e),link:r(e,t.refId),type:"BasicMenuItem",metaData:{}},"#"+i}function r(e,t){var n=h+w++;return e[n]={id:n,type:"PageLink",pageId:t,metaData:{}},"#"+n}function o(e,t){return t&&e[t.replace("#","")]}function a(e){delete e.link}function s(e,t){var n=o(e,t.link);return n&&"PageLink"===n.type&&!o(e,n.pageId)}function u(e,t){return t.link&&("#CUSTOM_MENU_HEADER"===t.link||s(e,t))}function c(t,n){n.items=e.filter(n.items,function(n){return!e.isUndefined(o(t,n))}),e.forEach(n.items,function(e){var n=o(t,e);u(t,n)&&a(n),c(t,n)})}function p(t){e(t.data.document_data).filter({type:"Menu"}).map("id").forEach(function(e){delete t.data.document_data[e]})}function d(e){return e&&e.structure&&"Page"===e.structure.type}function l(e){return e.replace("#","")}function m(t,n){var i=t.CUSTOM_MAIN_MENU.items,r=e(t).filter({type:"BasicMenuItem"}).map("link").compact().map(l).map(function(e){return t[e]}).map("pageId").compact().map(l).value(),o=e.difference(n,r);e.forEach(o,function(e){t[e].isPopup||i.push(g(t,e))})}function g(e,t){var n=v+y++,i=e[t];return e[n]={id:n,label:i.title,isVisible:!i.hidePage,isVisibleMobile:void 0!==i.mobileHidePage?!i.mobileHidePage:!i.hidePage,items:[],link:r(e,"#"+t),type:"BasicMenuItem",metaData:{}},"#"+n}function f(t,n){var i=e.filter(t,function(e){return e.id&&0===e.id.indexOf(n)}),r=-1;return e.forEach(i,function(e){var t=Number(e.id.replace(n,""));t>r&&(r=t)}),++r}var y=0,w=0,v="bmi",h="pglk";return{exec:function(i,r){if(t.exec(i,r),d(i))p(i);else{var o=i.data.document_data;y=f(o,v),w=f(o,h),i.data.document_data.CUSTOM_MAIN_MENU||(i.data.document_data.CUSTOM_MAIN_MENU={id:"CUSTOM_MAIN_MENU",items:n(i.data.document_data.MAIN_MENU.items,i.data.document_data),name:"Custom Main Menu",type:"CustomMenu",metaData:{}}),i.data.document_data.CUSTOM_MENUS?e.includes(i.data.document_data.CUSTOM_MENUS.menus,"#CUSTOM_MAIN_MENU")||i.data.document_data.CUSTOM_MENUS.menus.push("#CUSTOM_MAIN_MENU"):i.data.document_data.CUSTOM_MENUS={id:"CUSTOM_MENUS",menus:["#CUSTOM_MAIN_MENU"],type:"CustomMenusCollection",metaData:{}},m(o,r),o.CUSTOM_MAIN_MENU.items=e.uniq(o.CUSTOM_MAIN_MENU.items),c(o,o.CUSTOM_MAIN_MENU),i.data.document_data.MAIN_MENU.items.length>0&&(i.data.document_data.MAIN_MENU.items=[])}}}}),define("dataFixer/plugins/multipleMenusFixer",["lodash","dataFixer/helpers/CompsMigrationHelper"],function(e,t){"use strict";function n(e,t,n,i){var r=this.getComponentData(e,i);r&&"CustomMenuDataRef"===r.type||(delete i.dataQuery,this.setComponentData(e,i,{menuRef:"#CUSTOM_MAIN_MENU",type:"CustomMenuDataRef"},t))}var i=new t({"wysiwyg.common.components.verticalmenu.viewer.VerticalMenu":n,"wysiwyg.viewer.components.menus.DropDownMenu":n});return{exec:i.migratePage.bind(i)}}),define("dataFixer/plugins/verticalMenuFixer",["lodash","coreUtils"],function(e,t){"use strict";function n(e){return!!e.data.theme_data.THEME_DATA}function i(e){g=e.data.theme_data}function r(t){var n=t.data.document_data,i=n.CUSTOM_MAIN_MENU||{items:[]};f=e.filter(i.items,function(e){return n[e.replace("#","")].isVisible}).length}function o(e,t,n,i){var r=u(e,t);t.layout.height=i,r.originalHeight=n}function a(t,n){var i=u(t,n);return!e.isUndefined(i.originalHeight)}function s(e,t){return"wysiwyg.common.components.verticalmenu.viewer.VerticalMenu"===t.componentType&&!a(e,t)}function u(e,t){return e.data.component_properties[t.propertyQuery.replace("#","")]}function c(e,t){return e.data.theme_data[t.styleId]||g[t.styleId]}function p(n,i){var r=c(n,i);if(r){var a=parseInt(r.style.properties.sepw||r.style.properties.separatorHeight||0,10),s=e.includes(w,r.skin),u=e.includes(v,r.skin),p=i.layout.height;o(n,i,p,t.verticalMenuCalculations.getFixedHeight(p,a,s,u,f))}else t.log.error("cannot find style")}function d(t,n){e.forEach(n,function(e){s(t,e)&&p(t,e),e.components&&d(t,e.components)})}function l(e){var t=e.structure;t&&(t.components&&d(e,t.components),t.mobileComponents&&d(e,t.mobileComponents),t.children&&d(e,t.children))}var m=!1,g={},f=0,y=[],w=["wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSeparatedButtonFixedWidthSkin","wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSeparatedButtonSkin","wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSolidColorSkin"],v=["wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSeparatedButtonFixedWidthSkin","wysiwyg.common.components.verticalmenu.viewer.skins.VerticalMenuSeparatedButtonSkin"];return{exec:function(e){if(n(e))for(i(e),r(e),m=!0;y.length>0;)l(y.pop());else m?l(e):y.push(e)}}}),define("dataFixer/plugins/skinFixer",["lodash"],function(e){"use strict";function t(e){e.skin&&i[e.skin]&&(e.skin=i[e.skin])}function n(e,i){var r,o,a=e[i]||e.components;if(a)for(r=0;r<a.length;r++)t(o=a[r]),n(o,i)}var i={"mobile.core.skins.InlineSkin":"skins.core.VerySimpleSkin","mobile.core.skins.TwitterTweetSkin":"skins.core.TwitterTweetSkin","mobile.core.skins.ButtonSkin":"skins.core.ButtonSkin","mobile.core.skins.ContactItemSkin":"skins.core.ContactItemSkin","mobile.core.skins.ContactListSkin":"skins.core.ContactListSkin","mobile.core.skins.FacebookCommentSkin":"skins.core.FacebookCommentSkin","mobile.core.skins.GlobalMenuSkin":"skins.core.GlobalMenuSkin","mobile.core.skins.GooglePlusOneSkin":"skins.core.GooglePlusOneSkin","mobile.core.skins.HeaderSkin":"skins.core.HeaderSkin","mobile.core.skins.HomeButtonSkin":"skins.core.HomeButtonSkin","mobile.core.skins.ImageNewSkin":"skins.core.ImageNewSkin","mobile.core.skins.ImageSkin":"skins.core.ImageSkin","mobile.core.skins.MenuButtonSkin":"skins.core.MenuButtonSkin","mobile.core.skins.NetworkItemSkin":"skins.core.NetworkItemSkin","mobile.core.skins.NetworkListSkin":"skins.core.NetworkListSkin","mobile.core.skins.PageTitleSkin":"skins.core.PageTitleSkin","mobile.core.skins.PhotoFullScreenSkin":"skins.core.PhotoFullScreenSkin","mobile.core.skins.PhotoGalleryFullScreenDefaultSkin":"skins.core.PhotoGalleryFullScreenDefaultSkin","mobile.core.skins.PhotoGalleryGridDefaultSkin":"skins.core.PhotoGalleryGridDefaultSkin","mobile.core.skins.PhotoSkin":"skins.core.PhotoSkin","mobile.core.skins.RichTextImageSkin":"skins.core.RichTextImageSkin","mobile.core.skins.RichTextSkin":"skins.core.RichTextSkin","mobile.core.skins.ServiceItemSkin":"skins.core.ServiceItemSkin","mobile.core.skins.ServiceListSkin":"skins.core.ServiceListSkin","mobile.core.skins.SimpleButtonSkin":"skins.core.SimpleButtonSkin","mobile.core.skins.SiteNavigationMenuSkin":"skins.core.SiteNavigationMenuSkin","mobile.core.skins.TwitterFollowSkin":"skins.core.TwitterFollowSkin","mobile.core.skins.FacebookLikeSkin":"skins.core.FacebookLikeSkin","skins.viewer.gallerymatrix.PolaroidCustomHeightSkin":"wysiwyg.viewer.skins.gallerymatrix.PolaroidCustomHeightSkin","skins.viewer.gallerymatrix.PolaroidDisplayerCustomHeightSkin":"wysiwyg.viewer.skins.gallerymatrix.PolaroidDisplayerCustomHeightSkin","skins.viewer.gallerymatrix.TextBottomCustomHeightSkin":"wysiwyg.viewer.skins.gallerymatrix.TextBottomCustomHeightSkin","skins.viewer.gallerymatrix.TextBottomDisplayerCustomHeightSkin":"wysiwyg.viewer.skins.gallerymatrix.TextBottomDisplayerCustomHeightSkin","skins.viewer.galleryslider.SliderGalleryScotchTapeSkin":"wysiwyg.viewer.skins.galleryslider.SliderGalleryScotchTapeSkin","skins.viewer.galleryslider.SliderGalleryIronSkin":"wysiwyg.viewer.skins.galleryslider.SliderGalleryIronSkin","skins.viewer.galleryslider.SliderDisplayerIronSkin":"wysiwyg.viewer.skins.galleryslider.SliderDisplayerIronSkin","skins.viewer.galleryslider.SliderDisplayerScotchTapeSkin":"wysiwyg.viewer.skins.galleryslider.SliderDisplayerScotchTapeSkin","wysiwyg.viewer.skins.gallerymatrix.MatrixGallerySeparateTextBoxSkin":"wysiwyg.common.components.matrixgallery.viewer.skins.MatrixGallerySeparateTextBoxSkin","wysiwyg.viewer.skins.gallerymatrix.MatrixGalleryTextOnCenterSkin":"wysiwyg.common.components.matrixgallery.viewer.skins.MatrixGalleryTextOnCenterSkin","wysiwyg.viewer.skins.dropmenu.TextOnlyMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.TextOnlyMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.TextSeparatorsMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.TextSeparatorsMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SolidColorMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SolidColorMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.ShinyMenuINSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ShinyMenuIButtonSkin","wysiwyg.viewer.skins.dropmenu.ShinyMenuIINSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ShinyMenuIIButtonSkin","wysiwyg.viewer.skins.dropmenu.OverlineMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.OverlineMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateBasicMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateBasicMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateShinyIMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateShinyIMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateShinyIIMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateShinyIIMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.LinesMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.LinesMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateLinesMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateLinesMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.PointerMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.PointerMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.RibbonsMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.RibbonsMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.VerticalRibbonsMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.VerticalRibbonsMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.IndentedMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.IndentedMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SeparateIndentedMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateIndentedMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.ArrowRightMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ArrowRightMenuButtonSkin","wysiwyg.viewer.skins.dropmenu.SloppyBorderMenuNSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SloppyBorderMenuButtonSkin","wysiwyg.viewer.skins.menu.ShinyMenuISkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ShinyMenuIIButtonSkin","wysiwyg.viewer.skins.menu.ShinyMenuIISkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ShinyMenuIIButtonSkin","wysiwyg.viewer.skins.menu.TextOnlyMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.TextOnlyMenuButtonBgFixSkin","wysiwyg.viewer.skins.menu.TextSeparatorsMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.TextSeparatorsMenuButtonSkin","wysiwyg.viewer.skins.menu.SolidColorMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SolidColorMenuButtonSkin","wysiwyg.viewer.skins.menu.OverlineMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.OverlineMenuButtonHorizontalMenuAdaptationSkin","wysiwyg.viewer.skins.menu.SeparateBasicMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateBasicMenuButtonSkin","wysiwyg.viewer.skins.menu.SeparateShinyIMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateShinyIMenuButtonSkin","wysiwyg.viewer.skins.menu.SeparateShinyIIMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateShinyIIMenuButtonBorderRadiusFixSkin","wysiwyg.viewer.skins.menu.LinesMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.LinesMenuButtonBorderRadiusFixSkin","wysiwyg.viewer.skins.menu.SeparateLinesMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateLinesMenuButtonHorizontalMenuAdaptationSkin","wysiwyg.viewer.skins.menu.PointerMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.PointerMenuButtonHorizontalMenuAdaptationSkin","wysiwyg.viewer.skins.menu.RibbonsMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.RibbonsMenuButtonSkin","wysiwyg.viewer.skins.menu.IndentedMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.IndentedMenuButtonSkin","wysiwyg.viewer.skins.menu.SeparateIndentedMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SeparateIndentedMenuButtonSkin","wysiwyg.viewer.skins.menu.ArrowRightMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.ArrowRightMenuButtonSkin","wysiwyg.viewer.skins.menu.SloppyBorderMenuSkin":"wysiwyg.common.components.dropdownmenu.viewer.skins.SloppyBorderMenuButtonSkin","tpa.viewer.skins.TPAMasonrySkin":"wysiwyg.viewer.skins.TPAMasonrySkin","tpa.viewer.skins.TPA3DCarouselSkin":"wysiwyg.viewer.skins.TPA3DCarouselSkin","tpa.viewer.skins.TPA3DGallerySkin":"wysiwyg.viewer.skins.TPA3DGallerySkin","tpa.viewer.skins.TPAAccordionSkin":"wysiwyg.viewer.skins.TPAAccordionSkin","tpa.viewer.skins.TPACollageSkin":"wysiwyg.viewer.skins.TPACollageSkin","tpa.viewer.skins.TPAEcomGallerySkin":"wysiwyg.viewer.skins.TPAEcomGallerySkin","tpa.viewer.skins.TPAFreestyleSkin":"wysiwyg.viewer.skins.TPAFreestyleSkin","tpa.viewer.skins.TPAHoneycombSkin":"wysiwyg.viewer.skins.TPAHoneycombSkin","tpa.viewer.skins.TPAImpressSkin":"wysiwyg.viewer.skins.TPAImpressSkin","tpa.viewer.skins.TPAStripShowcaseSkin":"wysiwyg.viewer.skins.TPAStripShowcaseSkin","tpa.viewer.skins.TPAStripSlideshowSkin":"wysiwyg.viewer.skins.TPAStripSlideshowSkin","tpa.viewer.skins.TPAThumbnailsSkin":"wysiwyg.viewer.skins.TPAThumbnailsSkin","tpa.common.skins.TPAPreloaderSkin":"wysiwyg.viewer.skins.TPAPreloaderSkin","tpa.common.skins.TPAUnavailableMessageOverlaySkin":"wysiwyg.viewer.skins.TPAUnavailableMessageOverlaySkin"};return{exec:function(i){var r,o=i.structure;o&&(n(o,"children"),n(o,"mobileComponents"),t(o)),(r=i.data&&i.data.theme_data)&&e.forEach(r,function(e){t(e)})}}}),define("dataFixer/plugins/stylesFixer",["lodash"],function(e){"use strict";function t(e,t,n){return e[n.replace("llt_","llf_")]=t,e}function n(t){t.style&&e.forEach(t.style.properties,function(e,t,n){"string"==typeof e&&(n[t]=e.replace(/(\d)x/g,"$1px"))})}function i(){return{type:"TopLevelStyle",id:"v2",metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1},style:{properties:{brd:"color_15",brw:"0px",rd:"0px",shd:"0 1px 4px rgba(0, 0, 0, 0.6);"},propertiesSource:{brd:"theme",brw:"value",rd:"value",shd:"value"},groups:{}},componentClassName:"",pageId:"",compId:"",styleType:"system",skin:"wysiwyg.viewer.skins.video.VideoDefault"}}function r(t){if(!t.v2){var n=i();t.v2=e.cloneDeep(t.vl)||n}}function o(t){e.forOwn(t,function(e){s["*"](e),s[e.skin]&&s[e.skin](e)})}var a=function(n){n.style.properties=e.reduce(n.style.properties,t,{}),n.style.propertiesSource=e.reduce(n.style.propertiesSource,t,{})},s={"*":function(e){"THEME_DATA"!==e.id&&(e.style||(e.style={properties:{},propertiesSource:{},groups:{}}))},"wysiwyg.common.components.subscribeform.viewer.skins.SubscribeFormLineLayoutFlat":a,"wysiwyg.common.components.subscribeform.viewer.skins.SubscribeFormLineLayoutTransparentWithIcon":a};return{exec:function(t){var i=t.data&&t.data.theme_data;e.isEmpty(i)||(r(i),o(i),e.forEach(i,function(e){n(e)}))}}}),define("dataFixer/plugins/bgImageStripDataFixer",["lodash"],function(e){"use strict";function t(e){return e&&"wysiwyg.viewer.components.BgImageStrip"===e.componentType}function n(e){return e&&e.dataQuery&&e.dataQuery.replace("#","")}function i(e){return e.uri.slice(0-s.length)===s}function r(e,r,o){if(t(o)){var a=n(o),s=a&&r[a];s&&(s.title=s.title||"",i(s)||(e[o.id]=a))}}function o(e,n,i){if(t(i)){var r=e[i.id];r?i.dataQuery="#"+r:delete i.dataQuery}}function a(t,n){e.forEach(t,function(e){n(e),a(e.components,n)})}var s="add_image_thumb.png";return{exec:function(e){var t=e.structure,n=t&&(t.components||t.children),i=t&&t.mobileComponents;if(n){var s={};a(n,r.bind(null,s,e.data.document_data)),a(n,o.bind(null,s,e.data.document_data)),a(i,o.bind(null,s,e.data.document_data))}}}}),define("dataFixer/plugins/compFixer",["lodash","coreUtils"],function(e,t){"use strict";function n(e,t){var n=t.componentType,i=M[n];i&&(t.componentType=i.comp,i.dataQuery&&(t.dataQuery=i.dataQuery),i.callback&&i.callback(e))}function i(e,t){"wysiwyg.viewer.components.ItunesButton"===t.componentType&&(t.layout.height=Math.round(t.layout.width/2.75))}function r(e,t){return e.data.component_properties[t.propertyQuery]}function o(e,t){return t.dataQuery&&e.data.document_data[t.dataQuery.replace("#","")]}function a(e,t,n){e.data.component_properties[t.propertyQuery]=n}function s(e,n,i){var r=t.guidUtils.getUniqueId("dataItem","-");n.dataQuery="#"+r,i.id=r,e.data.document_data[r]=i}function u(t){if(t.components.length>0){var n=e.map(t.components,function(e){return e.layout.y+e.layout.height});return e.max(n)}return 0}function c(t){var n=e.find(t.structure.children,{id:"PAGES_CONTAINER"});return n.layout.y+n.layout.height}function p(e,t){"SITE_FOOTER"!==t.id||t.layout||(t.layout={anchors:[],fixedPosition:!1,height:u(t),rotationInDegrees:0,scale:1,width:320,x:0,y:c(e)})}function d(e,t){if(!o(e,t))switch(t.componentType){case"wysiwyg.viewer.components.svgshape.SvgShape":s(e,t,{link:null,type:"SvgShape"});break;case"wysiwyg.viewer.components.WFacebookComment":return void s(e,t,{type:"WFacebookComment",urlFormat:"hashBang"});case"wysiwyg.viewer.components.WFacebookLike":return void s(e,t,{type:"WFacebookLike",urlFormat:"hashBang"})}}function l(e,t){var n=o(e,t);if(n)switch(t.componentType){case"wysiwyg.viewer.components.ClipArt":return void(n.title="");case"wysiwyg.viewer.components.FacebookShare":case"wysiwyg.viewer.components.VKShareButton":case"wysiwyg.common.components.pinterestpinit.viewer.PinterestPinIt":case"wysiwyg.viewer.components.WTwitterTweet":case"wysiwyg.viewer.components.WFacebookComment":case"wysiwyg.viewer.components.WFacebookLike":return void(n.urlFormat=n.urlFormat||"hashBang")}}function m(e,t,n){"wysiwyg.common.components.anchor.viewer.Anchor"===n.componentType&&0===n.layout.width&&(n.layout.width=e)}function g(e,t){if(!r(e,t))switch(t.componentType){case"wysiwyg.viewer.components.menus.DropDownMenu":a(e,t,{alignButtons:"center",alignText:"center",sameWidthButtons:!1,moreButtonLabel:"More",moreItemHeight:15,stretchButtonsToMenuWidth:!0,type:"HorizontalMenuProperties"});break;case"wysiwyg.viewer.components.mobile.TinyMenu":t.propertyQuery="TINY_MENU",a(e,t,{direction:"left",type:"TinyMenuProperties",id:"TINY_MENU",metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1}})}}function f(e,t,n){e.properties[n.id]=r(t,n)}function y(e,t,n){!r(t,n)&&e.properties[n.id]&&a(t,n,e.properties[n.id])}function w(t,n){var i=e.get(t,"modes.definitions");return!e.some(i,{modeId:n})}function v(n){var i=e.get(n,"modes.definitions");return e.find(i,{type:t.siteConstants.COMP_MODES_TYPES.HOVER}).modeId}function h(e,t){var n=r(e,t);if(t.propertyQuery&&n)switch(t.componentType){case"wysiwyg.viewer.components.WFacebookLike":case"wysiwyg.viewer.components.PayPalButton":case"wysiwyg.viewer.components.GoogleMap":n.language||(n.language="en");break;case"wysiwyg.viewer.components.WRichText":"WRichTextProperties"!==n.type&&delete t.propertyQuery;break;case"wysiwyg.viewer.components.HoverBox":n.mobileDisplayedModeId&&w(t,n.mobileDisplayedModeId)&&(n.mobileDisplayedModeId=v(t))}}function T(t,n,i){e.forEach(n,function(n){e.forEach(i,function(e){e(t,n)}),n.components&&T(t,n.components,i)})}function k(t,r,o){T(t,o,[n,i,d,g,h,l,e.partial(m,1920),e.partial(f,r)])}function S(e,t,n){e.pageContainsStructuresWithoutJsonAnchors=e.pageContainsStructuresWithoutJsonAnchors||!n.layout||!n.layout.anchors}function x(e,t){t.layout&&delete t.layout.anchors}function I(t,r,o){var a={pageContainsStructuresWithoutJsonAnchors:!1};T(t,o,[n,i,d,g,h,l,p,e.partial(m,320),e.partial(y,r),e.partial(S,a)]),a.pageContainsStructuresWithoutJsonAnchors&&T(t,o,[x])}var M={"wysiwyg.viewer.components.HorizontalMenu":{comp:"wysiwyg.viewer.components.menus.DropDownMenu",dataQuery:"#MAIN_MENU"}};return{exec:function(e){var t=e.structure;if(t){var n={properties:{}},i=t.components||t.children,r=t.mobileComponents;i&&k(e,n,i),r&&I(e,n,r)}}}}),define("dataFixer/plugins/galleryFixer",["lodash"],function(e){"use strict";var t=["GalleryExpandProperties","MatrixGalleryProperties","PaginatedGridGalleryProperties","SliderGalleryProperties","SlideShowGalleryProperties"],n=function(t){return(e.isUndefined(t.galleryImageOnClickAction)||"unset"===t.galleryImageOnClickAction)&&(!1===t.expandEnabled?t.galleryImageOnClickAction="disabled":t.galleryImageOnClickAction="zoomMode"),t},i=function(t,n,i){return e(t).pickBy(function(t){return e.includes(n,t.type)}).mapValues(i).value()};return{exec:function(e){i(e.data.component_properties,t,n)}}}),define("dataFixer/helpers/behaviorsMigrationHelper",["coreUtils"],function(e){"use strict";return{createBehaviorsDataItem:function(t){return{id:e.guidUtils.getUniqueId("behavior","-"),type:"ObsoleteBehaviorsList",items:t}}}}),define("dataFixer/plugins/behaviorsDataFixer",["lodash","coreUtils","dataFixer/helpers/behaviorsMigrationHelper"],function(e,t,n){"use strict";function i(n){var i=t.dataUtils.getAllCompsInStructure(n,!1);return e.pickBy(i,"behaviors")}function r(n,i){var r=t.dataUtils.getAllCompsInStructure(n,!0);return e.pickBy(r,function(e){return i[e.id]})}function o(e,t,n){e.behaviorQuery=t.id,n&&(n.behaviorQuery=e.behaviorQuery)}return{exec:function(t){var a=e.get(t,"data"),s=e.get(t,"structure");a.behaviors_data=a.behaviors_data||{};var u=i(s),c=r(s,u);e.forEach(u,function(t){var i=n.createBehaviorsDataItem(t.behaviors);o(t,i,c[t.id]),delete t.behaviors,e.set(a,["behaviors_data",i.id],i)})}}}),define("dataFixer/plugins/behaviorsFixer",["lodash","dataFixer/plugins/behaviorsDataFixer"],function(e,t){"use strict";function n(e){return["behaviors_data",e.behaviorQuery,"items"]}function i(t){return e.has(t,"behaviors_data")}function r(t,r,o){var a=JSON.stringify(t);i(o)?e.set(o,n(r),a):r.behaviors=a}function o(t,r){return i(r)?e.get(r,n(t),"[]"):t.behaviors||"[]"}function a(t,n){var a=[],s=o(t,n),u=JSON.parse(s);if(e.isEmpty(u))i(n)?delete t.behaviorQuery:delete t.behaviors;else{if(e.isArray(u)){var c=!1;return e.forEach(u,function(n){var i=e.get(n,"action.sourceId");i&&i!==t.id&&(n.action.sourceId=t.id,c=!0)}),void(c&&r(u,t,n))}e.forEach(u,function(t,n){e.forEach(t,function(t,i){e.forEach(t,function(t){var r=e.assign({targetId:i,action:n},t);"screenIn"!==n&&"pageIn"!==n||(r.targetId=""),a.push(r)})})}),r(a,t,n)}}function s(t,n){e.forEach(t,function(e){a(e,n),e.components&&s(e.components,n)})}return{exec:function(e){t.exec(e);var n=e.structure;n&&(n.components&&s(n.components,e.data),n.mobileComponents&&s(n.mobileComponents,e.data),n.children&&s(n.children,e.data))}}}),define("dataFixer/plugins/connectionsDataFixer",["lodash"],function(e){"use strict";return{exec:function(t){var n=e.get(t,"data");n.connections_data=n.connections_data||{}}}}),define("dataFixer/plugins/fiveGridLineLayoutFixer",["lodash"],function(e){"use strict";function t(i){e.forEach(i,function(i){if(e.has(n,i.skin)){var r=n[i.skin];i.layout=e.mapValues(i.layout,function(e,t){return r[t]?Math.max(e,r[t]):e})}i.components&&t(i.components)})}var n={"wysiwyg.viewer.skins.line.FadeLine":{width:90},"wysiwyg.viewer.skins.line.FadeNotchBottomLine":{width:60},"wysiwyg.viewer.skins.line.FadeNotchTopLine":{width:60},"wysiwyg.viewer.skins.line.ShadowBottomLine":{width:200},"wysiwyg.viewer.skins.line.ShadowTopLine":{width:200}};return{exec:function(e){var n=e.structure;n&&(n.components&&t(n.components),n.children&&t(n.children),n.mobileComponents&&t(n.mobileComponents))}}}),define("dataFixer/plugins/toPageAnchorsFixer",["lodash"],function(e){"use strict";function t(t){var n=e.head(t);return!!e.get(n,"layout.anchors")}return{exec:function(n){var i=n.structure;if(i&&i.components&&!e.isEmpty(i.components)&&t(i.components)){var r,o=e.maxBy(i.components,function(t){var n=-1*Number.MAX_VALUE;return t.layout&&e.isNumber(t.layout.y)&&e.isNumber(t.layout.height)&&(n=t.layout.y+t.layout.height),n});o.layout&&o.layout.anchors&&(r=e.find(o.layout.anchors,{type:"BOTTOM_PARENT"})),r||(o.layout=o.layout||{},o.layout.anchors=o.layout.anchors||[],o.layout.anchors.push({distance:0,type:"BOTTOM_PARENT",targetComponent:n.structure.id,locked:!0,originalValue:n.structure.layout.height,topToTop:o.layout.y}))}}}}),define("dataFixer/helpers/anchorCyclesHelper",["lodash"],function(e){"use strict";function t(e){return e&&e.layout&&e.layout.y+e.layout.height}function n(e){return e.layout&&e.layout.anchors||[]}function i(n,i,r){var o;switch(n.type){case s.BOTTOM_BOTTOM:o=t(r);break;case s.BOTTOM_TOP:o=e.get(r,"layout.y");break;default:return!1}return!e.isUndefined(o)&&o-t(i)<0}function r(e){return e.type===s.BOTTOM_BOTTOM||e.type===s.BOTTOM_TOP}function o(t,i,a,s){if(s[i.id])return!1;s[i.id]=!0;var u=n(i);return u=e.filter(u,r),e.some(u,function(e){return e.targetComponent===t.id||o(t,a[e.targetComponent],a,s)})}function a(t){if(!e.isEmpty(t)){var s=e.keyBy(t,"id");e.forEach(t,function(t){var u=n(t);e.remove(u,function(e){return r(e)&&i(e,t,s[e.targetComponent])&&o(t,s[e.targetComponent],s,{})}),a(t.components)})}}var s={BOTTOM_BOTTOM:"BOTTOM_BOTTOM",BOTTOM_TOP:"BOTTOM_TOP"};return{fixBottomTopBottomBottomCycles:a}}),define("dataFixer/plugins/wrongAnchorsFixer",["lodash","dataFixer/helpers/anchorCyclesHelper"],function(e,t){"use strict";function n(e){T[e.componentType]&&(e.layout.anchors=[])}function i(e){"TOP_TOP"===e.type&&(e.locked=!0)}function r(e,t,n){var i=(n||0)*Math.PI/180;return parseInt(Math.abs(t*Math.sin(i))+Math.abs(e*Math.cos(i)),10)}function o(e,t,n){return parseInt(e-(n-t)/2,10)}function a(e){return e.layout&&e.layout.y+e.layout.height}function s(e){return e.layout&&e.layout.anchors||[]}function u(t,n,i,r,o){if(!(o[t.id]||a(t)>i)){o[t.id]=!0;var c=s(t);e.remove(c,function(e){if(e.targetComponent===n.id)return!0;if("BOTTOM_PARENT"!==e.type){if(!r[e.targetComponent])return!0;u(r[e.targetComponent],n,i,r,o)}return!1})}}function c(t,n,i){if("BOTTOM_TOP"===t.type){var r=s(i[t.targetComponent]);e.remove(r,{targetComponent:n.id});var o=e.filter(r,{type:"TOP_TOP"}),c=a(n)+10;e.forEach(o,function(e){i[e.targetComponent]&&u(i[e.targetComponent],n,c,i,{})})}}function p(t,n){"Document"===t.type&&e.forEach(n,function(e){"SITE_STRUCTURE"===e.targetComponent&&(e.targetComponent="masterPage")})}function d(t,n,i){n=e.reject(n,{type:"BOTTOM_PARENT"}),e.forEach(n,function(n){var r=i[n.targetComponent];if(r){var o=e.filter(s(r),{targetComponent:t.id,type:n.type});e.forEach(o,function(i){var o=t.layout.y<r.layout.y?r:t,a=t.layout.y<r.layout.y?i:n;e.remove(o.layout.anchors,function(e){return e===a})})}})}function l(t){e.forEach(t,function(n){var i=s(n);i=e.reject(i,{type:"BOTTOM_PARENT"}),e.remove(i,function(n){return!e.some(t,{id:n.targetComponent})})})}function m(t,n,i){var a=n.id,s=i[t.targetComponent];if("BOTTOM_PARENT"===t.type&&(s=t.targetComponent===a?n:null),!s)return!1;if("BOTTOM_BOTTOM"===t.type&&h[s.componentType])return!1;if("BOTTOM_PARENT"!==t.type&&(T[s.componentType]||"wysiwyg.viewer.components.HeaderContainer"===s.componentType&&s.layout&&!0===s.layout.fixedPosition))return!1;var u;if(s.layout&&e.isNumber(s.layout.height)&&e.isNumber(s.layout.y)){var c=s.layout,p=r(c.height,c.width,c.rotationInDegrees),d=o(c.y,c.height,p);u="BOTTOM_PARENT"===t.type||"BOTTOM_BOTTOM"===t.type?p:d}else u=0;return t.originalValue=Math.min(t.originalValue,u),!0}function g(t){e.remove(t,function(e){return null===e.distance||isNaN(e.distance)})}function f(e,t){!!t&&n(e)}function y(e,t){return f(e,t),w(e,t)}function w(t,r){var o=r?t[r]:t.components;if(!e.isEmpty(o)){var a=e.transform(o,function(e,t){e[t.id]=t},{});l(o),e.forEach(o,function(r){var o=s(r);g(o),n(r),p(t,o),d(r,o,a),e.remove(o,function(e){i(e);var n=m(e,t,a);return n&&c(e,r,a),!n}),w(r)})}}function v(t){var n=e.head(t);return!!e.get(n,"layout.anchors")}var h={"wysiwyg.common.components.anchor.viewer.Anchor":!0,"wysiwyg.common.components.subscribeform.viewer.SubscribeForm":!0,"wysiwyg.common.components.pinitpinwidget.viewer.PinItPinWidget":!0,"wysiwyg.common.components.singleaudioplayer.viewer.SingleAudioPlayer":!0,"wixapps.integration.components.AppPart":!0,"wixapps.integration.components.AppPart2":!0,"wixapps.integration.components.common.minipart":!0,"wysiwyg.common.components.onlineclock.viewer.OnlineClock":!0,"wysiwyg.common.components.weather.viewer.Weather":!0,"wysiwyg.common.components.skypecallbutton.viewer.SkypeCallButton":!0,"wysiwyg.common.components.spotifyfollow.viewer.SpotifyFollow":!0,"wysiwyg.common.components.spotifyplayer.viewer.SpotifyPlayer":!0,"wysiwyg.common.components.youtubesubscribebutton.viewer.YouTubeSubscribeButton":!0,"wysiwyg.viewer.components.ContactForm":!0,"wysiwyg.viewer.components.FacebookShare":!0,"wysiwyg.viewer.components.FiveGridLine":!0,"wysiwyg.viewer.components.FlickrBadgeWidget":!0,"wysiwyg.viewer.components.ItunesButton":!0,"wysiwyg.viewer.components.LinkBar":!0,"wysiwyg.viewer.components.PayPalButton":!0,"wysiwyg.viewer.components.PinterestFollow":!0,"wysiwyg.viewer.components.VKShareButton":!0,"wysiwyg.viewer.components.WFacebookComment":!0,"wysiwyg.viewer.components.WGooglePlusOne":!0,"wysiwyg.viewer.components.mobile.TinyMenu":!0},T={"wysiwyg.common.components.backtotopbutton.viewer.BackToTopButton":!0,"wysiwyg.viewer.components.tpapps.TPAGluedWidget":!0,"mobile.core.components.Page":!0,"wixapps.integration.components.AppPage":!0};return{exec:function(n){var i=n.structure,r="components";i&&("Document"===i.type&&((i=e.clone(n.structure)).id="masterPage",n.structure=i,r="children"),v(i[r])&&y(i,r),v(i.mobileComponents)&&(y(i,"mobileComponents"),t.fixBottomTopBottomBottomCycles(i.mobileComponents)))}}}),define("dataFixer/plugins/addMissingAnchorsOfMasterPage",["lodash"],function(e){"use strict";function t(e){return e*Math.PI/180}function n(e){if(!e.rotationInDegrees)return e.height;var n=t(e.rotationInDegrees);return parseInt(Math.abs(e.width*Math.sin(n))+Math.abs(e.height*Math.cos(n)),10)}function i(e){if(!e.rotationInDegrees)return e.y;var t=n(e);return parseInt(e.y-(t-e.height)/2,10)}function r(t){return e.maxBy(t,function(e){return i(e.layout)})}function o(t){var n=t.pagesContainer,i=t.header;n&&i&&(e.remove(n.layout.anchors,{targetComponent:"SITE_HEADER",type:"TOP_TOP"}),e.remove(i.layout.anchors,{targetComponent:"PAGES_CONTAINER",type:"TOP_TOP"}))}function a(t,o){var a=o.pagesContainer,s=o.header,u=o.footer,c=a&&a.components&&e.find(a.components,{id:"SITE_PAGES"});if(!c||!c.layout||c.layout.anchors&&0!==c.layout.anchors.length||(c.layout.anchors=[{distance:0,locked:!0,originalValue:0,targetComponent:"PAGES_CONTAINER",type:"BOTTOM_PARENT"}]),a&&a.layout&&(!a.layout.anchors||0===a.layout.anchors.length)&&u&&u.layout&&!u.layout.fixedPosition&&(a.layout.anchors=[{distance:10,locked:!0,originalValue:0,targetComponent:"SITE_FOOTER",type:"BOTTOM_TOP"}]),s&&!e.find(t,function(t){return e.find(t.layout.anchors,{type:"BOTTOM_PARENT",targetComponent:"masterPage"})})){var p=r(t);if(!p.layout.anchors)return;p.layout.anchors.push({distance:0,locked:!0,originalValue:i(p.layout)+n(p.layout)+(s?n(s.layout):0),targetComponent:"masterPage",type:"BOTTOM_PARENT"})}}function s(e){return!(e.length&&e[0].layout&&e[0].layout.anchors)}function u(t){var n={};return e.forEach(t,function(e){switch(e.id){case"SITE_HEADER":return n.header=e,!(n.footer&&n.pagesContainer);case"SITE_FOOTER":return n.footer=e,!(n.header&&n.pagesContainer);case"PAGES_CONTAINER":return n.pagesContainer=e,!(n.header&&n.footer);default:return!0}}),n}function c(t){if(t&&!e.isEmpty(t)&&!s(t)){var n=u(t);o(n),a(t,n)}}return{exec:function(e){var t=e.structure;t&&"Document"===t.type&&(c(t.children),c(t.mobileComponents))},test:{getBoundingHeight:n,getBoundingY:i,getLowestComp:r}}}),define("dataFixer/plugins/sitePagesFixer",["lodash"],function(e){"use strict";function t(t){var n;if(t.structure.children){var i=e.find(t.structure.children,{id:"PAGES_CONTAINER"});i&&!e.isEmpty(i.components)&&(n=e.find(i.components,{id:"SITE_PAGES"}))}return n}function n(t){var n;if(t.structure.mobileComponents){var i=e.find(t.structure.mobileComponents,{id:"PAGES_CONTAINER"});i&&!e.isEmpty(i.components)&&(n=e.find(i.components,{id:"SITE_PAGES"}))}return n}function i(t){e.isEmpty(t.components)||(t.components=[])}function r(e){e.layout&&(e.layout.y=0)}return{exec:function(e){if(e.structure&&"Document"===e.structure.type){var o=t(e),a=n(e);o&&(i(o),r(o)),a&&(i(a),r(a))}return e}}}),define("dataFixer/plugins/linkRefDataFixer",["lodash","coreUtils"],function(e,t){"use strict";return{exec:function(n){var i,r={toFix:["FlashComponent","SiteButton","Image"],newNames:["LinkableFlashComponent","LinkableButton","Image"],originalLink:["TextLink","Link"]},o=["href","text","target","icon","linkType"],a={oldValues:["same","other"],newValues:["_self","_blank"]},s=function(t){var n=e.indexOf(r.toFix,t.type),i=r.newNames[n],a=e.defaults({type:i},e.omit(t,o)),s=u(t,!0);return s&&(a.link=g(s.id),h[s.id]=s),t.type===a.type&&(a.metaData.schemaVersion="2.0"),a},u=function(e,t){var n=(e.linkType||"").toLowerCase(),i=t?w():e.id;switch(n){case"page":return p(i,e);case"website":return c(i,e);case"email":return l(i,e);case"document":return d(i,e);case"login":return m(i,e);case"admin_login":case"free_link":case"":default:return null}},c=function(e,t){var n={};n.id=e,n.type="ExternalLink",n.target=f(t.target);var i=t.href;return i?(n.url=i,n):null},p=function(e,t){var n={};n.id=e,n.type="PageLink";var i=t.href;if(!i)return null;var r=i.lastIndexOf("/");return r<0&&(r=i.lastIndexOf("|")),i=i.substr(r+1),n.pageId=g(i),n},d=function(e,t){var n,i,r={};r.type="DocumentLink",r.id=e;var o=t.href;return o?(n=o.substr(o.lastIndexOf("/")+1),-1!==(i=n.indexOf("?dn="))&&(n=n.substring(0,i)),r.docId=n,r.name=t.text,r):null},l=function(e,n){var i={};i.id=e,i.type="EmailLink";var r=n.href;if(!r||!r.toLowerCase)return null;t.stringUtils.startsWith(r,"mailto:",!0)&&(r=r.substr("mailto:".length));var o=r.split("?");if(i.recipient=o[0],o[1]){var a=y(o[1]);a.subject&&(i.subject=a.subject),a.body&&(i.body=a.body)}return i},m=function(e,n){var i={};i.id=e,i.type="LoginToWixLink";var r=n.text;return r&&t.stringUtils.startsWith(r,"{")&&(r=JSON.parse(r),i.postLoginUrl=r.postLoginUrl,i.postSignupUrl=r.postSignupUrl,i.dialog=r.type),i},g=function(e){return e?e&&t.stringUtils.startsWith(e,"#")?e:"#"+e:null},f=function(t){var n=e.indexOf(a.oldValues,t);return e.includes(a.newValues,t)?t:-1!==n?a.newValues[n]:a.newValues[1]},y=function(e){for(var t,n={},i=/([^&=]+)=([^&]*)/g;t=i.exec(e);)n[t[1]]=t[2];return n},w=function(){var t,i=e.keys(n.data.document_data);do{t=(t=(new Date).getTime().toString(36)+"_"+Math.round(99999*Math.random()).toString(36)).replace(/\s/g,"_")}while(i[t]);return t},v=n.data.document_data,h={};i=function(t){return e.filter(t,function(t){var n=!(t.type===r.toFix[2])||"2.0"!==t.metaData.schemaVersion;return!t.link&&e.includes(r.toFix,t.type)&&n})}(v),e.forEach(i,function(e){var t=s(e);t&&(v[e.id]=t)}),i=function(t){return e.filter(t,function(t){return t.linkType&&e.includes(r.originalLink,t.type)})}(v),e.forEach(i,function(e){var t=u(e);t&&(v[e.id]=t)}),e.assign(v,h)}}}),define("dataFixer/plugins/fromDocumentToThemeData",[],function(){"use strict";return{exec:function(e){var t=e.data;t.document_data.THEME_DATA&&(t.theme_data.THEME_DATA||(t.theme_data.THEME_DATA=t.document_data.THEME_DATA),delete t.document_data.THEME_DATA)}}}),define("dataFixer/plugins/tpaGluedWidgetDataFixer",["lodash"],function(e){"use strict";function t(t){e.forEach(t.structure.children,function(e){e.componentType===n&&(e.layout.fixedPosition=!0)})}var n="wysiwyg.viewer.components.tpapps.TPAGluedWidget";return{exec:function(n){"masterPage"===e.get(n,"structure.id")&&t(n)}}}),define("dataFixer/plugins/tpaAddChatAppDataFixer",["lodash","coreUtils","experiment"],function(e,t,n){"use strict";function i(e,n,i){var r=t.guidUtils.getUniqueId("dataItem","-");n.dataQuery="#"+r,i.id=r,e.data.document_data[r]=i}function r(t,n){var r=e.find(t,{appDefinitionId:T});if(r){var a=p(n,r.applicationId);if(e.forEach(a,function(t){var o=t.data,a=e.keys(o.widgets);o.applicationId===r.applicationId&&e.includes(a,o.widgetId)||i(n,t.comp,e.assign(o,{applicationId:r.applicationId,widgetId:k}))}),!d(r)&&!a.length){var m=e.get(r,"widgets."+k),g=l("comp","-"),f=l("dataItem","-"),y=l("propItem","-"),w=o(g,f,y,m);n.structure.children.push(w),n.data.document_data[f]=s(r,f),n.data.component_properties[y]=u(m),n.data.theme_data[w.styleId]||(n.data.theme_data[w.styleId]=c(w.styleId))}}}function o(t,n,i,r,o){return{type:"Component",styleId:o||"tpagw0",id:t,dataQuery:"#"+n,skin:"wysiwyg.viewer.skins.TPAWidgetSkin",layout:{width:e.get(r,"defaultWidth")||320,height:e.get(r,"defaultHeight")||250,x:e.get(r,"x")||0,y:e.get(r,"y")||0,scale:1,rotationInDegrees:0,fixedPosition:e.get(r,"fixedPosition")||!0},propertyQuery:i,componentType:"wysiwyg.viewer.components.tpapps.TPAGluedWidget"}}function a(e,t,n,i){return o(e,t=w(t),n=w(n),{x:10,y:10,width:0,height:5,fixedPosition:!1},i)}function s(e,t){return{type:"TPAWidget",id:t,metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1},applicationId:e.applicationId,widgetId:k}}function u(t){return{type:"TPAGluedProperties",metaData:{schemaVersion:"1.0"},placement:e.get(t,"gluedOptions.placement"),verticalMargin:e.get(t,"gluedOptions.verticalMargin"),horizontalMargin:e.get(t,"gluedOptions.horizontalMargin")}}function c(e){return{type:"TopLevelStyle",styleType:"system",compId:"",componentClassName:"wysiwyg.viewer.components.tpapps.TPAGluedWidget",pageId:"",skin:"wysiwyg.viewer.skins.TPAWidgetSkin",style:{groups:{},properties:{},propertiesSource:{}},id:e,metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1}}}function p(t,n){return e(t.structure.children).filter(function(i){if(!i.dataQuery)return!1;var r=t.data.document_data[i.dataQuery.replace("#","")];return e.get(r,"widgetId")===k||e.get(r,"applicationId")===n}).map(function(e){return{comp:e,data:t.data.document_data[e.dataQuery.replace("#","")]}}).value()}function d(t){return!0===e.get(t,"permissions.revoked")}function l(e,t){return m(x,e,t,Date.now())}function m(e,t,n,i){t=t||"",n=n||"";var r=i;return r===e.lastGeneratedId?e.counter++:(e.lastGeneratedId=r,e.counter=0),t+n+Number(e.lastGeneratedId).toString(36)+(e.counter||"")}function g(t,n){var i=e.find(n,{appDefinitionId:T}),r=p(t).length>0;t&&t.structure.id===S&&i&&!e.get(i,"permissions.revoked")&&r&&f(t.data,t.structure.children,i)&&!f(t.data,t.structure.mobileComponents,i)&&v(t,y(t.data.document_data,t.structure.children,i))}function f(e,t,n){return!!y(e.document_data,t,n)}function y(t,n,i){for(var r=[].concat(n);!e.isEmpty(r);){var o=r.shift();if(o.componentType===h){var a=t[w(o.dataQuery)];if(Number(a.applicationId)===Number(i.applicationId))return o}e.isEmpty(o.components)||(r=r.concat(o.components))}return null}function w(e){return e&&"#"===e[0]?e.substr(1):e}function v(t,n){var i=t.structure.mobileComponents,r=e.find(i,{id:"SITE_FOOTER"}),o=n.dataQuery,s=n.propertyQuery,u=n.styleId;r&&e.isArray(r.components)?r.components.push(a(n.id,o,s,u)):i.push(a(n.id,o,s,u))}var h="wysiwyg.viewer.components.tpapps.TPAGluedWidget",T="14517e1a-3ff0-af98-408e-2bd6953c36a2",k="14517f3f-ffc5-eced-f592-980aaa0bbb5c",S="masterPage",x={lastGeneratedId:void 0,counter:0};return{exec:function(t,i,o,a,s,u,c){var p=e.get(c,"clientSpecMap");if("masterPage"===t.structure.id){r(p,t);var d=e.get(c,"siteMetaData.quickActions.configuration.quickActionsMenuEnabled");n.isOpen("sv_qab",{rendererModel:c})&&e.get(t,"structure.id")===S&&!d&&g(t,p)}}}}),define("dataFixer/plugins/tpaProGalleryBackgroundDataFixer",["lodash","experiment"],function(e,t){"use strict";function n(){return{type:"BackgroundMedia",color:"transparent",alignType:"center",fittingType:"fill",scrollType:"none",mediaRef:null}}function i(t,n){var i=e.get(t,"structure.id"),o=e.get(t,["data","document_data",i]),a=e.get(o,"tpaPageId"),s=e.get(o,"tpaApplicationId");a===p&&s===n&&(r(o,t,"desktop"),r(o,t,"mobile"),t.structure.styleId=d)}function r(t,i,r){var o=e.get(t,"pageBackgrounds."+r+".ref");o=e.replace(o,"#","");var a=e.get(i,["data","document_data",o]);a&&e.merge(a,n())}function o(t,n){if("masterPage"===e.get(t,"structure.id")){var i=e.get(t,"data.document_data"),o=e.find(i,{tpaApplicationId:n,tpaPageId:p});o&&(r(o,t,"desktop"),r(o,t,"mobile"))}else a(t)}function a(t){var n=e.get(t,["structure","components"]),i=e.find(n,{componentType:l});if(i){var r=i.dataQuery.replace("#","");e.get(t,["data","document_data",r,"widgetId"])===c&&(t.structure.styleId=d)}}function s(t){var n=e.get(t,"clientSpecMap"),i=e.find(n,{appDefinitionId:u});return e.get(i,"applicationId")}var u="14271d6f-ba62-d045-549b-ab972ae1f70e",c="144f04b9-aab4-fde7-179b-780c11da4f46",p="fullscreen_page",d="non_existing_style_id",l="wysiwyg.viewer.components.tpapps.TPAMultiSection";return{exec:function(e,n,r,a,u,c,p){var d=s(p);d&&(c?i(e,d):t.isOpen("se_proGalleryBGDataFixer",{rendererModel:p})&&o(e,d))}}}),define("dataFixer/imageService/imageTransformDataFixers",["lodash","imageClientApi"],function(e,t){"use strict";function n(e){return(e||"").toLowerCase().trim()}var i=t.fittingTypes,r=t.alignTypes,o={"repeat-x":i.TILE_HORIZONTAL,"repeat no_repeat":i.TILE_HORIZONTAL,"repeat no-repeat":i.TILE_HORIZONTAL,"repeat-y":i.TILE_VERTICAL,"no_repeat repeat":i.TILE_VERTICAL,"no-repeat repeat":i.TILE_VERTICAL,repeat:i.TILE,"repeat repeat":i.TILE,"":""};Object.freeze(o);var a={auto:function(e){return e||i.LEGACY_ORIGINAL_SIZE},cover:function(){return i.SCALE_TO_FILL},contain:function(e){return e?i.FIT_AND_TILE:i.SCALE_TO_FIT},"":function(){return i.SCALE_TO_FILL}};Object.freeze(a);var s={"center center":r.CENTER,center:r.CENTER,"50% 50%":r.CENTER,"top center":r.TOP,"center top":r.TOP,"50% 0%":r.TOP,"bottom center":r.BOTTOM,"center bottom":r.BOTTOM,"50% 100%":r.BOTTOM,"center right":r.RIGHT,"right center":r.RIGHT,"100% 50%":r.RIGHT,"center left":r.LEFT,"left center":r.LEFT,"0% 50%":r.LEFT,"left top":r.TOP_LEFT,"top left":r.TOP_LEFT,"0% 0%":r.TOP_LEFT,"right top":r.TOP_RIGHT,"top right":r.TOP_RIGHT,"100% 0%":r.TOP_RIGHT,"left bottom":r.BOTTOM_LEFT,"bottom left":r.BOTTOM_LEFT,"0% 100%":r.BOTTOM_LEFT,"right bottom":r.BOTTOM_RIGHT,"bottom right":r.BOTTOM_RIGHT,"100% 100%":r.BOTTOM_RIGHT,"":r.CENTER};Object.freeze(s);var u=function(){var e={};return e[i.LEGACY_STRIP_TILE_HORIZONTAL]="repeat-x",e[i.TILE_HORIZONTAL]="repeat-x",e[i.LEGACY_STRIP_TILE_VERTICAL]="repeat-y",e[i.TILE_VERTICAL]="repeat-y",e[i.LEGACY_STRIP_TILE]="repeat",e[i.TILE]="repeat",e[i.FIT_AND_TILE]="repeat",e[""]="no-repeat",e}();Object.freeze(u);var c=function(){var e={};return e[i.LEGACY_ORIGINAL_SIZE]="auto",e[i.LEGACY_STRIP_ORIGINAL_SIZE]="auto",e[i.SCALE_TO_FILL]="cover",e[i.LEGACY_STRIP_SCALE_TO_FILL]="cover",e[i.SCALE_TO_FIT]="contain",e[i.LEGACY_STRIP_SCALE_TO_FIT]="contain",e[i.FIT_AND_TILE]="contain",e[i.LEGACY_STRIP_FIT_AND_TILE]="contain",e[""]="auto",e}();Object.freeze(c);var p=function(){var e={};return e[r.TOP]="center top",e[r.CENTER]="center",e[r.BOTTOM]="center bottom",e[r.TOP_LEFT]="left top",e[r.LEFT]="left center",e[r.BOTTOM_LEFT]="left bottom",e[r.TOP_RIGHT]="right top",e[r.RIGHT]="right center",e[r.BOTTOM_RIGHT]="right bottom",e[""]="center",e}();return Object.freeze(p),{cssToFittingType:function(e){var t=n(e.bgRepeat),i=n(e.bgSize),r=o[t];return a[i]&&a[i](r)},cssToAlignType:function(e){return e=n(e),s[e]},fittingTypeToBgRepeat:function(e){return u[e]||u[""]},fittingTypeToBgSize:function(e){return c[e]||c[""]},alignTypeToBgPosition:function(e){return p[e]||p[""]},migrateToLegacyFittings:function(e){return e===i.TILE?i.LEGACY_STRIP_TILE:e===i.TILE_HORIZONTAL?i.LEGACY_STRIP_TILE_HORIZONTAL:e===i.TILE_VERTICAL?i.LEGACY_STRIP_TILE_VERTICAL:e===i.SCALE_TO_FILL?i.LEGACY_STRIP_SCALE_TO_FILL:e===i.SCALE_TO_FIT?i.LEGACY_STRIP_SCALE_TO_FIT:e===i.FIT_AND_TILE?i.LEGACY_STRIP_FIT_AND_TILE:e===i.LEGACY_ORIGINAL_SIZE?i.LEGACY_STRIP_ORIGINAL_SIZE:e}}}),define("dataFixer/plugins/compsWithImagesDataFixer",["lodash","dataFixer/imageService/imageTransformDataFixers"],function(e,t){"use strict";function n(t){e.forEach(t,function(e){var t=i[e.type];t&&t(e)})}var i={BgImageStripProperties:function(e){e.fittingType=t.cssToFittingType({bgSize:e.bgSize,bgRepeat:e.bgRepeat}),e.fittingType=t.migrateToLegacyFittings(e.fittingType),e.alignType=t.cssToAlignType(e.bgPosition),e.type="BgImageStripUnifiedProperties",delete e.bgSize,delete e.bgRepeat,delete e.bgPosition,delete e.bgUrl}};return{exec:function(t){var i=t.data.component_properties;e.isEmpty(i)||n(i)}}}),define("dataFixer/plugins/appPartCustomizationsFixer",["lodash"],function(e){"use strict";var t={faq:{filterAppPart:{appPartName:"f2c4fc13-e24d-4e99-aadf-4cff71092b88",viewName:"ExpandQuestions"},filterAppLogicCustomization:{type:"AppPartCustomization",forType:"Category",view:"ToggleMobile",key:"comp.initialState",fieldId:"toggle",format:"Mobile"},modify:function(t){return e.assign(t,{fieldId:"vars",key:"initialState"})}}};return{exec:function(n){e(t).values().forEach(function(t){e(n.data.document_data).filter(t.filterAppPart).forEach(function(n){n.appLogicCustomizations=e(n.appLogicCustomizations).map(function(n){return e.find([n],t.filterAppLogicCustomization)?t.modify(n):n}).compact().value()})})}}}),define("dataFixer/plugins/backgroundMediaConverter",["lodash","dataFixer/imageService/imageTransformDataFixers","coreUtils"],function(e,t,n){"use strict";function i(t,n){var i=e.filter(t,function(e){return"Page"===e.type||"AppPage"===e.type}),r=e.map(i,"id");e.some(i,function(e){return e.pageBackgrounds&&e.pageBackgrounds.desktop.ref})?o(t):u(t,n.siteBg,n.mobileBg&&"[siteBg]"!==n.mobileBg?n.mobileBg:n.siteBg,r)}function r(e){o(e)}function o(t){var n=e.filter(t,{type:w});e.forEach(n,function(e){a(t,e)})}function a(e,t){var i=t.id,r=n.guidUtils.getUniqueId(v+T);s(e,d(t),i,r)}function s(t,n,i,r){t[i]=e.assign({id:i},n.bgItem),n.imageItem&&(t[i].mediaRef="#"+r,t[r]=e.assign({id:r},n.imageItem))}function u(t,i,r,o){var a=p(i),s=p(r);e.forEach(o,function(e){var i=n.guidUtils.getUniqueId(h,T),r=n.guidUtils.getUniqueId(h,T),o=i.replace(h,v),u=r.replace(h,v);c(t,a,e,i,o,"desktop"),c(t,s,e,r,u,"mobile")})}function c(e,t,n,i,r,o){e[n].pageBackgrounds=e[n].pageBackgrounds||{desktop:"",mobile:""},e[n].pageBackgrounds[o]={ref:"#"+i,custom:!0,isPreset:!1},s(e,t,i,r)}function p(t){return m(l.apply(this,e.compact(t.split(" "))))}function d(e){return m(l.apply(this,[e.url,e.imagesizew,e.imagesizeh,e.positionx,e.positiony,e.width,e.repeatx,e.repeaty,e.attachment,e.color,e.metaData]))}function l(e,t,n,i,r,o,a,s,u,c,p){return p=p||{},{imageId:e,imageW:t,imageH:n,x:i,y:r,width:o,repeatX:a,repeatY:s,attachment:u,color:c,metaData:{isPreset:p.isPreset||!1,schemaVersion:"2.0",isHidden:p.isHidden||!1}}}function m(e){var n={bgItem:{}},i="rgb(255,255,255)",r=t.cssToAlignType(e.x+" "+e.y),o=t.cssToFittingType({bgRepeat:e.repeatX+" "+e.repeatY,bgSize:e.width}),a="fixed"===e.attachment?"fixed":"scroll";return o=g(o),e.color&&"none"!==e.color&&(i=e.color),e.imageId&&"none"!==e.imageId&&(n.imageItem={type:"Image",uri:e.imageId,width:parseInt(e.imageW,10),height:parseInt(e.imageH,10),metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1}}),n.bgItem={type:"BackgroundMedia",color:i,alignType:r,fittingType:o,scrollType:a,metaData:e.metaData},n}function g(e){var t={};return t[n.imageUtils.fittingTypes.TILE]=n.imageUtils.fittingTypes.LEGACY_BG_FIT_AND_TILE,t[n.imageUtils.fittingTypes.TILE_HORIZONTAL]=n.imageUtils.fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,t[n.imageUtils.fittingTypes.TILE_VERTICAL]=n.imageUtils.fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL,t[n.imageUtils.fittingTypes.LEGACY_ORIGINAL_SIZE]=n.imageUtils.fittingTypes.LEGACY_BG_NORMAL,t[e]||e}function f(e){e.siteBg=y(e.siteBg),e.mobileBg&&"[siteBg]"!==e.mobileBg&&(e.mobileBg=y(e.mobileBg))}function y(t){var n=e.compact(t.split(" ")),i=l.apply(this,n).color;return i&&(i=(i=i.replace("[","{")).replace("]","}"),n[9]=i),n.join(" ")}var w="BackgroundImage",v="bgImage",h="mediaBg",T="-";return{exec:function(t){if(t.structure){var n=t.data.theme_data&&t.data.theme_data.THEME_DATA,o=t.data.document_data,a=e.some(o,{type:"BackgroundMedia"}),s=e.some(o,{type:w});a&&!s||("Document"===t.structure.type?(f(n),i(o,n)):r(o))}}}}),define("dataFixer/plugins/backgroundMediaUndefinedFixer",["lodash","coreUtils"],function(e,t){"use strict";function n(e,n){return t.guidUtils.getUniqueId(n.id,"_")+e}function i(t,n){n[t]=e.assign({id:t},o)}function r(t){var r=e.filter(t,function(e){return"Page"===e.type||"AppPage"===e.type});e.forEach(r,function(r){var o;e.defaults(r,a),r.pageBackgrounds.mobile.ref||(i(o=n("_mobile_bg",r),t),r.pageBackgrounds.mobile.ref="#"+o),r.pageBackgrounds.desktop.ref||(i(o=n("_desktop_bg",r),t),r.pageBackgrounds.desktop.ref="#"+o)})}var o={alignType:"center",color:"{color_11}",fittingType:"fill",scrollType:"scroll",type:"BackgroundMedia"},a={pageBackgrounds:{desktop:{custom:!0,isPreset:!0,ref:null},mobile:{custom:!0,isPreset:!0,ref:null}}};return{exec:function(t){if(t.structure){var n=t.data.document_data;e.some(n,{type:"BackgroundMedia"})&&r(n)}}}}),define("dataFixer/plugins/backgroundMediaRefDuplicationFixer",["lodash"],function(e){"use strict";function t(t,n,i){i[t]=e.assign({id:t},e.omit(n,"id"))}function n(e,t,n){return e+"_"+t+"_"+n}function i(i,r,o,a,s){if(0!==i[r].indexOf("#"+a)){var u=e.cloneDeep(s[i[r].replace("#","")]),c=n(a,o,r);t(c,u,s),i[r]="#"+c}}function r(e,t,n){var r,o=n[t.pageBackgrounds[e].ref.replace("#","")];o&&o.mediaRef&&("WixVideo"===(r=n[o.mediaRef.replace("#","")]).type&&i(r,"posterImageRef",e,t.id,n),o.imageOverlay&&i(o,"imageOverlay",e,t.id,n),i(o,"mediaRef",e,t.id,n))}function o(e,t){e.pageBackgrounds&&(r("mobile",e,t),r("desktop",e,t))}return{exec:function(t){if(t.structure){var n=t.data.document_data,i=e.filter(n,function(e){return"Page"===e.type||"AppPage"===e.type});e.forEach(i,function(e){o(e,n)})}}}}),define("dataFixer/plugins/stripContainerBgEffectFixer",["lodash","dataFixer/helpers/behaviorsMigrationHelper"],function(e,t){"use strict";function n(t,n){var i=e.get(n,[t.behaviorQuery,"items"],"[]");return JSON.parse(i)}function i(e,t){var n,i;return i=e.designQuery.replace("#",""),n=t[i].background.replace("#",""),t[n]}function r(r,o,a){var s,p;if(e.includes(u,r.componentType)){var d=i(r,o);if(p=d.scrollType,d.scrollType="none","scroll"!==p&&"none"!==p){s=n(r,a),(s=e.reject(s,{name:"ContainerFixedBg",action:"bgScrub"})).push(c[p]);var l=JSON.stringify(s);if(r.behaviorQuery)e.set(a,[r.behaviorQuery,"items"],l);else{var m=t.createBehaviorsDataItem(l);e.set(a,m.id,m),r.behaviorQuery=m.id}}}}function o(t,r,o){var a;e.includes(u,t.componentType)&&(i(t,r).scrollType="none",a=n(t,o),a=e.reject(a,{name:"ContainerFixedBg",action:"bgScrub"}),e.isEmpty(a)?(delete t.behaviors,delete t.behaviorQuery):e.set(o,[t.behaviorQuery,"items"],JSON.stringify(a)))}function a(t,n,i){e.forEach(t,function(e){r(e,n,i),e.components&&a(e.components,n,i)})}function s(t,n,i){e.forEach(t,function(e){o(e,n,i),e.components&&s(e.components,n,i)})}var u=["wysiwyg.viewer.components.StripContainer","wysiwyg.viewer.components.StripContainerSlideShowSlide"],c={fixed:{action:"bgScrub",name:"BackgroundReveal",duration:1,delay:0},parallax:{action:"bgScrub",name:"BackgroundParallax",duration:1,delay:0}};return{exec:function(e){var t,n=e.structure;if(n){t=e.data.design_data;var i=e.data.behaviors_data;n.components&&a(n.components,t,i),n.children&&a(n.children,t,i),n.mobileComponents&&s(n.mobileComponents,t,i)}}}}),define("dataFixer/plugins/documentMediaFixer",["lodash"],function(e){"use strict";return{exec:function(t){if("Page"===t.structure.type){var n=t.structure.components,i=t.data.document_data;e.forEach(n,function(t){if(e.includes(t.componentType,"DocumentMedia")){var n=t.dataQuery,r=i[n.replace("#","")];0===r.uri.indexOf("media/")&&(r.uri=r.uri.replace("media/",""))}})}return t}}}),define("dataFixer/plugins/pinterestFollowFixer",["lodash"],function(e){"use strict";var t=function(t){t.urlChoice=e.includes(t.urlChoice,"pinterest.com")?t.urlChoice:"www.pinterest.com/"+t.urlChoice};return{exec:function(n){return e(n.data.document_data).pickBy({type:"PinterestFollow"}).mapValues(t).value()}}}),define("dataFixer/plugins/blogPageMenuFixer",["lodash"],function(e){"use strict";function t(e){var t=n(e);t&&i(e,"#"+t)}function n(t){var n=e.findKey(t,function(e){return e.appPageId&&"7326bfbb-4b10-4a8e-84c1-73f776051e10"===e.appPageId});if(!n)return null;var i=e.findKey(t,function(e){return e.pageId&&e.pageId==="#"+n});return e.findKey(t,function(e){return e.link&&e.link==="#"+i})}function i(t,n){var i=t.CUSTOM_MAIN_MENU&&t.CUSTOM_MAIN_MENU.items;e.forEach(i,function(i){var r=t[i.replace("#","")].items,o=e.indexOf(r,n);if(-1!==o)return r.splice(o,1),t.CUSTOM_MAIN_MENU.items.push(n),!1})}return{exec:function(e){return e.structure&&"Document"===e.structure.type&&t(e.data.document_data),e}}}),define("dataFixer/plugins/appPartMediaInnerCustomizationFormatFixer",["lodash","coreUtils"],function(e,t){"use strict";var n={exec:function(i){i.data&&i.data.document_data&&e(i.data.document_data).filter(function(e){return n.isAppPartType(e.type)}).forEach(function(n){e(n.appLogicCustomizations).compact().groupBy("view").filter(function(e,n){return t.appPartMediaInnerViewNameUtils.isMediaInnerViewName(n)}).forEach(function(t){e(t).groupBy("fieldId").filter(function(t){return e.isEqual(e.map(t,"format"),[""])}).forEach(function(t){e.forEach(t,function(e){e.format="*"})})})})},isAppPartType:function(e){return"AppPart"===e}};return n}),define("dataFixer/plugins/appPartReadMoreValueCustomizationFormatFixer",["lodash","coreUtils"],function(e,t){"use strict";var n={exec:function(t){t.data&&e(t.data.document_data).filter(function(t){return t.type===n.getAppPartType()&&e.includes(n.getBlogFeedAppPartNames(),t.appPartName)}).forEach(function(t){var i=t.appLogicCustomizations;e(i).compact().filter(function(t){return t.fieldId===n.getReadMoreValueCustomizationFieldId()&&t.key===n.getReadMoreValueCustomizationKey()&&""===t.format&&e.includes(n.getAffectedReadMoreValueCustomizationViews(),t.view)}).forEach(function(t){e.remove(i,{fieldId:t.fieldId,format:"*",key:t.key,view:t.view}),t.format="*"})})},getAppPartType:function(){return"AppPart"},getBlogFeedAppPartNames:function(){return[t.blogAppPartNames.FEED,t.blogAppPartNames.CUSTOM_FEED]},getReadMoreValueCustomizationFieldId:function(){return"ReadMoreBtn"},getReadMoreValueCustomizationKey:function(){return"value"},getAffectedReadMoreValueCustomizationViews:function(){return["MediaLeft","MediaLeftPage","MediaRight","MediaRightPage","MediaZigzag","MediaZigzagPage","Masonry","MasonryPage"]}};return n}),define("dataFixer/plugins/appPartTagsValueCustomizationFormatFixer",["lodash"],function(e){"use strict";return{exec:function(t){e(t.data.document_data).filter({type:"AppPart"}).forEach(function(t){e(t.appLogicCustomizations).filter({fieldId:"tagsValue",forType:"Post",format:"",key:"value",view:"SinglePostMediaTop"}).forEach(function(e){e.format="*"})})}}}),define("dataFixer/plugins/appPartDuplicateCustomizationFixer",["lodash"],function(e){"use strict";function t(t){var n=e.omit(t,"value");return JSON.stringify(n)}return{exec:function(n){e(n.data.document_data).filter({type:"AppPart"}).forEach(function(e){for(var n=e.appLogicCustomizations,i=n.length,r={};i;){var o=t(n[i-=1]);r[o]?n.splice(i,1):r[o]=!0}})}}}),define("dataFixer/plugins/blogCustomFeedPostsPerPageCustomizationFixer",["lodash","coreUtils"],function(e,t){"use strict";function n(t){return"Array"===t.forType&&"comp.itemsPerPage"===t.key&&e.includes(["","*"],t.format)&&e.includes(["paginatedlist","columnBlog"],t.fieldId)&&e.includes(["MediaTop","MediaBottom","MediaLeft","MediaRight","MediaZigzag","Masonry"],t.view)}return{exec:function(i){e(i.data.document_data).filter({type:"AppPart",appPartName:t.blogAppPartNames.CUSTOM_FEED}).forEach(function(t){e(t.appLogicCustomizations).filter(n).forEach(function(t){e.assign(t,{fieldId:"vars",format:"*",key:"itemsPerPage"})})})}}}),define("dataFixer/plugins/blogDateAndAuthorHiddenCustomizationFixer",["lodash","coreUtils"],function(e,t){"use strict";function n(t){return"Post"===t.forType&&"comp.hidden"===t.key&&("date"===t.fieldId||"author"===t.fieldId)&&e.includes(["MediaTop","MediaBottom","MediaLeft","MediaRight","MediaZigzag","Masonry","MediaTopPage","MediaBottomPage","MediaLeftPage","MediaRightPage","MediaZigzagPage","MasonryPage","SinglePostMediaBottom","SinglePostMediaTop"],t.view)}return{exec:function(i){e(i.data.document_data).filter(function(n){return"AppPart"===n.type&&e.includes([t.blogAppPartNames.CUSTOM_FEED,t.blogAppPartNames.FEED,t.blogAppPartNames.SINGLE_POST],n.appPartName)}).forEach(function(t){e(t.appLogicCustomizations).filter(n).forEach(function(t){e.assign(t,{fieldId:"dateAndAuthor"})})})}}}),define("dataFixer/plugins/blogDateAlignmentCustomizationFixer",["lodash","coreUtils"],function(e,t){"use strict";function n(t){return"Post"===t.forType&&"layout.spacerBefore"===t.key&&"date"===t.fieldId&&e.includes(["MediaTop","MediaBottom","MediaLeft","MediaRight","MediaZigzag","Masonry","MediaTopPage","MediaBottomPage","MediaLeftPage","MediaRightPage","MediaZigzagPage","MasonryPage","SinglePostMediaBottom","SinglePostMediaTop"],t.view)}return{exec:function(i){e(i.data.document_data).filter(function(n){return"AppPart"===n.type&&e.includes([t.blogAppPartNames.CUSTOM_FEED,t.blogAppPartNames.FEED,t.blogAppPartNames.SINGLE_POST],n.appPartName)}).forEach(function(t){e(t.appLogicCustomizations).filter(n).forEach(function(t){e.assign(t,{fieldId:"vars",key:"dateAndAuthorPosition",value:"0"===t.value?"left":"right"})})})}}}),define("dataFixer/plugins/appPartBrokenButtonStyleFixer",["lodash","coreUtils"],function(e,t){"use strict";var n=null;return{exec:function(i){e.isNull(n)&&(n=[],e.forEach(i.data.theme_data,function(t,i,r){e.matches({componentClassName:"wysiwyg.viewer.components.SiteButton",skin:"wysiwyg.viewer.skins.AppPartSkin"})(t)&&(n.push(i),delete r[i])}),setTimeout(function(){n=null})),e(i.data.document_data).filter(function(n){return"AppPart"===n.type&&e.includes(t.blogAppPartNames,n.appPartName)}).forEach(function(t){e.remove(t.appLogicCustomizations,function(t){return"comp.style"===t.key&&e.includes(n,t.value)})})}}}),define("dataFixer/plugins/blogDateFormatCustomizationFormatFixer",["lodash","coreUtils"],function(e,t){"use strict";var n={};return n[t.blogAppPartNames.FEED]=["MediaBottomPage","MediaLeftPage","MediaRightPage","MediaTopPage","MediaZigzagPage"],n[t.blogAppPartNames.POSTS_LIST]=["PostsList","PostsListMediaLeft"],n[t.blogAppPartNames.TICKER]=["TickerMediaBottom","TickerMediaTop"],{exec:function(i){e(i.data.document_data).filter(function(n){return"AppPart"===n.type&&e.includes([t.blogAppPartNames.FEED,t.blogAppPartNames.POSTS_LIST,t.blogAppPartNames.TICKER],n.appPartName)}).forEach(function(t){e(t.appLogicCustomizations).filter(function(i){return"date"===i.fieldId&&"Post"===i.forType&&!i.format&&"comp.format"===i.key&&e.includes(n[t.appPartName],i.view)}).forEach(function(e){e.format="*"})})}}}),define("dataFixer/plugins/contactFormDataFixer",["lodash","coreUtils","translationsUtils"],function(e,t,n){"use strict";function i(t){return"Template"===e.get(t,"siteInfo.documentType")}function r(r,o,s,u){var c,p;i(u)&&(c=t.wixUserApi.getLanguage(o.cookie,s,o.language),(p=n.contactFormTranslations[c])&&e.forOwn(r,function(t){"ContactForm"===t.type&&e.forEach(a,function(e){t[e]=p[e]||t[e]})}))}function o(t){e.forOwn(t,function(e){"ContactForm"===e.type&&(e.onSubmitBehavior||(e.onSubmitBehavior="message"))})}var a=["addressFieldLabel","emailFieldLabel","errorMessage","messageFieldLabel","nameFieldLabel","phoneFieldLabel","subjectFieldLabel","submitButtonLabel","successMessage","validationErrorMessage"];return{exec:function(e,t,n,i,a,s,u){var c=e.data.document_data;r(c,n,i,u),o(c)}}}),define("dataFixer/plugins/contactFormMigrationDataFixer",["lodash","experiment"],function(e,t){"use strict";function n(e){return(e||"").replace("#","")}function i(e){switch(e){case"email":return{fieldType:"email",fieldInputType:"email"};case"phone":return{fieldType:"phone",fieldInputType:"tel"};default:return{fieldType:e,fieldInputType:"text"}}}function r(e,t){switch(t){case"naive":return i(e);default:return{}}}function o(t,n,i,o){var a=e.startsWith(t,u.skinPrefix)?u.fields:c.fields;return e.reduce(a,function(e,t){var a=t+"FieldLabel",s=i["hidden_"+a];if(s){var u=r(t,o);e.push({name:u.fieldType,inputType:u.fieldInputType,displayLabel:n[a],required:i["required_"+a],isDisplayed:s})}return e},[])}function a(t){var i=n(t.dataQuery),r=this.pageJson.data.document_data[i],a=n(t.propertyQuery),s=this.pageJson.data.component_properties[a];t.componentType="wysiwyg.viewer.components.DynamicContactForm",s&&(e.assign(this.pageJson.data.document_data[i],{type:"DynamicContactForm",dynamicFields:o(t.skin,r,s,this.migrationPolicy)}),["name","email","subject","phone","address","message"].forEach(function(e){delete this.pageJson.data.document_data[i][e+"FieldLabel"]}.bind(this)),delete this.pageJson.data.component_properties[a])}function s(t){t&&e.forEach(t,function(e){"wysiwyg.viewer.components.ContactForm"===e.componentType&&a.call(this,e),s.call(this,e.components)}.bind(this))}var u={skinPrefix:"contactform.",fields:["name","email","subject","phone","address","message"]},c={skinPrefix:"wysiwyg.viewer.skins.contactform.",fields:["name","email","phone","address","subject","message"]};return{exec:function(n,i,r,o,a,u,c){var p=n.structure;if(t.isOpen("sv_contactFormTemplatesMigration",{rendererModel:c})&&p){var d=e.concat([],p.components||p.children,p.mobileComponents||[]);s.call({pageJson:n,migrationPolicy:"naive"},d)}}}}),define("dataFixer/plugins/subscribeFormDataFixer",["lodash","coreUtils","translationsUtils"],function(e,t,n){"use strict";function i(t){return"Template"===e.get(t,"siteInfo.documentType")}function r(r,o,s,u){var c,p;i(u)&&(c=t.wixUserApi.getLanguage(o.cookie,s,o.language),(p=n.subscribeFormTranslations[c])&&e.forOwn(r,function(t){"SubscribeForm"===t.type&&e.forEach(a,function(e){t[e]=p[e]||t[e]})}))}function o(t){e.forOwn(t,function(e){"SubscribeForm"===e.type&&(e.onSubmitBehavior||(e.onSubmitBehavior="message"))})}var a=["emailFieldLabel","errorMessage","firstNameFieldLabel","lastNameFieldLabel","phoneFieldLabel","submitButtonLabel","subscribeFormTitle","successMessage","validationErrorMessage"];return{exec:function(e,t,n,i,a,s,u){var c=e.data.document_data;r(c,n,i,u),o(c)}}}),define("dataFixer/plugins/pageDataFixer",["lodash"],function(e){"use strict";function t(t){return"Page"===e.get(t,"structure.type")}function n(t){e(t.data.document_data).filter({type:"Page"}).map("id").forEach(function(e){delete t.data.document_data[e]})}function i(t){e.forEach(t.data.document_data,function(e){"#SITE_STRUCTURE"===e.pageId&&(e.pageId="#masterPage")})}return{exec:function(e){t(e)&&n(e),i(e)}}}),define("dataFixer/plugins/groupFixer",["lodash"],function(e){"use strict";function t(e){e.componentType===i&&(e.skin=r)}function n(i){e.forEach(i,function(e){t(e),n(e.components)})}var i="wysiwyg.viewer.components.Group",r="wysiwyg.viewer.components.GroupSkin";return{exec:function(e){var t=e.structure;if(t){var i=t.components||t.children,r=t.mobileComponents;i&&n(i),r&&n(r)}}}}),define("dataFixer/plugins/textSecurityFixer",["lodash"],function(e){"use strict";function t(t){return e(t).pickBy(function(t){return e.includes(r,t.type)}).mapValues(function(e){return e.text=n(e.text),e.text=i(e.text),e}).value()}function n(e){return e&&e.replace(/(<object[^>]*>)(.*?)(<\/object>)/gi,"")}function i(e){return e&&e.replace(/<img[^>]*(onerror|onload|onmouseenter|onmousemove|onmouseleave|onmouseover|onmouseup|onmouseout)[^>]*\/?>(<\/img>)?/gi,"")}var r=["RichText","Text","StyledText","MediaRichText"];return{exec:function(e){var n=e.data.document_data;n&&t(n)}}}),define("dataFixer/plugins/pageUriSeoFixer",["lodash","coreUtils"],function(e,t){"use strict";var n=e.matchesProperty(["structure","type"],"Page"),i=e.matchesProperty("format",t.siteConstants.URL_FORMATS.SLASH);return{exec:function(t,r,o,a,s){i(s)&&!n(t)&&e.forEach(s.pageIdToResolvedUriSEO,function(e,n){t.data.document_data[n].pageUriSEO=e.curr})}}}),define("dataFixer/plugins/migrateStripToColumnsContainer",["lodash","dataFixer/helpers/CompsMigrationHelper","coreUtils"],function(e,t,n){"use strict";function i(){return{type:"MediaContainerDesignData",id:n.guidUtils.getUniqueId("dataItem","-"),background:{id:n.guidUtils.getUniqueId("dataItem","-"),type:"BackgroundMedia",mediaRef:null,alignType:"center",fittingType:"fill",colorOpacity:0,colorOverlay:"",colorOverlayOpacity:1,imageOverlay:"",scrollType:"none",color:"#FFFFFF"}}}function r(){return{columnsMargin:0,frameMargin:0,fullWidth:!0,rowMargin:0,siteMargin:0,type:"StripColumnsContainerProperties"}}function o(){return{type:"ColumnProperties",alignment:50}}function a(t,i){return{id:e.get(i,[t.id,"mediaId"],n.guidUtils.getUniqueId("media")),type:"Container",layout:{width:t.layout.width,height:t.layout.height,x:0,y:0,scale:1,rotationInDegrees:0,anchors:[{distance:0,topToTop:0,originalValue:0,type:"BOTTOM_PARENT",locked:!0,targetComponent:t.id}],fixedPosition:!1},components:t.components,componentType:"wysiwyg.viewer.components.Column",styleId:"strc1"}}function s(t,n){e.forEach(t.components,function(t){var i=e.get(t,["layout","anchors"],[]);e.forEach(i,function(e){"BOTTOM_PARENT"===e.type&&(e.targetComponent=n.id)})})}function u(t,n){t.behaviors&&(n.behaviors=e.clone(t.behaviors),delete t.behaviors),t.behaviorQuery&&(n.behaviorQuery=t.behaviorQuery,delete t.behaviorQuery)}var c=new t({"wysiwyg.viewer.components.StripContainer":function(t,n,c,p){p.componentType="wysiwyg.viewer.components.StripColumnsContainer",delete p.skin,p.styleId="strc1",this.setComponentProperties(t,p,r(),n);var d=a(p,n);if(s(p,d),u(p,d),e.set(n,[p.id,"mediaId"],d.id),this.setComponentProperties(t,d,o(),n),d.designQuery=p.designQuery,delete p.designQuery,c)p.layout.width=320,p.designQuery=e.get(n,[p.id,"designQuery"]),this.deleteComponentData(t,p);else{p.layout.width=980;var l=i();this.setComponentDesignData(t,p,l,n)}delete p.dataQuery,p.components=[d]}});return{exec:c.migratePage.bind(c)}}),define("dataFixer/plugins/tinyMenuSkinBackgroundFixer",["lodash"],function(e){"use strict";function t(t){function i(t,n,i){e.isUndefined(t)||e.isUndefined(t[n])||(t[i]=t[i]||t[n])}if(t.skin===n&&!e.isUndefined(t.style)&&!e.isUndefined(t.style.properties)){var r=t.style.properties,o=t.style.propertiesSource;e.forEach([["bg","bgDrop"],["bg","bgOpen"],["txt","bordercolor"],["txt","iconcolor"],["bordercolor","borderColorSelected"]],function(e){var t=e[0],n=e[1];i(r,t,n),i(o,t,n),i(r,t="alpha-"+t,n="alpha-"+n),i(o,t,n)})}}var n="wysiwyg.viewer.skins.mobile.TinyMenuSkin";return{exec:function(n){var i=n.data&&n.data.theme_data;e.isEmpty(i)||e.forEach(i,t)}}}),define("dataFixer/plugins/tinyMenuLayoutFixer",["lodash"],function(e){"use strict";function t(n){var i=e.find(n,{id:"TINY_MENU"});return i?(i.layout.fixedPosition&&i.layout.x>320&&(i.layout.x=250),!0):e.some(n,function(n){return!e.isEmpty(n.components)&&t(n.components)})}return{exec:function(n){"masterPage"===e.get(n,["structure","id"])&&t(n.structure.mobileComponents)}}}),define("dataFixer/plugins/designDataFixer",["lodash","coreUtils"],function(e,t){"use strict";function n(e){return"wysiwyg.viewer.components.StripContainer"===e.componentType}function i(t){return!e.isUndefined(t.designQuery)}function r(n,i,r){return e.isUndefined(r)&&(r=t.guidUtils.getUniqueId("dataItem","-")),i[r]={id:r,type:"MediaContainerDesignData",metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1}},n.designQuery="#"+r,r}function o(e,t,n){return t[n]=e[n],delete e[n],t[n]}function a(t,n,i,r){var a=i[t];if(!e.isUndefined(a.background)){var s=a.background.slice(1),u=o(i,r,s);if(!e.isUndefined(u.mediaRef)){var c=o(i,r,u.mediaRef.slice(1));"WixVideo"===c.type&&o(i,r,c.posterImageRef.slice(1)),e.isUndefined(c.originalImageDataRef)||o(i,r,c.originalImageDataRef.slice(1)),e.isUndefined(c.link)||delete c.link}return e.isUndefined(u.imageOverlay)||o(i,r,u.imageOverlay.slice(1)),delete a.background,r[n].background="#"+s,s}}function s(t,n,i,o,s){var u=s.dataQuery.slice(1),c=r(s,n);i[u]=c;var p=a(u,c,t,n);e.isUndefined(p)||(o[u]=p)}function u(e,t,n,i){var r=i.dataQuery.slice(1);i.designQuery="#"+t[r]}function c(t,r,o,a){var c={},p={},d=e.filter(t,n);e(d).reject(i).forEach(e.partial(s,o,a,p,c)),e(r).filter(function(e){return n(e)&&!i(e)}).forEach(e.partial(u,a,p,c))}function p(t){return e.isUndefined(t.components)?e.isUndefined(t.children)?[]:t.children:t.components}function d(t){for(var n=e.clone(t)||[],i=[];n.length>0;){var r=n.pop();i.push(r);var o=p(r);e.forEach(o,function(e){n.push(e)})}return i}function l(e){return d(p(e.structure))}function m(e){return d(e.structure.mobileComponents)}return{exec:function(e){var t=l(e),n=m(e);e.data.design_data=e.data.design_data||{},c(t,n,e.data.document_data,e.data.design_data)}}}),define("dataFixer/plugins/homePageLoginDataFixer",["lodash"],function(e){"use strict";function t(e){e.metaData&&"2.0"===e.metaData.schemaVersion||(e.sendMail=!0)}function n(n){e.forEach(n,function(e){"LoginToWixLink"!==e.type&&"HomePageLogin"!==e.type||t(e)})}return{exec:function(t){var i=t.data.document_data;e.isEmpty(i)||n(i)}}}),define("dataFixer/plugins/characterSetsFixer",["lodash"],function(e){"use strict";return{exec:function(t){return t.structure&&"Document"===t.structure.type&&e.isEmpty(t.data.document_data.masterPage.characterSets)&&(t.data.document_data.masterPage.characterSets=["latin"]),t}}}),define("dataFixer/plugins/popupPropsTempDataFixer",["lodash"],function(e){"use strict";return{exec:function(t){var n=e.get(t,["data","component_properties",t.structure.id]);n&&n.popup&&(e.forEach(["desktop","mobile"],function(t){var i=n[t],r=n.popup[t];(i||r)&&e.set(n,[t,["popup"]],e.assign(i||{},r||{}))}),delete n.popup)}}}),define("dataFixer/plugins/blogSelectionSharerCustomizationsFixer",["lodash","coreUtils"],function(e,t){"use strict";return{exec:function(n){e(n.data.document_data).filter({type:"AppPart",appPartName:t.blogAppPartNames.SINGLE_POST}).forEach(function(t){var n=e.find(t.appLogicCustomizations,{forType:"Post",fieldId:"vars",key:"selectionSharerExperimentOpen",view:t.viewName});n||(n={forType:"Post",fieldId:"vars",key:"selectionSharerExperimentOpen",view:t.viewName,type:"AppPartCustomization",format:""},t.appLogicCustomizations.push(n))})}}}),define("dataFixer/plugins/quickActionBarDataFixer",["lodash","experiment"],function(e,t){"use strict";function n(t){return e.find(t.structure.mobileComponents,{id:"QUICK_ACTION_BAR"})}function i(e){e.structure.mobileComponents.push({type:"Container",id:"QUICK_ACTION_BAR",componentType:"wysiwyg.viewer.components.QuickActionBar",components:[],styleId:"quickActionBarStyle",layout:{fixedPosition:!0}})}function r(t){n(t).styleId="quickActionBarStyle",e.assign(t.data.theme_data,{quickActionBarStyle:{type:"TopLevelStyle",id:"quickActionBarStyle",metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1},skin:"wysiwyg.viewer.skins.quickActionBar.floatingSkin",style:{properties:{"alpha-controlButtonBG":"1","alpha-controlButtonFG":"1","alpha-controlButtonBorderColor":"1","alpha-actionsBorderColor":"1","boxShadowToggleOn-actionsSHD":"true","boxShadowToggleOn-controlButtonSHD":"true",controlButtonBG:"#ffffff",controlButtonFG:"#4682b4",controlButtonBorderSize:"0",controlButtonBorderColor:"#ffffff",actionsBorderSize:"0",actionsBorderColor:"#ffffff",colorScheme:"brand inv",controlButtonSHD:"0px 1px 4px 0px rgba(0,0,0,0.6)",actionsSHD:"0px 1px 4px 0px rgba(0,0,0,0.6)"},propertiesSource:{controlButtonBG:"value",controlButtonFG:"value",controlButtonBorderSize:"value",controlButtonBorderColor:"value",actionsBorderSize:"value",actionsBorderColor:"value",colorScheme:"value",controlButtonSHD:"value",actionsSHD:"value"},groups:{}},componentClassName:"wysiwyg.viewer.components.QuickActionBar",pageId:"",compId:"",styleType:"custom"}})}function o(t){n(t).propertyQuery="quickActionBarProps",e.assign(t.data.component_properties,{quickActionBarProps:{type:"QuickActionBarProperties",metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1},colorScheme:"brand",invertColors:!0,alignment:"right",hideText:!0}})}function a(e){return!!n(e)}function s(t){var n=e.find(t,{appDefinitionId:"14517e1a-3ff0-af98-408e-2bd6953c36a2"});return!e.isUndefined(n)&&!e.get(n,"permissions.revoked")}function u(t){return e.get(t,"quickActions.configuration.quickActionsMenuEnabled",!1)}function c(t){var n=e.find(t.structure.mobileComponents,{id:"QUICK_ACTION_BAR"});e.isUndefined(n.components)&&(n.components=[]),n.type="Container",e.isUndefined(t.data.component_properties[n.propertyQuery])&&o(t)}function p(t){var n=e.find(t.structure.mobileComponents,{id:"QUICK_ACTION_BAR"}),i=e.get(t.data.theme_data,[n.styleId,"style","properties"]);e.transform(["controlButtonBorderColor","actionsBorderColor"],function(e,t){/^rgb/.test(e[t])&&(e[t]="#ffffff")},i)}function d(n,i){t.isOpen("sv_qabUnhide",{rendererModel:i})||(e.find(n.structure.mobileComponents,{id:"QUICK_ACTION_BAR"}).components=[])}return{exec:function(n,l,m,g,f,y,w){if("masterPage"===n.structure.id){if(a(n))return c(n),p(n),void d(n,w);t.isOpen("sv_qab",{rendererModel:w})&&s(e.get(w,"clientSpecMap"))&&!a(n)&&!u(e.get(w,"siteMetaData"))&&(i(n),r(n),o(n))}}}}),define("dataFixer/plugins/boxSlideShowDataFixer",["lodash","coreUtils","translationsUtils"],function(e,t,n){"use strict";function i(t){return"Template"===e.get(t,"siteInfo.documentType")}function r(r,a,s,u){var c,p;i(u)&&(c=a?t.wixUserApi.getLanguage(a.cookie,s,a.language):"en",(p=n.boxSlideShowTranslation[c])&&e.forOwn(r,function(e){if("boxSlideShowSlide"===e.type||"StripContainerSlideShowSlide"===e.type){var t=e.title?e.title.split(" ")[1]:"";e.title=p[o]&&t?p[o].replace("<%= curr_slide %>",t):e.title}}))}var o="BOXSLIDESHOW_Regular_Slideshow_Slides_New_Slide_Label";return{exec:function(e,t,n,i,o,a,s){r(e.data.document_data,n,i,s)}}}),define("dataFixer/plugins/appPartMobileFeedMediaDateHiddenFixer",["lodash","coreUtils"],function(e,t){"use strict";var n={exec:function(i){e.forEach(i.data.document_data,function(e){e.appPartName&&e.appPartName===t.blogAppPartNames.FEED&&n.fixMobileDateCustomization(e)})},fixMobileDateCustomization:function(t){e.forEach(t.appLogicCustomizations,function(e){"date"===e.fieldId&&"Mobile"===e.format&&"Post"===e.forType&&"comp.hidden"===e.key&&(e.fieldId="dateAndAuthor")})}};return n}),define("dataFixer/plugins/originalImageDataRefFixer",["lodash","coreUtils"],function(e,t){"use strict";function n(e){return"Image"===e.type}function i(e,t){return"undefined"!==t&&"null"!==t&&e.length>1}function r(n,i){var r=i+"_"+t.guidUtils.getUniqueId(),o=e.cloneDeep(n[i]);return o.id=r,o}return{exec:function(t){var o=e.get(t,["data","document_data"]);o&&e(o).pickBy(n).groupBy("originalImageDataRef").pickBy(i).forOwn(function(t,n){var i=e.tail(t),a=n.replace("#","");e.forEach(i,function(e){var t=r(o,a);o[t.id]=t,e.originalImageDataRef="#"+t.id})})}}}),define("dataFixer/plugins/tpaWixForumDataFixer",["lodash","experiment"],function(e,t){"use strict";function n(t,n){var i=n.widgets[p];!0===e.get(i,"appPage.landingPageInMobile")&&(t.isMobileLandingPage=!0)}function i(e,t){r(t,o(e))}function r(t,n){!0===a(t)&&(e.set(n.layout,"dock",d),10===n.layout.y&&(n.layout.y=0))}function o(t){for(var n=[].concat(e.get(t,"structure.mobileComponents"));n.length>0;){var i=n.shift();if(i&&i.componentType===u)return i;i.components&&(n=n.concat(i.components))}}function a(t){if(t){var n=t.widgets[p];return e.get(n,"shouldBeStretchedByDefaultMobile")}return null}function s(t){var n=e.find(t,{appDefinitionId:c});return e.get(n,"applicationId")}var u="wysiwyg.viewer.components.tpapps.TPASection",c="14724f35-6794-cd1a-0244-25fd138f9242",p="1489040e-001f-4631-55a9-2c29b4417126",d={left:{vw:0},right:{vw:0}};return{exec:function(r,o,a,u,c,p,d){var l,m=e.get(d,"clientSpecMap"),g=s(m);if(g&&t.isOpen("sv_tpaSectionsMobileFSDataFixer",{rendererModel:d})){var f=e.get(m,g);if("masterPage"===e.get(r,"structure.id")){var y=e.get(r,"data.document_data");(l=e.find(y,{tpaApplicationId:g}))&&n(l,f)}else l=e.get(r,["data","document_data"]),e.find(l,{applicationId:g.toString(),type:"TPA"})&&i(r,f)}}}}),define("dataFixer/plugins/filterEffectPropertyFixer",["lodash"],function(e){"use strict";function t(t){e.forEach(t,function(e){"WPhotoProperties"===e.type&&e.effectName&&(e.filterEffect||"none"===e.effectName||(e.filterEffect={effectType:e.effectName}),delete e.effectName)})}return{exec:function(n){var i=n.data.component_properties;e.isEmpty(i)||t(i)}}}),define("dataFixer/plugins/tinyMenuSkinFixer",["lodash"],function(e){"use strict";function t(t,n){var i=e.get(n,[t.styleId,"skin"]),o=t.skin;return i&&o&&e.includes(r,i)&&e.includes(r,o)}function n(e){e.skin=o,e.styleId=a}function i(t){var n=e.find(t,{id:"TINY_MENU"});return n||(e.forEach(t,function(t){if(!e.isEmpty(t.components))return!(n=i(t.components))}),n)}var r=["wysiwyg.viewer.skins.mobile.TinyMenuSkin","wysiwyg.viewer.skins.mobile.TinyMenuFullScreenSkin","wysiwyg.viewer.skins.mobile.TinyMenuPullFromLeftSkin","wysiwyg.viewer.skins.mobile.TinyMenuPullFromTopSkin","wysiwyg.viewer.skins.mobile.TinyMenuPullFromRightSkin"],o="wysiwyg.viewer.skins.mobile.TinyMenuSkin",a="tm2";return{exec:function(r){if("masterPage"===e.get(r,["structure","id"])){var o=i(r.structure.mobileComponents);o&&!t(o,r.data.theme_data)&&n(o)}}}}),define("dataFixer/plugins/tpaPublicAPIWidgetDataFixer",["lodash","experiment"],function(e,t){"use strict";function n(t,n){var i=t.data.document_data[n.dataQuery.replace("#","")];return{widgetId:e.get(i,"widgetId"),applicationId:e.get(i,"applicationId")}}return{exec:function(i,r,o,a,s,u,c){t.isOpen("sv_tpaAddPublicAPI",{rendererModel:c})&&e.forEach(i.structure.components,function(t){if("wysiwyg.viewer.components.tpapps.TPAWidget"===t.componentType){var r=n(i,t),o=e.get(c,"clientSpecMap["+r.applicationId+"].widgets",[]);e.forEach(o,function(e){e.publicAPI={restart:""}})}})}}}),define("dataFixer/plugins/svgShapeToVectorImageFixer",["lodash","coreUtils","experiment"],function(e,t,n){"use strict";function i(e,t){e.componentType=t.comp,e.skin=t.skin}function r(t){e.forEach(t,function(e){var t=a[e.componentClassName];t&&(s(e,t),u(e,t))})}function o(t){e.forEach(t,function(e){var t=a[e.componentType];t&&i(e,t)})}var a={"wysiwyg.viewer.components.svgshape.SvgShape":t.vectorImageConversionUtils.vectorImageDefaults},s=t.vectorImageConversionUtils.convertStyleProperties,u=t.vectorImageConversionUtils.convertPropertiesSource;return{exec:function(t,i,a,s,u,c,p){if(n.isOpen("sv_vector_image_shape",{rendererModel:p})){var d=t.data.theme_data,l=t.structure.components||t.structure.children,m=t.structure.mobileComponents;e.isEmpty(d)||r(d),e.isEmpty(l)||o(l),e.isEmpty(m)||o(m)}}}}),define("dataFixer/plugins/migrateIframesToSemiNativeComponents",["lodash","experiment","dataFixer/helpers/CompsMigrationHelper"],function(e,t,n){"use strict";function i(t){return e(t).filter("platformApp").reduce(function(t,n){return e(n.widgets).pickBy("semiNative").mapValues(e.constant(!0)).assign(t).value()},{})}function r(t){var n=e(t.data.theme_data).filter({componentClassName:"wysiwyg.viewer.components.tpapps.TPAWidget",skin:"wysiwyg.viewer.skins.TPAWidgetSkin"}).map(function(t){var n=e.cloneDeep(t);return n.componentClassName="platform.components.semiNativeComponent",n.skin="wysiwyg.viewer.skins.semiNativeComponentSkin",n}).transform(function(e,t){e[t.id+a]=t},{}).value();e.assign(t.data.theme_data,n)}function o(t,n,r,o,u){var c=i(e.get(t,"clientSpecMap")),p=this.getComponentData(n,u);u.componentType===s&&c[p.widgetId]&&(u.componentType="platform.components.semiNativeComponent",u.skin="wysiwyg.viewer.skins.semiNativeComponentSkin",u.styleId+=a,this.setComponentData(n,u,e.defaults({type:"SemiNative"},p),r))}var a="-semi",s="wysiwyg.viewer.components.tpapps.TPAWidget";return{exec:function(i,a,s,u,c,p,d){if(t.isOpen("sv_migrateTpaToSemiNative",{rendererModel:d})&&p){"masterPage"===i.structure.id&&r(i);var l={"wysiwyg.viewer.components.tpapps.TPAWidget":e.partial(o,d)};new n(l).migratePage(i)}}}}),define("dataFixer/plugins/migrateGridDataSource",["lodash","dataFixer/helpers/CompsMigrationHelper"],function(e,t){"use strict";function n(t,n,i,r){var o=t.data.document_data[r.dataQuery.slice(1)],a=t.data.component_properties,s=a[r.propertyQuery];if(e.has(s,"dataSource")){var u={type:s.dataSource.type,revision:s.dataSource.id};delete s.dataSource;var c="mobile_"+r.propertyQuery;e.has(a,c)&&delete a[c].dataSource,e.set(o,"dataSource",u)}}return{exec:function(e){new t({"wysiwyg.viewer.components.Grid":n}).migratePage(e)}}}),define("dataFixer/plugins/unforkDesignData",["lodash","dataFixer/helpers/CompsMigrationHelper"],function(e,t){"use strict";var n=new t({"wysiwyg.viewer.components.Column":function(t,n,i,r){i&&e.startsWith(r.designQuery,"#mobile_")&&(this.deleteComponentDesignData(t,r),r.designQuery=e.replace(r.designQuery,"mobile_",""))}});return{exec:n.migratePage.bind(n)}}),define("dataFixer/plugins/stripColumnsContainerNoDesignFixer",["lodash","dataFixer/helpers/CompsMigrationHelper","coreUtils"],function(e,t,n){"use strict";function i(){return{type:"MediaContainerDesignData",id:n.guidUtils.getUniqueId("dataItem","-"),background:{id:n.guidUtils.getUniqueId("dataItem","-"),type:"BackgroundMedia",mediaRef:null,alignType:"center",fittingType:"fill",colorOpacity:0,colorOverlay:"",colorOverlayOpacity:1,imageOverlay:"",scrollType:"none",color:"#FFFFFF"}}}var r=new t({"wysiwyg.viewer.components.StripColumnsContainer":function(e,t,n,r){if(!r.designQuery&&!n){r.layout.width=980;var o=i();this.setComponentDesignData(e,r,o,t)}}});return{exec:r.migratePage.bind(r)}}),define("dataFixer/core/fixPageData",["lodash","loggingUtils","dataFixer/plugins/galleriesMobileTypeFixer","dataFixer/plugins/pageTopFixer","dataFixer/plugins/masterPageFixer","dataFixer/plugins/customSiteMenuFixer","dataFixer/plugins/multipleMenusFixer","dataFixer/plugins/verticalMenuFixer","dataFixer/plugins/skinFixer","dataFixer/plugins/stylesFixer","dataFixer/plugins/bgImageStripDataFixer","dataFixer/plugins/compFixer","dataFixer/plugins/galleryFixer","dataFixer/plugins/behaviorsFixer","dataFixer/plugins/connectionsDataFixer","dataFixer/plugins/fiveGridLineLayoutFixer","dataFixer/plugins/toPageAnchorsFixer","dataFixer/plugins/wrongAnchorsFixer","dataFixer/plugins/addMissingAnchorsOfMasterPage","dataFixer/plugins/sitePagesFixer","dataFixer/plugins/linkRefDataFixer","dataFixer/plugins/fromDocumentToThemeData","dataFixer/plugins/tpaGluedWidgetDataFixer","dataFixer/plugins/tpaAddChatAppDataFixer","dataFixer/plugins/tpaProGalleryBackgroundDataFixer","dataFixer/plugins/compsWithImagesDataFixer","dataFixer/plugins/appPartCustomizationsFixer","dataFixer/plugins/backgroundMediaConverter","dataFixer/plugins/backgroundMediaUndefinedFixer","dataFixer/plugins/backgroundMediaRefDuplicationFixer","dataFixer/plugins/stripContainerBgEffectFixer","dataFixer/plugins/documentMediaFixer","dataFixer/plugins/pinterestFollowFixer","dataFixer/plugins/blogPageMenuFixer","dataFixer/plugins/appPartMediaInnerCustomizationFormatFixer","dataFixer/plugins/appPartReadMoreValueCustomizationFormatFixer","dataFixer/plugins/appPartTagsValueCustomizationFormatFixer","dataFixer/plugins/appPartDuplicateCustomizationFixer","dataFixer/plugins/blogCustomFeedPostsPerPageCustomizationFixer","dataFixer/plugins/blogDateAndAuthorHiddenCustomizationFixer","dataFixer/plugins/blogDateAlignmentCustomizationFixer","dataFixer/plugins/appPartBrokenButtonStyleFixer","dataFixer/plugins/blogDateFormatCustomizationFormatFixer","dataFixer/plugins/contactFormDataFixer","dataFixer/plugins/contactFormMigrationDataFixer","dataFixer/plugins/subscribeFormDataFixer","dataFixer/plugins/pageDataFixer","dataFixer/plugins/groupFixer","dataFixer/plugins/textSecurityFixer","dataFixer/plugins/pageUriSeoFixer","dataFixer/plugins/migrateStripToColumnsContainer","dataFixer/plugins/tinyMenuSkinBackgroundFixer","dataFixer/plugins/tinyMenuLayoutFixer","dataFixer/plugins/designDataFixer","dataFixer/plugins/homePageLoginDataFixer","dataFixer/plugins/characterSetsFixer","dataFixer/plugins/popupPropsTempDataFixer","dataFixer/plugins/blogSelectionSharerCustomizationsFixer","dataFixer/plugins/quickActionBarDataFixer","dataFixer/plugins/boxSlideShowDataFixer","dataFixer/plugins/appPartMobileFeedMediaDateHiddenFixer","dataFixer/plugins/originalImageDataRefFixer","dataFixer/plugins/tpaWixForumDataFixer","dataFixer/plugins/filterEffectPropertyFixer","dataFixer/plugins/tinyMenuSkinFixer","dataFixer/plugins/tpaPublicAPIWidgetDataFixer","dataFixer/plugins/svgShapeToVectorImageFixer","dataFixer/plugins/migrateIframesToSemiNativeComponents","dataFixer/plugins/migrateGridDataSource","dataFixer/plugins/unforkDesignData","dataFixer/plugins/stripColumnsContainerNoDesignFixer"],function(e,t,n,i,r,o,a,s,u,c,p,d,l,m,g,f,y,w,v,h,T,k,S,x,I,M,_,F,P,b,E,C,A,O,B,D,N,L,U,R,G,H,Q,z,V,W,q,Y,Z,j,J,K,X,$,ee,te,ne,ie,re,oe,ae,se,ue,ce,pe,de,le,me,ge,fe,ye){"use strict";var we=e.compact([n,r,F,P,b,o,a,s,u,c,p,d,l,m,g,re,f,y,w,v,h,T,k,i,S,x,I,M,_,$,E,C,A,O,B,D,N,U,R,G,L,H,Q,z,V,W,q,Y,Z,j,J,K,X,ee,ne,te,ie,oe,ae,se,ue,ce,pe,de,le,me,ge,fe,ye]);return Object.freeze(we),function(n,i,r,o,a,s,u){var c=n.structure.id;return c=c?5===c.length||4===c.length?"":" "+c:" masterPage",t.performance.time("Fix page"+c,function(){var t=n.data||{};return t.document_data=t.document_data||{},t.theme_data=t.theme_data||{},t.component_properties=t.component_properties||{},t.mobile_hints=t.mobile_hints||{},n.data=t,e.forEach(we,function(e){e.exec(n,i,r,o,a,s,u)}),n},s)}}),define("dataFixer/plugins/deprecatedSiteModelMigrater",["lodash","coreUtils","dataFixer/core/fixPageData"],function(e,t,n){"use strict";function i(e){switch(e){case"wysiwyg.viewer.components.WSiteStructure":return"Document";case"mobile.core.components.Page":return"Page";case"wixapps.integration.components.Area":case"mobile.core.components.Container":case"wysiwyg.viewer.components.HeaderContainer":case"wysiwyg.viewer.components.FooterContainer":case"wysiwyg.viewer.components.PagesContainer":case"wysiwyg.viewer.components.ScreenWidthContainer":case"wysiwyg.viewer.components.StripContainer":return"Container"}return"Component"}function r(e){return parseInt(e||0,10)}function o(t,n,o,a,s){var u=e(a).map("name").invokeMap("toLowerCase").zipObject(e.map(a,"value")).value();"Page"===i(u.comp)&&(n.page=u.id),t.pagesData[n.page]=t.pagesData[n.page]||{structure:{},data:{},theme_data:{}};var c=t.pagesData[n.page].structure=t.pagesData[n.page].structure||{};if(e.has(n.childrenIndex,n.page)){for(var p=0;p<n.childrenIndex[n.page].length;p++)c=c.components[n.childrenIndex[n.page][p]];var d={};n.childrenIndex[n.page].push(c.components.length),c.components.push(d),c=d}else n.childrenIndex[n.page]=[];c.componentType=u.comp,c.type=i(u.comp),c.id=u.id,c.components=[],c.skin=u.skin,c.styleId=u.styleid,u.dataquery&&(c.dataQuery=u.dataquery),c.propertyQuery=u.propertyquery,c.layout={width:r(u.width),height:r(u.height),x:r(u.x),y:r(u.y),anchors:t.wixAnchors[u.id]||[]}}function a(e,t,n){0===t.childrenIndex[t.page].length?t.page="masterPage":t.childrenIndex[t.page].pop()}return function(i){i.pagesData={};var r=e.get(i,"wixData.document_data.SITE_STRUCTURE.mainPage")||e.get(i,"wixData.document_data.masterPage.mainPage"),s=r&&r.slice(1);i.pagesData.masterPage={data:i.wixData},i.pagesData.masterPage.structure={};var u={page:"masterPage",childrenIndex:{}};t.htmlParser(i.wixHtmlRaw,{start:o.bind(void 0,i,u),end:a.bind(void 0,i,u)});var c=e.keys(i.pagesData),p=e.without(c,"masterPage");i.pagesData.masterPage.data.document_data.MAIN_MENU=i.pagesData.masterPage.data.document_data.MAIN_MENU||{items:[],type:"Menu",id:"MAIN_MENU",metaData:{}},e.forEach(c,function(e){i.pagesData[e]=n(i.pagesData[e],p,i.requestModel,i.currentUrl,i.urlFormatModel)}),i.publicModel.pageList={mainPageId:s,pages:e.map(p,function(t){return e.chain(i).get(["pagesData","masterPage","data","document_data",t]).pick(["title","pageUriSEO"]).assign({pageId:t}).value()})}}}),define("dataFixer/plugins/fixBackgroundData",["lodash","imageClientApi","dataFixer/imageService/imageTransformDataFixers"],function(e,t,n){"use strict";function i(t){return!t[e.find(t,{type:"Page"}).id].pageBackgrounds}function r(t){var n=e.find(t,{type:"Page"});return t[n.id].pageBackgrounds&&"BackgroundMediaUnified"===t[n.id].pageBackgrounds.type}function o(t,n){var i=e(n).filter({type:"Page"}).map("id").value(),r=t.THEME_DATA.siteBg||"none 0 0 center center auto repeat repeat scroll none",o=("[siteBg]"===t.THEME_DATA.mobileBg?t.THEME_DATA.siteBg:t.THEME_DATA.mobileBg)||"none 0 0 center center auto repeat repeat scroll none",u=s(r),c=s(o);u.id="customBgImg"+a(),c.id="customBgImg"+a([u.id]),n[u.id]=u,n[c.id]=c,e.forEach(i,function(e){n[e].pageBackgrounds={desktop:{custom:!0,isPreset:!1,ref:"#"+u.id},mobile:{custom:!0,isPreset:!1,ref:"#"+c.id}}})}function a(t){var n="";for(t=t||[];e.includes(t,n);)n=e.random(0,99999).toString(36).replace(" ","_");return n}function s(t){var n=e.compact(t.split(" "));return c.apply(this,n)}function u(e){var n={};return n[t.fittingTypes.TILE]=t.fittingTypes.LEGACY_BG_FIT_AND_TILE,n[t.fittingTypes.TILE_HORIZONTAL]=t.fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,n[t.fittingTypes.TILE_VERTICAL]=t.fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL,n[t.fittingTypes.ORIGINAL_SIZE]=t.fittingTypes.LEGACY_BG_NORMAL,n[e]||e}function c(e,t,i,r,o,a,s,c,p,d,l,m){var g=n.cssToAlignType(r+" "+o),f=n.cssToFittingType({bgRepeat:s+" "+c,bgSize:a});return f=u(f),l=l||{},d&&"none"!==d||(d="rgba(0,0,0,0)"),{type:"BackgroundMediaUnified",alignType:g,fittingType:f,attachment:p,imageWidth:Number(t),imageHeight:Number(i),mediaType:"image",uri:e,color:d,metaData:{isHidden:l.isHidden||!1,isPreset:l.isPreset||!1,schemaVersion:2},id:m}}function p(e){var t=[e.url,e.imagesizew,e.imagesizeh,e.positionx,e.positiony,e.width,e.repeatx,e.repeaty,e.attachment,e.color,e.metaData,e.id];return c.apply(this,t)}return{fixBackgroundData:function(t){var n=t.getPageDataMap(t.MASTER_PAGE_ID,t.dataTypes.THEME),a=t.getPageDataMap(t.MASTER_PAGE_ID,t.dataTypes.DATA),s=e(a).filter({type:"BackgroundImage"}).map("id").value();r(a)||(i(a)?o(n,a):e.forEach(s,function(e){p(a[e])}))},migrateBgDataItem:p,migrateBgString:s}}),define("dataFixer",["dataFixer/core/fixPageData","dataFixer/plugins/deprecatedSiteModelMigrater","dataFixer/plugins/fixBackgroundData","dataFixer/imageService/imageTransformDataFixers","dataFixer/helpers/anchorCyclesHelper"],function(e,t,n,i,r){"use strict";return{fix:e,deprecatedSiteModelMigrater:t,fixBackgroundData:n,imageTransformDataFixers:i,anchorCyclesHelper:r}});
//# sourceMappingURL=dataFixer.min.js.map
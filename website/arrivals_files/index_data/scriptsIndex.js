"use strict";var wix;!function(a){var b;!function(a){var b;!function(){angular.module("bookingsDynamicForm",["ngMessages","schedulerCommonStatics"])}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.FULL="Full",b.PARTIAL="Partial",a.DynamicAttributeDisplayTypes=b;var c=function(){function a(){}return a}();c.SHORT_TEXT="SHORT_TEXT",c.LONG_TEXT="LONG_TEXT",c.EMAIL="EMAIL",c.PHONE="PHONE_NUMBER",c.DROP_DOWN="DROP_DOWN",c.NUMBER="NUMBER",a.DynamicFormValueTypes=c;var d=function(){function a(){}return a}();d.FULL_NAME="FullName",d.EMAIL="Email",d.CUSTOM_FIELD="Custom",d.PHONE="PhoneNumber",d.MESSAGE="Message",d.ADDRESS="Address",d.CITY="City",d.STREET="Street",d.STATE="State",d.ZIP="ZipCode",d.APARTMENT="AptFloorNo",d.NUM_OF_PARTICIPANTS="NumberOfParticipants",d.isAddressProperty=function(a){return["Street","AptFloorNo","City","State","ZipCode"].indexOf(a)>-1},a.DynamicFormFieldTypes=d;var e=function(){function a(){}return a}();e.PRISTINE="Default",e.DIRTY="OwnerCustomized",a.DynamicFormSources=e;var f=function(){function a(a){void 0===a&&(a={});var b={fieldType:d.CUSTOM_FIELD,valueType:c.SHORT_TEXT,label:"",displayType:"Full",isReadOnly:!1};Object.assign(this,b,a)}return a}();a.DynamicFormAttribute=f}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.API_PREFIX="_api/scheduler-server/visitor/",b.DYNAMIC_FORM_API_PREFIX=b.API_PREFIX+"bookingsForm/",a.DynamicFormApiConst=b;var c=function(){function a(a,c){var d=this;this.$http=a,this.commonApiBase=c,this.gettingBookingsDynamicForm=this.commonApiBase.httpWrapper(function(a){var c=a.isDummyOffering?"preview":a.offeringType,e=a.isDummyOffering?"":a.offeringId+"/"+("GROUP"===a.offeringType?a.offeringInstanceId+"/":"");return d.$http.get(""+b.DYNAMIC_FORM_API_PREFIX+c+"/"+e)})}return a.$inject=["$http","commonApiBase"],a}();a.DynamicFormApiSrv=c,angular.module("bookingsDynamicForm").service("dynamicFormApiSrv",c)}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c){this.dynamicFormApiSrv=a,this.experimentsEnabler=b,this.$q=c}return b.$inject=["dynamicFormApiSrv","experimentsEnabler","$q"],b.prototype.gettingBookingsDynamicForm=function(a,c,d){return this.experimentsEnabler.isBookingsFormEnabled()?this.dynamicFormApiSrv.gettingBookingsDynamicForm(a).then(function(c){return b.overrideLegacyInfo(a,c)}).then(function(a){return b.enrichFormDataWithContactInfo(a,c,d)}):this.$q.when(b.EMPTY_DEFAULT_FORM)},b.overrideLegacyInfo=function(c,d){if(c.legacyLabels&&b.isNeverModifiedByOwner(d)){if(c.legacyLabels.message){var e=d.form.fields.find(function(b){return b.fieldType===a.DynamicFormFieldTypes.MESSAGE});e&&(e.label=c.legacyLabels.message)}d.form.actions.onlinePaymentLabel=c.legacyLabels.onlinePayment||d.form.actions.onlinePaymentLabel,d.form.actions.offlinePaymentLabel=c.legacyLabels.offlinePayment||d.form.actions.offlinePaymentLabel}return d},b.isNeverModifiedByOwner=function(b){return b.source===a.DynamicFormSources.PRISTINE},b.enrichFormDataWithContactInfo=function(a,c,d){var e={},f=c.dynamicFormData;if(e.name=c.name||d.fullName,e.phone=c.phone||d.phoneNumber,e.email=c.email||d.email,e.message=c.message,e.address=c.address||{},a.form.fields=a.form.fields.map(function(a){return b.updateDynamicFormAttributeByLegacyContactInfo(a,e,d)}),f&&f.form&&f.form.fields){var g=new Map;b.createDynamicFormFieldValueMap(g,f.form.fields),a.form.fields=a.form.fields.map(function(a){return b.updateDynamicFormAttributeWithExistingDynamicForm(a,g)})}return a},b.createDynamicFormFieldValueMap=function(a,c){c.forEach(function(c){a.set(c.id,c.value),c.subFields&&c.subFields.length>0&&b.createDynamicFormFieldValueMap(a,c.subFields)})},b.prototype.enrichContactInfoWithFormData=function(a,c){c&&c.form&&c.form.fields&&c.form.fields.forEach(function(c){return b.updateContactInfoByDynamicFormAttribute(a,c)})},b.updateDynamicFormAttributeByLegacyContactInfo=function(c,d,e){var f=new a.DynamicFormAttribute(c);switch(c.fieldType){case a.DynamicFormFieldTypes.FULL_NAME:f.value=d.name||f.value;break;case a.DynamicFormFieldTypes.PHONE:f.value=d.phone||f.value;break;case a.DynamicFormFieldTypes.EMAIL:f.value=d.email||f.value,f.isReadOnly=!!e.email;break;case a.DynamicFormFieldTypes.MESSAGE:f.value=d.message||f.value;break;case a.DynamicFormFieldTypes.ADDRESS:f.subFields=b.updateDynamicFormAddressAttributeByLegacyContactInfo(f,d.address)}return f},b.updateDynamicFormAddressAttributeByLegacyContactInfo=function(b,c){return b.subFields.map(function(b){var d=new a.DynamicFormAttribute(b);switch(d.displayType=a.DynamicAttributeDisplayTypes.PARTIAL,d.fieldType){case a.DynamicFormFieldTypes.STREET:d.value=c.addressLine,d.displayType=a.DynamicAttributeDisplayTypes.FULL;break;case a.DynamicFormFieldTypes.CITY:d.value=c.city;break;case a.DynamicFormFieldTypes.APARTMENT:d.value=c.aptOrFloor}return d})},b.updateDynamicFormAttributeWithExistingDynamicForm=function(a,c){var d=c.get(a.id);return a.value=d||a.value,a.subFields&&a.subFields.length>0&&(a.subFields=b.updateSubFieldsAttributesWithExistingDynamicForm(a,c)),a},b.updateSubFieldsAttributesWithExistingDynamicForm=function(a,c){return a.subFields.map(function(a){return b.updateDynamicFormAttributeWithExistingDynamicForm(a,c)})},b.updateContactInfoByDynamicFormAttribute=function(c,d){switch(d.fieldType){case a.DynamicFormFieldTypes.FULL_NAME:c.name=d.value;break;case a.DynamicFormFieldTypes.PHONE:c.phone=d.value;break;case a.DynamicFormFieldTypes.EMAIL:c.email=d.value;break;case a.DynamicFormFieldTypes.MESSAGE:c.message=d.value;break;case a.DynamicFormFieldTypes.ADDRESS:c.address=c.address||{},d.subFields.forEach(function(a){return b.updateAddressByDynamicFormAttribute(c.address,a)})}},b.updateAddressByDynamicFormAttribute=function(b,c){if(c.value)switch(c.fieldType){case a.DynamicFormFieldTypes.STREET:b.addressLine=c.value;break;case a.DynamicFormFieldTypes.CITY:b.city=c.value;break;case a.DynamicFormFieldTypes.APARTMENT:b.aptOrFloor=c.value}},b.prototype.countRequiredFields=function(a){var b=function(a){return a?a.reduce(function(a,c){return a+(c.userConstraints&&c.userConstraints.required?1:0)+b(c.subFields)},0):0};return a&&a.form?b(a.form.fields):0},b}();b.EMPTY_DEFAULT_FORM={source:a.DynamicFormSources.PRISTINE,form:{fields:[],id:null,header:{title:null,description:null,isDescriptionHidden:!0},actions:{onlinePaymentLabel:null,offlinePaymentLabel:null}}},a.DynamicFormSrv=b,angular.module("bookingsDynamicForm").service("dynamicFormSrv",b)}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d){this.$compile=a,this.$element=b,this.$scope=c,this.$filter=d,this.escapeHtml=d("escapeHtml"),this.notifyDropDownAttributeValueExist()}return b.$inject=["$compile","$element","$scope","$filter"],b.prototype.notifyDropDownAttributeValueExist=function(){this.attribute.value&&this.isDropDown()&&this.onAttributeValueChanged()},b.prototype.getInputNodeName=function(){var b="";switch(this.attribute.valueType){case a.DynamicFormValueTypes.SHORT_TEXT:case a.DynamicFormValueTypes.EMAIL:case a.DynamicFormValueTypes.PHONE:case a.DynamicFormValueTypes.NUMBER:b="input";break;case a.DynamicFormValueTypes.LONG_TEXT:b="textarea"}return b},b.prototype.getInputTypeByValueType=function(){var b="";switch(this.attribute.valueType){case a.DynamicFormValueTypes.EMAIL:b="email";break;case a.DynamicFormValueTypes.PHONE:b="tel";break;case a.DynamicFormValueTypes.NUMBER:b="number";break;default:b="text"}return b},b.prototype.onValidValueSelected=function(a){this.attribute.value=a,this.onAttributeValueChanged()},b.prototype.onAttributeValueChanged=function(){this.onAttributeChanged({attribute:this.attribute})},b.prototype.renderDropDown=function(){var b="";if(this.attribute.valueType===a.DynamicFormValueTypes.DROP_DOWN)this.dropDownValidValues=this.attribute.validValues.map(function(a){return{value:a.id,label:a.label}}),b=this.generateDropDownTemplate();else if(this.attribute.fieldType===a.DynamicFormFieldTypes.NUM_OF_PARTICIPANTS){var c=1,d=this.attribute.userConstraints.max;if(d>1){this.dropDownValidValues=[];for(var e=c;d>=e;e++)this.dropDownValidValues.push({value:e,label:""+e});b=this.generateDropDownTemplate("max-participants-dropdown")}}return b},b.prototype.generateDropDownTemplate=function(a){var b=this;void 0===a&&(a="dynamic-form-attribute-dropdown");var c=this.dropDownValidValues.indexOf(this.dropDownValidValues.find(function(a){return a.value===b.attribute.value})),d=c>-1?'selected-item="$ctrl.dropDownValidValues['+c+']"':"";return'<boost-dropdown data-hook="'+a+'"\n                              items="$ctrl.dropDownValidValues"\n                              on-select="$ctrl.onValidValueSelected(value)"\n                              custom-class="dropdown--input dropdown--input__form"\n                              '+d+"></boost-dropdown>"},b.prototype.isInvalid=function(){var a=this.attribute.id;return this.formController[a]&&this.formController[a].$dirty&&this.formController[a].$invalid},b.prototype.shouldRenderTemplate=function(){return!(this.isSubFieldExist()||this.hasOneParticipant())},b.prototype.hasOneParticipant=function(){return this.isNumberOfParticipantAttribute()&&this.attribute.userConstraints.max<=1},b.prototype.isNumberOfParticipantAttribute=function(){return this.attribute.fieldType===a.DynamicFormFieldTypes.NUM_OF_PARTICIPANTS},b.prototype.isSubFieldExist=function(){return this.attribute.subFields&&this.attribute.subFields.length>0},b.prototype.isRequired=function(){return this.attribute.userConstraints&&this.attribute.userConstraints.required?"required":""},b.prototype.shouldRenderLabel=function(){return!0},b.prototype.getSubComponentToRender=function(){return"bks-dynamic-form-attribute"},b.prototype.getPlaceholder=function(){return""},b.prototype.isAttributeWithSubElements=function(){return!1},b.prototype.hasTextAreaAutoScale=function(){return!1},b.prototype.mapCamelCaseToDashed=function(){return this.attribute.fieldType.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},b.prototype.getInputConstrains=function(){var b="";switch(this.attribute.valueType){case a.DynamicFormValueTypes.SHORT_TEXT:case a.DynamicFormValueTypes.EMAIL:case a.DynamicFormValueTypes.PHONE:b+='maxlength="40"';break;case a.DynamicFormValueTypes.LONG_TEXT:b+='maxlength="255"'}return b},Object.defineProperty(b.prototype,"label",{get:function(){var a=this.isRequired();return""+(a?"* ":"")+this.escapeHtml(this.attribute.label)},enumerable:!0,configurable:!0}),b.prototype.updateNumberOfParticipantValue=function(){this.isNumberOfParticipantAttribute()&&1===this.attribute.userConstraints.max&&(this.attribute.value=1,this.onAttributeChanged({attribute:this.attribute}))},b.prototype.isDropDown=function(){return this.isNumberOfParticipantAttribute()||this.attribute.valueType===a.DynamicFormValueTypes.DROP_DOWN},b.prototype.renderInput=function(a,b,c){var d=this.getInputNodeName(),e=this.getInputTypeByValueType(),f=this.getPlaceholder(),g=this.hasTextAreaAutoScale(),h=c+" "+this.getInputConstrains();return"<"+d+' data-hook = "dynamic-form-attribute-input"\n                        id="'+a+'"\n                        ng-model="$ctrl.attribute.value"\n                        ng-change="$ctrl.onAttributeValueChanged()"\n                        class="dynamic-form-attribute__input input"\n                        name="'+a+'"\n                        type="'+e+'"\n                        '+(b?"disabled":"")+"\n                        "+h+'\n                        placeholder="'+f+'"\n                        '+(g?'auto-scale-text-area rows="1"':"")+'\n                        tabindex="0"/>'},b.prototype.getContactInfoClass=function(){return this.isAttributeWithSubElements()?"contact-info-input":""},b.prototype.$onInit=function(){var a=this.isRequired(),b=this.attribute.id,c=this.attribute.isReadOnly,d=this.getSubComponentToRender(),e=this.mapCamelCaseToDashed(),f=this.shouldRenderTemplate(),g=this.getContactInfoClass(),h='<div data-hook="dynamic-form-attribute-input-container" class="dynamic-form-attribute--container dynamic-form-attribute--container__'+this.attribute.displayType+'">\n            <div data-hook="dynamic-form-attribute-'+this.attribute.fieldType+'" class="dynamic-form-attribute dynamic-form-attribute__'+e+" "+g+'" \n                    ng-class="{\'dynamic-form-attribute__invalid\': $ctrl.isInvalid() }">\n            '+(f&&this.shouldRenderLabel()?'<label data-hook="dynamic-form-attribute-label"\n                                    for="'+b+'"\n                                    class="label">'+this.label+"</label>":"")+"\n             "+(f?'<div class="dynamic-form-attribute__input-container">\n               '+(this.isDropDown()?this.renderDropDown():this.renderInput(b,c,a))+'\n               <div ng-if="'+c+'"\n                    data-hook="dynamic-form-attribute-lock"\n                    class="dynamic-form-attribute__disabled-indication scheduler-svg-font-icons-lock">\n               </div>\n             </div>':"")+'\n            </div>\n            <div ng-if="$ctrl.isInvalid()" ng-messages="$ctrl.formController[\''+b+'\'].$error" role="alert"\n                 class="dynamic-form-attribute__validation-message"\n                 data-hook="dynamic-form-attribute-validation-message">\n                 <span ng-message="required">{{\'visitor.contact-info.form.validation.required\' | translate}}</span>\n                 <span ng-message="email">{{\'visitor.contact-info.form.validation.email\' | translate}}</span>\n            </div>\n           </div>\n          <'+d+'\n             ng-repeat="subField in $ctrl.attribute.subFields"\n             data-hook="dynamic-dynamic-form-attribute-sub-field"\n             attribute="subField"/>',i=angular.element(h);this.$element.append(i),this.$compile(i)(this.$scope),this.updateNumberOfParticipantValue()},b}();a.DynamicFormAttributeComponent=b,angular.module("bookingsDynamicForm").component("bksDynamicFormAttribute",{template:"",controller:b,require:{formController:"^form"},bindings:{attribute:"=",onAttributeChanged:"&"}})}(b=a.form||(a.form={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.INDIVIDUAL="INDIVIDUAL",b.GROUP="GROUP",a.OfferingTypes=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){Object.assign(this,a)}return a}();a.BusinessInfo=b}(b=a.domain||(a.domain={}))}(b=a.common||(a.common={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.staffList=[]}return a.prototype.withStaffList=function(a){return this.staffList=a,this},a.prototype.build=function(){return{staff:this.staffList}},a}();a.StaffMemberListDtoBuilder=b;var c=function(){function a(){this.staffMember={id:"staffMember-id",fullName:"staffMember name"}}return a.prototype.withName=function(a){return this.staffMember.fullName=a,this},a.prototype.withId=function(a){return this.staffMember.id=a,this},a.prototype.build=function(){return this.staffMember},a}();a.StaffMemberDtoBuilder=c}(b=a.staff||(a.staff={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.bookingRequest={tentativeBookingId:null,nextStep:{name:null,orderId:null}}}return a.prototype.withTentativeBookingId=function(a){return this.bookingRequest.tentativeBookingId=a,this},a.prototype.withStepName=function(a){return this.bookingRequest.nextStep.name=a,this},a.prototype.withExternalOrderId=function(a){return this.bookingRequest.nextStep.orderId=a,this},a.prototype.build=function(){return this.bookingRequest},a}();a.CreateBookingStepResponseBuilder=b}(b=a.domain||(a.domain={}))}(b=a.offering||(a.offering={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.category={name:"",order:0,id:"category-id"}}return a.prototype.withCategoryId=function(a){return this.category.id=a,this},a.prototype.withName=function(a){return this.category.name=a,this},a.prototype.withOrder=function(a){return this.category.order=a,this},a.prototype.build=function(){return this.category},a}();a.OfferingCategoryDtoBuilder=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.idGenerator=function(){return"offering-id-"+Math.random()},this.offering=this.validOfferingDto()}return a.prototype.validOfferingDto=function(){var a=moment();return{id:this.idGenerator(),categoryId:this.idGenerator(),order:0,type:this.getOfferingType(),urlName:"offering-id-0",info:{name:"Offering Name",description:"This is some description blah blah blah",images:null},location:{type:"BUSINESS",locationText:"Location"},payment:{currency:"USD",price:10,isFree:!1,priceText:"",minCharge:9,paymentType:"OFFLINE"},schedulePolicy:{maxParticipantsPerOrder:1,capacity:1},schedule:{startDate:parseInt(a.clone().format("x"),10),endDate:parseInt(a.clone().add(100,"days").format("x"),10),noEndDate:!0,durationInMinutes:10}}},a.prototype.withDuration=function(a){return this.offering.schedule.durationInMinutes=a,this},a.prototype.withId=function(a){return this.offering.id=a,this},a.prototype.withDummyIndication=function(){return this.offering.dummy=!0,this},a.prototype.withUrlName=function(a){return this.offering.urlName=a,this},a.prototype.withIdGenerator=function(a){return this.idGenerator=a,this},a.prototype.withCategoryId=function(a){return this.offering.categoryId=a,this},a.prototype.withLocation=function(a){return this.offering.location.type=a.type,this.offering.location.locationText=a.text,this},a.prototype.withName=function(a){return this.offering.info.name=a,this},a.prototype.withPaymentType=function(a){return this.offering.payment.paymentType=a,this},a.prototype.withDescription=function(a){return this.offering.info.description=a,this},a.prototype.withCapacity=function(a){return this.offering.schedulePolicy.capacity=a,this},a.prototype.withNameSuffix=function(a){return this.offering.info.name+=a,this},a.prototype.withImages=function(a){return this.offering.info.images=a,this},a.prototype.withOrder=function(a){return this.offering.order=a,this},a.prototype.withPrice=function(a){var b=a.price,c=void 0===b?1.99:b,d=a.priceText,e=void 0===d?"":d,f=a.currency,g=void 0===f?"USD":f,h=a.isFree,i=void 0===h?!1:h,j=a.minCharge,k=void 0===j?0:j;return this.offering.payment.currency=g,this.offering.payment.priceText=e,this.offering.payment.isFree=i,this.offering.payment.price=c,this.offering.payment.minCharge=k,this},a.prototype.build=function(){return this.offering},a}();a.BaseOfferingDtoBuilder=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.getOfferingType=function(){return a.OfferingTypes.INDIVIDUAL},c.prototype.validOfferingDto=function(){var a=b.prototype.validOfferingDto.call(this);return __assign({},a,{schedulePolicy:__assign({},a.schedulePolicy,{staffMembersIds:[],minutesBetweenAppointments:15})})},c.prototype.withStaffMembers=function(a){return this.offering.schedulePolicy.staffMembersIds=a.map(function(a){return a.id}),this},c.prototype.build=function(){return b.prototype.build.call(this)},c}(a.BaseOfferingDtoBuilder);a.IndividualOfferingDtoBuilder=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.getOfferingType=function(){return a.OfferingTypes.GROUP},c.prototype.validOfferingDto=function(){var a=b.prototype.validOfferingDto.call(this);return __assign({},a,{schedule:__assign({},a.schedule,{classHours:{mon:{workingHours:[{id:this.idGenerator(),workingHour:{startTime:"12:00"},staffId:null}]},tue:{workingHours:[{id:this.idGenerator(),workingHour:{startTime:"14:00"},staffId:null},{id:this.idGenerator(),workingHour:{startTime:"16:00"},staffId:null}]}}})})},c.prototype.withStaffMembers=function(a){var b=this.offering,c=Object.keys(b.schedule.classHours),d=0;return c.map(function(a){return b.schedule.classHours[a]}).forEach(function(b){return b.workingHours.forEach(function(b){return b.staffId=a[d++%a.length].id})}),this},c.prototype.build=function(){return b.prototype.build.call(this)},c}(a.BaseOfferingDtoBuilder);a.GroupOfferingDtoBuilder=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){function b(a,b){void 0===b&&(b=""),(b?a.find(b):a).focus()}function c(a,b,c){void 0===c&&(c=""),e(l,a,b,c)}function d(a,b,c){void 0===c&&(c=""),e(m,a,b,c)}function e(a,b,c,d){void 0===d&&(d=""),a.has(b)&&a.get(b)(c,d)}a.focusOn=b;var f=function(a,c){return b(a.next(),c)},g=function(a,c){return b(a.prev(),c)},h=40,i=38,j=37,k=39,l=new Map;l.set(h,f),l.set(i,g);var m=new Map;m.set(k,f),m.set(j,g),a.navigateWithVerticalArrowWhileOnElement=c,a.navigateWithHorizontalArrowWhileOnElement=d}(b=a.accessibility||(a.accessibility={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={})),angular.module("schedulerAngularClientAppInternal",["schedulerAngularClientTranslations","schedulerAngularClientAppConstants","schedulerGroupAppInternal","schedulerOfferingsAppInternal","schedulerClientCommon","wix","schedulerTemplatesInternal","schedulerAngularClientCommon","bookingsDynamicForm","schedulerBiLogger","ngRoute","fedops"]).config(["fedopsLoggerProvider","$compileProvider","$qProvider","$locationProvider",function(a,b,c,d){a.setAppName(window.__APP_NAME__||"appName"),d.hashPrefix(""),c.errorOnUnhandledRejections(!1),b.preAssignBindingsEnabled(!0)}]).run(["$rootScope","experimentsEnabler",function(a,b){a.experimentsEnabler=b}]),angular.module("schedulerTemplatesInternal",[]),angular.module("schedulerAngularClientAppConstants",[]),angular.module("schedulerGroupAppInternal",[]),angular.module("schedulerOfferingsAppInternal",[]);try{angular.module("schedulerAngularClientTranslations")}catch(e){angular.module("schedulerAngularClientTranslations",["pascalprecht.translate"])}angular.module("schedulerAngularClientCommon",["wixSdkUtilInternal","schedulerCommonStatics"]),angular.module("wixSdkUtilInternal",["wix","schedulerAngularClientTranslations"]),angular.module("schedulerAngularClientBootstrap",["schedulerAngularClientAppInternal","ui.bootstrap"]).config(["$tooltipProvider",function(a){a.setTriggers({mouseenter:"mouseleave","staff-member-selection.open":"staff-member-selection.close","timezone-switch-popover.open":"timezone-switch-popover.close"})}]),angular.module("schedulerBiLogger",["wix.common.bi"]).config(["wixBiLoggerProvider","appEventMap",function(a,b){var c=function(a){try{return a()}catch(b){return""}},d=function(){var a=Wix.Utils.getInstanceValue("uid");return null===a?Wix.Utils.getInstanceValue("aid"):a},e=function(){try{return"OWNER"===Wix.Utils.getPermissions()}catch(a){return""}};a.setConfig({eventMap:b,defaultEventArgs:{visitor_id:c(d),src:16,businessId:c(Wix.Utils.getInstanceId),is_over_editor:c(Wix.Utils.isOverEditor),is_owner:e(),biToken:c(function(){return Wix.Utils.getInstanceValue("biToken")}),contactId:c(Wix.Utils.getUid)},adapter:"wixboost-ugc"})}]).run(["$window","$q",function(a,b){a.Promise=b}]);var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(){var b=a.boost.common.general.Timezone;angular.module("schedulerAngularClientAppSeverConfig",["wixAngularLazyLoad"]),angular.module("schedulerAngularClientApp",["schedulerAngularClientBootstrap","wixAngular","isoCurrency","ui.calendar","ui.bootstrap","debounce","ngAria","react","schedulerAngularClientAppSeverConfig"]).config(["$provide",function(a){a.decorator("$exceptionHandler",["$delegate","$window",function(a,b){return function(c,d){b.trackJs&&"true"===bookingsExperiments["specs.TrackJSVisitorSpecs"]&&b.trackJs.track(c),a(c,d)}}])}]).config(["$routeProvider","clientPages","experimentsEnablerProvider","experimentManagerProvider",function(a,c,d,e){e.setExperiments(bookingsExperiments);var f=c.PREFIX,g={serviceList:["servicesSrv",function(a){return a.gettingServices()}],groupList:["groupsSrv",function(a){return a.gettingGroupsList()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]},h={template:'<bks-offering-list-page offerings-list="$resolve.offeringList">',resolve:{offeringList:["offeringsListGetterSrv",function(a){return a.gettingOfferingsList()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]}},i=d.isOfferingsUnificationEnabled(),j=i?h:{templateUrl:"modules/common/components/services-list/visitor-service-list.preload.html",reloadOnSearch:!1,controller:"ServicesCtrl as servicesCtrl",resolve:g},k=i?h:{template:"<boost-group-list-page>",resolve:g};a.when(f+c.VISITOR_SERVICES,j).when(f+c.VISITOR_CALENDAR+"/:timezone?",{template:'<boost-calendar-page business-timezone="$resolve.businessTimezone" user-timezone="$resolve.userTimezone"/>',reloadOnSearch:!0,resolve:{capableStaff:["visitorStaffSrv",function(a){return a.getCapableStaff()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}],userTimezone:["timezoneSrv",function(a){return a.gettingUserTimezone()}],businessTimezone:["businessInfoSrv","experimentsEnabler",function(a,c){return a.gettingBusinessInfo().then(function(a){return c.isCityTimezoneEnabled()?new b(a.timeZone,a.timeZoneStandardOffset,a.timeZoneOffset):new b(a.timeZone,"","")})}],selectedServiceEnforced:["ServiceTypes","appointmentService",function(a,b){b.enforceSelectedServiceType(a.INDIVIDUAL)}],firstAvailableDate:["timezoneSrv","appointmentService","slotsSrv",function(a,b,c){return a.gettingUserTimezone().then(function(a){var d=b.getSelectedService();return c.getFirstAvailableSlotForIndividualService(d,a.name)})}]}}).when(f+c.VISITOR_CONTACT_INFO,{template:i?"<bks-contact-info-page/>":"<bks-individuals-contact-info-page/>",resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],timezone:["appointmentService",function(a){var b=a.getSelectedTime();return b&&b.timeZone}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}],dynamicFormData:["contactInfoSrv",function(a){return a.gettingBookingsDynamicForm()}]},reloadOnSearch:!1}).when(f+c.VISITOR_GROUPS_CONTACT_INFO,{template:"<bks-groups-contact-info-page/>",resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],timezone:["appointmentService",function(a){var b=a.getSelectedTime();return b&&b.timeZone}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}],dynamicFormData:["contactInfoSrv",function(a){return a.gettingBookingsDynamicForm()}]},reloadOnSearch:!1}).when(f+c.VISITOR_CONGRATS,{template:i?"<bks-congratulations-page/>":"<boost-individual-congratulations-page/>",resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}]}}).when(f+c.GROUPS_VISITOR_CONGRATS,{template:"<boost-group-congratulations-page/>",resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}]}}).when(f+c.VISITOR_GROUPS_CALENDAR,{template:"<boost-groups-calendar></boost-groups-calendar>",reloadOnSearch:!1,resolve:{businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}],selectedServiceEnforced:["ServiceTypes","appointmentService",function(a,b){b.enforceSelectedServiceType(a.GROUP)}],firstAvailableDate:["appointmentService","groupsSrv",function(a,b){var c=a.getSelectedService();return b.getFirstAvailableSlotForPrototype(c)}],staff:["visitorStaffSrv",function(a){return a.gettingStaffMembers()}]}}).when(f+c.VISITOR_GROUPS,k).when(f+c.VISITOR_SPLASH,{template:"<boost-service-type-page></boost-service-type-page>",resolve:{groupsList:["groupsSrv",function(a){return a.gettingGroupsList()}],servicesList:["servicesSrv",function(a){return a.gettingServices()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]}}).when(f+c.WIDGET_INDIVIDUAL+"/:serviceId",{template:"<boost-widget-route></boost-widget-route>",resolve:{groupsList:["groupsSrv",function(a){return a.gettingGroupsList()}],servicesList:["servicesSrv",function(a){return a.gettingServices()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]},serviceType:"individual"}).when(f+c.WIDGET_GROUP+"/:serviceId",{template:"<boost-widget-route></boost-widget-route>",resolve:{groupsList:["groupsSrv",function(a){return a.gettingGroupsList()}],servicesList:["servicesSrv",function(a){return a.gettingServices()}],styleParams:["wixSdkUtil",function(a){return a.getStyleParams()}]},serviceType:"group"}).when(f+c.USER_ACCOUNT_MANAGEMENT,{redirectTo:function(){return f+c.USER_ACCOUNT_MANAGEMENT+"/"+c.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS}}).when(f+c.USER_ACCOUNT_MANAGEMENT+"/"+c.USER_ACCOUNT_MANAGEMENT_INFO,{template:"<bks-account-management-user-info/>"}).when(f+c.USER_ACCOUNT_MANAGEMENT+"/"+c.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS,{template:'<bks-account-management-bookings booking-list="$resolve.bookingList" timezone="{{$resolve.timezone}}"/>',resolve:{timezone:["businessInfoSrv",function(a){return a.gettingBusinessInfo().then(function(a){return a.timeZone})}],bookingList:["bookingHistorySrv",function(a){return a.gettingBookings()}]}}).when(f+c.OFFERING_PAGE,{template:'<bks-offering-page\n            offering="$resolve.offering" \n            business-info="$resolve.businessInfo"/>',resolve:{lazyLoader:["lazyLoaderSrv",function(a){return a.lazyLoadLibs(["react","offeringPage"])}],offering:["offeringFinder",function(a){return a.selected()}],businessInfo:["businessInfoSrv",function(a){return a.gettingBusinessInfo()}]}}).otherwise({redirectTo:function(){return f+c.VISITOR_SPLASH}})}])}(c=b.desktop||(b.desktop={}))}(c=b.visitor||(b.visitor={}))
}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));try{angular.module("schedulerAngularClientTranslations")}catch(e){angular.module("schedulerAngularClientTranslations",["pascalprecht.translate"])}angular.module("schedulerAngularClientApp").config(["routeManagerProvider","clientPages",function(a,b){a.setPrefix(b.PREFIX)}]).run(["visitorBiListener",function(a){a.init()}]).run(["$$testability","$wix",function(a,b){a.whenStable(function(){b.Performance.applicationLoaded()})}]).run(["$route","$rootScope","eventsConst","$location","$routeParams","$window","wixSdkUtil","clientPages","routeManager","wixPageNavigation","userManagementSrv",function(a,b,c,d,e,f,g,h,i,j,k){i.suspendFocus=!0,b.$on("$locationChangeStart",function(a,b){k.isPathAllowed(b)||i.gotoPage("")}),b.$on("$routeChangeStart",function(){b.$emit("showLoading")}),j.init(),b.$on("$routeChangeSuccess",function(a,h,j){b.$emit("hideLoading"),b.$emit(c.CONTENT_CHANGED);var k=d.path()+"?";angular.forEach(e,function(a,b){k+=b+"="+a+"&"}),k=k.substr(0,k.length-1),f._gaq&&f._gaq.push(["_trackPageview",k]),j&&(i.suspendFocus===!1&&g.resetHeight(),i.suspendFocus=!1)}),a.reload()}]);var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.staffMember=c,this.time=moment.tz(+a,b)}return a.prototype.getStaff=function(){return this.staffMember},a.prototype.getTime=function(){return this.time},a.prototype.getTimeStamp=function(){return+this.time.format("x")},a}();a.TimeSlotOption=b}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.TILE_IMAGE_SHAPE=a,this.commonServices=b}return a.prototype.isSquareImage=function(){return this.tileConfig.imageType===this.TILE_IMAGE_SHAPE.SQUARE},a.prototype.isRoundImage=function(){return this.tileConfig.imageType===this.TILE_IMAGE_SHAPE.ROUND},a.prototype.isImageVisible=function(){return this.tileConfig.imageType!==this.TILE_IMAGE_SHAPE.NONE},a.prototype.getImageUrl=function(a,b){return this.commonServices.getImageUrl(a,b)},a}();a.BaseTileController=b}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),function(){function a(a){a.$emit("we are using controllerAs syntax, scope is used only for events and watches"),this.awesomeThings=["Bower","Grunt","Haml","Compass","AngularJS","Karma"]}a.$inject=["$scope"],angular.module("schedulerAngularClientAppInternal").controller("MainController",a)}(),function(){function a(a,b,c,d){this.next=function(){b.gotoPage(c.VISITOR_CALENDAR)},this.doAddAppointment=function(){var b={timestamp:d.$("#asdate").val(),email:d.$("#aemail").val()};a.addingAppointment("api/visitor/appointments","PUT",b)}}a.$inject=["appointmentService","routeManager","clientPages","libs"],angular.module("schedulerAngularClientAppInternal").controller("AddAppointmentController",a)}();var BaseServicesCtrl=function(){function a(a,b,c,d,e){this.groupsSrv=a,this.servicesSrv=b,this.SERVICE_CATEGORY_LAYOUT=c,this.commonServices=d,this.firstServiceType=e.getServiceTypeOrder()}return a.$inject=["groupsSrv","servicesSrv","SERVICE_CATEGORY_LAYOUT","commonServices","appSettings"],a.prototype.hasGroupsServices=function(){return this.groupsSrv.hasRealGroups(this.groupsList)},a.prototype.hasIndividualServices=function(){return this.servicesSrv.hasRealServices(this.serviceList)},a.prototype.isCategoriesAvailable=function(){return this.categoriesType!==this.SERVICE_CATEGORY_LAYOUT.NONE},a.prototype.updatePerCategory=function(a,b){return this.categoriesType!==this.SERVICE_CATEGORY_LAYOUT.NONE?this.commonServices.getServicesForCategory(a):b},a}(),wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.API_PREFIX="_api/scheduler-server/visitor/",b.CREATING_LEGACY_BOOKING_API=b.API_PREFIX+"booking/register",b.CREATING_LEGACY_TENTATIVE_BOOKING_API=b.API_PREFIX+"booking/payment",b.CREATING_TENTATIVE_BOOKING_API=b.API_PREFIX+"tentativeBooking",b.FINALIZING_BOOKING_API=b.API_PREFIX+"finalizeBooking",a.BookingApiConst=b;var c=function(){function a(a,c){var d=this;this.$http=a,this.commonApiBase=c,this.creatingTentativeBooking=this.commonApiBase.httpWrapper(function(a){return d.$http.post(""+b.CREATING_TENTATIVE_BOOKING_API,a)}),this.finalizingBooking=this.commonApiBase.httpWrapper(function(a){return d.$http.post(""+b.FINALIZING_BOOKING_API,a)}),this.creatingLegacyTentativeBooking=this.commonApiBase.httpWrapper(function(a){return d.$http.post(""+b.CREATING_LEGACY_TENTATIVE_BOOKING_API,a)}),this.creatingBooking=this.commonApiBase.httpWrapper(function(a){return d.$http.post(""+b.CREATING_LEGACY_BOOKING_API,a)})}return a.$inject=["$http","commonApiBase"],a}();a.BookingApiSrv=c,angular.module("schedulerAngularClientAppInternal").service("bookingApiSrv",c)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){Object.assign(this,a)}return a}();a.Booking=b}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.bookingApiSrv=a}return a.$inject=["bookingApiSrv"],a.prototype.creatingLegacyTentativeBooking=function(a){return this.bookingApiSrv.creatingLegacyTentativeBooking(a).then(function(a){return a.orderId})},a.prototype.creatingBooking=function(a){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(b){switch(b.label){case 0:return[4,this.bookingApiSrv.creatingBooking(a)];case 1:return[2,b.sent()]}})})},a}();a.CreateBookingSrv=b,angular.module("schedulerAngularClientAppInternal").service("createBookingSrv",b)}(b=a.booking||(a.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){function c(c,d,e,f,g,h,i,j,k,l,m){function n(a){return a&&409===a.status&&a.data&&-7===a.data.errorCode}function o(a){return a&&413===a.status&&a.data&&-102477===a.data.errorCode}function p(a){return B(a)?b.BOOKING_CONFLICT:a}function q(){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(b){switch(b.label){case 0:return r()?[4,d.registerTentativeGroup(v())]:[3,2];case 1:return a=b.sent(),[3,4];case 2:return[4,d.registerTentativeIndividual(u())];case 3:a=b.sent(),b.label=4;case 4:return[2,a.orderId]}})})}function r(){var a=y.getSelectedService();return a.type===f.GROUP}function s(a,b,c){var d;return d=y.isGroupService(b)?c&&c.groupInstance?c.groupInstance[a]:"":b[a]}function t(a){var b={email:a.email,fullName:a.name,phoneNumber:a.phone,message:a.message};return a.address&&(b.addressLine=a.address.addressLine,b.apartmentNum=a.address.aptOrFloor,b.city=a.address.city),b}function u(){var a=y.getContactInfo(),b=y.getSelectedTime(),c=y.getSelectedService(),d=t(a);return d.serviceId=c.id,d.payment=y.getPaymentInfo(),d.timestamp=parseInt(b.startTime,10),d.timeZone=b.timeZone,d.staffMemberId=b.staffMember.id,d}function v(){var a={},b=y.getContactInfo(),c=y.getSelectedTime(),d=y.getSelectedService(),e=t(b);return a.classInstanceId=c.groupInstance.id,a.payment=y.getPaymentInfo(),a.participants=[e],a.numberOfParticipants=d.numberOfParticipants,a}function w(a){return r()?d.registeringToGroup(v(),a):d.creatingAppointment(u(),a)}var x=this,y=this,z=function(){var a=x.getSelectedService(),b=x.getSelectedTime();return{type:a.type,offeringId:a.id,timeSlot:{id:r()?b.groupInstance.id:"",staffMemberId:b.staffMember.id,timeStamp:parseInt(b.startTime,10),timeZone:b.timeZone}}},A=function(){var a=x.getContactInfo().dynamicFormData.form,c=x.getPaymentInfo(),d=z(),e=new b.Booking({scheduleInfo:d,contactInfo:{bookingsForm:a},paymentInfo:c});return e};this.init=function(){y.fillContactInfoWithLoggedInUserDetails(),l.$on(a.bookings.user.UserManagementSrv.USER_INFO_CHANGED,function(){y.fillContactInfoWithLoggedInUserDetails()}),l.$on(a.bookings.user.UserManagementSrv.LOGOUT_INITIATED,function(){c.clearKey("contactInfo")})},this.initiate=function(a,b){return b||(c.clearKey("bookingInfo"),c.clearKey("appointmentDateTime")),null===a?c.clearKey("selectedService"):(y.serviceWithZeroPricePaymentTypeOnlineWorkaround(a),this.persist(a))},this.persist=function(a){return c.setToCache("selectedService",a)},this.enforceSelectedServiceType=function(a){var b=c.getFromCache("selectedService");b&&a!==b.type&&c.clearKey("selectedService")},this.getSelectedService=function(){var a=c.getFromCache("selectedService");return a=e.enrichServiceIfOverEditor(a)},this.serviceWithZeroPricePaymentTypeOnlineWorkaround=function(a){0===a.price&&a.paymentType===i.PAYMENT_TYPE_ONLINE&&(a.paymentType=i.PAYMENT_TYPE_OFFLINE,a.isFree=!0)},this.fillContactInfoWithLoggedInUserDetails=function(){var a=k.getCurrentSiteMember(),b=this.getContactInfo()||{};if(!e.isOverEditor&&a.email){var c={email:a.email,name:a.fullName,phone:a.phoneNumber};this.setContactInfo(__assign({},b,c))}},this.setPaymentInfo=function(a){return c.setToCache("paymentInfo",a)},this.getPaymentInfo=function(){return c.getFromCache("paymentInfo")},this.setCurrentBooking=function(a){return c.setToCache("bookingInfo",a)},this.getCurrentBooking=function(){return c.getFromCache("bookingInfo")},this.getSelectedTime=function(){return e.enrichSelectedTimeIfOverEditor(c.getFromCache("appointmentDateTime"))},this.setSelectedTime=function(a){return c.setToCache("appointmentDateTime",a)},this.setLastSelectedTime=function(a){return c.setToCache("appointmentLastDateTime",a)},this.getLastSelectedTime=function(){return c.getFromCache("appointmentLastDateTime")},this.getContactInfo=function(){return e.enrichContactIfOverEditor(c.getFromCache("contactInfo"))},this.setContactInfo=function(a){return c.setToCache("contactInfo",a)};var B=function(a){return n(a)||o(a)};this.save=function(){return __awaiter(this,void 0,void 0,function(){var a,b,c;return __generator(this,function(d){switch(d.label){case 0:return e.isDemoFlow?(g.appointmentCreated("OFFLINE"),[2,""]):[3,1];case 1:return d.trys.push([1,6,,7]),h.isBookingsFormEnabled()?[4,m.creatingBooking(A())]:[3,3];case 2:return b=d.sent(),[3,5];case 3:return[4,w(B)];case 4:b=d.sent(),d.label=5;case 5:return a=b,g.appointmentCreated("OFFLINE"),[2,a];case 6:throw c=d.sent(),p(c);case 7:return[2]}})})},this.getAppointmentLocation=function(a,b){return a=this.populateService(a),b=this.populateTime(b),s("location",a,b)},this.getAppointmentLocationText=function(a,b){return a=this.populateService(a),b=this.populateTime(b),s("locationText",a,b)},this.isGroupService=function(a){return a.type===f.GROUP},this.isShowBusinessAddress=function(a,b,c,d){return a=this.populateService(a),b=this.populateTime(b),d=d||!1,y.isShowBusinessAddressIndividual(a,b,c,d)||y.isShowBusinessAddressGroups(a,b)},this.populateService=function(a){return a||(a=y.getSelectedService()),a},this.populateTime=function(a){return a||(a=y.getSelectedTime()),a},this.isShowBusinessAddressIndividual=function(a,b,c,d){var e=y.getAppointmentLocation(a,b);return!y.isGroupService(a)&&(y.isCustomerLocationToShow(e,d)||y.isBusinessLocationOnTheGoAndNotServiceLocationCustomer(e,c))},this.isCustomerLocationToShow=function(a,b){return"CUSTOMER"===a&&b},this.isBusinessLocationOnTheGoAndNotServiceLocationCustomer=function(a,b){return"CUSTOMER"!==a&&(!b||"ON_THE_GO"!==b.businessLocation)},this.isShowBusinessAddressGroups=function(a,b){return y.isGroupService(a)&&!!b&&!!b.groupInstance},this.getBusinessCity=function(a,b,c){if(b=this.populateService(b),c=this.populateTime(c),!this.isOtherLocation(b,c)&&"ON_THE_GO"!==a.businessLocation){var d=a.city,e=a.zipCode;return j("sidebar.address.line2",{city:d,zipCode:e})}},this.isOtherLocation=function(a,b){return"OTHER"===this.getAppointmentLocation(a,b)},this.createTentativeBooking=function(){return __awaiter(x,void 0,void 0,function(){var a,b,c;return __generator(this,function(d){switch(d.label){case 0:return e.isDemoFlow?[2,""]:[3,1];case 1:return d.trys.push([1,6,,7]),h.isBookingsFormEnabled()?[4,m.creatingLegacyTentativeBooking(A())]:[3,3];case 2:return b=d.sent(),[3,5];case 3:return[4,q()];case 4:b=d.sent(),d.label=5;case 5:return a=b,[2,a];case 6:throw c=d.sent(),p(c);case 7:return[2]}})})},y.init()}c.$inject=["cacheSrv","visitorApi","overEditor","ServiceTypes","visitorBILogger","experimentsEnabler","paymentType","$translate","userManagementSrv","$rootScope","createBookingSrv"],b.BOOKING_CONFLICT="BOOKING_CONFLICT",angular.module("schedulerAngularClientAppInternal").service("appointmentService",c)}(c=b.booking||(b.booking={}))}(b=a.visitor||(a.visitor={}))}(wix||(wix={})),function(){angular.module("schedulerAngularClientAppConstants").constant("serviceConst",{LOCATION_CUSTOMER:"CUSTOMER",LOCATION_OTHER:"OTHER",LOCATION_BUSINESS:"BUSINESS",LOCATIONS_WITH_ADDRESS:["CUSTOMER"]}).constant("SERVICE_EDITOR_DEFAULTS",{imagesList:[{images:[{fileName:"Receptionist",relativeUri:"413707c67361480983896a2e55509f29.jpg",width:7360,height:4912}]},{images:[{fileName:"Clock",relativeUri:"2c2ed29dab6946dfb37072e57fd294a3.jpg",width:3666,height:2435}]},{images:[{fileName:"Modern Coffee Table",relativeUri:"6142ea7f91914d1c9bee8f8380110f78.jpg",width:3025,height:1706}]},{images:[{fileName:"Laptop",relativeUri:"f656fb99b72847c7b66e01324d843074.jpg",width:2560,height:1709}]},{images:[{fileName:"Business Meeting ",relativeUri:"bfc7011abc1642358204a81111b9e72b.jpg",width:4368,height:2912}]},{images:[{fileName:"Table Plant",relativeUri:"e2d524c78f3842a1b74dc3b2f4827727.jpg",width:2560,height:1709}]},{images:[{fileName:"Cactus Plant ",relativeUri:"a781e4805ee549c193112e17192b376c.jpg",width:2560,height:1707}]},{images:[{fileName:"Making Appointments",relativeUri:"7f70fae2af3e444d9ab8c3b7698a6c1a.jpg",width:4944,height:3948}]},{images:[{fileName:"Coffee Time",relativeUri:"d18f6586a05443c8a8d4b671cee5ea4c.jpg",width:2560,height:1707}]}]}).constant("SERVICE_IMAGE_SIZE",{angelina:{width:105,height:105},angelina_round:{width:105,height:105},heidi:{width:470,height:446},heidi_round:{width:360,height:360},bar:{width:300,height:200},bar_round:{width:185,height:185},bar_with_sidebar:{width:370,height:220},bar_with_sidebar_round:{width:225,height:225},mobile:{width:282,height:169},mobile_round:{width:370,height:169}}).constant("ServiceTypes",{GROUP:"GROUP",INDIVIDUAL:"INDIVIDUAL"}).constant("GROUP_IMAGE_SIZE",{simple:{width:470,height:446}})}();var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.imagesList=[],this.imagesList.push({images:[{fileName:"Receptionist",relativeUri:"94529b508b40459fb23e9c35b7e7cc0c.jpg",width:2560,height:1707}]}),this.imagesList.push({images:[{fileName:"Receptionist",relativeUri:"2789fba4f9de4318a4fe0cbcfd39b671.jpg",width:2560,height:1707}]}),this.imagesList.push({images:[{fileName:"Receptionist",relativeUri:"515c2410e09149e89d8d70b84beaba0a.jpg",width:2560,height:1707}]})}return a}();a.GroupEditorDefaults=b,angular.module("schedulerAngularClientAppConstants").constant("GROUP_EDITOR_DEFAULTS",new b)}(b=a.groups||(a.groups={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var MemberAreaDeepLinkConst=function(){function a(){}return a}();MemberAreaDeepLinkConst.BOOK_ANOTHER_DEEP_LINK_NAME="memberArea_bookAnotherDeepLink",MemberAreaDeepLinkConst.RESCHEDULE_DEEP_LINK_NAME="memberArea_rescheduleDeepLink",MemberAreaDeepLinkConst.BOOKING="booking";var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a[a.BUSINESS=0]="BUSINESS",a[a.USER=1]="USER"}(b=a.Timezones||(a.Timezones={}))}(b=a.constants||(a.constants={}))}(b=a.common||(a.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.common.constants.Timezones,d=function(){function b(a,b,c,d,e,f,g){this.momentSrv=a,this.libs=b,this.visitorBILogger=c,this.cacheSrv=d,this.experimentsEnabler=e,this.$translate=f,this.$element=g,"true"===this.openByDefault&&this.openPopover()}return b.$inject=["momentSrv","libs","visitorBILogger","cacheSrv","experimentsEnabler","$translate","$element"],b.prototype.isPopoverOpen=function(){return this.popoverOpen},b.prototype.togglePopover=function(){this.popoverOpen?this.closePopover():this.openPopover()},b.prototype.onKeyPress=function(a){var b=a.which;if(this.isVisitorAccessibilityEnabled()){var c=13,d=32;(c===b||d===b)&&this.togglePopover()}},b.prototype.openPopover=function(){this.popoverOpen=!0,this.visitorBILogger.logPopupOpened(),this.cacheSrv.setToCache(b.CACHE_KEY,!0)},b.prototype.closePopover=function(){this.popoverOpen=!1,this.visitorBILogger.logPopupClosed("time_zone"),this.isVisitorAccessibilityEnabled()&&this.focusOnTimeZoneLinkElement()},b.prototype.isVisitorAccessibilityEnabled=function(){return this.experimentsEnabler.isVisitorAccessibilityEnabled()},b.prototype.focusOnTimeZoneLinkElement=function(){var a=this.$element.find('[data-hook="timezone-switch"]');focusOn(a)},b.prototype.onSwitch=function(a){this.onSwitchCallback({timezone:a})},b.prototype.isBusiness=function(){return+this.currentTimezone===c.BUSINESS},b.prototype.isUser=function(){return+this.currentTimezone===c.USER},b.prototype.calculateOffset=function(a){return this.momentSrv.timestampToLocaleMoment(this.nowTimestamp(),a).format("Z")},b.prototype.nowTimestamp=function(){return moment().format("x")},b.prototype.timezoneString=function(a){return+a===c.BUSINESS?this.businessTimezone:this.userTimezone},b.prototype.currentTimezoneOffset=function(){return this.calculateOffset(this.timezoneString(this.currentTimezone))},b.prototype.userTimezoneOffset=function(){return this.calculateOffset(this.userTimezone)},b.prototype.businessTimezoneOffset=function(){return this.calculateOffset(this.businessTimezone)},b.prototype.getBookingBaseOnTimeZoneText=function(){var a=this.getTranslationKey();return this.$translate(a,{city:this.getTranslateTimezoneCity(this.timezoneString(this.currentTimezone)),offset:this.currentTimezoneOffset()})},b.prototype.getTranslationKey=function(){var a=this.isBusiness()?"business":"user",b=this.experimentsEnabler.isCityTimezoneEnabled()?"-city":"",c=this.experimentsEnabler.isCityTimezoneEnabled()&&this.isUSATimezone(this.currentTimezone)?"-usa":"",d="calendar.timezone"+c+b+"-switch."+a;return d},b.prototype.isUSATimezone=function(b){return a.bookings.timezone.USATimezone.has(this.timezoneString(b))},b.prototype.getTranslateTimezoneCity=function(a){return this.$translate("timezone-"+a+"-city")},b}();d.CACHE_KEY="tz_switch_shown",b.TimezoneSwitch=d,angular.module("schedulerAngularClientAppInternal").component("bksTimezoneSwitch",{template:'\n               <div class="timezone-switch" ng-click="$ctrl.togglePopover()" ng-keypress="$ctrl.onKeyPress($event)" data-hook="timezone-switch" tabindex="0">\n                 <div class="timezone-switch__icon scheduler-svg-font-icons-clock-icon"\n                 bks-timezone-switch-popover="test"\n                 bks-timezone-switch-popover-placement="bottom"\n                 bks-timezone-switch-popover-animation="false"\n                 bks-timezone-switch-popover-is-open="$ctrl.isPopoverOpen()"\n                 bks-timezone-switch-popover-on-close="$ctrl.closePopover()"\n                 bks-timezone-switch-popover-on-switch="$ctrl.onSwitch(timezone)"\n                 bks-timezone-switch-popover-append-to-body="true"\n                 bks-timezone-switch-popover-btz="{{$ctrl.businessTimezone}}"\n                 bks-timezone-switch-popover-utz="{{$ctrl.userTimezone}}"\n                 bks-timezone-switch-popover-current="{{$ctrl.currentTimezone}}"\n                 bks-timezone-switch-popover-utz-offset="{{$ctrl.userTimezoneOffset()}}"\n                 bks-timezone-switch-popover-btz-offset="{{$ctrl.businessTimezoneOffset()}}"\n                 aria-hidden="true"\n               ></div>\n                 <div class="timezone-switch__label" data-hook="timezone-switch-label">\n                    {{$ctrl.getBookingBaseOnTimeZoneText()}}\n                 </div>\n               </div>',controller:d,bindings:{businessTimezone:"@",userTimezone:"@",onSwitchCallback:"&onSwitch",currentTimezone:"@",openByDefault:"@"}})}(c=b.components||(b.components={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){function c(a){return{restrict:"EA",replace:!0,controller:e,bindToController:!0,controllerAs:"$ctrl",scope:{title:"@",content:"@",placement:"@",animation:"&"},template:function(){return a.getIsMobile()?'<div class="timezone-switch-popover popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }" data-hook="timezone-switch-popover">\n                <div class="arrow"></div>\n                <div class="timezone-switch-popover__body popover-inner">\n                    <div class="timezone-switch-popover__content">\n                        <div class="timezone-switch-popover__current-state" data-hook="timezone-switch-popover__current-state">{{ ::getCurrentStateText()}}</div>\n                        <a class="timezone-switch-popover__switch-button" data-hook="tsp-switch-to" ng-click="onSwitch()">{{ ::getSwitchText()}}</a>\n                    </div>\n                </div>\n             </div>':'\n             <div class="timezone-switch-popover popover {{placement}}" \n                  ng-keydown="onKeyDown($event)" \n                  ng-class="{ in: isOpen(), fade: animation() }" \n                  data-hook="timezone-switch-popover"\n                  aria-label="{{ \'calendar.timezone-switch.popover.accessibility.insidePopup\' | wixSdkTranslate }}"\n                  aria-describedby="switchTimeZoneDesc"\n                  role="dialog"\n                  tabindex="0">\n                <div class="timezone-switch-popover__body popover-inner">\n                    <div ng-click="close()"\n                         ng-keydown="$ctrl.onCloseKeyDown($event)"\n                         class="timezone-switch-popover__close scheduler-svg-font-icons-close"\n                         data-hook="tsp-close"\n                         tabindex="0"\n                         role="button"\n                         aria-label="{{ \'calendar.timezone-switch.popover.accessibility.closePopup\' | wixSdkTranslate }}">\n                    </div>\n                    <div class="timezone-switch-popover__content">\n                        <div class="timezone-switch-popover__current-state" data-hook="timezone-switch-popover__current-state" id="switchTimeZoneDesc">{{::getCurrentStateText()}}</div>\n                        <button data-hook="tsp-switch-to"\n                                class="btn-primary"\n                                type="button"\n                                ng-click="onSwitch()"\n                                tabindex="0"\n                                ng-keydown="$ctrl.onButtonKeyDown($event)">{{::getSwitchText()}}</button>\n                    </div>\n                </div>\n             </div>'}}}var d=a.boost.common.constants.Timezones,e=function(){function b(b,c,e,f,g){var h=this;this.$scope=b,this.$translate=c,this.experimentsEnabler=e,this.$element=f,this.$timeout=g,this.onButtonKeyDown=function(a){var b=9;a.which!==b||a.shiftKey?a.shiftKey&&a.stopPropagation():(a.preventDefault(),a.stopPropagation(),focusOn($(".timezone-switch-popover__close")))},this.onCloseKeyDown=function(a){var b=9,c=13,d=32;a.which===b&&a.shiftKey?(a.preventDefault(),a.stopPropagation(),focusOn($('[data-hook="tsp-switch-to"]'))):(a.which===c||a.which===d)&&(a.preventDefault(),a.stopPropagation(),h.$scope.close())};var i=b.$parent.$parent.$parent,j=i.onSwitch,k=i.onClose,l=i.userOffset,m=i.businessOffset,n=i.userTimezone,o=i.businessTimezone,p=function(){return+i.currentTimezone},q=function(){return e.isVisitorAccessibilityEnabled()};b.userOffset=l,b.businessOffset=m,b.onSwitch=function(){var a=b.isBusinessTimezone()?d.USER:d.BUSINESS;j(a),k()},b.isBusinessTimezone=function(){return p()===d.BUSINESS},b.isUserTimezone=function(){return p()===d.USER},b.close=function(){return k()};var r=function(d,f,g){var h=e.isCityTimezoneEnabled()&&a.bookings.timezone.USATimezone.has(d)?"-usa":"",i=b.isUserTimezone()?"user":"business",j=e.isCityTimezoneEnabled()?"-city":"",k=b.getTranslateTimezoneCity(d),l="calendar.timezone-switch.popover."+i+h+j+g;return c(l,{city:k,offset:f})};b.getSwitchText=function(){var a=b.isUserTimezone()?o:n,c=b.isUserTimezone()?m:l;return r(a,c,".button")},b.getCurrentStateText=function(){var a=b.isUserTimezone()?n:o,c=b.isUserTimezone()?l:m;return r(a,c,".message")},b.getTranslateTimezoneCity=function(a){return c("timezone-"+a+"-city")},q()&&(f.on("click",function(a){a.stopPropagation()}),b.onKeyDown=function(a){var c=27,d=9;a.which===c?b.close():a.which===d&&a.shiftKey&&(a.preventDefault(),a.stopPropagation(),focusOn($('[data-hook="tsp-switch-to"]')))},g(function(){return focusOn(f)}))}return b.$inject=["$scope","$translate","experimentsEnabler","$element","$timeout"],b}();b.TimezoneSwitchPopoverCtrl=e,angular.module("schedulerAngularClientAppInternal").directive("bksTimezoneSwitchPopoverPopup",["appConfig",c]),angular.module("schedulerAngularClientAppInternal").directive("bksTimezoneSwitchPopover",["$tooltip","$timeout","experimentsEnabler",function(a,b,c){var d=a("bksTimezoneSwitchPopover","bksTimezoneSwitchPopover","timezone-switch-popover.open");d.scope={isOpen:"=bksTimezoneSwitchPopoverIsOpen",onCloseCallback:"&bksTimezoneSwitchPopoverOnClose",onSwitchCallback:"&bksTimezoneSwitchPopoverOnSwitch",businessTimezone:"@bksTimezoneSwitchPopoverBtz",userTimezone:"@bksTimezoneSwitchPopoverUtz",currentTimezone:"@bksTimezoneSwitchPopoverCurrent",userOffset:"@bksTimezoneSwitchPopoverUtzOffset",businessOffset:"@bksTimezoneSwitchPopoverBtzOffset"};var e=d.compile();return{restrict:"A",scope:d.scope,link:function(a,d,f){e.call(null,a,d,f);var g=angular.element("body"),h=function(a){return b(function(){return d.trigger(a)})},i=function(){h("timezone-switch-popover.close"),focusOn(d)},j=function(){return g.click(a.onClose)},k=function(){return g.off("click",a.onClose)},l=function(){return c.isVisitorAccessibilityEnabled()};a.onClose=function(){i(),a.onCloseCallback(),l()&&k()},a.$watch("isOpen",function(a){a?(h("timezone-switch-popover.open"),l()&&b(j)):i()}),a.onSwitch=function(b){a.onSwitchCallback({timezone:b})}}}}])}(c=b.components||(b.components={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.calendar.TimeSlotOption,d=a.boost.common.constants.Timezones,e=a.bookings.visitor.components.TimezoneSwitch,f=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){this.$scope=a,this.$rootScope=b,this.slotsSrv=c,this.appointmentService=d,this.$route=e,this.$element=f,this.clientPages=g,this.routeManager=h,this.flowManagerSrv=i,this.$timeout=j,this.wixBiLogger=k,this.$wix=l,this.TimeOfDay=m,this.CALENDAR_EVENTS=n,this.visitorBILogger=o,this.experimentsEnabler=p,this.$routeParams=q,this.$q=r,this.cacheSrv=s,this.visitorTimezoneSrv=u,this.libs=v,this.$translate=w,this.isActionComplete=!1,this.selectedService=this.appointmentService.getSelectedService(),this.staff=e.current.locals.staff,this.firstAvailableDate=e.current.locals.firstAvailableDate,this.currentTimezone=this.determineInitialTimezone(q.timezone),this.visitorBILogger.logTimezone();var x=e.current.locals.capableStaff;this.capableStaff=t(OrderByLowerCase.FILTER_NAME)(x.map(function(a){return{value:a.id,label:a.fullName}}),"label"),this.registerListeners(a,n,o),this.restorePreviousStateIfPresent(),p.isVisitorAccessibilityEnabled()&&(this.libs.$(".aria-page-title").html(""),this.libs.$(".aria-page-title").attr("aria-hidden",!1))}return a.$inject=["$scope","$rootScope","slotsSrv","appointmentService","$route","$element","clientPages","routeManager","flowManagerSrv","$timeout","wixBiLogger","$wix","TimeOfDay","CALENDAR_EVENTS","visitorBILogger","experimentsEnabler","$routeParams","$q","cacheSrv","$filter","visitorTimezoneSrv","libs","$translate"],a.prototype.focusOnTimeZoneLinkElement=function(){var a=this.$element.find('[data-hook="timezone-switch"]');focusOn(a)},a.prototype.$onInit=function(){var a=this;this.experimentsEnabler.isVisitorAccessibilityEnabled()&&(this.$timeout(function(){a.libs.$(".aria-page-title").html(a.ariaLabelPageAlert())},1500),this.$timeout(function(){a.libs.$(".aria-page-title").html("")},2e3),this.hasTimezoneRouteParameter()&&this.$timeout(function(){a.focusOnTimeZoneLinkElement()}))},a.prototype.hasTimezoneRouteParameter=function(){return this.$routeParams.hasOwnProperty("timezone")},a.prototype.ariaLabelPageAlert=function(){return this.$translate("calendar.accessibility.alert-title",{serviceName:this.selectedService.name})},a.prototype.determineInitialTimezone=function(a){var b=this.appointmentService.getSelectedTime();return angular.isDefined(a)?+a:b?this.businessTimezone&&b.timeZone===this.businessTimezone.name?d.BUSINESS:d.USER:d.BUSINESS
},a.prototype.registerListeners=function(a,b,c){var d=this;a.$on(b.DAY_SELECTED,function(a,b){d.slot=null,d.isActionComplete=!1,d.selectedDate=b.startOf("day"),d.availableSlotsForDay=d.createAvailableSlotsForDay(d.selectedDate),d.storeLastSelectionIfOverTheEditor(b.format("x")),d.handlePrepopulatedDateIfRequired()}),a.$on(b.SLOT_SELECTED,function(a,b){c.selectSlot(),d.isActionComplete=!!b.getStaff(),d.slot=b})},a.prototype.getCapableStaff=function(){return this.capableStaff},Object.defineProperty(a.prototype,"numOfStaff",{get:function(){return this.staff?this.staff.staff.length:0},enumerable:!0,configurable:!0}),a.prototype.handlePrepopulatedDateIfRequired=function(){var a=this;if(this.prePopulatedDate){var b=this.prePopulatedDate,d=b.startTime,e=b.staffMember,f=new c(+d,this.currentTimezoneString(),e);this.$timeout(function(){a.$rootScope.$broadcast(a.CALENDAR_EVENTS.SLOT_SELECTED,f),a.prePopulatedDate=null})}},a.prototype.storeLastSelectionIfOverTheEditor=function(a){this.$wix.isInEditingMode()&&this.appointmentService.setSelectedTime({startTime:a})},a.prototype.restorePreviousStateIfPresent=function(){var a,b=this,c=this.appointmentService.getSelectedTime();if(c)this.prePopulatedDate=c,a=c.startTime;else{var d=this.appointmentService.getCurrentBooking();d&&(a=d.start)}a&&this.$timeout(function(){b.$rootScope.$broadcast(b.CALENDAR_EVENTS.SELECT_DATE,moment.tz(+a,b.currentTimezoneString()))},200)},a.prototype.createAvailableSlotsForDay=function(a){return this.slotsSrv.partitionSlotsIntoPartsOfDay(this.staffMemberAvailabilityInRange,a,this.currentTimezoneString())},a.prototype.getSlotsAvailability=function(a){var b=this;return this.staffMemberUpdated?(this.staffMemberUpdated=!1,this.$q.when(this.staffMemberAvailabilityInRange)):this.slotsSrv.getSlotsAvailability(a,this.currentTimezoneString(),this.selectedService).then(function(a){return b.slotsAvailabilityForRange=a,b.resolveStaffMemberAvailability(),a})},a.prototype.getAvailableSlotsDuringTimeOfDay=function(a){return this.availableSlotsForDay[a]},a.prototype.getMorningSlots=function(){return this.getAvailableSlotsDuringTimeOfDay(this.TimeOfDay.MORNING)},a.prototype.getAfternoonSlots=function(){return this.getAvailableSlotsDuringTimeOfDay(this.TimeOfDay.AFTERNOON)},a.prototype.getEveningSlots=function(){return this.getAvailableSlotsDuringTimeOfDay(this.TimeOfDay.EVENING)},a.prototype.isDaySelected=function(){return!!this.selectedDate},a.prototype.getSlotRange=function(){var a=this.slot.getTime();return{start:a,end:a.clone().add(this.selectedService.duration,"minutes")}},a.prototype.goToNextPage=function(){this.storeSlotData(),this.wixBiLogger.log(this.wixBiLogger.events.NEXT,{referal_info:"date&time"}),this.flowManagerSrv.next()},a.prototype.storeSlotData=function(){var a=this.getSlotDataToStore();this.appointmentService.setSelectedTime(a)},a.prototype.getSlotDataToStore=function(){var a=this.getSlotRange(),b={startTime:a.start.format("x"),endTime:a.end.format("x"),timeZone:this.currentTimezoneString(),staffMember:this.slot.getStaff()};return b},a.prototype.currentTimezoneString=function(){return this.currentTimezone===d.BUSINESS?this.businessTimezone.name:this.userTimezone.name},a.prototype.goBack=function(){this.flowManagerSrv.prev()},a.prototype.isDayFull=function(){return!this.slotsSrv.getAvailableSlotsForTheDay(this.slotsAvailabilityForRange,this.selectedDate,this.currentTimezoneString())},a.prototype.onCalendarRendered=function(){this.firstAvailableDate&&(this.$rootScope.$broadcast(this.CALENDAR_EVENTS.GO_TO_MONTH,this.firstAvailableDate),this.firstAvailableDate=null)},a.prototype.onStaffSelected=function(a){this.currentStaffMemberId!==a&&(this.currentStaffMemberId=a,this.resolveStaffMemberAvailability(),this.staffMemberUpdated=!0,this.deselectDay(),this.expandCalendar(),this.forceAvailableDatesRefresh(),this.visitorBILogger.staffMemberSelectionChangedFromCalendar())},a.prototype.promptTimezoneSwitch=function(){return!angular.isDefined(this.$routeParams.timezone)&&!this.prePopulatedDate&&!this.cacheSrv.getFromCache(e.CACHE_KEY)},a.prototype.expandCalendar=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.EXPAND)},a.prototype.deselectDay=function(){this.selectedDate=null},a.prototype.forceAvailableDatesRefresh=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.REFRESH_EVENTS_SOURCE,this.currentTimezoneString())},a.prototype.onTimezoneSwitch=function(a){this.visitorBILogger.timezoneSwitched(a),this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR+"/"+a)},a.prototype.resolveStaffMemberAvailability=function(){this.staffMemberAvailabilityInRange=this.currentStaffMemberId?this.slotsSrv.getAvailabilityOfStaffMember(this.slotsAvailabilityForRange,this.currentStaffMemberId):this.slotsAvailabilityForRange},a.prototype.allowTimezoneSwitch=function(){return this.experimentsEnabler.isCityTimezoneEnabled()?!this.visitorTimezoneSrv.isBusinessTimezoneEqualToVisitorTimezone(this.businessTimezone,this.userTimezone):this.userTimezone.name!==this.businessTimezone.name},a}();b.CalendarPageCtrl=f,angular.module("schedulerAngularClientAppInternal").controller("CalendarPageCtrl",f).component("boostCalendarPage",{templateUrl:"modules/calendar-page/calendar-page.preload.html",controller:f,controllerAs:"clpCtrl",bindings:{businessTimezone:"=",userTimezone:"="}})}(c=b.calendar||(b.calendar={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.NEXT="DispatchedEvents.NEXT",b.APPOINTMENT_BOOKED="DispatchedEvents.APPOINTMENT_BOOKED",b.CONTACT_INFO_SAVE_SUCCESS="DispatchedEvents.CONTACT_INFO_SAVE_SUCCESS",b.CANCELLATION_POLICY="DispatchedEvents.CANCELLATION_POLICY",b.CHOOSE_TIME_SLOT="DispatchedEvents.CHOOSE_TIME_SLOT",b.BOOK_ANOTHER="DispatchedEvents.BOOK_ANOTHER",b.GOOGLE_EXPORT="DispatchedEvents.GOOGLE_EXPORT",b.BOOKIT="DispatchedEvents.BOOKIT",b.BOOKED_GROUP_BUT_NOT_PREMUIM="DispatchedEvents.BOOKED_GROUP_BUT_NOT_PREMUIM",b.CAL_TODAY="DispatchedEvents.CAL_TODAY",b.SERVICE_TYPE_WELCOME_PAGE="DispatchedEvents.SERVICE_TYPE_WELCOME_PAGE",b.SWITCH_SERVICE_TYPE="DispatchedEvents.SWITCH_SERVICE_TYPE",b.CAL_MOVE="DispatchedEvents.CAL_MOVE",b.SERVICES_PAGE_OPENED="DispatchedEvents.SERVICES_PAGE_OPENED",b.CHOOSE_STAFF_MEMBER_POPUP_OPENED="DispatchedEvents.CHOOSE_STAFF_MEMBER_POPUP_OPENED",b.CHOOSE_STAFF_MEMBER="DispatchedEvents.CHOOSE_STAFF_MEMBER",b.CHANGE_STAFF_MEMBER_SELECTION="DispatchedEvents.CHANGE_STAFF_MEMBER_SELECTION",b.LOG_TIMEZONE="DispatchedEvents.LOG_TIMEZONE",b.PARTICIPANTS_AMOUNT_CHANGE="DispatchedEvents.PARTICIPANTS_AMOUNT_CHANGE",b.POPUP_CLOSED="DispatchedEvents.CLOSE_POPUP",b.TIMEZONE_POPUP_OPENED="DispatchedEvents.TIMEZONE_POPUP_OPENED",b.TIMEZONE_SWITCH="DispatchedEvents.TIMEZONE_SWITCH",b.DEEP_LINK_CALENDAR_OPEN="DispatchedEvents.DEEP_LINK_CALENDAR_OPEN",b.LOGIN_CLICKED="DispatchedEvents.LOGIN_CLICKED",b.LOGIN_COMPLETE="DispatchedEvents.LOGIN_COMPLETE",b.POST_LOGIN_COMPLETE="DispatchedEvents.POST_LOGIN_COMPLETE",b.GO_TO_ACCOUNT_MANAGEMENT="DispatchedEvents.GO_TO_ACCOUNT_MANAGEMENT",b.BOOKING_RESCHEDULE="DispatchedEvents.BOOKING_RESCHEDULE",b.BOOKING_RESCHEDULE_SUCCESS="DispatchedEvents.BOOKING_RESCHEDULE_SUCCESS",b.BOOKING_CANCEL="DispatchedEvents.BOOKING_CANCEL",b.ACCOUNT_MANAGEMENT_SECTION_SELECTION="DispatchedEvents.ACCOUNT_MANAGEMENT_SECTION_SELECTION",b.ACCOUNT_MANAGEMENT_SEE_SERVICES="DispatchedEvents.ACCOUNT_MANAGEMENT_SEE_SERVICES",b.USER_INFO_SAVED="DispatchedEvents.USER_INFO_SAVED",b.USER_INFO_EDIT_CLICKED="DispatchedEvents.USER_INFO_EDIT_CLICKED",b.SIGNOUT_CLICKED="DispatchedEvents.SIGNOUT_CLICKED",a.DispatchedEvents=b;var c=function(){function a(){this.BOOKIT={evid:501},this.MORE={evid:502},this.CAL_MOVE={evid:504},this.CAL_TODAY={evid:505},this.CHOOSE_TIME_SLOT={evid:506},this.CHANGE={evid:508},this.NEXT={evid:509},this.BACK={evid:510},this.SYS_MSG_CLOSE={evid:511},this.BOOK_ANOTHER={evid:512},this.GOOGLE_EXPORT={evid:513},this.SERVICES_PAGE_OPENED={evid:515},this.CONTACT_INFO_SAVE_SUCCESS={evid:517},this.CANCELLATION_POLICY={evid:521},this.SERVICE_TYPE_WELCOME_PAGE={evid:522},this.SWITCH_SERVICE_TYPE={evid:523},this.APPOINTMENT_BOOKED={evid:526},this.BOOKED_GROUP_BUT_NOT_PREMUIM={evid:527},this.ERROR={evid:524},this.CHANGE_STAFF_MEMBER_SELECTION={evid:529},this.CHOOSE_STAFF_MEMBER={evid:530},this.CHOOSE_STAFF_MEMBER_POPUP_OPENED={evid:531},this.LOG_TIMEZONE={evid:532},this.PARTICIPANTS_AMOUNT_CHANGE={evid:533},this.TIMEZONE_SWITCH={evid:538},this.TIMEZONE_POPUP_OPENED={evid:539},this.DEEP_LINK_CALENDAR_OPEN={evid:541},this.LOGIN_CLICKED={evid:542},this.LOGIN_COMPLETE={evid:543},this.POST_LOGIN_COMPLETE={evid:557},this.GO_TO_ACCOUNT_MANAGEMENT={evid:544},this.BOOKING_RESCHEDULE={evid:546},this.BOOKING_RESCHEDULE_SUCCESS={evid:551},this.BOOKING_CANCEL={evid:547},this.ACCOUNT_MANAGEMENT_SECTION_SELECTION={evid:548},this.ACCOUNT_MANAGEMENT_SEE_SERVICES={evid:549},this.USER_INFO_SAVED={evid:550},this.USER_INFO_EDIT_CLICKED={evid:553},this.SIGNOUT_CLICKED={evid:552}}return a}();a.AppEventMap=c;var d=function(){function a(){this.SETTINGS_OPENED={evid:160},this.SETTINGS_GET_STARTED={evid:142},this.SHOW_HIDE={evid:110},this.APP_SET_SCREENS_DROP_DOWN={evid:111},this.APP_SET_TAB_MENU_CLICK={evid:112},this.APP_SET_LAYOUT_SELECTION={evid:113},this.APP_SET_CATEGORY_MENU_SELECTION={evid:125},this.APP_SET_IMAGE_SELECTION={evid:126},this.APP_SET_ALIGNMENT_SELECTION={evid:127},this.UPGRADE_CLICKED={evid:156},this.APP_SET_PATE_TITLE_SHOW={evid:143},this.SETTINGS_ADD_SERVICE={evid:165},this.SETTINGS_TEXT_CHANGED={evid:166},this.SETTINGS_STYLE_CHANGED={evid:167},this.SETTINGS_LAYOUT_TAB_POSITION_CHANGED={evid:168},this.SETTINGS_CLICK_ADD_WIDGET={evid:207},this.SETTINGS_MEMBER_LOGIN_TOGGLED={evid:229},this.SETTINGS_MEMBER_LOGIN_CLICKED={evid:230}}return a}();a.SettingsEventMap=d,angular.module("schedulerAngularClientAppConstants").constant("appEventMap",new c).constant("settingsEventMap",new d)}(b=a.bi||(a.bi={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function b(a){this.$rootScope=a}return b.$inject=["$rootScope"],b.prototype.todayClick=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CAL_TODAY)},b.prototype.bookIt=function(b){void 0===b&&(b=!1),this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKIT,{bookAnotherLogged:b})},b.prototype.bookedGroupButNotPremium=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKED_GROUP_BUT_NOT_PREMUIM)},b.prototype.googleCalendar=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.GOOGLE_EXPORT)},b.prototype.bookAnother=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOK_ANOTHER)},b.prototype.selectSlot=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_TIME_SLOT)},b.prototype.cancellationPolicy=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CANCELLATION_POLICY)},b.prototype.appointmentCreated=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.APPOINTMENT_BOOKED,b)},b.prototype.saveSuccessContactInfo=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CONTACT_INFO_SAVE_SUCCESS,{dynamicForm:b})},b.prototype.sendNext=function(b,c){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.NEXT,{referralInfo:b,dynamicForm:c})},b.prototype.selectServiceType=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SERVICE_TYPE_WELCOME_PAGE,b)},b.prototype.switchServiceType=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SWITCH_SERVICE_TYPE,b)},b.prototype.monthChangeClick=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CAL_MOVE)},b.prototype.servicesPageOpened=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SERVICES_PAGE_OPENED,b)},b.prototype.staffMemberPopupOpenedFromTimeSlot=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER_POPUP_OPENED)},b.prototype.staffMemberSelectedFromTimeSlot=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER)},b.prototype.staffMemberSelectionChangedFromCalendar=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.CHANGE_STAFF_MEMBER_SELECTION)},b.prototype.logTimezone=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOG_TIMEZONE)},b.prototype.logParticipantsAmountChanged=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.PARTICIPANTS_AMOUNT_CHANGE,b)},b.prototype.logPopupClosed=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.POPUP_CLOSED,b)},b.prototype.timezoneSwitched=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_SWITCH,b)},b.prototype.logPopupOpened=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_POPUP_OPENED)},b.prototype.logDeepLinkCalendarOpened=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.DEEP_LINK_CALENDAR_OPEN,b)},b.prototype.logLoginClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOGIN_CLICKED)},b.prototype.logLoginComplete=function(b){var c=b.success,d=void 0===c?!1:c,e=b.visitorIdAnon;this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.LOGIN_COMPLETE,{success:d,visitorIdAnon:e})},b.prototype.logPostLoginComplete=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.POST_LOGIN_COMPLETE,b)},b.prototype.logGoToAccountManagement=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.GO_TO_ACCOUNT_MANAGEMENT)},b.prototype.logBookingReschedule=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKING_RESCHEDULE,b)},b.prototype.logBookingRescheduleSuccess=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKING_RESCHEDULE_SUCCESS,b)},b.prototype.logBookingCancelClick=function(a){this.logBookingCancel(a,!1)},b.prototype.logBookingCancelConfirm=function(a){this.logBookingCancel(a,!0)},b.prototype.logAccountManagementSectionSelected=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.ACCOUNT_MANAGEMENT_SECTION_SELECTION,{selection:b})},b.prototype.logAccountManagementHeaderBack=function(b){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.ACCOUNT_MANAGEMENT_SEE_SERVICES,{referralInfo:b})},b.prototype.logUserInfoSaved=function(b,c){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.USER_INFO_SAVED,{newUserInfo:b,currentUserInfo:c})},b.prototype.logSignoutClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.SIGNOUT_CLICKED)},b.prototype.logEditUserInfoClicked=function(){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.USER_INFO_EDIT_CLICKED)},b.prototype.logBookingCancel=function(b,c){this.$rootScope.$emit(a.boost.visitor.bi.DispatchedEvents.BOOKING_CANCEL,{booking:b,confirmation:c})},b}();b.VisitorBILogger=c,angular.module("schedulerAngularClientAppInternal").service("visitorBILogger",c)}(c=b.bi||(b.bi={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),function(){angular.module("schedulerAngularClientAppConstants").constant("apiConst",{SCHEDULER_URL_PREFIX:"_api/scheduler-server"})}();var StorageConst=function(){function a(){}return a}();StorageConst.DEEP_LINK="deepLink",StorageConst.SERVICE_TYPE="serviceType",StorageConst.SERVICE_ID="serviceId",angular.module("schedulerAngularClientAppConstants").constant("storageConst",StorageConst);var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=a.call(this,r,q,n,h,s)||this;v.$route=b,v.routeManager=c,v.flowManagerSrv=d,v.clientPages=e,v.businessInfoSrv=f,v.overEditor=g,v.visitorBILogger=i,v.$scope=j,v.TILE_LIST_EVENTS=k,v.wixBiLogger=l,v.TILE_IMAGE_SHAPE=m,v.ServiceTypes=o,v.experimentsEnabler=p,v.appSettings=s,v.IS_ONBOARDING=t,v.$filter=u,v.updateServicesPerCategory=function(a){v.updateCategoryId(a),v.services=v.updatePerCategory(a,v.serviceList.services)};var w=v;return v.groupsList=b.current.locals.groupList,v.serviceList=b.current.locals.serviceList,v.services=v.serviceList.services,h.updateModel(v.serviceList),v.categories=v.serviceList.categories,v.serviceImageType=s.getServiceTileImageType(v.categories.length),v.categoriesType=s.getIndividualCategoryLayout(v.categories.length),v.isNoServicesOverEditor=!1,v.showGroupsButton=v.showGroupServiceButton(),v.isOverEditor=g.isOverEditor,v.isNoServicesOverEditor=v.serviceList.dummy,f.gettingBusinessInfo(),j.$on(k.TILE_SELECTED,function(a,b){w.next(b,"next")}),j.$on(k.TILE_SHOW_DETAILS,function(a,b){w.next(b,"showMoreDetails")}),v}return __extends(b,a),b.$inject=["$route","routeManager","flowManagerSrv","clientPages","businessInfoSrv","overEditor","commonServices","visitorBILogger","$scope","TILE_LIST_EVENTS","wixBiLogger","TILE_IMAGE_SHAPE","SERVICE_CATEGORY_LAYOUT","ServiceTypes","experimentsEnabler","servicesSrv","groupsSrv","appSettings","IS_ONBOARDING","$filter"],b.prototype.isShowInstruction=function(){return this.overEditor.isEditModeAndNotVisitedOwner()&&this.IS_ONBOARDING},b.prototype.getServiceTypeId=function(){return this.ServiceTypes.INDIVIDUAL},b.prototype.next=function(a,b){this.flowManagerSrv.initiateIndividual(a),this.goToNextPage(b),this.logServiceSelection()},b.prototype.goToNextPage=function(a){this.flowManagerSrv.doNavigation(a)},b.prototype.logServiceSelection=function(){this.visitorBILogger.bookIt()},b.prototype.isImagesShown=function(){return this.serviceImageType!==this.TILE_IMAGE_SHAPE.NONE},b.prototype.isPageTitleShown=function(){return!!this.$filter("wixSdkTranslate")("service-list-page-title","textPageTitle")},b.prototype.updateCategoryId=function(a){this.selectedCategory=a},b.prototype.goToGroups=function(){this.visitorBILogger.switchServiceType(this.ServiceTypes.GROUP),this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS)},b.prototype.showGroupServiceButton=function(){return this.hasGroupsServices()?!0:this.hasIndividualServices()||this.hasGroupsServices()?void 0:!0},b}(BaseServicesCtrl);a.ServicesCtrl=b,angular.module("schedulerAngularClientAppInternal").controller("ServicesCtrl",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.visitor.offerings.OfferingTypes,d=function(){function a(a,b,c,d,e,f,g){this.visitorApi=a,this.serviceConst=b,this.overEditor=c,this.boostInjectionPersister=d,this.$q=e,this.visitorStaffSrv=f,this.commonServices=g}return a.$inject=["visitorApi","serviceConst","overEditor","boostInjectionPersister","$q","visitorStaffSrv","commonServices"],a.prototype.gettingServices=function(){var a=this;return this.$q.all([this.gettingRealServices(),this.visitorStaffSrv.gettingStaffMembers()]).then(function(b){var c=b[0],d=b[1];return a.hasServices(c)?(a.commonServices.populateServicesStaffMembers(c.services,d),c):a.overEditor.enrichServiceListIfOverEditor(c)}).then(function(a){var b=a.services.map(function(a){return __assign({},a,{type:c.INDIVIDUAL})});return __assign({},a,{services:b})})},a.prototype.hasRealServices=function(a){return this.hasServices(a)&&!a.services[0].dummy},a.prototype.hasServices=function(a){return a&&a.services&&a.services.length>0},a.prototype.gettingRealServices=function(){var a=this.boostInjectionPersister.getServicesList();return a?this.$q.when(a):this.visitorApi.gettingServices()},a.prototype.requireAddress=function(a){return a&&this.serviceConst.LOCATIONS_WITH_ADDRESS.indexOf(a.location)>-1},a.prototype.isDummyService=function(a){return this.overEditor.isOverEditor&&(!a||!a.id||a.dummy)},a}();b.ServicesSrv=d,angular.module("schedulerAngularClientAppInternal").service("servicesSrv",d)}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e){this.visitorApi=a,this.cacheSrv=b,this.$q=c,this.overEditor=d,this.boostInjectionPersister=e}return a.$inject=["visitorApi","cacheSrv","$q","overEditor","boostInjectionPersister"],a.prototype.setBusinessInfo=function(a){return this.cacheSrv.setToCache("businessInfo",a)},a.prototype.getBusinessInfo=function(){var a=this.cacheSrv.getFromCache("businessInfo");return this.overEditor.enrichBusinessInfoIfOverEditor(a),a},a.prototype.gettingBusinessInfo=function(){var a=this,b=this.$q.defer(),c=this.getBusinessInfo();return c?b.resolve(c):this.gettingNewBusinessInfo().then(function(c){return a.setBusinessInfo(c),b.resolve(a.overEditor.enrichBusinessInfoIfOverEditor(c))}),b.promise},a.prototype.gettingNewBusinessInfo=function(){var a=this.boostInjectionPersister.getBusinessInfo();return a?this.$q.when(a):this.visitorApi.gettingBusinessInfo()},a}();a.BusinessInfoSrv=b,angular.module("schedulerAngularClientAppInternal").service("businessInfoSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h};!function(){function a(a,b,c){function d(){return b.SCHEDULER_URL_PREFIX}var e=this;this.gettingBusinessInfo=c.httpWrapper(function(){return a.get(d()+"/visitor/business/")}),this.gettingServices=c.httpWrapper(function(){return a.get(d()+"/visitor/services/")}),this.gettingCalendarInfo=c.httpWrapper(function(b){var c=b.start.getTime(),e=b.end.getTime();return a.get(d()+"/visitor/appointments/"+c+"/"+e)}),this.creatingAppointment=c.httpWrapper(function(b){return a.post(d()+"/visitor/appointments/",b)}),this.registeringToGroup=c.httpWrapper(function(b){return a.post(d()+"/visitor/classes/register/",b)}),this.registerTentativeGroup=c.httpWrapper(function(b){return a.post(d()+"/visitor/bookings/group",b)}),this.registerTentativeIndividual=c.httpWrapper(function(b){return a.post(d()+"/visitor/bookings/individual",b)}),this.updatingLanguage=c.httpWrapper(function(b){return a.put(d()+"/owner/business/language",b)}),this.notifyingNonPremiumEnrollmentAttempt=c.httpWrapper(function(){return a.post(d()+"/visitor/classes/nonPremium","")}),this.getSlotsAvailability=c.httpWrapper(function(b){var c=b.range.start.format("x"),e=b.range.end.format("x"),f=b.timeZone,g=b.duration;return a.get(d()+"/visitor/slots/"+c+"/"+e+"?tz="+f+"&duration="+g)}),this.gettingGroupsInstances=c.httpWrapper(function(b){var c=b.dateRange,e=b.id,f=c.start.valueOf(),g=c.end.valueOf();return a.get(d()+"/visitor/classes/inst/"+e+"/"+f+"/"+g)}),this.gettingGroups=c.httpWrapper(function(){return a.get(d()+"/visitor/classes/proto")}),this.getFirstAvailableSlotForIndividualService=c.httpWrapper(function(b){var c=b.timezone.name,e=b.serviceId;return a.get(d()+"/visitor/slots/nextAvailable/"+e+"?tz="+c)}),this.getFirstAvailableSlotForGroupPrototype=c.httpWrapper(function(b){var c=b.groupProtoId;return a.get(d()+"/visitor/classes/inst/nextAvailable/"+c)}),this.gettingStaffMembers=c.httpWrapper(function(){return a.get(d()+"/visitor/staff/")}),this.getAvailableSlotsForIndividualService=c.httpWrapper(function(b){var c=b.range.start.format("x"),e=b.range.end.format("x"),f=b.timeZone,g=b.serviceId;return a.get(d()+"/visitor/staff/slots/"+g+"/"+c+"/"+e+"?tz="+f)}),this.isCashierConnected=function(){return __awaiter(e,void 0,void 0,function(){var b;return __generator(this,function(c){switch(c.label){case 0:return[4,a.get(d()+"/visitor/payments/status/")];case 1:return b=c.sent().data,[2,b.cashier]}})})}}a.$inject=["$http","apiConst","commonApiBase","ServiceTypes"],angular.module("schedulerAngularClientCommon").service("visitorApi",a)}();var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),VisitorTimezoneSrv=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.isBusinessTimezoneEqualToVisitorTimezone=function(a,b){return this.isTimezoneEqual(a,b)?!0:this.isStandardOffsetEqual(a,b)&&this.isCurrentOffsetEqual(a,b)?!0:!1},b.prototype.isTimezoneEqual=function(a,b){return a.name===b.name},b.prototype.isStandardOffsetEqual=function(a,b){return a.standardOffset===b.standardOffset},b.prototype.isCurrentOffsetEqual=function(a,b){return a.offset===b.offset},b}(TimezoneSrv);angular.module("schedulerAngularClientAppInternal").service("visitorTimezoneSrv",VisitorTimezoneSrv);var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j){this.$window=a,this.$q=b,this.appointmentService=c,this.servicesSrv=d,this.routeManager=e,this.visitorBILogger=f,this.$route=g,this.cacheSrv=h,this.$translate=i,this.paymentService=j,this.participantsVisibility=!1,this.init()}return a.$inject=["$window","$q","appointmentService","servicesSrv","routeManager","visitorBILogger","$route","cacheSrv","$translate","paymentService"],Object.defineProperty(a.prototype,"appointmentLocationText",{get:function(){return this.concatinateAddressString(this.address,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"appointmentLocation",{get:function(){return this.appointmentService.getAppointmentLocation(this.serviceInfo,this.appointmentTime)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dayOfMonth",{get:function(){return this.momentOfStartTime.format("D")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"month",{get:function(){return this.momentOfStartTime.format("MMM")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fullMonth",{get:function(){return this.momentOfStartTime.format("MMMM")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dayOfWeek",{get:function(){return this.momentOfStartTime.format("ddd")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fullDayOfWeek",{get:function(){return this.momentOfStartTime.format("dddd")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){return this.momentOfStartTime.format(this.$translate("visitor.time-format"))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"momentOfStartTime",{get:function(){var a=this.appointmentTime,b=a.startTime,c=a.timeZone;return this.appointmentTime?moment.tz(+b,c):moment()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"staffName",{get:function(){return this.appointmentTime&&this.appointmentTime.staffMember&&this.staff&&this.staff.staff.length>1?this.appointmentTime.staffMember.fullName:""},enumerable:!0,configurable:!0}),a.prototype.getMinCharge=function(){return this.serviceInfo.minCharge},a.prototype.getSelectedNumberOfParticipants=function(){return this.serviceInfo.numberOfParticipants||1},a.prototype.isMultipleParticipants=function(){return!1},a.prototype.getCurrency=function(){return this.serviceInfo.currency},a.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return this.businessInfo=this.$route.current.locals.businessInfo,this.addressKey=this.businessInfo.apartmentNum?"sidebar.address.line1":"sidebar.address.line1-no-apt",this.staff=this.$route.current.locals.staff,this.serviceInfo=this.appointmentService.getSelectedService(),this.appointmentTime=this.appointmentService.getSelectedTime()||this.appointmentService.getLastSelectedTime(),this.appointmentTime&&this.appointmentService.setLastSelectedTime(this.appointmentTime),this.address=this.getAppointmentLocation(this.serviceInfo),[2]})})},a.prototype.setParticipantsVisibility=function(a){this.participantsVisibility=a,this.cacheSrv.clearKey("appointmentDateTime")},a.prototype.formatDate=function(a){return moment(parseInt(a,10)).toDate().toISOString().replace(/-|:|\.\d+/g,"")},a.prototype.createGoogleCalendarUrlForAppointment=function(a){var b=this.formatDate(a.time.startTime),c=this.formatDate(a.time.endTime),d=encodeURI(["https://www.google.com/calendar/render","?action=TEMPLATE","&text="+(a.title||""),"&dates="+(b||""),"/"+(c||""),"&location="+(a.location||""),"&sprop=&sprop=name:"].join(""));return d},a.prototype.concatinateAddressString=function(a,b){void 0===b&&(b=!1);var c=[];return Object.keys(a).filter(function(a){return"city"!==a||!b&&"city"===a?!0:!1}).forEach(function(b){c.push(a[b])}),c.join(", ")},a.prototype.handleLocationTextGiven=function(a){return{text:a}},a.prototype.getBusinessAddress=function(){return{street:this.businessInfo.address,city:this.businessInfo.city,apartmentNum:this.businessInfo.apartmentNum}},a.prototype.getAppointmentLocation=function(a){var b=this.servicesSrv.requireAddress(a),c=a.locationText;
return b?this.appointmentService.getContactInfo().address:c?this.handleLocationTextGiven(c):this.getBusinessAddress()},a.prototype.redirectToGoogleCalendar=function(){this.visitorBILogger.googleCalendar();var a={title:this.serviceInfo.name,time:this.appointmentTime},b=this.getAppointmentLocation(this.serviceInfo);return a.location=this.concatinateAddressString(b),this.$window.open(this.createGoogleCalendarUrlForAppointment(a),"GoogleCalendar"),a},a.prototype.doAddAnother=function(){this.visitorBILogger.bookAnother(),this.routeManager.gotoPage(this.bookAnotherPage)},a.getTemplateUrl=function(a){return a?"modules/congratulations-page/congratulations-old.preload.html":"modules/congratulations-page/congratulations.preload.html"},a.prototype.isShowLocation=function(){return this.appointmentService.isShowBusinessAddress(this.serviceInfo,this.appointmentTime,this.businessInfo,!0)},a.prototype.getCity=function(){return"CUSTOMER"===this.serviceInfo.location?this.address.city:this.appointmentService.getBusinessCity(this.businessInfo,this.serviceInfo,this.appointmentTime)},a}();a.CongratulationsController=b,angular.module("schedulerAngularClientAppInternal").controller("CongratulationsController",b)}(b=a.pages||(a.pages={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.cache={}}return a.prototype.getFromCache=function(a){return this.cache[a]},a.prototype.setToCache=function(a,b){this.cache[a]=b},a.prototype.clearKey=function(a){this.cache[a]=void 0},a.prototype.clearCache=function(){this.cache={}},a}(),c=function(){function a(a){this.$window=a}return a.$inject=["$window"],a.prototype.isWebStorageSupported=function(){try{var a="SessionStorageCacheSrvTestKey";this.$window.sessionStorage.setItem(a,"OK");var b=this.$window.sessionStorage.getItem(a);return this.$window.sessionStorage.removeItem(a),"OK"===b}catch(c){return!1}},a.prototype.getFromCache=function(a){return this.$window.sessionStorage.getItem(a)},a.prototype.setToCache=function(a,b){this.$window.sessionStorage.setItem(a,b)},a.prototype.clearKey=function(a){this.$window.sessionStorage.removeItem(a)},a.prototype.clearCache=function(){this.$window.sessionStorage.clear()},a}(),d=function(){function a(a,b,c){this.$wix=a,this.stringsCache=b.isWebStorageSupported()?b:c}return a.$inject=["$wix","sessionStorageCacheSrv","inMemoryCacheSrv"],a.prototype.getCacheKey=function(a){return a+"_"+this.$wix.getBusinessId()},a.prototype.getFromCache=function(a){var b=this.stringsCache.getFromCache(this.getCacheKey(a));return angular.fromJson(b)},a.prototype.setToCache=function(a,b){this.stringsCache.setToCache(this.getCacheKey(a),angular.toJson(b))},a.prototype.clearKey=function(a){this.stringsCache.clearKey(this.getCacheKey(a))},a.prototype.clearCache=function(){this.stringsCache.clearCache()},a}();a.CacheSrv=d,angular.module("schedulerAngularClientAppInternal").service("cacheSrv",d).service("inMemoryCacheSrv",b).service("sessionStorageCacheSrv",c)}(b=a.utils||(a.utils={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),function(a){var b,c,d=a.fullCalendar;if(d){b=d.Grid.prototype.headCellHtml,c=d.Grid.prototype.bindHandlers,a.extend(d.Grid.prototype,{headCellHtml:function(c){var d=this.view,e=c.start,f=d.calendar.getNow().stripTime(),g=e.isSame(f,"day")?"fc-today":"",h=b.call(this,c);return g?(h=a(h),a(h).addClass(g),h[0].outerHTML):h},bindHandlers:function(){function b(b){var c=a(b);return c.hasClass("fc-highlight")||c.hasClass("fc-hovered-over")}var d=this,e=this.view.opt("hoverEffect"),f=this.view.opt("defaultEventMinutes");a(".fc-view-container").mouseleave(function(){d.destroyHover()}),a(".fc-slats tr").mouseenter(function(c){var g=a(c.target);if(a(".fc-hover-skeleton").length&&d.destroyHover(),e&&!b(c.target)){d.coordMap.build();var h=d.coordMap.getCell(c.pageX,c.pageY);if(null!==h&&void 0!==h.day){var i={};i.col=void 0,i.row=h.row,i.start=h.start.clone(),i.day=h.day.clone(),i.grid=h.grid,i.end=h.start.add(f,"m");var j=d.computeSelection(h,i);null!==j&&(g.addClass("fc-hovered-over"),d.renderHover(j))}}}),c.call(this)},hoverSegClasses:function(){return["fc-hover"]},renderHover:function(a){this.renderFill("hover",this.rangeToSegs(a))},destroyHover:function(){this.destroyFill("hover"),a(".fc-widget-content").removeClass("fc-hovered-over")}});var e=a.fullCalendar.views.agenda.prototype.initialize;a.extend(a.fullCalendar.views.agenda.prototype,{initialize:function(){e.call(this),this.timeGrid.renderSelection=function(a){var b=this.view.opt("defaultEventMinutes"),c={};c.end=a.start.clone().add(b,"m"),c.start=c.end.clone();var d=this.computeSelection(a,c);null!==d&&(a.end=c.end,this.renderHighlight(a))}}})}}(jQuery);var scheduler;!function(a){var b;!function(a){function b(a){function b(b,c,d){var e=a.getTextForModel(c+"_Checkbox");return"false"===e?"":d?a.getTextForModel(c,"")||a.getTextForModel(d,b):a.getTextForModel(c,b)}return b.$stateful=!0,b}b.$inject=["wixSdkUtil"],a.wixSdkTranslate=b,angular.module("wixSdkUtilInternal").filter("wixSdkTranslate",b)}(b=a.filter||(a.filter={}))}(scheduler||(scheduler={})),function(){function a(a){return{restrict:"A",link:function(b,c){function d(a){c.css({top:a})}function e(){a.addEventListener(a.Events.SCROLL,g),b.$on("$destroy",function(){a.removeEventListener(a.Events.SCROLL,g)})}function f(a){var b=a.rect.top,d=c.outerHeight();return 0>b?Math.min(-b,a.rect.height-d-c.parent().offset().top):0}function g(){a.getBoundingRectAndOffsets(function(a){d(f(a))})}function h(){c.css({position:"absolute"}).addClass("sticky"),c.parent().css({position:"relative"}).addClass("sticky__container"),d(0)}h(),e()}}}a.$inject=["$wix"],angular.module("schedulerAngularClientAppInternal").directive("bksViewerSticky",a)}();var StaffMemberDtoBuilder=wix.bookings.visitor.staff.StaffMemberDtoBuilder,OfferingCategoryDtoBuilder=wix.bookings.visitor.offerings.OfferingCategoryDtoBuilder,IndividualOfferingDtoBuilder=wix.bookings.visitor.offerings.IndividualOfferingDtoBuilder;!function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){return new Array(3).fill(null).map(function(a,c){return(new OfferingCategoryDtoBuilder).withCategoryId("cat_id_"+(c+1)).withOrder(c).withName(b("category-name-editor-"+(c+1))).build()})}var p=this,q=this;q.REDIRECT_TO_PAGE_WHEN_NAVIGATING_AWAY="default-page";try{this.isOverEditor=a.isOverEditor()}catch(r){this.isOverEditor=!1}try{this.isInEditingMode=a.isInEditingMode()}catch(r){this.isInEditingMode=!1}try{this.isDemoMode=a.Utils.getDemoMode()}catch(r){this.isDemoMode=!1}this.isDemoFlow=this.isDemoMode||this.isOverEditor;var s=new Array(3).fill(null).map(function(a,c){return(new StaffMemberDtoBuilder).withId("dummy-staff-"+(c+1)).withName(b("over-editor.staff-name-"+(c+1))).build()});this.enrichStaffIfOverEditor=function(a){this.isOverEditor&&!a.staff.length&&(a.staff=s)},this.enrichServiceIfOverEditor=function(a){return this.isOverEditor&&!a?{name:b("service-name-editor-selected"),duration:parseInt(b("service-duration-editor"),10),price:parseInt(b("service-price-editor"),10),currency:b("service-currency-editor"),description:b("service-description-editor"),capacity:5,dummy:!0,type:l.GROUP,location:"CUSTOMER",maxParticipantsPerOrder:1,urlName:"offering-id-0",tagLine:b("service-tagline-editor"),images:j.imagesList[0].images}:a},this.enrichGroupListIfOverEditor=function(a){if(this.isOverEditor){for(var c=3,d=[],e=0;c>e;e++)d.push({id:e,capacity:5,name:b("group-name-editor"),duration:+b("group-duration-editor"),currency:b("group-currency-editor"),categoryId:"cat_id_"+(Math.floor(e/3)+1),price:+b("group-price-editor"),description:b("group-description-editor"),urlName:"group-offering-id-"+e,classHours:{mon:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:"Shera"}]},tue:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:null}]},wed:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:null}]},thu:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:null}]},fri:{workingHours:[{workingHour:{startTime:"09:00:00.000",endTime:"11:03:00.000"},teacher:null}]},sat:null,sun:null},dummy:!0,showFullText:!1,images:k.imagesList[e].images});return{classes:d,categories:[]}}return a},this.enrichBusinessInfoIfOverEditor=function(a){if(this.isOverEditor){var c=a;return c&&!c.name&&(c.name=b("over-editor.mock-business-name"),c.address=b("over-editor.mock-business-address"),c.phone=c.phone||b("over-editor.mock-contact.phone"),c.email=c.email||b("over-editor.mock-contact.email")),c}return a},this.enrichSelectedTimeIfOverEditor=function(a){var b=a;if(this.isOverEditor){if(!b){var c=e.moment().hour(12).minutes(0).seconds(0),d=e.moment().hour(12).minutes(45).seconds(0);b={startTime:c.format("x"),endTime:d.format("x")}}b.groupInstance||(b.groupInstance={dummy:!0,id:"id_0"})}return b},this.enrichContactIfOverEditor=function(a){return this.isOverEditor&&!a?{name:b("over-editor.mock-contact.name"),email:b("over-editor.mock-contact.email"),phone:b("over-editor.mock-contact.phone"),address:{addressLine:b("over-editor.mock-contact.address"),aptOrFloor:b("over-editor.mock-contact.apt"),city:b("over-editor.mock-contact.city")}}:a},this.enrichServiceListIfOverEditor=function(a){var c=9,d=[];if(this.isOverEditor){for(var e=o(),f=0;c>f;f++)d.push({id:f,name:b("service-name-editor-"+(f%3+1)),duration:+b("service-duration-editor"),currency:b("service-currency-editor"),price:+b("service-price-editor"),description:b("service-description-editor"),urlName:"individual-offering-id-"+f,dummy:!0,categoryId:e[Math.floor(f/e.length)].id,showFullText:!1,images:j.imagesList[f].images});return{services:d,categories:e,dummy:!0}}return a},this.getClassesInstancesIfOverEditor=function(a,c){var d=[];if(this.isOverEditor){var e=c.staff.length?c.staff:s;0===e.length&&e.push({});for(var f=a.start,g=0;25>g;g++){var h=g%5+g%2;h=5===h?1:h;for(var i=0;i<e.length;i++){var j={id:"id_"+g,capacity:5,classProtoId:g,registered:g%7,teacher:b("group-teacher-editor"),staffMemberId:e[i].id,start:f.clone().startOf("isoWeek").add(h,"day").hour(g%12+6).valueOf(),end:f.clone().startOf("isoWeek").add(h,"day").hour(g%12+7).valueOf(),dummy:!0};d.push(j)}}}return{classesInstances:d}},this.getFirstAvailableSlotForService=function(){return e.moment()},this.enrichOfferingListIfOverEditor=function(a){if(!p.isOverEditor||a&&0!==a.offerings.length)return a;var c=9,d=o(),e=new Array(c).fill(null).map(function(a,c){return(new IndividualOfferingDtoBuilder).withId(c).withName(b("service-name-editor-"+(c%3+1))).withDescription(b("service-description-editor")).withDuration(+b("service-duration-editor")).withUrlName("individual-offering-id-"+c).withDummyIndication().withCategoryId(d[Math.floor(c/d.length)].id).withPrice({price:+b("service-price-editor"),currency:b("service-currency-editor")}).withImages(j.imagesList[c].images).build()});return{dummy:!0,offerings:e,categories:d}},this.getSlotsAvailability=function(a,b,c,d){for(var f={},g=e.moment.tz(a.start,b).startOf("month"),h=g.clone(),i=c.staff.length?c.staff:s,j=0;d>j;j++){var k=f[g.format("x")]=[],l=[];if(0===j%3){for(var m=0;m<i.length;m++)k.push({staffId:i[m].id,slots:l});for(var n=0;40>n;n++)h.add(30,"minutes"),l.push(h.valueOf());h.startOf("day")}g.add(1,"days"),h=g.clone()}return f},this.isEditModeAndNotVisitedOwner=function(){return!m.isVisitedOwner()&&this.isInEditingMode},this.isOverEditor&&(a.addEventListener(a.Events.EDIT_MODE_CHANGE,function(a){"preview"===a.editMode&&f.location.reload()}),a.addEventListener(a.Events.SETTINGS_UPDATED,function(a){i(function(){var b=d.getTextForModel("previewPage");a===g.PREVIEW_UPDATE?n.path().endsWith(b)||c.gotoPage(b):a===g.OWNER_OVER_EDITOR_CHANGE?(h.clearCache(),c.gotoPage(b),f.location.reload()):(a===g.LANGUAGE_CHANGE||a===g.LAYOUT_CHANGE)&&(c.gotoPage(b),f.location.reload())},150)}))}a.$inject=["$wix","$translate","routeManager","wixSdkUtil","libs","$window","eventsConst","cacheSrv","$timeout","SERVICE_EDITOR_DEFAULTS","GROUP_EDITOR_DEFAULTS","ServiceTypes","entryPointsIndicator","$location"],angular.module("schedulerAngularClientAppInternal").service("overEditor",a)}();var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.$wix=a,this.deviceType=a.Utils.getDeviceType(),this.isMobile="mobile"===this.deviceType.toLowerCase()}return a.$inject=["$wix"],a.prototype.getIsMobile=function(){return this.isMobile},a}();a.AppConfig=b,angular.module("schedulerAngularClientAppInternal").service("appConfig",b)}(b=a.services||(a.services={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.appSettings=a,this.SERVICE_CATEGORY_LAYOUT=b,this.columnsAmountToClass={1:"service--single",2:"service--even",3:"service--odd"}}return a.prototype.mapColumnsAmountToClass=function(){return this.columnsAmountToClass[this.columnsAmount]},a.prototype.getTileSize=function(){return this.getCategoryPlacement()===this.SERVICE_CATEGORY_LAYOUT.VERTICAL&&1===this.columnsAmount||this.columnsAmount>2?"small":"large"},a.prototype.getCategoryPlacement=function(){},a}();a.ServicesList=b}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c){var d=a.call(this,b,c)||this;return d.tileTemplate=b.getServiceListTemplate(),d.tileConfig=b.getServiceTileConfig(),d.columnsAmount=b.getNumberOfColumns(d.tileTemplate,b.getCategoryLayoutType(d.individualCategories)),d.serviceItemClass=d.mapColumnsAmountToClass(),d}return __extends(b,a),b.$inject=["appSettings","SERVICE_CATEGORY_LAYOUT"],b.prototype.getCategoryPlacement=function(){return this.appSettings.getCategoryLayoutType(this.individualCategories)},b}(a.ServicesList);angular.module("schedulerAngularClientAppInternal").component("boostIndividualServicesList",{controller:b,templateUrl:"modules/visitor/services/services-list.preload.html",bindings:{services:"=",individualCategories:"=",category:"="}})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(){this.categories&&this.categories[0]&&this.categoryChanged(this.categories[0].id)}return a.prototype.categoryChanged=function(a){this.selectedCategoryId=a,this.callbackFunc(a)},a.prototype.isCategorySelected=function(a){return this.selectedCategoryId===a},a.prototype.accessibilityFocusCategoryIndex=function(a){return this.isCategorySelected(a)?0:-1},a}();!function(){function b(){return{scope:{callbackFunc:"=onChangeCategoryCallback",categories:"=",type:"@"},templateUrl:"modules/visitor/services/services-categories-list.preload.html",restrict:"E",controller:"CategoryListController",controllerAs:"$ctrl",bindToController:!0}}angular.module("schedulerAngularClientAppInternal").controller("CategoryListController",a).directive("boostCategoryList",b)}()}(b=a.components||(a.components={}))}(b=a.common||(a.common={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(){angular.module("schedulerAngularClientAppInternal").directive("boostServiceTile",["experimentsEnabler","$timeout",function(a,b){return{scope:{service:"=",size:"@",template:"@",serviceDays:"=",fullServiceDays:"=",tileConfig:"=config",buttonText:"@",customClass:"@"},controller:"serviceTileController",controllerAs:"stCtrl",template:"<ng-include style=\"width:100%\" src=\"'modules/service-tile/'+stCtrl.template+'/service-'+stCtrl.template+'.preload.html'\"/>",bindToController:!0,transclude:!0,restrict:"EA",link:function(c,d){if(a.isVisitorAccessibilityEnabled()){var e=d;b(function(){var a=e.find(".mCustomScrollBox");a.on("focus",function(){a.mouseover(),a.addClass("focus")}),a.on("focusout",function(){a.mouseleave(),a.removeClass("focus")})},100)}}}}])}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b,e)||this;return h.$scope=c,h.TILE_LIST_EVENTS=d,h.wixBiLogger=f,h.experimentsEnabler=g,h.showDescriptionContainer=!1,h}return __extends(b,a),b.$inject=["TILE_IMAGE_SHAPE","$scope","TILE_LIST_EVENTS","commonServices","wixBiLogger","experimentsEnabler"],b.prototype.getImageUrl=function(){return a.prototype.getImageUrl.call(this,this.service.images,this.tileConfig.imageSize)},b.prototype.onShowDetails=function(a){this.experimentsEnabler.isServicePageEnabled()&&(a&&a.stopImmediatePropagation(),this.$scope.$emit(this.TILE_LIST_EVENTS.TILE_SHOW_DETAILS,this.service))},b.prototype.selectTile=function(a){a&&a.stopImmediatePropagation(),this.$scope.$emit(this.TILE_LIST_EVENTS.TILE_SELECTED,this.service)},b.prototype.logShowMore=function(){this.wixBiLogger.log(this.wixBiLogger.events.MORE,{service_id:this.service.id})},b.prototype.toggleDescription=function(){this.service.description&&(this.showDescriptionContainer=!this.showDescriptionContainer)},b.prototype.applyChanges=function(){return this.$scope.$apply()},b.prototype.mouseover=function(){this.service.description&&(this.service.showFullText=!0)},b.prototype.mouseleave=function(){this.service.description&&(this.service.showFullText=!1)},b}(a.BaseTileController);a.ServiceTileController=b,angular.module("schedulerAngularClientAppInternal").controller("serviceTileController",b)}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.common.domain.BusinessInfo,d=a.bookings.visitor.offerings.OfferingTypes,e=function(){function a(a){this.provider=a}return a.$inject=["provider"],a.prototype.getServicesList=function(){return this.provider.servicesList},a.prototype.getGroupsList=function(){return this.provider.groupsList},a.prototype.getBusinessInfo=function(){return this.provider.businessInfo?new c(this.provider.businessInfo):null},a.prototype.getStaff=function(){return this.provider.staff},a.prototype.getCurrentMember=function(){return this.provider.currentMember},a.prototype.getOfferingId=function(){return this.provider.offeringId},a.prototype.getOfferingsList=function(){return this.provider.offeringsList},a.prototype.isSpecificOfferingRequested=function(){return this.provider.isSpecificOfferingRequested},a.prototype.getOfferingsCount=function(){return this.provider.getOfferingsCount()},a}();b.BoostInjectionPersister=e;var f=function(){function a(){this.offeringId=null}return a.prototype.setServicesList=function(a){this.servicesList=this.safeReadInjectedAttribute(a)},a.prototype.setGroupsList=function(a){this.groupsList=this.safeReadInjectedAttribute(a)},a.prototype.setBusinessInfo=function(a){this.businessInfo=this.safeReadInjectedAttribute(a)},a.prototype.setStaff=function(a){this.staff=this.safeReadInjectedAttribute(a)},a.prototype.setCurrentMember=function(a){this.currentMember=this.safeReadInjectedAttribute(a,{})},a.prototype.setOfferingId=function(a){this.offeringId=this.safeReadInjectedAttribute(a)},a.prototype.setOfferingsList=function(a){this.offeringsList=this.safeReadInjectedAttribute(a)},a.prototype.setSpecificOfferingRequested=function(a){this.isSpecificOfferingRequested=this.safeReadInjectedAttribute(a)},a.prototype.getOfferingsCount=function(){var a={groups:0,individual:0};return this.offeringsList?this.offeringsList.offerings.reduce(function(a,b){switch(b.type){case d.GROUP:a.groups+=1;break;case d.INDIVIDUAL:a.individual+=1}return a},a):a},a.prototype.safeReadInjectedAttribute=function(a,b){void 0===b&&(b=null);try{return angular.fromJson(a)}catch(c){return console.warn("Missing injection from Bookings server",a),b}},a.prototype.$get=function(a){return a.instantiate(e,{provider:this})},a.prototype.$get.$inject=["$injector"],a}();b.BoostInjectionPersisterProvider=f,angular.module("schedulerAngularClientAppInternal").provider("boostInjectionPersister",f)}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=function(){function a(a){this.$modalInstance=a}return a.$inject=["$modalInstance"],a.prototype.close=function(){this.$modalInstance.close()},a}(),d=function(){function a(a,b,c,d,e){this.$modal=a,this.$wix=b,this.urlUtilSrv=c,this.$window=d,this.$translate=e}return a.$inject=["$modal","$wix","urlUtilSrv","$window","$translate"],a.prototype.openDetails=function(a){return a.animation=!0,this.$modal.open(a)},a.prototype.openGroupSelectedNotPremium=function(){return this.openDetails({templateUrl:"modules/templates/group-selected-but-not-premium.preload.html",controller:c,controllerAs:"$ctrl",windowClass:"modal--group-non-premium"})},a.prototype.openClassEnrollmentPromotion=function(){var a=this,b=this.urlUtilSrv.getUrlForEnv({urlSuffix:"classes-promo.html",localUrlSuffix:"class-enrollment-promo.html",localPort:9e3});this.$wix.openBareModal(b,564,610,function(){a.$window.location.reload()})},a.prototype.openLoginOutsideSite=function(){this.openNotificationModal(this.$translate("user-management.login-not-in-site.message"),this.$translate("user-management.login-not-in-site.confirm"))},a.prototype.openOwnerIsLoggedIn=function(){this.openNotificationModal(this.$translate("user-management.owner-logged-in.message"),this.$translate("user-management.owner-logged-in.confirm"))},a.prototype.openSuccessMessage=function(a){return this.openDetails({windowClass:"modal--success-message-modal",backdropClass:"modal--success-message-backdrop",template:'<div data-hook="success-message-modal" class="success-message-modal">\n                    <div class="success-message-modal__content">\n                        <div data-hook="success-message-modal-close" \n                             class="success-message-modal__close scheduler-svg-font-icons-close"\n                             ng-click="$ctrl.dismiss()"></div>\n                        <div data-hook="success-message-modal-icon"\n                             class="success-message-modal__icon scheduler-svg-font-icons-confirmation-v"></div>\n                        <div data-hook="success-message-modal-message"\n                             class="success-message-modal__message">'+a+"</div>\n                    </div>\n                  </div>",controller:["$scope",function(a){this.dismiss=a.$dismiss}],controllerAs:"$ctrl"})},a.prototype.openNotificationModal=function(a,b){this.openDetails({windowClass:"modal--notification-modal",template:'<bks-notification-modal dismiss="$ctrl.dismiss()"\n                                           confirm="$ctrl.dismiss()"\n                                           ok-label="{{$ctrl.okLabel}}"\n                                           >'+a+"</bks-notification-modal>",controller:["$scope",function(a){this.dismiss=a.$dismiss,this.close=a.$close,this.okLabel=b}],controllerAs:"$ctrl"})},a}();b.Modal=d,angular.module("schedulerAngularClientAppInternal").service("modal",a.boost.services.Modal)}(c=b.services||(b.services={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),angular.module("schedulerAngularClientAppInternal").directive("datepicker",["$timeout","$translate","experimentsEnabler",function(a,b,c){return{restrict:"A",link:function(d,e){d.getLeftArrow=function(){return e.find(".pull-left")},d.getRightArrow=function(){return e.find(".pull-right")},d.isLeftArrowFocus=function(){return d.getLeftArrow().is(":focus")},d.isRightArrowFocus=function(){return d.getRightArrow().is(":focus")},d.getArrows=function(){return e.find(".pull-left, .pull-right")},d.getActiveCell=function(){return e.find(".active")},d.isActiveCellFocus=function(){return d.getActiveCell().is(":focus")};var f={9:"tab",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};c.isVisitorAccessibilityEnabled()&&(a(function(){d.getLeftArrow().attr("aria-label",b("calendar.prev-aria")),d.getRightArrow().attr("aria-label",b("calendar.next-aria")),d.getArrows().on("keydown",function(a){(13===a.which||32===a.which)&&(a.preventDefault(),a.stopPropagation(),$(this).click())})},200),e.on("keydown",function(b){var c=f[b.which];c&&(b.preventDefault(),b.stopPropagation(),"tab"===c?b.shiftKey?d.isLeftArrowFocus()?d.getActiveCell().focus():d.isRightArrowFocus()?d.getLeftArrow().focus():d.getRightArrow().focus():d.isLeftArrowFocus()?d.getRightArrow().focus():d.isRightArrowFocus()?d.getActiveCell().focus():d.getLeftArrow().focus():(d.isLeftArrowFocus()||d.isRightArrowFocus())&&a(function(){d.getActiveCell().focus()},0,!1))}))}}}]);var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(b,c,d,e,f,g,h,i,j,k,l,m){var n=this;this.$scope=b,this.$rootScope=c,this.$element=d,this.CALENDAR_EVENTS=e,this.slotsSrv=f,this.$q=g,this.DateDefaults=h,this.visitorBILogger=j,this.momentSrv=k,this.$timeout=l,this.fullCalendarAccessibility=m,this.isInWeeklyMode=!1,this.eventsSource=[],this.calendarConfig={header:!1,firstDay:1,contentHeight:"auto",viewRender:function(){n.onCalendarRendered()},dayClick:function(a){a=n.momentSrv.createMomentWithSameTimeInDifferentTimeZone(a,n.timezone);var b=moment.tz(n.timezone);a.isSameOrAfter(b,"day")&&n.selectDate(a)},eventRender:function(b){n.findElementsByDate(b.start).addClass(a.AVAILABLE_DAYS_CLASS)},eventAfterAllRender:function(){n.initializeAccessibility()}},this.onSelectDate=function(a,b){n.calendarRenderedPromise.promise.then(function(){return n.goToMonth(b)}).then(function(){n.selectDate(b)}).then(function(){n.scrollToWeekOfDay(b)}).catch(function(){console.log("ERROR!")})},this.switchToWeekMode=function(){if(n.calendarAPI.switchToWeekView(),n.resetViewOffset(),n.$element.addClass(a.WEEKLY_MODE_CLASS),n.hoverDate){var b=$('[data-date="'+n.hoverDate+'"].fc-day').parents(".fc-week");n.scrollElementIntoView(b[0])}n.setWeekRange(),n.isInWeeklyMode=!0},this.goToNextMonth=function(){n.calendarAPI.goToNextMonth(),n.onMonthChanged()},this.goToToday=function(){n.visitorBILogger.todayClick(),n.calendarAPI.goToToday(),n.updateCurrentViewRange(),n.notifyMonthChanged(),n.resetViewOffset(),n.isInWeeklyMode&&(n.goToTodayInWeekMode(),n.calendarAPI.switchToWeekView())},this.goToPrevMonth=function(){n.calendarAPI.goToPrevMonth(),n.onMonthChanged()},this.switchToMonthMode=function(){n.calendarAPI.switchToMonthView(),n.resetViewOffset(),n.fullCalendarAccessibility.enableDaysInMonthViewSelection(),n.notifyMonthChanged(),n.$element.removeClass(a.WEEKLY_MODE_CLASS),n.isInWeeklyMode=!1},this.goToNextWeek=function(){n.currentWeek.start=n.currentWeek.start.clone().add(1,"week"),n.currentWeek.end=n.currentWeek.end.clone().add(1,"week"),n.isNextWeekOutOfCurrentRange()?n.goToFirstUnseenDatesOfNextMonth():n.animateRight(n.calendarSingleWeekWidth),n.notifyWeekChanged()},this.goToPrevWeek=function(){n.currentWeek.start=n.currentWeek.start.clone().subtract(1,"week"),n.currentWeek.end=n.currentWeek.end.clone().subtract(1,"week"),n.isPreviousWeekOutOfCurrentRange()?n.goToFirstUnseenDatesOfPreviousMonth():n.animateLeft(n.calendarSingleWeekWidth),n.notifyWeekChanged()},this.calendarAPI=i.create(this.$element.children().first(),this.timezone),this.calendarRenderedPromise=g.defer(),this.registerListeners()}return a.$inject=["$scope","$rootScope","$element","CALENDAR_EVENTS","slotsSrv","$q","DateDefaults","FullCalendarAdapterFactory","visitorBILogger","momentSrv","$timeout","fullCalendarAccessibility"],a.prototype.initializeAccessibility=function(){this.fullCalendarAccessibility.removeAriaAttributes(),this.fullCalendarAccessibility.hideDaysWeekHeader(),this.fullCalendarAccessibility.hideBlankAreas(),this.fullCalendarAccessibility.initializeDaysSelectionEvents()},a.prototype.goToMonth=function(a){return this.calendarAPI.goToDate(a),this.updateCurrentViewRange(),this.updateSlotsAvailability()},a.prototype.scrollToWeekOfDay=function(a){var b=this.findElementsByDate(a).parents(".fc-week");this.scrollElementIntoView(b)},a.prototype.onCalendarRendered=function(){var a=this;this.onReady();var b;this.retrieveCalendarProperties(),this.onMonthChanged(),this.notifyLowerBound(this.currentViewRange.end),this.calendarRenderedPromise.resolve(),$(document).on("mouseover",".fc-week .fc-day",function(c){var d=angular.element(c.currentTarget);d.addClass("fc-day-active"),b=d.attr("data-date"),a.hoverDate=b}),$(document).on("mouseout, mouseleave",".fc-week .fc-day",function(b){var c=angular.element(b.currentTarget);c.removeClass("fc-day-active"),a.hoverDate=null})},a.prototype.scrollElementIntoView=function(a){var b=angular.element(a);this.$calendarContent.css({right:b.position().left})},a.prototype.selectDate=function(a){this.selectedDate=a,this.notifyDateSelected(a),this.switchToWeekMode(),this.goToWeekOfSelectedDate(a),this.removePreviousSelectionAndSelect(a)},a.prototype.goToWeekOfSelectedDate=function(a){var b=a.clone().startOf("isoWeek");this.setWeekRange(b)},a.prototype.notifyDateSelected=function(a){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.DAY_SELECTED,a)},a.prototype.findElementsByDate=function(a){var b=a.format(this.DateDefaults.DATE_FORMAT);return this.$element.find('[data-date="'+b+'"]')},a.prototype.markSelectedDate=function(b){this.findElementsByDate(b).addClass(a.SELECTED_DAY_CLASS)},a.prototype.removeSelectionMark=function(){this.$element.find("."+a.SELECTED_DAY_CLASS).removeClass(a.SELECTED_DAY_CLASS)},a.prototype.retrieveCalendarProperties=function(){var a=this.$element.find(".fc-week"),b=this.$element.find(".fc-day").first();this.$calendarContent=this.$element.find(".fc-day-grid"),this.calendarSingleWeekWidth=a.width(),this.calendarSingleWeekHeight=a.height(),this.calendarSingleDayWidth=b.outerWidth()},a.prototype.updateCurrentViewRange=function(){var a=this.calendarAPI.getViewDatesRange();this.currentViewRange={start:a.start,end:a.end}},a.prototype.getAvailableSlotsForCurrentRange=function(){return this.getSlotsAvailability({range:this.currentViewRange}).then(this.slotsSrv.getDaysWithAvailableSlots).then(this.calendarAPI.convertDatesToAllDayEvents.bind(this.calendarAPI))},a.prototype.getDaysIntersectionWithPreviousUpperBound=function(){return this.previousViewRange?7*this.getNumberOfFullWeeksBetweenRanges(this.previousViewRange.end,this.currentViewRange.start):0},a.prototype.getDaysIntersectionWithPreviousLowerBound=function(){return this.previousViewRange?7*this.getNumberOfFullWeeksBetweenRanges(this.previousViewRange.start,this.currentViewRange.end):0},a.prototype.getNumberOfFullWeeksBetweenRanges=function(a,b){var c=a.clone().startOf("day").diff(b,"days");return Math.abs(Math.ceil(c/7))},a.prototype.notifyWeekChanged=function(){var a=this;this.notifyVisibleDatesRangeChanged(this.currentWeek),this.$timeout(function(){var b=Math.ceil(parseInt(a.$calendarContent.css("right"),10)/a.calendarSingleWeekWidth);a.fullCalendarAccessibility.enableDaysInWeekViewSelectionOf(a.currentWeek.start,b)},400)},a.prototype.removePreviousSelectionAndSelect=function(a){this.removeSelectionMark(),this.markSelectedDate(a)},a.prototype.onMonthChanged=function(){this.resetViewOffset(),this.notifyMonthChanged(),this.updateCurrentViewRange(),this.updateSlotsAvailability(),this.markPreviouslySelectedDateIfRequired(),this.isInWeeklyMode&&this.calendarAPI.switchToWeekView()
},a.prototype.markPreviouslySelectedDateIfRequired=function(){this.selectedDate&&this.selectedDate.isBetween(this.currentViewRange.start,this.currentViewRange.end)&&this.removePreviousSelectionAndSelect(this.selectedDate)},a.prototype.goToTodayInWeekMode=function(){this.setWeekRange(moment().startOf("isoWeek")),this.scrollToWeekOfDay(moment())},a.prototype.updateSlotsAvailability=function(){var a=this;return this.getAvailableSlotsForCurrentRange().then(function(b){a.calendarAPI.addEventsSource(b)})},a.prototype.notifyVisibleDatesRangeChanged=function(a){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.VISIBLE_RANGE_CHANGED,a)},a.prototype.notifyLowerBound=function(a){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SET_LOWER_BOUND,a)},a.prototype.notifyMonthChanged=function(){var a=this.calendarAPI.getDate(),b={start:a,end:a};this.notifyVisibleDatesRangeChanged(b)},a.prototype.setWeekRange=function(a){void 0===a&&(a=this.currentViewRange.start),this.currentWeek={start:a.clone(),end:a.clone().add(6,"days")},this.notifyWeekChanged()},a.prototype.resetViewOffset=function(){this.retrieveCalendarProperties(),this.$calendarContent.css("right","0px")},a.prototype.goToLastWeekOfMonth=function(){this.$calendarContent.animate({right:"+="+5*this.calendarSingleWeekWidth+"px"})},a.prototype.isNextWeekOutOfCurrentRange=function(){return this.currentWeek.start.isAfter(this.currentViewRange.end.clone().subtract(1,"days"))},a.prototype.goToFirstUnseenDatesOfNextMonth=function(){this.previousViewRange=this.currentViewRange,this.goToNextMonth(),this.animateRight(this.calendarSingleDayWidth*this.getDaysIntersectionWithPreviousUpperBound())},a.prototype.animateRight=function(a){this.$calendarContent.animate({right:"+="+a+"px"})},a.prototype.isPreviousWeekOutOfCurrentRange=function(){return this.currentWeek.end.isBefore(this.currentViewRange.start)},a.prototype.goToFirstUnseenDatesOfPreviousMonth=function(){this.previousViewRange=this.currentViewRange,this.goToPrevMonth(),this.goToLastWeekOfMonth(),this.animateLeft(this.calendarSingleDayWidth*this.getDaysIntersectionWithPreviousLowerBound())},a.prototype.animateLeft=function(a){this.$calendarContent.animate({right:"-="+a+"px"})},a.prototype.refetchEvents=function(b){this.calendarAPI.setTimezone(b),this.calendarAPI.clearEvents(),this.$element.find("[data-date]").removeClass(a.AVAILABLE_DAYS_CLASS),this.updateSlotsAvailability()},a.prototype.registerListeners=function(){var a=this;this.$scope.$on(this.CALENDAR_EVENTS.NEXT_MONTH,this.goToNextMonth),this.$scope.$on(this.CALENDAR_EVENTS.PREV_MONTH,this.goToPrevMonth),this.$scope.$on(this.CALENDAR_EVENTS.COLLAPSE,this.switchToWeekMode),this.$scope.$on(this.CALENDAR_EVENTS.EXPAND,this.switchToMonthMode),this.$scope.$on(this.CALENDAR_EVENTS.NEXT_WEEK,this.goToNextWeek),this.$scope.$on(this.CALENDAR_EVENTS.PREV_WEEK,this.goToPrevWeek),this.$scope.$on(this.CALENDAR_EVENTS.TODAY_REQUESTED,this.goToToday),this.$scope.$on(this.CALENDAR_EVENTS.SELECT_DATE,this.onSelectDate),this.$scope.$on(this.CALENDAR_EVENTS.REFRESH_EVENTS_SOURCE,function(b,c){return a.refetchEvents(c)}),this.$scope.$on(this.CALENDAR_EVENTS.GO_TO_MONTH,function(b,c){return a.goToMonth(c)})},a}();b.WEEKLY_MODE_CLASS="calendar--weekly",b.AVAILABLE_DAYS_CLASS="fc-has-event",b.SELECTED_DAY_CLASS="fc-day-selected",a.VisitorCalendarCtrl=b,angular.module("schedulerAngularClientAppInternal").directive("boostVisitorCalendar",function(){return{templateUrl:"modules/calendar-page/visitor-calendar/visitor-calendar.preload.html",controller:b,controllerAs:"vCldr",bindToController:!0,restrict:"EA",scope:{getSlotsAvailability:"&slotsAvailabilitySource",onReady:"&",timezone:"@"}}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.timezone=b,this.calendarAPI=a.fullCalendar.bind(a)}return a.prototype.goToNextMonth=function(){this.calendarAPI("next")},a.prototype.goToPrevMonth=function(){this.calendarAPI("prev")},a.prototype.goToToday=function(){this.calendarAPI("today")},a.prototype.getViewDatesRange=function(){var a=this.calendarAPI("getView"),b=a.start,c=a.end;return b.tz(this.timezone),c.tz(this.timezone),{start:b,end:c}},a.prototype.getActualDateRange=function(){var a=this.calendarAPI("getView"),b=a.intervalStart,c=a.intervalEnd;return{start:b,end:c}},a.prototype.getDate=function(){return this.calendarAPI("getDate")},a.prototype.addEventsSource=function(a){this.calendarAPI("addEventSource",a)},a.prototype.clearEvents=function(){this.calendarAPI("removeEvents",function(){return!0})},a.prototype.convertDatesToAllDayEvents=function(a){var b=this,c=a.map(function(a){return a=parseInt(a,10),{start:moment.tz(a,b.timezone).format("YYYY-MM-DD"),end:moment.tz(a,b.timezone).format("YYYY-MM-DD"),rendering:"background",allDay:!0}});return c},a.prototype.goToDate=function(a){this.calendarAPI("gotoDate",a)},a.prototype.switchToWeekView=function(){var a=this.calendarAPI("getView"),b=a.coordMap.grid.rowCnt;a.coordMap.grid.colCnt=7*b},a.prototype.switchToMonthView=function(){var a=this.calendarAPI("getView");a.coordMap.grid.colCnt=7},a.prototype.setTimezone=function(a){this.timezone=a},a}();a.FullCalendarAdapter=b,angular.module("schedulerAngularClientAppInternal").service("FullCalendarAdapterFactory",function(){this.create=function(a,c){return new b(a,c)}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a){this.DateDefaults=a}return a.$inject=["DateDefaults"],a.prototype.hideDaysWeekHeader=function(){$(".fc-head").attr("aria-hidden","true")},a.prototype.removeAriaAttributes=function(){$(".fc-day").removeAttr("aria-hidden"),$(".fc-bg, .fc-bgevent-skeleton").removeAttr("aria-hidden"),$(".fc-day-number").removeAttr("aria-hidden"),$(".fc-content-skeleton").removeAttr("aria-hidden")},a.prototype.hideBlankAreas=function(){$(".fc-day").attr("aria-hidden","true"),$(".fc-bg, .fc-bgevent-skeleton").attr("aria-hidden","true"),$(".fc-day-number").not(".fc-has-event").attr("aria-hidden","true"),$(".fc-day-number.fc-past").attr("aria-hidden","true"),$(".fc-day-number.fc-has-event").each(function(a,b){var c=moment($(b).attr("data-date")),d='<span aria-label="'+c.format("MMMM DD dddd")+'" role="button">'+c.format("D")+"</span>";$(b).html(d)}),$("td").filter(function(){return!this.innerHTML}).attr("aria-hidden","true"),$(".fc-content-skeleton").filter(function(){return 7===$(this).find(".fc-day-number[aria-hidden=true]").length}).attr("aria-hidden","true")},a.prototype.initializeDaysSelectionEvents=function(){var a=this;this.setDaysButtonArieEnabled(),this.daysWithNumbersAndEvent().on("click",function(b){var c=b.currentTarget,d=a.dateWithEventFor(c);a.simulateClick(d)}),this.daysWithNumbersAndEvent().keypress(function(b){if(!a.preventKeyPressOnTab(b)&&(b.preventDefault(),a.canSelectSlot(b))){var c=a.dateWithEventFor(b.currentTarget);a.simulateClick(c)}})},a.prototype.preventKeyPressOnTab=function(a){var b=9;return a.keyCode===b?!0:!1},a.prototype.enableDaysInMonthViewSelection=function(){this.setDaysButtonArieEnabled(),$(".fc-week").attr("aria-hidden","false")},a.prototype.enableDaysInWeekViewSelectionOf=function(a,b){this.disableAllDaysSelection(),this.disableWeekBlocks(),this.enableWeekBlockWithChild(a,b)},a.prototype.enableWeekBlockWithChild=function(a,b){$(".fc-week").attr("aria-hidden","true"),$(".fc-week:eq("+b+")").attr("aria-hidden","false"),$(".fc-week:eq("+b+") .fc-day-number.fc-has-event").not(".fc-past").attr("tabindex","0")},a.prototype.disableWeekBlocks=function(){$(".fc-week").attr("aria-hidden","true")},a.prototype.dateWithEventFor=function(a){return $('[data-date="'+$(a).attr("data-date")+'"][aria-hidden="true"]')},a.prototype.simulateClick=function(a){var b=a.offset(),c=jQuery.Event("mousedown",{which:1,pageX:b.left,pageY:b.top});a.mouseover().trigger(c).mouseup()},a.prototype.disableAllDaysSelection=function(){this.daysWithEvent().removeAttr("tabindex")},a.prototype.setDaysButtonArieEnabled=function(){this.daysWithNumbersAndEvent().attr("tabindex","0")},a.prototype.daysWithEvent=function(){return $(".fc-week").find(".fc-has-event").not(".fc-past")},a.prototype.daysWithNumbersAndEvent=function(){return $(".fc-week").find(".fc-day-number.fc-has-event").not(".fc-past")},a.prototype.canSelectSlot=function(a){return this.isEnterPressed(a)||this.isSpacePressed(a)},a.prototype.isSpacePressed=function(a){return 32===a.which},a.prototype.isEnterPressed=function(a){return 13===a.which},a}();angular.module("schedulerAngularClientAppInternal").service("fullCalendarAccessibility",a)}(b=a.components||(a.components={}))}(b=a.crm||(a.crm={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a,b,c,d,e,f,g,h){var i=this;this.$rootScope=a,this.CALENDAR_EVENTS=b,this.libs=c,this.timezoneSrv=d,this.visitorBILogger=e,this.$translate=f,this.experimentsEnabler=g,this.$timeout=h,this.isCollapsed=!1,this.onDateRangeChanged=function(a,b){i.visibleDatesRange=b},this.onDaySelected=function(){i.isCollapsed=!0},this.$rootScope.$on(this.CALENDAR_EVENTS.VISIBLE_RANGE_CHANGED,this.onDateRangeChanged),this.$rootScope.$on(this.CALENDAR_EVENTS.DAY_SELECTED,this.onDaySelected),this.$rootScope.$on(this.CALENDAR_EVENTS.SET_LOWER_BOUND,function(a,b){i.lowerBound=b}),this.timezoneSrv.gettingFormattedOffset().then(function(a){i.timeZone=a})}return a.$inject=["$rootScope","CALENDAR_EVENTS","libs","timezoneSrv","visitorBILogger","$translate","experimentsEnabler","$timeout"],a.prototype.getTitle=function(){return this.visibleDatesRange?this.isCollapsed?this.libs.$.fullCalendar.formatRange(this.visibleDatesRange.start,this.visibleDatesRange.end,this.$translate("visitor.calendar.range-date-format")):this.visibleDatesRange.start.format("MMM YYYY"):void 0},a.prototype.doCalendarNavigatePrev=function(){this.isCollapsed?this.goToPrevWeek():this.goToPrevMonth()},a.prototype.doCalendarNavigateNext=function(){this.isCollapsed?this.goToNextWeek():this.goToNextMonth()},a.prototype.goToNextMonth=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.NEXT_MONTH)},a.prototype.goToPrevMonth=function(){this.isRangeBounderyReached()||this.$rootScope.$broadcast(this.CALENDAR_EVENTS.PREV_MONTH)},a.prototype.goToNextWeek=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.NEXT_WEEK)},a.prototype.goToPrevWeek=function(){this.isRangeBounderyReached()||this.$rootScope.$broadcast(this.CALENDAR_EVENTS.PREV_WEEK)},a.prototype.goToToday=function(){this.visitorBILogger.todayClick(),this.$rootScope.$broadcast(this.CALENDAR_EVENTS.TODAY_REQUESTED)},a.prototype.toggleCollapse=function(a){this.experimentsEnabler.isVisitorAccessibilityEnabled()&&a.which&&this.preventScrollDownWhenSpaceKeyClicked(a),this.$rootScope.$broadcast(this.isCollapsed?this.CALENDAR_EVENTS.EXPAND:this.CALENDAR_EVENTS.COLLAPSE),this.isCollapsed=!this.isCollapsed,this.$timeout(function(){$(".fc-content-skeleton .fc-has-event:eq(0)").focus()},401)},a.prototype.preventScrollDownWhenSpaceKeyClicked=function(a){var b=32;b===a.which&&a.preventDefault()},a.prototype.isRangeBounderyReached=function(){return this.visibleDatesRange.start.isSame(this.lowerBound,"day")},a.prototype.getCollapseStateLabel=function(){return this.isCollapsed?this.$translate("calendar.controls.collapse-switch.label.monthly"):this.$translate("calendar.controls.collapse-switch.label.weekly")},a}();angular.module("schedulerAngularClientAppInternal").directive("boostVisitorCalendarControls",function(){return{templateUrl:"modules/calendar-page/calendar-controls/visitor-calendar-controls.preload.html",controller:a,transclude:!0,controllerAs:"vccCtrl",bindToController:!0,restrict:"EA"}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){return a?Object.keys(a).sort().reduce(function(b,c){return b[c]=a[c],b},{}):null},c=function(){function c(a,b,c,d,e,f){var g=this;this.$scope=a,this.$rootScope=b,this.CALENDAR_EVENTS=c,this.$translate=d,this.libs=e,this.visitorBILogger=f,this.staffListStateMap={},this.id=+Date.now(),this.onDaySelected=function(){g.selectedSlot=null},this.onSlotSelected=function(a,b){var c=b.getTime().valueOf();g.selectedSlot=g.slots[c]?c:null},this.$scope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,this.onSlotSelected),this.$scope.$on(this.CALENDAR_EVENTS.DAY_SELECTED,this.onDaySelected)}return c.$inject=["$scope","$rootScope","CALENDAR_EVENTS","$translate","libs","visitorBILogger"],c.prototype.sortedSlots=function(){return b(this.slots)},c.prototype.selectSlot=function(a,b){a.preventDefault(),this.selectedSlot=+b;var c=this.slots[this.selectedSlot],d=c.length,e=1===d?c[0]:null;this.staffListStateMap=(f={},f[this.selectedSlot]=d>1,f),this.announceSlotSelection(e);var f},c.prototype.selectedStaff=function(a){var b=this.slots[this.selectedSlot].filter(function(b){return b.id===a})[0];this.visitorBILogger.staffMemberSelectedFromTimeSlot(),this.announceSlotSelection(b)},c.prototype.announceSlotSelection=function(b){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SLOT_SELECTED,new a.TimeSlotOption(this.selectedSlot,this.timezone,b))},c.prototype.getFormattedDate=function(a){return moment.tz(+a,this.timezone).format(this.$translate("visitor.time-format"))},c.prototype.isListEmpty=function(){return!this.slots||0===Object.keys(this.slots).length},c.prototype.getStaff=function(a){return this.slots[a]},c.prototype.staffListClosed=function(){this.staffListStateMap={}},c.prototype.isStaffListOpen=function(a){return this.staffListStateMap[a]},c}();angular.module("schedulerAngularClientAppInternal").directive("boostTimeSlotsList",function(){return{templateUrl:"modules/directives/time-slots-list/time-slots-list.preload.html",controller:c,controllerAs:"tslCtrl",scope:{slots:"=",title:"@slotsListTitle",timezone:"@"},bindToController:!0,restrict:"E"}})}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k){var l=this;this.visitorApi=a,this.TimeOfDay=b,this.TimeOfDayBounds=c,this.experimentsEnabler=d,this.momentSrv=e,this.libs=f,this.overEditor=g,this.$q=h,this.servicesSrv=i,this.visitorStaffSrv=j,this.appointmentService=k,this.visitorStaffSrv.gettingStaffMembers().then(function(a){l.staff=a})}return a.$inject=["visitorApi","TimeOfDay","TimeOfDayBounds","experimentsEnabler","momentSrv","libs","overEditor","$q","servicesSrv","visitorStaffSrv","appointmentService"],a.prototype.getSlotsAvailability=function(a,b,c){var d;if(this.servicesSrv.isDummyService(c)){var e=70;return this.$q.when(this.overEditor.getSlotsAvailability(a,b,this.staff,e))}var f=c.id;return d=this.visitorApi.getAvailableSlotsForIndividualService({range:a,timeZone:b,serviceId:f}),d.then(function(a){return a.slots})},a.prototype.getDaysWithAvailableSlots=function(a){return Object.keys(a).filter(function(b){return!!a[b].length})},a.prototype.splitFutureSlotsByPartsOfDay=function(a,b){var c=this,d=this.prepareSlotBlocksForTimesOfDay(),e=function(a,b,e){a.forEach(function(a){if(c.isDateInTheFuture(a)){var f=c.determineTimeOfDay(a,b),g=d[f];g[a]=g[a]||[],g[a].push(e)}})};return a.forEach(function(a){var d=a.slots,f=c.visitorStaffSrv.getStaffListByIds([a.staffId],c.staff)[0];e(d,b,f)}),d},a.prototype.isDateInTheFuture=function(a){var b=moment();return b.isBefore(+a)},a.prototype.prepareSlotBlocksForTimesOfDay=function(){var a=this,b={};return Object.keys(this.TimeOfDay).forEach(function(c){var d=a.TimeOfDay[c];b[d]={}}),b},a.prototype.getDatesWithInstances=function(a,b){var c=[];for(var d in a)if(a[d].length>0){var e=+moment.tz(+d,b).startOf("day").format("x");c.push(e)}return c},a.prototype.determineTimeOfDay=function(a,b){var c=this.momentSrv.timestampToMomentInTimezone(a,b).hour();return c<this.TimeOfDayBounds.MORNING?this.TimeOfDay.MORNING:c<this.TimeOfDayBounds.AFTERNOON?this.TimeOfDay.AFTERNOON:this.TimeOfDay.EVENING},a.prototype.getFirstAvailableSlotForIndividualService=function(a,b){if(this.servicesSrv.isDummyService(a))return this.$q.when(this.overEditor.getFirstAvailableSlotForService());var c=a.id;return this.getFirstRequiredSlotForIndividual({serviceId:c,timezone:b}).then(function(a){return moment(+a.slot)})},a.prototype.getFirstRequiredSlotForIndividual=function(a){var b=this.appointmentService.getCurrentBooking();return b?this.$q.when({slot:b.start}):this.visitorApi.getFirstAvailableSlotForIndividualService(a)},a.prototype.getAvailabilityOfStaffMember=function(a,b){var c={};return Object.keys(a).forEach(function(d){c[d]=a[d].filter(function(a){return a.staffId===b})}),c},a.prototype.createUnifiedSlotsList=function(a){return this.createUnifiedSlotsListGroupByStart(a)},a.prototype.getAvailableSlotsForTheDay=function(a,b,c){var d=Object.keys(a).find(function(a){var d=36e5,e=moment.tz(+a,c);return Math.abs(e.diff(b))<=d});return a[d]},a.prototype.partitionSlotsIntoPartsOfDay=function(a,b,c){var d=this.getAvailableSlotsForTheDay(a,b,c);return d?this.splitFutureSlotsByPartsOfDay(d,c):null},a.prototype.createUnifiedSlotsListGroupByStart=function(a){var b=[],c={};return a.forEach(function(a){c[a.start]?c[a.start].slots.push(a):c[a.start]={start:a.start,slots:[a]}}),Object.keys(c).sort().forEach(function(a){b.push(c[a])}),b},a}();a.SlotsService=b,angular.module("schedulerAngularClientAppInternal").service("slotsSrv",b)}(b=a.calendar||(a.calendar={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.MORNING="morning",this.AFTERNOON="afternoon",this.EVENING="evening"}return a}();a.TimeOfDay=b;var c=function(){function a(){this.MORNING=12,this.AFTERNOON=17,this.EVENING=23}return a}();a.TimeOfDayBounds=c;var d=function(){function a(){this.DATE_FORMAT="YYYY-MM-DD"}return a}();a.DateDefaults=d,angular.module("schedulerAngularClientAppInternal").constant("TimeOfDay",new b).constant("TimeOfDayBounds",new c).constant("DateDefaults",new d)}(b=a.constants||(a.constants={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g){var h=this;if(this.$rootScope=a,this.appointmentService=b,this.businessInfoSrv=c,this.$translate=d,this.CALENDAR_EVENTS=e,this.$element=f,this.$timeout=g,this.participantsVisibility=!0,this.onSlotSelected=function(a,b){h.staffMember=b.getStaff(),h.selectedTime=h.selectedDate=b.getTime()},this.onDateSelected=function(a,b){h.selectedTime=null,h.selectedDate=moment(b),h.staffMember=null},!angular.isNumber(this.numOfStaff))throw"numOfStaff must me a number";this.service=b.getSelectedService(),c.gettingBusinessInfo().then(function(a){h.businessInfo=a,h.addressKey=a.apartmentNum?"sidebar.address.line1":"sidebar.address.line1-no-apt"}),this.checkForPreviouslySelectedSlot(),this.setupListeners()}return a.$inject=["$rootScope","appointmentService","businessInfoSrv","$translate","CALENDAR_EVENTS","$element","$timeout"],a.prototype.setParticipantsVisibility=function(a){this.participantsVisibility=a},a.prototype.setupListeners=function(){var b=this;this.$rootScope.$on(this.CALENDAR_EVENTS.DAY_SELECTED,this.onDateSelected),this.$rootScope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,this.onSlotSelected),this.$rootScope.$on(a.EVENTS.SERVICE_UPDATED,function(a,c){return b.onServiceUpdated(c)}),this.$rootScope.$on(StaffPickerComponent.STAFF_SELECTED,function(){return b.$timeout(function(){return b.$element.find('[data-hook="sidebar-action"]').focus()})})},a.prototype.checkForPreviouslySelectedSlot=function(){var a=this.appointmentService.getSelectedTime();a&&(this.selectedDate=this.createMomentFromTime(+a.startTime),this.selectedTime=this.createMomentFromTime(+a.startTime),this.staffMember=a.staffMember)},a.prototype.createMomentFromTime=function(a){return this.timezone?moment.tz(a,this.timezone):moment(a)},a.prototype.getTitle=function(){return this.service.name},a.prototype.getDuration=function(){return this.service.duration},a.prototype.getDate=function(){return this.selectedDate.format(this.$translate("sidebar.date-format"))},a.prototype.getTime=function(){return this.selectedTime?this.selectedTime.format(this.$translate("visitor.time-format")):""},a.prototype.isShowSlotInfo=function(){return!(!this.selectedDate&&!this.selectedTime)},a.prototype.getBusinessName=function(){return this.businessInfo.name},a.prototype.getBusinessCity=function(){return this.appointmentService.getBusinessCity(this.businessInfo)},a.prototype.getLocation=function(){return this.appointmentService.getAppointmentLocation()},a.prototype.getLocationText=function(){return this.appointmentService.getAppointmentLocationText()},a.prototype.getCancellationPolicy=function(){return this.businessInfo.cancellationPolicy},a.prototype.getTeacher=function(){return this.staffMember&&this.numOfStaff>1?this.staffMember.fullName:""},a.prototype.getMinCharge=function(){return this.service.minCharge},a.prototype.getSelectedNumberOfParticipants=function(){return this.service.numberOfParticipants||1},a.prototype.getCurrency=function(){return this.service.currency},a.prototype.onServiceUpdated=function(a){this.service=Object.assign({},a)},a}();b.EVENTS={SERVICE_UPDATED:"Sidebar.SERVICE_UPDATED"},a.VisitorSidebar=b,angular.module("schedulerAngularClientAppInternal").component("boostVisitorSidebar",{templateUrl:"modules/sidebar/sidebar.preload.html",controller:b,bindings:{isLastStep:"=",actionLabel:"@",isActionEnabled:"=actionEnabled",onActionClick:"&actionClick",timezone:"@",sidebarShowUpfront:"@",numOfStaff:"=",onlinePaymentLabel:"@?",offlinePaymentLabel:"@?"}})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.visitorBILogger=a,this.experimentsEnabler=b,this.isCollapsed=!0}return a.$inject=["visitorBILogger","experimentsEnabler"],a.prototype.toggleCollapse=function(a){this.experimentsEnabler.isVisitorAccessibilityEnabled()&&this.preventScrollDownWhenSpaceKeyClicked(a),this.visitorBILogger.cancellationPolicy(),this.isCollapsed=!this.isCollapsed},a.prototype.preventScrollDownWhenSpaceKeyClicked=function(a){var b=32;b===a.which&&a.preventDefault()},a}();a.CollapsableSidebarWidget=b,angular.module("schedulerAngularClientAppInternal").directive("boostCollapsableWidget",function(){return{templateUrl:"modules/templates/collapsable-sidebar-widget.preload.html",controller:b,controllerAs:"cswCtrl",scope:{title:"@",content:"@"},bindToController:!0,restrict:"EA"}})}(b=a.directives||(a.directives={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a.PAYMENT_PROCESS_RESULT={SUCCEEDED:"PAYMENT_SUCCEEDED",FAILED:"PAYMENT_FAILED",OFFLINE:"PAYMENT_OFFLINE"},a.PAYMENT_MODAL_HEIGHT=650,a.PAYMENT_MODAL_WIDTH=800;var b=function(){function a(){this.PAYMENT_TYPE_ONLINE="ONLINE",this.PAYMENT_TYPE_OFFLINE="OFFLINE",this.PAYMENT_TYPE_ALL="ALL"}return a}();a.PaymentType=b;var c=function(){function b(a,b,c,d,e,f,g,h){this.$q=a,this.appointmentService=b,this.visitorApi=c,this.$wix=e,this.urlUtilSrv=f,this.features=g,this.premiumService=h,this.PAYMENT_TYPE_ONLINE=d.PAYMENT_TYPE_ONLINE,this.PAYMENT_TYPE_OFFLINE=d.PAYMENT_TYPE_OFFLINE}return b.$inject=["$q","appointmentService","visitorApi","paymentType","$wix","urlUtilSrv","features","premiumService"],b.prototype.payFor=function(a){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(b){switch(b.label){case 0:return[4,this.openPaymentMethodsModal(a)];case 1:return[2,b.sent()]}})})},b.prototype.handle=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,this.setOfflinePayment()];case 1:return[2,a.sent()]}})})},b.prototype.setBusinessInfo=function(a){this.businessInfo=a},b.prototype.isPaidOnline=function(a){var b=this.appointmentService.getPaymentInfo();return!(!b||!a||b.paymentType!==this.PAYMENT_TYPE_ONLINE)},b.prototype.hasUpfrontPayment=function(a){return __awaiter(this,void 0,void 0,function(){var b;return __generator(this,function(c){switch(c.label){case 0:return b=a,b?[4,this.isOnlinePaymentAllowed()]:[3,2];case 1:b=c.sent(),c.label=2;case 2:return[2,!!b]}})})},b.prototype.isOnlinePaymentAllowed=function(){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(b){switch(b.label){case 0:return a=this.isPaymentNeeded(this.appointmentService.getSelectedService())&&this.premiumService.isFeatureEnabled(this.features.PAYMENTS),a?[4,this.hasPaymentMethodConnected()]:[3,2];case 1:a=b.sent(),b.label=2;case 2:return[2,a]}})})},b.prototype.isPaymentNeeded=function(a){return void 0===a&&(a=this.appointmentService.getSelectedService()),!a.isFree&&!this.isOfflinePayment(a)&&!a.dummy},b.prototype.isOfflinePayment=function(a){return a.paymentType===this.PAYMENT_TYPE_OFFLINE},b.prototype.hasPaymentMethodConnected=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,this.visitorApi.isCashierConnected()];case 1:return[2,a.sent()]}})})},b.prototype.openPaymentMethodsModal=function(b){var c=this.$q.defer(),d=this.appointmentService.getSelectedService(),e=d.id,f=d.type,g=d.paymentType,h=this.generatePaymentMethodUrl(b,e,f,g);return this.$wix.openDefaultModal(h,a.PAYMENT_MODAL_WIDTH,a.PAYMENT_MODAL_HEIGHT,function(b){return b&&b.message!==a.PAYMENT_PROCESS_RESULT.FAILED?c.resolve(b.message):c.reject()}),c.promise},b.prototype.generatePaymentMethodUrl=function(a,b,c,d){return this.urlUtilSrv.getUrlForEnv({urlSuffix:"payment-options.html?order_id="+a+"&service_id="+b+"&service_type="+c+"&payment_method="+d})},b.prototype.setOfflinePayment=function(){this.appointmentService.setPaymentInfo({paymentType:this.PAYMENT_TYPE_OFFLINE})},b}();a.PaymentService=c,angular.module("schedulerAngularClientAppInternal").constant("paymentType",new b).service("paymentService",c)}(b=a.payments||(a.payments={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var ServiceClassicWithImage=function(){function a(a){this.experimentsEnabler=a,this.hover=!1}return a.$inject=["experimentsEnabler"],a.prototype.isShowOverlay=function(){return this.description},a.prototype.isHideImage=function(){return this.hover&&this.isShowOverlay()},Object.defineProperty(a.prototype,"description",{get:function(){return this.service.description},enumerable:!0,configurable:!0}),a.prototype.mouseenter=function(){this.hover=!0},a.prototype.mouseleave=function(){this.hover=!1},a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceClassicWithImage",{templateUrl:"modules/service-tile/heidi/classic-with-image.preload.html",controller:ServiceClassicWithImage,bindings:{imageUrl:"@",isImageRound:"=",onClick:"&",onShowDetails:"&",service:"=",serviceDays:"=",fullServiceDays:"=",buttonText:"@"}});var ServiceClassicWithoutImage=function(){function a(){}return Object.defineProperty(a.prototype,"description",{get:function(){return this.service.description},enumerable:!0,configurable:!0}),a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceClassicWithoutImage",{templateUrl:"modules/service-tile/heidi/classic-without-image.preload.html",controller:ServiceClassicWithoutImage,bindings:{onClick:"&",onShowDetails:"&",service:"=",serviceDays:"=",fullServiceDays:"=",buttonText:"@"}});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.FINALIZE="Finalize",b.CASHIER="PayWithCashier",a.CreateBookingSteps=b;var c=function(){function a(a){this.dto=a}return a.prototype.isCashierRequired=function(){return this.dto.nextStep.name===b.CASHIER},Object.defineProperty(a.prototype,"bookingId",{get:function(){return this.dto.tentativeBookingId},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cashierExternalId",{get:function(){return this.isCashierRequired()?this.dto.nextStep.orderId:null},enumerable:!0,configurable:!0}),a}();a.BookingStepDomain=c;var d=function(){function a(a){this.appointmentServiceAdapter=a}return a.prototype.generateCreateTentativeBookingRequest=function(){var a=this.appointmentServiceAdapter.getSelectedService(),b=this.appointmentServiceAdapter.getSelectedTime(),c=this.appointmentServiceAdapter.getContactInfo();return{scheduleInfo:{type:a.type,offeringId:a.id,timeSlot:{id:b.groupInstance?b.groupInstance.id:null,staffMemberId:b.staffMember.id,startTime:parseInt(b.startTime,10)},timeZone:b.timeZone},contactInfo:{bookingsForm:c.dynamicFormData.form}}},a.prototype.generateCreateFinalizeBookingRequest=function(a){var b=this.appointmentServiceAdapter.getPaymentInfo();return{tentativeBookingId:a.bookingId,paymentInfo:{paymentOption:b.paymentType}}},a}();a.CreateBookingRequestFactory=d}(b=a.domain||(a.domain={}))}(b=a.offering||(a.offering={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];
return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.offering.domain.CreateBookingRequestFactory,d=a.bookings.offering.domain.BookingStepDomain;b.PAYMENT_PROCESS_RESULT={SUCCEEDED:"PAYMENT_SUCCEEDED",FAILED:"PAYMENT_FAILED",OFFLINE:"PAYMENT_OFFLINE"},b.BOOKING_ERRORS={BOOKING_CONFLICT_HTTP_ERROR:409,BOOKING_CONFLICT_SERVER_ERROR_CODE:-7,BOOKING_CONFLICT_CLIENT_STATUS_CODE:"BOOKING_CONFLICT"};var e=function(){function a(a,c,d,e,f,g,h,i){var j=this;this.appointmentService=a,this.paymentType=c,this.paymentService=d,this.visitorBILogger=e,this.overEditor=f,this.bookingApiSrv=g,this.experimentsEnabler=h,this.$q=i,this.handleBookingConflictError=function(a){throw j.isBookingConflict(a)?b.BOOKING_ERRORS.BOOKING_CONFLICT_CLIENT_STATUS_CODE:a},this.registerPaymentResult=function(a){var b=j.willBePayedInPerson(a)?j.paymentType.PAYMENT_TYPE_OFFLINE:j.paymentType.PAYMENT_TYPE_ONLINE;j.appointmentService.setPaymentInfo({paymentType:b}),j.visitorBILogger.appointmentCreated(b)}}return a.$inject=["appointmentService","paymentType","paymentService","visitorBILogger","overEditor","bookingApiSrv","experimentsEnabler","$q"],a.prototype.isTentativeBookingRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,this.paymentService.isOnlinePaymentAllowed()];case 1:return[2,a.sent()]}})})},a.prototype.registerImmediate=function(){return this.appointmentService.save()},a.prototype.processImmediate=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,this.paymentService.handle()];case 1:return a.sent(),[4,this.registerImmediate()];case 2:return[2,a.sent()]}})})},a.prototype.willBePayedInPerson=function(a){return a===b.PAYMENT_PROCESS_RESULT.OFFLINE},a.prototype.payFor=function(a){return this.paymentService.payFor(a)},a.prototype.registerTentative=function(){return this.appointmentService.createTentativeBooking()},a.prototype.processTentative=function(){return __awaiter(this,void 0,void 0,function(){var a,b;return __generator(this,function(c){switch(c.label){case 0:return[4,this.registerTentative()];case 1:return a=c.sent(),[4,this.payFor(a)];case 2:return b=c.sent(),this.registerPaymentResult(b),this.willBePayedInPerson(b)?[4,this.registerImmediate()]:[3,4];case 3:return[2,c.sent()];case 4:this.visitorBILogger.appointmentCreated("ONLINE"),c.label=5;case 5:return[2]}})})},a.prototype.execute=function(a){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(b){switch(b.label){case 0:return this.paymentService.setBusinessInfo(a),this.experimentsEnabler.isOfferingsUnificationEnabled()?[2,this.processBookingUnifiedOffering()]:[3,1];case 1:return[4,this.isTentativeBookingRequired()];case 2:return b.sent()?[4,this.processTentative()]:[3,4];case 3:return[2,b.sent()];case 4:return[4,this.processImmediate()];case 5:return[2,b.sent()]}})})},a.prototype.processBookingUnifiedOffering=function(){return this.overEditor.isDemoFlow?(this.registerPaymentResult(b.PAYMENT_PROCESS_RESULT.OFFLINE),this.$q.when({})):this.processBookingWithServer()},a.prototype.processBookingWithServer=function(){var a=this,b=new c(this.appointmentService),e=b.generateCreateTentativeBookingRequest();return this.bookingApiSrv.creatingTentativeBooking(e,this.isBookingConflict).then(function(c){var e=new d(c);return a.performPaymentIfNeeded(e).then(a.registerPaymentResult).then(function(){return a.bookingApiSrv.finalizingBooking(b.generateCreateFinalizeBookingRequest(e),a.isBookingConflict)})}).catch(this.handleBookingConflictError)},a.prototype.isBookingConflict=function(a){return a&&a.data&&a.status===b.BOOKING_ERRORS.BOOKING_CONFLICT_HTTP_ERROR&&a.data.errorCode===b.BOOKING_ERRORS.BOOKING_CONFLICT_SERVER_ERROR_CODE},a.prototype.performPaymentIfNeeded=function(a){return a.isCashierRequired()?this.paymentService.payFor(a.cashierExternalId):this.$q.when(b.PAYMENT_PROCESS_RESULT.OFFLINE)},a}();b.ProcessBookingSrv=e,angular.module("schedulerAngularClientAppInternal").service("processBookingSrv",e)}(c=b.services||(b.services={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g){this.servicesSrv=a,this.$q=b,this.groupsSrv=c,this.boostInjectionPersister=d,this.appointmentService=e,this.offeringsListGetterSrv=f,this.ServiceTypes=g}return a.$inject=["servicesSrv","$q","groupsSrv","boostInjectionPersister","appointmentService","offeringsListGetterSrv","ServiceTypes"],a.prototype.selectedWithDefault=function(a){return this.selected().then(function(b){return b||a})},a.prototype.selected=function(){return this.$q.all([this.findInjected(),this.findSelected()]).then(function(a){var b=a[0],c=a[1];return c||b})},a.prototype.find=function(a){return this.offeringsListGetterSrv.getBy(a).then(function(a){return null!==a?a.toLegacyService():null})},a.prototype.findSelected=function(){return this.appointmentService.getSelectedService()},a.prototype.findInjected=function(){var a=this,b=this.boostInjectionPersister.getOfferingId();return this.$q.all([this.servicesSrv.gettingServices(),this.groupsSrv.gettingGroupsList()]).then(function(c){var d=c[0],e=c[1];return a.findInServices(d,b)||a.findInGroups(e,b)})},a.prototype.findInServices=function(b,c){var d=b.services;return a.findInOfferingsListByIdWithType(d,c,this.ServiceTypes.INDIVIDUAL)},a.prototype.findInGroups=function(b,c){var d=b.classes;return a.findInOfferingsListByIdWithType(d,c,this.ServiceTypes.GROUP)},a.findInOfferingsListByIdWithType=function(a,b,c){var d=a.find(function(a){return a.id===b});return d?__assign({},d,{type:c}):null},a}();a.OfferingLocator=b,angular.module("schedulerAngularClientAppInternal").service("offeringFinder",b)}(b=a.offering||(a.offering={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(b){function c(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=b.call(this,m,n,p,o,q)||this;return v.$scope=c,v.flowManagerSrv=d,v.routeManager=e,v.clientPages=f,v.TILE_LIST_EVENTS=g,v.ServiceTypes=h,v.overEditor=i,v.visitorBILogger=j,v.activeFeatures=k,v.features=l,v.appSettings=q,v.IS_ONBOARDING=r,v.$rootScope=s,v.$filter=t,v.experimentsEnabler=u,v.groupSelectedButNotPremium=!1,v.updateGroupsPerCategory=function(a){v.updateCategoryId(a),v.groups=v.updatePerCategory(a,v.groupsList.classes)},v.groupsList=a.current.locals.groupList,v.serviceList=a.current.locals.serviceList,v.groups=v.groupsList.classes,v.categories=v.groupsList.categories,v.$scope.$on(g.TILE_SELECTED,function(a,b){v.next(b)}),v.$scope.$on(g.TILE_SHOW_DETAILS,function(a,b){v.showServiceDetails(b)}),o.updateModelClasses(v.groupsList),v.individualServices=a.current.locals.serviceList,v.isShowIndividualServiceButton=v.showIndividualServiceButton(),v.isNoServicesOverEditor=i.isOverEditor&&v.groups.length&&v.groups[0].dummy,v.categoriesType=q.getGroupsCategoryLayoutType(v.categories.length),v}return __extends(c,b),c.$inject=["$route","$scope","flowManagerSrv","routeManager","clientPages","TILE_LIST_EVENTS","ServiceTypes","overEditor","visitorBILogger","activeFeatures","features","groupsSrv","servicesSrv","commonServices","SERVICE_CATEGORY_LAYOUT","appSettings","IS_ONBOARDING","$rootScope","$filter","experimentsEnabler"],c.prototype.isPageTitleShown=function(){return!!this.$filter("wixSdkTranslate")("groups-list.title","textPageTitleGroups")},c.prototype.isShowInstruction=function(){return this.overEditor.isEditModeAndNotVisitedOwner()&&this.IS_ONBOARDING},c.prototype.getServiceTypeId=function(){return this.ServiceTypes.GROUP},c.prototype.showIndividualServiceButton=function(){return this.hasIndividualServices()?!0:this.hasIndividualServices()||this.hasGroupsServices()?void 0:!0},c.prototype.goToIndividual=function(){this.visitorBILogger.switchServiceType(this.ServiceTypes.INDIVIDUAL),this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)},c.prototype.updateCategoryId=function(a){this.selectedCategory=a},c.prototype.next=function(a){var b="next";this.navigate(a,b)},c.prototype.showServiceDetails=function(a){var b="showMoreDetails";this.navigate(a,b)},c.prototype.navigate=function(b,c){this.flowManagerSrv.initiateGroup(b),this.visitorBILogger.bookIt(),this.isGroupSelectionAllowed()?this.flowManagerSrv.doNavigation(c):(this.groupSelectedButNotPremium=!0,this.visitorBILogger.bookedGroupButNotPremium(),this.groupsSrv.notifyingNonPremiumEnrollmentAttempt(),this.$rootScope.$broadcast(a.boost.visitor.directives.ScrollToMe.SCROLL_EVENT,{toElement:"appMessage"}))},c.prototype.isGroupSelectionAllowed=function(){return this.activeFeatures[this.features.GROUPS]||this.overEditor.isDemoFlow},c}(BaseServicesCtrl);b.GroupListPage=c,angular.module("schedulerGroupAppInternal").directive("boostGroupListPage",function(){return{templateUrl:"modules/group-list/group-list-page.preload.html",controller:c,controllerAs:"groupListPage",bindToController:!0,restrict:"E"}})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.visitor.offerings.OfferingTypes,d="week-day.",e="short-week-day.",f=function(){function a(a,b,c,d,e,f,g,h,i,j,k){this.visitorApi=a,this.$translate=b,this.boostInjectionPersister=c,this.$q=d,this.overEditor=e,this.visitorStaffSrv=f,this.experimentsEnabler=g,this.$timeout=h,this.businessInfoSrv=i,this.appointmentService=j,this.commonServices=k}return a.$inject=["visitorApi","$translate","boostInjectionPersister","$q","overEditor","visitorStaffSrv","experimentsEnabler","$timeout","businessInfoSrv","appointmentService","commonServices"],a.prototype.gettingGroupsList=function(){var a=this;return this.$q.all([this.gettingRealGroups(),this.visitorStaffSrv.gettingStaffMembers()]).then(function(b){var c=b[0],d=b[1];return a.hasGroups(c)?(a.commonServices.populateGroupsStaffMembers(c.classes,d.staff),c):a.overEditor.enrichGroupListIfOverEditor(c)}).then(function(a){var b=a.classes.map(function(a){return __assign({},a,{type:c.GROUP})});return __assign({},a,{classes:b})})},a.prototype.hasRealGroups=function(a){return this.hasGroups(a)&&!a.classes[0].dummy},a.prototype.notifyingNonPremiumEnrollmentAttempt=function(){return this.visitorApi.notifyingNonPremiumEnrollmentAttempt()},a.prototype.gettingGroupsInstances=function(a,b){var c,d=this;if(this.isOnDemoMode(a))c=this.$q.when(this.$timeout(function(){return d.visitorStaffSrv.gettingStaffMembers().then(function(a){return d.overEditor.getClassesInstancesIfOverEditor(b,a)})}));else{var e=this.createRangeWithTimeZoneCompensation(b);c=this.visitorApi.gettingGroupsInstances({id:a,dateRange:e}).then(function(a){return d.filterClassInstanceByDatRange(a,b)})}return c.then(function(a){return d.markGroupInstancesAvailability(a)})},a.prototype.gettingFutureGroupInstances=function(a,b){var c=moment().valueOf();return this.gettingGroupsInstances(a,b).then(function(a){return a.classesInstances=a.classesInstances.filter(function(a){return a.start>c}),a})},a.prototype.isOnDemoMode=function(a){return!a},a.prototype.createRangeWithTimeZoneCompensation=function(a){return{start:a.start.clone().subtract(1,"days"),end:a.end.clone().add(1,"days")}},a.prototype.filterClassInstanceByDatRange=function(a,b){var c=Object.assign({},a);return c.classesInstances=a.classesInstances.filter(function(a){return moment(a.start).isBetween(b.start,b.end,null,"[)")}),c},a.prototype.hasGroups=function(a){return a&&a.classes&&a.classes.length>0},a.prototype.gettingRealGroups=function(){var a=this.boostInjectionPersister.getGroupsList();return a?this.$q.when(a):this.visitorApi.gettingGroups()},a.prototype.getFullTranslatedActiveDays=function(a){return this.getDaysTranslationByKey(a,d)},a.prototype.getTranslatedActiveDays=function(a){return this.getDaysTranslationByKey(a,e)},a.prototype.getDaysTranslationByKey=function(a,b){var c=[];return a.classHours?(c=Object.keys(a.classHours).map(this.daysOfWeek(a)).filter(this.activeDaysOfWeek()),this.isFullTranslationForActiveDayRequired(c.length)?c.map(this.translateActiveDayWithPrefix(d)):c.map(this.translateActiveDayWithPrefix(b))):c},a.prototype.isFullTranslationForActiveDayRequired=function(a){return 1===a},a.prototype.translateActiveDayWithPrefix=function(a){var b=this;return function(c){var d=c.dayOfWeek;return b.$translate(a+d)}},a.prototype.activeDaysOfWeek=function(){var a=this;return function(b){var c=b.dayOfWeekData;return a.isActiveDay(c)}},a.prototype.daysOfWeek=function(a){return function(b){return{dayOfWeek:b,dayOfWeekData:a.classHours[b]}}},a.prototype.isActiveDay=function(a){return!!a&&a.workingHours&&a.workingHours.length>0},a.prototype.convertInstancesToAvailableTimeSlots=function(a,b,c){for(var d,e=["mon","tue","wed","thu","fri","sat","sun"],f={},g=0;g<e.length;g++)f[e[g]]=[];for(var h=this.visitorStaffSrv.createId2StaffMemberMap(c),i=this.groupInstancesByTime(a),g=0;g<i.length;g++){d=moment.tz(i[g][0].start,b).isoWeekday()-1;var j=i[g],k=this.createGroupInstancesTimeSlot(j,h);f[e[d]].push(k)}return this.sortTimeSlots(e,f),f},a.prototype.createGroupInstancesTimeSlot=function(a,b){var c=this;return{instances:a,availableStaff:this.visitorStaffSrv.getStaffListByStaffMap(a.map(function(a){return a.staffMemberId}),b),staffStatus:a.reduce(function(a,b){return a.set(b.staffMemberId,{isFull:!c.isInstanceAvailable(b)}),a},new Map)}},a.prototype.sortTimeSlots=function(a,b){for(var c=0;c<a.length;c++)b[a[c]].sort(function(a,b){var c=a.instances[0],d=b.instances[0];return c.start-d.start})},a.prototype.getDatesWithInstances=function(a,b){var c=[];return a.forEach(function(a){var d=+moment.tz(a.start,b).startOf("day").format("x");-1===c.indexOf(d)&&c.push(d)}),c},a.prototype.getFutureInstancesWithVacancyOnGivenDay=function(a,b){var c=this,d=moment();return a.filter(function(a){var e=moment(a.start);return b.isSame(e,"day")&&e.isAfter(d)&&c.isInstanceAvailable(a)})},a.prototype.getInstanceById=function(a,b){return a.filter(function(a){return a.id===b})[0]},a.prototype.isInstanceAvailable=function(a){return!a.isFull},a.prototype.getFirstAvailableSlotForPrototype=function(a){if(!a||!a.id||a.dummy)return this.$q.when(this.overEditor.getFirstAvailableSlotForService());var b=a.id;return this.$q.all([this.businessInfoSrv.gettingBusinessInfo(),this.getFirstRequiredSlotForGroup({groupProtoId:b})]).then(function(a){var b=a[0],c=a[1];return moment.tz(+c.slot,b.timeZone)})},a.prototype.getFirstRequiredSlotForGroup=function(a){var b=this.appointmentService.getCurrentBooking();return b?this.$q.when({slot:b.start}):this.visitorApi.getFirstAvailableSlotForGroupPrototype(a)},a.prototype.groupInstancesByTime=function(a){var b=[],c={};return a.forEach(function(a){c[a.start]||(c[a.start]=[]),c[a.start].push(a)}),Object.keys(c).forEach(function(a){b.push(c[a])}),b},a.prototype.markGroupInstancesAvailability=function(a){var b=this.appointmentService.getCurrentBooking(),c=b&&b.numOfParticipants||1;return __assign({},a,{classesInstances:a.classesInstances.map(function(a){return __assign({},a,{isFull:a.registered+c>a.capacity})})})},a}();b.GroupsService=f,angular.module("schedulerGroupAppInternal").service("groupsSrv",f)}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a,b){this.groupsSrv=b,this.activeDays=b.getTranslatedActiveDays(this.group),this.activeFullDays=b.getFullTranslatedActiveDays(this.group)}return a.$inject=["appSettings","groupsSrv"],a}();angular.module("schedulerAngularClientAppInternal").component("boostGroupTile",{template:'<boost-service-tile service="$ctrl.group" size="{{$ctrl.size}}" template="{{$ctrl.template}}" service-days="$ctrl.activeDays" full-service-days="$ctrl.activeFullDays" config="$ctrl.tileConfig" button-text="{{\'group-select-button\' | wixSdkTranslate: \'textBookButtonGroups\'}}" custom-class="group" style="width:100%;"></boost-service-tile>',controller:a,bindings:{group:"=",size:"@",template:"@",tileConfig:"=config"}})}(b=a.groups||(a.groups={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.libs=a,this.$translate=b,this.experimentsEnabler=c,this.groupsSrv=d,this.appointmentService=e,this.DateDefaults=g,this.$scope=h,this.$rootScope=i,this.CALENDAR_EVENTS=j,this.visitorBILogger=k,this.visitorStaffSrv=l,this.$filter=m,this.flowManagerSrv=n,this.$timeout=o,this.$element=p,this.isActionComplete=!1,this.pickerOpened=!1,this.selectedService=e.getSelectedService(),this.businessInfo=f.current.locals.businessInfo;var q=f.current.locals.firstAvailableDate;this.staff=f.current.locals.staff,this.populateValidStaffMembers(),this.updateSelectedWeekPerSelectedDate(q),this.registerEventListeners(),c.isVisitorAccessibilityEnabled()&&(this.libs.$(".aria-page-title").html(""),this.libs.$(".aria-page-title").attr("aria-hidden",!1))}return a.$inject=["libs","$translate","experimentsEnabler","groupsSrv","appointmentService","$route","DateDefaults","$scope","$rootScope","CALENDAR_EVENTS","visitorBILogger","visitorStaffSrv","$filter","flowManagerSrv","$timeout","$element"],a.prototype.$onInit=function(){var a=this;this.experimentsEnabler.isVisitorAccessibilityEnabled()&&(this.$timeout(function(){a.libs.$(".aria-page-title").html(a.ariaLabelPageAlert())},1500),this.$timeout(function(){a.libs.$(".aria-page-title").html("")},2e3),this.$timeout(function(){a.libs.$(".user-login__action").focus()},5e3))},a.prototype.ariaLabelPageAlert=function(){return this.$translate("visitor.groups.calendar.accessibility.alert-title",{serviceName:this.selectedService.name})},a.prototype.populateValidStaffMembers=function(){this.availableStaffMembers=this.visitorStaffSrv.getCapableStaffByStaff(this.staff).map(function(a){return{value:a.id,label:a.fullName}}),this.availableStaffMembers=this.$filter(OrderByLowerCase.FILTER_NAME)(this.availableStaffMembers,"label")},a.prototype.updateSelectedWeekPerSelectedDate=function(a){var b=this;this.splitInstances={};var c=a.clone().startOf("isoWeek"),d=a.clone().endOf("isoWeek");this.currentWeek={start:c,end:d};var e=this.selectedService.dummy?null:this.selectedService.id;this.groupsSrv.gettingFutureGroupInstances(e,this.currentWeek).then(function(a){b.classInstances=a.classesInstances,b.updateInstancesModel()})},a.prototype.updateInstancesModel=function(){var a=this,b=this.selectedStaffMemberId?this.classInstances.filter(function(b){return b.staffMemberId===a.selectedStaffMemberId}):this.classInstances;this.splitInstances=this.groupsSrv.convertInstancesToAvailableTimeSlots(b,this.businessInfo.timeZone,this.staff),this.$rootScope.$broadcast(this.CALENDAR_EVENTS.GROUPS_DATA_FETCHED)},a.prototype.getFormattedDateRange=function(){return this.libs.$.fullCalendar.formatRange(this.currentWeek.start,this.currentWeek.end,this.$translate("visitor.calendar.range-date-format"))},a.prototype.goToNextWeek=function(){this.promoteWeekByAmount(1)},a.prototype.goToPrevWeek=function(){this.promoteWeekByAmount(-1)},a.prototype.goToToday=function(){this.visitorBILogger.todayClick(),this.updateSelectedWeekPerSelectedDate(moment.tz(this.businessInfo.timeZone))},a.prototype.goBack=function(){this.flowManagerSrv.prev()},a.prototype.goToNextPage=function(){this.visitorBILogger.sendNext("date&time"),this.flowManagerSrv.next()},a.prototype.getDayByIndex=function(a){return this.currentWeek.start.clone().add(a,"day").format(this.DateDefaults.DATE_FORMAT)},a.prototype.triggerDatePicker=function(a){this.pickerOpened?this.pickerOpened=!1:(a.preventDefault(),a.stopPropagation(),this.pickerOpened=!0)},a.prototype.disabled=function(a,b){var c=new Date;return"day"===b&&c>a},a.prototype.onStaffMemberFilterSelected=function(a){this.selectedStaffMemberId!==a&&(this.selectedStaffMemberId=a,this.updateInstancesModel())},a.prototype.promoteWeekByAmount=function(a){var b=this.currentWeek.start.clone().add(a,"week");this.updateSelectedWeekPerSelectedDate(b)},a.prototype.focusOnDateRangePicker=function(){this.$element.find('[data-hook="groups-calendar-date-range"]').focus()},a.prototype.registerEventListeners=function(){var a=this;this.$scope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,function(b,c){a.visitorBILogger.selectSlot(),a.isActionComplete=!!c.getStaff()}),this.$scope.$watch(function(){return a.selectedDate},function(b){b&&(a.pickerOpened=!1,a.updateSelectedWeekPerSelectedDate(moment(b)),a.focusOnDateRangePicker())})},Object.defineProperty(a.prototype,"numOfStaff",{get:function(){return this.staff?this.staff.staff.length:0},enumerable:!0,configurable:!0}),a}();a.GroupsCalendar=b,angular.module("schedulerAngularClientAppInternal").directive("boostGroupsCalendar",function(){return{templateUrl:"modules/visitor/groups/groups-calendar.preload.html",controller:b,controllerAs:"groupsCalendar",bindToController:!0,restrict:"E"}})}(b=a.groups||(a.groups={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(){var b=a.boost.visitor.calendar.TimeSlotOption,c=function(){function a(a,b,c,d,e,f,g,h,i){this.appointmentService=a,this.libs=b,this.CALENDAR_EVENTS=c,this.$rootScope=e,this.DateDefaults=f,this.groupsSrv=g,this.$timeout=h,this.experimentsEnabler=i,this.todayDate=new Date,this.selectedService=a.getSelectedService(),this.timeFormat=d("visitor.time-format"),this.registerDateSelectionChanges(),this.initialize()}return a.$inject=["appointmentService","libs","CALENDAR_EVENTS","$translate","$rootScope","DateDefaults","groupsSrv","$timeout","experimentsEnabler"],a.prototype.initialize=function(){this.isRepresentingToday=moment().tz(this.calendarDayTimezone).format(this.DateDefaults.DATE_FORMAT)===this.calendarDay,this.calendarDayMoment=moment.tz(this.calendarDay,this.calendarDayTimezone)},a.prototype.hasSlotsThisDay=function(){return this.calendarDayList&&this.calendarDayList.length>0},a.prototype.isSingleGroupFull=function(a){var b=this,c=!0;return a.instances.forEach(function(a){c=c&&!b.groupsSrv.isInstanceAvailable(a)}),c},a.prototype.isInstancePassedDue=function(a){return a.instances[0].start<this.todayDate.getTime()},a.prototype.isSingleGroupUnavailable=function(a){return this.isSingleGroupFull(a)||this.isInstancePassedDue(a)},a.prototype.getSingleGroupLabel=function(a){return moment.tz(a.instances[0].start,this.calendarDayTimezone).format(this.timeFormat)},a.prototype.closeGroupInstanceTooltip=function(a){a.isOpen=!1},a.prototype.slotSelected=function(a){var b=this;this.isSingleGroupUnavailable(a)||(this.selectedInstance=a,a.instances.length>1?(this.$timeout(function(){b.selectedInstance.isOpen=!0}),this.deselectPrevSlot(),this.notifySlotSelected(a.instances[0],null)):this.selectGroupInstance(a.instances[0]))},a.prototype.deselectPrevSlot=function(){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SLOT_DESELECTED)},a.prototype.isGroupSlotSelected=function(a){return a===this.selectedInstance},a.prototype.selectStaffMemberInSlot=function(a){var b=this;this.selectedInstance.instances.forEach(function(c){c.staffMemberId===a&&b.selectGroupInstance(c)})},a.prototype.getDayNumber=function(){return this.calendarDayMoment.day()},a.prototype.accessibilityLabelForSlot=function(a){return moment.tz(a.instances[0].start,this.calendarDayTimezone).format("h:mm a")},a.prototype.accessibilityLabel=function(){return this.calendarDayMoment.format("dddd MM/DD/YYYY")},a.prototype.elementIdFor=function(a){return"instance-label-"+this.getDayNumber()+"-"+a},a.prototype.tabIndexFor=function(){return+this.calendarDayMoment.format("D")},a.prototype.selectGroupInstance=function(a){var b=this.getStaffById(a.staffMemberId),c={startTime:""+a.start,endTime:""+a.end,timeZone:this.calendarDayTimezone,staffMember:b,groupInstance:a};this.appointmentService.setSelectedTime(c),this.notifySlotSelected(a,b)},a.prototype.notifySlotSelected=function(a,c){this.$rootScope.$broadcast(this.CALENDAR_EVENTS.SLOT_SELECTED,new b(a.start,this.calendarDayTimezone,c))},a.prototype.getStaffById=function(a){return this.staff.staff.filter(function(b){return b.id===a})[0]},a.prototype.registerDateSelectionChanges=function(){var a=this;this.$rootScope.$on(this.CALENDAR_EVENTS.SLOT_SELECTED,function(b,c){a.calendarDay!==c.getTime().format(a.DateDefaults.DATE_FORMAT)&&(a.selectedInstance=void 0)}),this.$rootScope.$on(this.CALENDAR_EVENTS.GROUPS_DATA_FETCHED,function(){a.initialize()})},Object.defineProperty(a.prototype,"dayOfWeek",{get:function(){return this.calendarDayMoment.format("ddd").toLowerCase()},enumerable:!0,configurable:!0}),a}();angular.module("schedulerAngularClientAppInternal").directive("boostGroupsCalendarDay",function(){return{templateUrl:"modules/visitor/groups/groups-calendar-day.preload.html",controller:c,controllerAs:"groupsCalendarDay",bindToController:!0,restrict:"E",scope:{calendarDay:"=",calendarDayList:"=",calendarDayTimezone:"=",staff:"="}}})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a,b,c,d,e,f,g){var h=this;this.showTimezoneNote=!1,a.all([c.gettingBusinessInfo(),b.gettingUserTimezone()]).then(function(a){var b=a[0].timeZone,c=a[1].name;if(c!==b){var e="business"===g.boostTimezoneNote?b:c,i=d.timestampToLocaleMoment(moment().format("x"),e).format("Z");h.formattedMessage=f("calendar.displayed-time-timezone-formatted",{offset:i}),h.showTimezoneNote=!0}else h.formattedMessage="",h.showTimezoneNote=!1})}return a.$inject=["$q","timezoneSrv","businessInfoSrv","momentSrv","libs","$translate","$attrs"],a}();angular.module("schedulerAngularClientAppInternal").directive("boostTimezoneNote",function(){return{template:'<div class="timezone-note" data-hook="timezone-note" ng-if="timezoneNoteCtrl.showTimezoneNote">{{timezoneNoteCtrl.formattedMessage}}</div>',controller:a,controllerAs:"timezoneNoteCtrl",bindToController:!0,restrict:"A"}})}(b=a.common||(a.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h){this.routeManager=a,this.$route=b,this.postLoginNavigationSrv=c,this.serviceTypeNavigationSrv=d,this.widgetDeepLinkNavigationSrv=e,this.offeringPageNavigationSrv=f,this.memberAreaBookAnotherDeepLinkNavigationSrv=g,this.memberAreaRescheduleDeepLinkNavigationSrv=h,this.registerNavigationServices(),this.redirect()}return a.$inject=["routeManager","$route","postLoginNavigationSrv","serviceTypeNavigationSrv","widgetDeepLinkNavigationSrv","offeringPageNavigationSrv","memberAreaBookAnotherDeepLinkNavigationSrv","memberAreaRescheduleDeepLinkNavigationSrv"],a.prototype.registerNavigationServices=function(){this.serviceTypeNavigationSrv.init(this.$route.current.locals.servicesList,this.$route.current.locals.groupsList),this.navigationServices=[this.postLoginNavigationSrv,this.offeringPageNavigationSrv,this.widgetDeepLinkNavigationSrv,this.memberAreaBookAnotherDeepLinkNavigationSrv,this.memberAreaRescheduleDeepLinkNavigationSrv,this.serviceTypeNavigationSrv]},a.prototype.redirect=function(){return __awaiter(this,void 0,void 0,function(){var a,b;return __generator(this,function(c){switch(c.label){case 0:this.routeManager.suspendFocus=!0,a=0,c.label=1;case 1:return a<this.navigationServices.length?(b=this.navigationServices[a],[4,b.isRedirectRequired()]):[3,4];case 2:if(c.sent())return b.doRedirect(),[3,4];c.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},a}();a.ServiceTypePage=b,angular.module("schedulerAngularClientAppInternal").component("boostServiceTypePage",{template:"",controller:b,controllerAs:"vm"})}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a){this.$scope=a}return a.$inject=["$scope"],Object.defineProperty(a.prototype,"address",{get:function(){return this.resolveServiceAddress()},enumerable:!0,configurable:!0}),a.prototype.resolveServiceAddress=function(){return this.isServiceGivenRemotely()?this.serviceLocationText:this.isServiceGivenAtBusinessLocation()?this.isRemoteBusiness()?this.businessName:this.businessAddress:this.isServiceGivenAtCustomerPlace()?this.serviceLocationText:void 0},a.prototype.isRemoteBusiness=function(){return"ON_THE_GO"===this.businessLocation},a.prototype.isServiceGivenAtBusinessLocation=function(){return"BUSINESS"===this.serviceLocation},a.prototype.isServiceGivenRemotely=function(){return"OTHER"===this.serviceLocation},a.prototype.isServiceGivenAtCustomerPlace=function(){return"CUSTOMER"===this.serviceLocation},a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceAddress",{template:"{{$ctrl.address}}",controller:a,bindings:{serviceLocationText:"@sLocText",serviceLocation:"@sLoc",businessLocation:"@bLoc",businessName:"@bName",businessAddress:"@bAddr"}})}(b=a.components||(a.components={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];
for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.common.constants.Timezones,d=function(b){function d(a,c,d,e,f,g,h,i,j,k,l){var m=b.call(this,a,e)||this;return m.appointmentService=c,m.commonServices=d,m.timezoneSrv=f,m.businessInfoSrv=g,m.$q=h,m.routeManager=i,m.dynamicFormSrv=j,m.userManagementSrv=k,m.flowManagerSrv=l,m}return __extends(d,b),d.$inject=["wixBiLogger","appointmentService","commonServices","$rootScope","timezoneSrv","businessInfoSrv","$q","routeManager","dynamicFormSrv","userManagementSrv","flowManagerSrv"],d.prototype.init=function(){var b=this;this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CONTACT_INFO_SAVE_SUCCESS,function(a,c){return b.saveSuccessContactInfo(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.APPOINTMENT_BOOKED,function(a,c){return b.appointmentCreated(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CANCELLATION_POLICY,function(){return b.cancellationPolicy()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CHOOSE_TIME_SLOT,function(){return b.selectSlot()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOK_ANOTHER,function(){return b.bookAnother()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.GOOGLE_EXPORT,function(){return b.googleCalendar()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKIT,function(a,c){return b.bookIt(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKED_GROUP_BUT_NOT_PREMUIM,function(){return b.bookedGroupButNotPremium()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CAL_TODAY,function(){return b.todayClick()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.NEXT,function(a,c){return b.sendNext(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.SERVICE_TYPE_WELCOME_PAGE,function(a,c){return b.selectServiceType(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.SWITCH_SERVICE_TYPE,function(a,c){return b.switchServiceType(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CAL_MOVE,function(){return b.monthChangeClick()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.SERVICES_PAGE_OPENED,function(a,c){return b.servicesPageOpened(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER_POPUP_OPENED,function(){return b.staffMemberPopupOpenedFromTimeSlot()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CHOOSE_STAFF_MEMBER,function(){return b.staffMemberSelectedFromTimeSlot()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.CHANGE_STAFF_MEMBER_SELECTION,function(){return b.staffMemberSelectionChangedFromCalendar()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.LOG_TIMEZONE,function(){return b.logTimezone()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.PARTICIPANTS_AMOUNT_CHANGE,function(a,c){return b.logParticipantsAmountChanged(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.POPUP_CLOSED,function(a,c){return b.popupClosed(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_SWITCH,function(a,c){return b.timezoneSwitched(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.TIMEZONE_POPUP_OPENED,function(){return b.timezonePopupOpened()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.DEEP_LINK_CALENDAR_OPEN,function(a,c){return b.logDeepLinkCalendarOpened(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.LOGIN_CLICKED,function(){return b.logLoginClicked()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.GO_TO_ACCOUNT_MANAGEMENT,function(){return b.logGoToAccountManagement()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.LOGIN_COMPLETE,function(a,c){return b.logLoginComplete(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.POST_LOGIN_COMPLETE,function(a,c){return b.logPostLoginComplete(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKING_RESCHEDULE,function(a,c){return b.logBookingReschedule(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKING_RESCHEDULE_SUCCESS,function(a,c){return b.logBookingRescheduleSuccess(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.BOOKING_CANCEL,function(a,c){return b.logBookingCancel(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.ACCOUNT_MANAGEMENT_SECTION_SELECTION,function(a,c){return b.logAccountManagementSectionSelected(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.ACCOUNT_MANAGEMENT_SEE_SERVICES,function(a,c){return b.logAccountManagementHeaderBack(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.USER_INFO_SAVED,function(a,c){return b.logUserInfoSaved(c)}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.SIGNOUT_CLICKED,function(){return b.logSignoutClicked()}),this.$rootScope.$on(a.boost.visitor.bi.DispatchedEvents.USER_INFO_EDIT_CLICKED,function(){return b.logEditUserInfoClicked()})},d.prototype.todayClick=function(){this.logWithServiceType(this.wixBiLogger.events.CAL_TODAY,{})},d.prototype.bookIt=function(a){var b=this.getServiceId();this.logWithServiceType(this.wixBiLogger.events.BOOKIT,__assign({},a,{service_id:b,logged:this.userManagementSrv.isLoggedIn()}))},d.prototype.googleCalendar=function(){this.logWithServiceType(this.wixBiLogger.events.GOOGLE_EXPORT,{})},d.prototype.bookAnother=function(){this.logWithServiceType(this.wixBiLogger.events.BOOK_ANOTHER,{})},d.prototype.selectSlot=function(){var a=this.flowManagerSrv.isRescheduleFlow();this.logWithServiceType(this.wixBiLogger.events.CHOOSE_TIME_SLOT,{reschedule:a})},d.prototype.cancellationPolicy=function(){this.logWithServiceType(this.wixBiLogger.events.CANCELLATION_POLICY,{})},d.prototype.appointmentCreated=function(a){var b=this.userManagementSrv.isLoggedIn();this.logWithServiceType(this.wixBiLogger.events.APPOINTMENT_BOOKED,Object.assign({logged:b},this.getAppointmentDetailsForBi({messageEmptyNeeded:!1,paymentInfo:!0,paymentMethod:a})))},d.prototype.saveSuccessContactInfo=function(a){var b=a.dynamicForm,c=this.dynamicFormSrv.countRequiredFields(b);this.logWithServiceType(this.wixBiLogger.events.CONTACT_INFO_SAVE_SUCCESS,this.getAppointmentDetailsForBi({numberOfRequiredFields:c,messageEmptyNeeded:!0,paymentInfo:!1,paymentMethod:null}))},d.prototype.bookedGroupButNotPremium=function(){this.wixBiLogger.log(this.wixBiLogger.events.BOOKED_GROUP_BUT_NOT_PREMUIM)},d.prototype.sendNext=function(a){var b=a.referralInfo,c=a.dynamicForm,d=this.getSelectedService(),e=this.flowManagerSrv.isRescheduleFlow(),f={price_selection:this.getFreeLabel(d),referal_info:b,price:this.commonServices.decorateServicePriceForBi(d),depositAmount:this.commonServices.decorateServiceMinChargeForBi(d),currency:d.currency,catId:d.categoryId,serviceId:d.id,reschedule:e};c&&(f.numberOfRequiredFields=this.dynamicFormSrv.countRequiredFields(c)),this.logWithServiceType(this.wixBiLogger.events.NEXT,f)},d.prototype.selectServiceType=function(a){this.wixBiLogger.log(this.wixBiLogger.events.SERVICE_TYPE_WELCOME_PAGE,{type:a})},d.prototype.switchServiceType=function(a){this.wixBiLogger.log(this.wixBiLogger.events.SWITCH_SERVICE_TYPE,{switchToType:a})},d.prototype.monthChangeClick=function(){this.logWithServiceType(this.wixBiLogger.events.CAL_MOVE,{})},d.prototype.staffMemberPopupOpenedFromTimeSlot=function(){this.wixBiLogger.log(this.wixBiLogger.events.CHOOSE_STAFF_MEMBER_POPUP_OPENED)},d.prototype.staffMemberSelectedFromTimeSlot=function(){this.wixBiLogger.log(this.wixBiLogger.events.CHOOSE_STAFF_MEMBER)},d.prototype.staffMemberSelectionChangedFromCalendar=function(){this.wixBiLogger.log(this.wixBiLogger.events.CHANGE_STAFF_MEMBER_SELECTION)},d.prototype.logParticipantsAmountChanged=function(a){this.wixBiLogger.log(this.wixBiLogger.events.PARTICIPANTS_AMOUNT_CHANGE,{numParticipants:a})},d.prototype.getFreeLabel=function(a){return a&&a.isFree?"price_free":"price_paid"},d.prototype.getAppointmentDetailsForBi=function(a){var b=this,c=a.messageEmptyNeeded,d=void 0===c?!0:c,e=a.paymentInfo,f=void 0===e?!1:e,g=a.depositAmountNeeded,h=void 0===g?!0:g,i=a.numberOfRequiredFields,j=void 0===i?void 0:i,k=a.paymentMethod,l=this.getSelectedService(),m=this.getContactInfo(),n={catId:l.categoryId,currency:l.currency,price:this.commonServices.decorateServicePriceForBi(l),price_selection:this.getFreeLabel(l),serviceId:l.id,type:l.type,numParticipants:l.numberOfParticipants||1};return d&&(n.message_empty=function(){return b.isEmpatyString(m)}),h&&(n.depositAmount=this.commonServices.decorateServiceMinChargeForBi(l)),f&&(n.paymentMethod=k),"undefined"!=typeof j&&(n.numberOfRequiredFields=j),n},d.prototype.getServiceId=function(){return this.getSelectedService().id},d.prototype.getServiceType=function(){return this.getSelectedService().type},d.prototype.getSelectedService=function(){return this.appointmentService.getSelectedService()||{}},d.prototype.getContactInfo=function(){return this.appointmentService.getContactInfo()||{}},d.prototype.logWithServiceType=function(a,b){b.type=this.getServiceType(),this.wixBiLogger.log(a,b)},d.prototype.servicesPageOpened=function(a){var b={type:a};this.wixBiLogger.log(this.wixBiLogger.events.SERVICES_PAGE_OPENED,b)},d.prototype.logTimezone=function(){var a=this;this.$q.all([this.timezoneSrv.gettingUserTimezone(),this.businessInfoSrv.gettingBusinessInfo()]).then(function(b){var c={ownerTimeZone:b[1].timeZone,ownerOffset:b[1].timeZoneOffset,visitorTimeZone:b[0].name,visitorOffset:b[0].offset};a.wixBiLogger.log(a.wixBiLogger.events.LOG_TIMEZONE,c)})},d.prototype.popupClosed=function(a){this.wixBiLogger.log(this.wixBiLogger.events.SYS_MSG_CLOSE,{referal_info:a})},d.prototype.timezoneSwitched=function(a){var b=a===c.BUSINESS?"business time zone":"local";this.wixBiLogger.log(this.wixBiLogger.events.TIMEZONE_SWITCH,{changeTo:b})},d.prototype.timezonePopupOpened=function(){this.wixBiLogger.log(this.wixBiLogger.events.TIMEZONE_POPUP_OPENED)},d.prototype.logDeepLinkCalendarOpened=function(a){this.wixBiLogger.log(this.wixBiLogger.events.DEEP_LINK_CALENDAR_OPEN,a)},d.prototype.logLoginClicked=function(){var a={pageName:this.routeManager.getCurrentPagePartialPath()};this.wixBiLogger.log(this.wixBiLogger.events.LOGIN_CLICKED,a)},d.prototype.logLoginComplete=function(a){var b={pageName:this.routeManager.getCurrentPagePartialPath()};this.wixBiLogger.log(this.wixBiLogger.events.LOGIN_COMPLETE,Object.assign(b,a))},d.prototype.logPostLoginComplete=function(a){this.wixBiLogger.log(this.wixBiLogger.events.POST_LOGIN_COMPLETE,a)},d.prototype.logGoToAccountManagement=function(){var a={pageName:this.routeManager.getCurrentPagePartialPath()};this.wixBiLogger.log(this.wixBiLogger.events.GO_TO_ACCOUNT_MANAGEMENT,a)},d.prototype.logBookingReschedule=function(a){this.logRescheduleBookingBase(a,this.wixBiLogger.events.BOOKING_RESCHEDULE)},d.prototype.logBookingRescheduleSuccess=function(a){this.logRescheduleBookingBase(a,this.wixBiLogger.events.BOOKING_RESCHEDULE_SUCCESS)},d.prototype.logRescheduleBookingBase=function(a,b){var c={appointmentId:a.bookingId,serviceId:a.offeringDetails.id};this.wixBiLogger.log(b,c)},d.prototype.logBookingCancel=function(a){var b={appointmentId:a.booking.bookingId,serviceId:a.booking.offeringDetails.id,confirmation:a.confirmation};this.wixBiLogger.log(this.wixBiLogger.events.BOOKING_CANCEL,b)},d.prototype.logAccountManagementSectionSelected=function(a){this.wixBiLogger.log(this.wixBiLogger.events.ACCOUNT_MANAGEMENT_SECTION_SELECTION,a)},d.prototype.logAccountManagementHeaderBack=function(a){this.wixBiLogger.log(this.wixBiLogger.events.ACCOUNT_MANAGEMENT_SEE_SERVICES,a)},d.prototype.logUserInfoSaved=function(a){var b=a.newUserInfo,c=a.currentUserInfo;this.wixBiLogger.log(this.wixBiLogger.events.USER_INFO_SAVED,{phoneChanged:b.phoneNumber!==c.phoneNumber,nameChanged:b.fullName!==c.fullName})},d.prototype.logSignoutClicked=function(){var a={pageName:this.routeManager.getCurrentPagePartialPath()};this.wixBiLogger.log(this.wixBiLogger.events.SIGNOUT_CLICKED,a)},d.prototype.logEditUserInfoClicked=function(){this.wixBiLogger.log(this.wixBiLogger.events.USER_INFO_EDIT_CLICKED)},d}(BILogger);b.VisitorBiListenerSrv=d,angular.module("schedulerAngularClientAppInternal").service("visitorBiListener",d)}(c=b.bi||(b.bi={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var b=function(a){function b(b,c){var d=a.call(this,b,c)||this;return d.tileTemplate=b.getGroupListTemplate(),d.tileConfig=b.getGroupsTileConfig(),d.columnsAmount=b.getNumberOfColumns(d.tileTemplate,b.getGroupsCategoryLayoutType()),d.serviceItemClass=d.mapColumnsAmountToClass(),d}return __extends(b,a),b.$inject=["appSettings","SERVICE_CATEGORY_LAYOUT"],b}(a.ServicesList);angular.module("schedulerAngularClientAppInternal").component("boostGroupsList",{templateUrl:"modules/groups/components/groups-list.preload.html",bindings:{groups:"=",category:"="},controller:b})}(b=a.classes||(a.classes={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.$timeout=a,this.$element=b,this.cacheSrv=c,this.setFocusOnSelectedTab()}return a.$inject=["$timeout","$element","cacheSrv"],a.prototype.setFocusOnSelectedTab=function(){var a=this,b=this.cacheSrv.getFromCache("shouldShowFocus");b&&(this.$timeout(function(){a.$element.find(".tab--selected").focus()}),this.cacheSrv.setToCache("shouldShowFocus",!1))},a.prototype.selectTab=function(a){this.cacheSrv.setToCache("shouldShowFocus",!0),this.onTabSelectedCallback({value:a.value})},a.prototype.isSelected=function(a){return this.selectedValue===a.value},a.prototype.accessibilityFocusTabIndex=function(a){return this.isSelected(a)?0:-1},a}();b.SELECTED_CLASS="tab--selected",a.TabsController=b,angular.module("schedulerAngularClientAppInternal").component("boostTabs",{templateUrl:"modules/common/components/boost-tabs.preload.html",controller:b,bindings:{list:"=",onTabSelectedCallback:"&onTabSelected",selectedValue:"=",descending:"="}})}(b=a.components||(a.components={}))}(b=a.common||(a.common={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a,b,c,d,e){this.routeManager=a,this.visitorBILogger=b,this.clientPages=c,this.ServiceTypes=d,this.TABS_ORDER=e,this.tabs=[{order:1,value:d.INDIVIDUAL,defaultTextKey:"visitor.service-types.services",settingsTextKey:"textTitleIndividualService"},{order:2,value:d.GROUP,defaultTextKey:"visitor.service-types.groups",settingsTextKey:"textTitleGroupService"}]}return a.$inject=["routeManager","visitorBILogger","clientPages","ServiceTypes","TABS_ORDER"],a.prototype.onTabSelected=function(a){if(a!==this.current){var b=a===this.ServiceTypes.INDIVIDUAL;this.visitorBILogger.switchServiceType(b?this.ServiceTypes.INDIVIDUAL:this.ServiceTypes.GROUP),this.routeManager.suspendFocus=!0,this.routeManager.gotoPage(b?this.clientPages.VISITOR_SERVICES:this.clientPages.VISITOR_GROUPS)}},a.prototype.isInDescendingOrder=function(){return this.firstServiceType!==this.TABS_ORDER.INDIVIDUAL_FIRST},a}();angular.module("schedulerAngularClientAppInternal").component("boostServiceTypeTabs",{templateUrl:"modules/common/components/service-type-tabs/service-type-tabs.preload.html",controller:a,bindings:{current:"@",firstServiceType:"="}})}(b=a.components||(a.components={}))}(b=a.common||(a.common={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},UpfrontPaymentController=function(){function a(a,b,c,d){this.$filter=a,this.$translate=b,this.paymentService=c,this.$scope=d,this.init()}return a.$inject=["$filter","$translate","paymentService","$scope"],a.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var a,b,c=this;return __generator(this,function(d){switch(d.label){case 0:return this.quantity=angular.isDefined(this.quantity)?this.quantity:1,a=this,this.isConfirmation?(b=this.paymentService.isPaidOnline(this.minCharge),[3,3]):[3,1];case 1:return[4,this.paymentService.hasUpfrontPayment(this.minCharge)];case 2:b=d.sent(),d.label=3;case 3:return a.isUpfrontPaymentPresent=b,this.isUpfrontPaymentPresent&&(this.populateDisplayText(),this.$scope.$watch(function(){return c.quantity},function(){return c.populateDisplayText()})),[2]}})})},a.prototype.populateDisplayText=function(){var a=this.minCharge*this.quantity,b=this.$filter("isoCurrency")(a,this.currency),c=this.isConfirmation?"visitor.congratulations.upfront-payment-text":"sidebar.upfront-payment-text-secondary";this.displayText=this.$translate(c,{minCharge:b})},a.prototype.getText=function(){return this.displayText},a}();angular.module("schedulerAngularClientAppInternal").component("boostUpfrontPayment",{templateUrl:"modules/common/components/upfront-payment.preload.html",controller:UpfrontPaymentController,controllerAs:"upCtrl",bindings:{minCharge:"=",currency:"=",isConfirmation:"=",quantity:"=?"}});var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.visitor.booking.BOOKING_CONFLICT,d=function(){function a(){}return a}();d.INDIVIDUAL="INDIVIDUAL",d.GROUP="GROUP",b.BiOfferingTypes=d;var e=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){this.contactInfoSrv=a,this.wixSdkUtil=b,this.visitorBILogger=c,this.routeManager=d,this.clientPages=e,this.$scope=f,this.$route=g,this.appointmentService=h,this.processBookingSrv=i,this.$filter=j,this.paymentService=k,this.fedopsLogger=l,this.submittedInvalid=!1,this.isPossessing=!1}return a.$inject=["contactInfoSrv","wixSdkUtil","visitorBILogger","routeManager","clientPages","$scope","$route","appointmentService","processBookingSrv","$filter","paymentService","fedopsLogger"],a.prototype.doNext=function(a){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return this.fedopsLogger.interactionStarted("submit-contact-info-form"),this.savedOnNext=!1,this.submittedInvalid=a.$invalid,this.wixSdkUtil.resetHeight(),this.visitorBILogger.sendNext("contact_info",this.dynamicFormData),a.$invalid||(this.contactInfoSrv.setContactInfo(this.contactInfo,this.dynamicFormData),this.appointmentService.persist(this.selectedService),this.savedOnNext=!0,this.visitorBILogger.saveSuccessContactInfo(this.dynamicFormData),this.proceed()),[2,!a.$invalid]})})},a.prototype.proceed=function(){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(b){switch(b.label){case 0:this.preventConsecutiveBooking(),b.label=1;case 1:return b.trys.push([1,5,,6]),[4,this.contactInfoSrv.updatingLoggedUserDetails(this.contactInfo)];case 2:return b.sent(),this.fedopsLogger.interactionEnded("submit-contact-info-form"),[4,this.processBookingSrv.execute(this.businessInfo)];case 3:return b.sent(),[4,this.goToFlowEnd()];case 4:return b.sent(),[3,6];case 5:return a=b.sent(),this.errorCallback(a),[3,6];case 6:return[2]}})})},a.prototype.isNextActionAllowed=function(a){return a.$valid&&!this.isPossessing},a.prototype.getLoggedUser=function(){return this.contactInfoSrv.getLoggedInUser()},a.prototype.getTimezone=function(){return this.timezone},Object.defineProperty(a.prototype,"numOfStaff",{get:function(){return this.staff?this.staff.staff.length:0},enumerable:!0,configurable:!0}),a.prototype.onParticipantsAmountChanged=function(a,b){var c=this;this.preventConsecutiveBooking(),this.contactInfoSrv.updateNumberOfParticipants(a,this.selectedService,this.baseServicePrice,b).then(function(){c.isPossessing=!1})},a.prototype.showAddressContainer=function(){return this.viewParams.hasAddress},a.prototype.$onInit=function(){this.businessInfo=this.$route.current.locals.businessInfo,this.dynamicFormData=this.$route.current.locals.dynamicFormData,this.paymentService.setBusinessInfo(this.businessInfo),this.saveContactOnPageChange(),this.preventConsecutiveBooking(),this.isPossessing=!1,this.selectedService=this.contactInfoSrv.getSelectedService(),this.baseServicePrice=this.selectedService.price,this.isAddressNeeded=this.contactInfoSrv.isAddressNeeded(this.selectedService),this.contactInfo=this.contactInfoSrv.getContactInfo(),this.staff=this.$route.current.locals.staff,this.timezone=this.$route.current.locals.timezone,this.initViewParams()},a.prototype.getTitle=function(){return this.dynamicFormData.form.header.title?this.dynamicFormData.form.header.title:this.$filter("wixSdkTranslate")("visitor.contact-info.title",this.viewParams.titleKey)},a.prototype.getDescription=function(){return this.dynamicFormData.form.header.isDescriptionHidden?void 0:this.dynamicFormData.form.header.description},a.prototype.errorCallback=function(a){this.isPossessing=!1,this.showErrorKey=null,a===c&&(this.showErrorKey="visitor.confirmation.error.already-booked"),this.showError=null!==this.showErrorKey},a.prototype.saveContactOnPageChange=function(){var a=this;this.$scope.$on("$destroy",function(){a.savedOnNext||a.contactInfoSrv.setContactInfo(a.contactInfo,a.dynamicFormData)})},a.prototype.preventConsecutiveBooking=function(){this.isPossessing=!0},a.prototype.onlinePaymentLabel=function(){return this.dynamicFormData.form.actions.onlinePaymentLabel},a.prototype.offlinePaymentLabel=function(){return this.dynamicFormData.form.actions.offlinePaymentLabel},a}();e.templateUrl="modules/desktop/contact-info-form/common/contact-info-page.preload.html",b.BaseContactInfoController=e}(c=b.contact||(b.contact={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(b){function c(a,c,d,e,f,g,h,i,j,k,l,m){var n=b.call(this,a,f,g,d,e,h,c,i,j,k,l,m)||this;return n.contactInfoSrv=a,n.routeManager=d,n.clientPages=e,n.fedopsLogger=m,n}return __extends(c,b),c.$inject=["contactInfoSrv","$route","routeManager","clientPages","wixSdkUtil","visitorBILogger","$scope","appointmentService","processBookingSrv","$filter","paymentService","fedopsLogger"],c.prototype.doBack=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR)},c.prototype.goToFlowEnd=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONGRATS)},c.prototype.initViewParams=function(){this.viewParams={hasAddress:this.isAddressNeeded,maxParticipants:1,messageKey:"textContactInfoMessage",titleKey:"textContactInfo"}},c.prototype.getBiOfferingType=function(){return a.BiOfferingTypes.INDIVIDUAL},c}(a.BaseContactInfoController);a.IndividualsContactInfoPage=b,angular.module("schedulerAngularClientAppInternal").component("bksIndividualsContactInfoPage",{templateUrl:a.BaseContactInfoController.templateUrl,controller:b})}(b=a.contact||(a.contact={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b,c=function(b){function c(a,c,d,e,f,g,h,i,j,k,l,m){var n=b.call(this,a,f,g,d,e,h,c,i,j,k,l,m)||this;return n.contactInfoSrv=a,n.routeManager=d,n.clientPages=e,n.paymentService=l,n.fedopsLogger=m,n}return __extends(c,b),c.$inject=["contactInfoSrv","$route","routeManager","clientPages","wixSdkUtil","visitorBILogger","$scope","appointmentService","processBookingSrv","$filter","paymentService","fedopsLogger"],c.prototype.goToFlowEnd=function(){this.routeManager.gotoPage(this.clientPages.GROUPS_VISITOR_CONGRATS)},c.prototype.doBack=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR)},c.prototype.initViewParams=function(){this.viewParams={hasAddress:!1,maxParticipants:this.contactInfoSrv.getMaxParticipants(this.selectedService),messageKey:"textContactInfoMessageGroups",titleKey:"textContactInfoGroups"}},c.prototype.getBiOfferingType=function(){return a.BiOfferingTypes.GROUP},c}(a.BaseContactInfoController);!function(b){var d;!function(b){var d;!function(b){var d;!function(){angular.module("schedulerAngularClientAppInternal").component("bksGroupsContactInfoPage",{templateUrl:a.BaseContactInfoController.templateUrl,controller:c})}(d=b.pages||(b.pages={}))}(d=b.visitor||(b.visitor={}))}(d=b.boost||(b.boost={}))}(b||(b={}))}(b=a.contact||(a.contact={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.visitor.offerings.OfferingTypes,d=function(){function b(a,b,c,d,e,f,g,h,i,j){this.appointmentService=a,this.userManagementSrv=b,this.servicesSrv=c,this.visitorBILogger=d,this.$rootScope=e,this.paymentService=f,this.modal=g,this.wixSdkUtil=h,this.dynamicFormSrv=i,this.$q=j}return b.$inject=["appointmentService","userManagementSrv","servicesSrv","visitorBILogger","$rootScope","paymentService","modal","wixSdkUtil","dynamicFormSrv","$q"],b.prototype.getSelectedService=function(){return this.initObj(this.appointmentService.getSelectedService())},b.prototype.getContactInfo=function(){return this.initObj(this.appointmentService.getContactInfo())},b.prototype.setContactInfo=function(a,b){this.setDynamicFormData(a,b),this.dynamicFormSrv.enrichContactInfoWithFormData(a,b),this.appointmentService.setContactInfo(a)},b.prototype.getLoggedInUser=function(){return this.initObj(this.userManagementSrv.getCurrentSiteMember())},b.prototype.setDynamicFormData=function(a,b){a.dynamicFormData=b},b.prototype.getDynamicFormData=function(a){return a.dynamicFormData},b.prototype.updatingLoggedUserDetails=function(a){if(this.userManagementSrv.isSiteOwner())return this.modal.openOwnerIsLoggedIn(),this.$q.reject({});var b=this.getLoggedInUser();return this.isLoggedUserNeedsToBeUpdated(b,a)?(b.fullName=a.name,b.phoneNumber=a.phone,this.userManagementSrv.updatingSiteMember(b)):this.$q.when({})},b.prototype.isAddressNeeded=function(a){return this.servicesSrv.requireAddress(a)},b.prototype.getMaxParticipants=function(a){var b=this.initObj(this.appointmentService.getSelectedTime());return a.type===c.INDIVIDUAL?1:Math.min(a.maxParticipantsPerOrder,b.groupInstance.capacity-b.groupInstance.registered)||1},b.prototype.updateNumberOfParticipants=function(a,b,c,d){return this.updateGroupWithQuantity(a,b,c),this.visitorBILogger.logParticipantsAmountChanged(a),this.notifyQuantityUpdated(b,d)},b.prototype.gettingBookingsDynamicForm=function(){var a=this.appointmentService.getSelectedService(),b=this.appointmentService.getSelectedTime(),d={offeringType:a.type,offeringId:a.id,isDummyOffering:!!a.dummy};a.type===c.GROUP&&(d.offeringInstanceId=b.groupInstance.id,d.isDummyOffering=d.isDummyOffering||!!b.groupInstance.dummy),this.populateLegacyLabels(d,a);var e=this.getContactInfo(),f=this.getLoggedInUser();return this.dynamicFormSrv.gettingBookingsDynamicForm(d,e,f)},b.prototype.populateLegacyLabels=function(a,b){var d=b.type===c.GROUP?"Groups":"";a.legacyLabels={onlinePayment:this.wixSdkUtil.getTextForModel("textPayNowLabel"+d),offlinePayment:this.wixSdkUtil.getTextForModel("textBookNowLabel"+d),message:this.wixSdkUtil.getTextForModel("textContactInfoMessage"+d)}},b.prototype.updateGroupWithQuantity=function(a,b,c){Object.assign(b,{numberOfParticipants:a,price:this.totalPrice(a,c)}),this.appointmentService.persist(b)},b.prototype.totalPrice=function(a,b){return b*a},b.prototype.notifyQuantityUpdated=function(b,c){return c&&this.$rootScope.$broadcast(a.boost.visitor.VisitorSidebar.EVENTS.SERVICE_UPDATED,b),this.$q.resolve()},b.prototype.isLoggedUserNeedsToBeUpdated=function(a,b){return a.email&&(a.fullName!==b.name||a.phoneNumber!==b.phone)},b.prototype.initObj=function(a){return a?a:{}},b}();b.ContactInfoSrv=d,angular.module("schedulerAngularClientAppInternal").service("contactInfoSrv",d)}(c=b.contact||(b.contact={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.form.DynamicFormFieldTypes,d=function(){function a(){this.submittedInvalid=!1,this.attendeesAmountOptions=this.generateAttendeesAmountOptions(),this.contactInfo.name=this.contactInfo.name||this.loggedInUser.fullName,this.contactInfo.phone=this.contactInfo.phone||this.loggedInUser.phoneNumber,this.contactInfo.email=this.contactInfo.email||this.loggedInUser.email
}return a.prototype.isEmailEditForbidden=function(){return!!this.loggedInUser.email},a.prototype.showAddressContainer=function(){return this.viewParams.hasAddress},a.prototype.showMaxParticipantsDropdown=function(){return this.viewParams.maxParticipants&&this.viewParams.maxParticipants>1},a.prototype.onChangeNumOfParticipants=function(a){this.onParticipantsAmountChanged({numOfParticipants:a})},a.prototype.onAttributeChanged=function(a){a.fieldType===c.NUM_OF_PARTICIPANTS&&this.onChangeNumOfParticipants(a.value)},Object.defineProperty(a.prototype,"messageKey",{get:function(){return this.viewParams.messageKey},enumerable:!0,configurable:!0}),a.prototype.generateAttendeesAmountOptions=function(){return Array.from(Array(this.viewParams.maxParticipants).keys()).map(function(a){return a++,{label:""+a,value:a}})},a}();b.ContactInfoFormComponent=d,angular.module("schedulerAngularClientAppInternal").component("bksContactInfoForm",{templateUrl:"modules/desktop/contact-info-form/contact-info-form.preload.html",controller:d,bindings:{contactInfo:"=",loggedInUser:"=",viewParams:"=",dynamicFormData:"=",onParticipantsAmountChanged:"&"}})}(c=b.contact||(b.contact={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=a.call(this,b,f,g,d,e,h,c,i,j,k,l,o)||this;return p.contactInfoSrv=b,p.flowManagerSrv=m,p.offeringSettingKeysGetterSrv=n,p}return __extends(b,a),b.$inject=["contactInfoSrv","$route","routeManager","clientPages","wixSdkUtil","visitorBILogger","$scope","appointmentService","processBookingSrv","$filter","paymentService","flowManagerSrv","offeringSettingKeysGetterSrv","fedopsLogger"],b.prototype.doBack=function(){this.flowManagerSrv.prev()},b.prototype.goToFlowEnd=function(){this.flowManagerSrv.next()},b.prototype.initViewParams=function(){var a=this.offeringSettingKeysGetterSrv.getKeys().contactInfo;this.viewParams={messageKey:a.text.message,titleKey:a.text.title}},b.prototype.getBiOfferingType=function(){return this.selectedService.type},b}(a.BaseContactInfoController);a.ContactInfoPage=b,angular.module("schedulerAngularClientAppInternal").component("bksContactInfoPage",{templateUrl:a.BaseContactInfoController.templateUrl,controller:b})}(b=a.contact||(a.contact={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var focusOn=wix.bookings.accessibility.focusOn,StaffPickerComponent=function(){function a(a,b,c,d,e){this.$scope=a,this.visitorBILogger=b,this.$element=c,this.$timeout=d,this.$rootScope=e,this.staffStatus=this.staffStatus||new Map,this.resetSelectedIndexIfDataSourceChanges(),this.visitorBILogger.staffMemberPopupOpenedFromTimeSlot(),this.staffMemberNameSelector='[data-hook="staff-member-name"]',this.registerCloseEvent()}return a.$inject=["$scope","visitorBILogger","$element","$timeout","$rootScope"],a.prototype.registerCloseEvent=function(){var a=this,b=function(c){a.isEscapeKey(c)&&(a.close(),$("body").unbind("keyup",b))};$("body").bind("keyup",b)},a.prototype.isEscapeKey=function(a){return 27===a.which},a.prototype.$postLink=function(){var a=this;this.$timeout(function(){return focusOn(a.$element.find(a.staffMemberNameSelector).first())})},a.prototype.selectStaffMember=function(a,b,c){if(a.preventDefault(),!this.isFull(c)){this.selectedStaffIndex=b;var d=c.id;this.onStaffSelected({staffMemberId:d}),this.notifyStaffSelected(),this.close()}},a.prototype.notifyStaffSelected=function(){this.$rootScope.$broadcast(a.STAFF_SELECTED)},a.prototype.close=function(){this.$timeout(function(){return $("body").click()})},a.prototype.isFull=function(a){var b=this.staffStatus.get(a.id);return b&&b.isFull},a.prototype.resetSelectedIndexIfDataSourceChanges=function(){var a=this;this.$scope.$watch(function(){return a.staff},function(){a.selectedStaffIndex=-1})},a}();StaffPickerComponent.STAFF_SELECTED="STAFF_SELECTED",angular.module("schedulerAngularClientAppInternal").component("boostStaffPicker",{templateUrl:"modules/components/staff-picker/staff-picker.preload.html",controller:StaffPickerComponent,bindings:{staff:"=",staffStatus:"=?",onStaffSelected:"&"}});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.$element=a,this.$timeout=b}return a.$inject=["$element","$timeout"],a.prototype.$onInit=function(){this.items=this.itemsInput.slice(),this.setDefaultAndNotify()},a.prototype.setDefaultAndNotify=function(){var a=!this.defaultOptionLabel&&!this.selectedItem&&this.items.length;this.initDefaultOption(),!this.selectedItem&&this.items.length&&(this.selectedItem=this.items[0]),a&&this.selectItem(this.selectedItem)},a.prototype.initDefaultOption=function(){if(this.defaultOptionLabel){var a={value:"",label:this.defaultOptionLabel};this.items.unshift(a)}},a.prototype.onSelect=function(a){this.selectItem(a),this.$element.find('[data-hook="dropdown_button"]').focus()},a.prototype.selectItem=function(a){this.selectedItem=a,this.onSelectCallback({value:a.value})},a.prototype.onToggle=function(a){var b=this;this.isOpen=a,this.onToggleCallBack({open:a}),a&&this.$timeout(function(){return b.$element.find(".dropdown-menu__item").first().focus()})},a.prototype.onKeyPress=function(a,b){var c=a.which,d=13,e=32;(c===d||c===e)&&(this.onSelect(b),c===e&&this.onToggle(!1))},a}();a.Dropdown=b,angular.module("schedulerAngularClientAppInternal").component("boostDropdown",{template:'\n        <div class="dropdown" ng-class="$ctrl.customClass" dropdown dropdown-append-to-body on-toggle="$ctrl.onToggle(open)" data-hook="dropdown" is-open="$ctrl.isOpen">\n            <button class="button btn btn-default dropdown__button" ng-class="{\'dropdown__button--open\': $ctrl.isOpen}" dropdown-toggle ng-disabled="disabled" role="button" data-hook="dropdown_button" tabindex="0">\n              <span class="dropdown__label" data-hook="dropdown-select-label" data-value="{{$ctrl.selectedItem.value}}" aria-label="{{\'dropdown.accessibility.selected\' | translate: {item: $ctrl.selectedItem.label} }}">{{$ctrl.selectedItem.label}}</span>\n              <span class="dropdown__caret scheduler-svg-font-icons-groups-calendar-week-prev" aria-hidden="true"></span>\n            </button>\n             <div data-hook="dropdown-menu-content" class="dropdown-menu" boost-scrollbar="{{$ctrl.scrollbarType || \'dark-3\'}}"  boost-scrollbar-amount="25" boost-scrollbar-inertia="600" role="presentation" tabindex="-1">\n                <ul class="dropdown-menu__content" role="menu"> \n                    <li class="dropdown-menu__item" ng-repeat="item in $ctrl.items" id="ddl-{{$index}}" data-hook="dropdown-item" data-value="{{item.value}}" ng-click="$ctrl.onSelect(item)" aria-label="{{item.label}}" with-vertical-navigation ng-keydown="$ctrl.onKeyPress($event, item)" role="menuitem" tabindex="-1">{{item.label}}</li>\n                </ul>\n             </div>\n        </div>\n         ',controller:b,bindings:{itemsInput:"=items",onSelectCallback:"&onSelect",defaultOptionLabel:"@",onToggleCallBack:"&onToggle",scrollbarType:"@?",customClass:"@",selectedItem:"=?"}})}(b=a.components||(a.components={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var VisitorStaffSrv=function(){function a(a,b,c,d,e,f,g){this.visitorApi=a,this.experimentsEnabler=b,this.appointmentService=c,this.$q=d,this.boostInjectionPersister=e,this.overEditor=f,this.ServiceTypes=g}return a.$inject=["visitorApi","experimentsEnabler","appointmentService","$q","boostInjectionPersister","overEditor","ServiceTypes"],a.prototype.gettingStaffMembers=function(){var a=this;return this.gettingRealStaffMembers().then(function(b){return a.overEditor.enrichStaffIfOverEditor(b),b})},a.prototype.gettingRealStaffMembers=function(){var a=this.boostInjectionPersister.getStaff();return a?this.$q.when(a):this.visitorApi.gettingStaffMembers()},a.prototype.getStaffListByIds=function(a,b){var c=[];return a&&b.staff&&b.staff.length&&(c=this.getStaffListByStaffMap(a,this.createId2StaffMemberMap(b))),c},a.prototype.createId2StaffMemberMap=function(a){var b={};return a.staff.forEach(function(a){b[a.id]=a}),b},a.prototype.getStaffListByStaffMap=function(a,b){var c=[];return a.forEach(function(a){c.push(b[a])}),c},a.prototype.getCapableStaff=function(){var a=this;return this.gettingStaffMembers().then(function(b){return a.getCapableStaffByStaff(b)})},a.prototype.getCapableStaffByStaff=function(a){var b,c=this.appointmentService.getSelectedService();return b=c?c.dummy?a.staff.map(function(a){return a.id}):this.getValidStaffIdsForService(c):[],this.getStaffListByIds(b,a)},a.prototype.getValidStaffIdsForService=function(a){return a.type===this.ServiceTypes.GROUP?this.getStaffIdsForGroup(a):this.getStaffIdsForIndividualService(a)},a.prototype.getStaffIdsForGroup=function(a){for(var b=["mon","tue","wed","thu","fri","sat","sun"],c={},d=0;d<b.length;d++)a.classHours&&a.classHours[b[d]]&&a.classHours[b[d]].workingHours.forEach(function(a){a.staffId&&(c[a.staffId]=!0)});return Object.keys(c)},a.prototype.getStaffIdsForIndividualService=function(a){return a.staffMembers||[]},a}();angular.module("schedulerAngularClientAppInternal").service("visitorStaffSrv",VisitorStaffSrv),function(){function a(a){var b=a.$parent.$parent.$parent,c=b.staff,d=b.staffStatus,e=b.onStaffSelected;a.staff=c,a.staffStatus=d,a.onStaffSelected=function(a){return e({staffMemberId:a})}}function b(){return{restrict:"EA",replace:!0,controller:a,controllerAs:"staffPickerTooltipPopupCtrl",scope:{title:"@",content:"@",placement:"@",animation:"&"},template:'<div class="staff-member-popover popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }" data-hook="staff-member-popover">\n         <div class="popover-inner" boost-scrollbar="default" boost-scrollbar-amount="25" boost-scrollbar-inertia="600" ><boost-staff-picker staff="staff" on-staff-selected="onStaffSelected(staffMemberId)" staff-status="staffStatus"></boost-staff-picker></div>\n         </div>'}}a.$inject=["$scope"],angular.module("schedulerAngularClientAppInternal").directive("boostStaffPickerTooltipPopup",b).directive("boostStaffPickerTooltip",["$tooltip","$timeout",function(a,b){var c=a("boostStaffPickerTooltip","boostStaffPickerTooltip","staff-member-selection.open");c.scope={staff:"=",staffStatus:"=?",onStaffSelected:"&",onTooltipClose:"&",staffMemberSelectionOpen:"="};var d=c.compile();return{restrict:"A",scope:c.scope,link:function(a,c,e){function f(d,e){void 0===e&&(e=!1),b(function(){c.trigger(d),e&&a.onTooltipClose()})}function g(){i.off("click",g),f("staff-member-selection.close",!0)}function h(){i.click(g)}d.call(null,a,c,e);var i=angular.element("body");a.$watch("staffMemberSelectionOpen",function(a){angular.isDefined(a)&&(a?(f("staff-member-selection.open"),b(h)):g())})}}}])}();var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.pages.CongratulationsController,d=function(a){function b(b,c,d,e,f,g,h,i,j,k,l){var m=a.call(this,b,c,d,e,f,h,i,j,k,l)||this;return m.messageKeys={translate:"visitor.congratulations.message",settings:"textCongrads"},m.instructionsKeys={translate:"visitor.congratulations.instructions",settings:"textCongradsNotes"},m.googleKeys={translate:"visitor.groups.congratulations.export",settings:"textCongradsGoogle"},m.bookAnotherKeys={translate:"visitor.congratulations.bookanother",settings:"textCongradsBookAnother"},m.bookAnotherPage=g.VISITOR_SERVICES,m.type="individual",m}return __extends(b,a),b.$inject=["$window","$q","appointmentService","servicesSrv","routeManager","clientPages","visitorBILogger","$route","cacheSrv","$translate","paymentService"],b}(c);b.IndividualCongratulationsController=d,angular.module("schedulerAngularClientAppInternal").controller("IndividualCongratulationsController",d),angular.module("schedulerAngularClientAppInternal").component("boostIndividualCongratulationsPage",{templateUrl:["appConfig",function(a){return c.getTemplateUrl(a.getIsMobile())}],controller:d})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.boost.visitor.pages.CongratulationsController,d=function(a){function b(b,c,d,e,f,g,h,i,j,k,l){var m=a.call(this,b,c,d,e,f,h,i,j,k,l)||this;return m.messageKeys={translate:"visitor.groups.congratulations.message",settings:"textCongradsGroups"},m.instructionsKeys={translate:"visitor.groups.congratulations.instructions",settings:"textCongradsNotesGroups"},m.googleKeys={translate:"visitor.groups.congratulations.export",settings:"textCongradsGoogleGroups"},m.bookAnotherKeys={translate:"visitor.groups.congratulations.bookanother",settings:"textCongradsBookAnotherGroups"},m.bookAnotherPage=g.VISITOR_GROUPS,m.participantsVisibility=!0,m.type="groups",m}return __extends(b,a),b.$inject=["$window","$q","appointmentService","servicesSrv","routeManager","clientPages","visitorBILogger","$route","cacheSrv","$translate","paymentService"],b.prototype.isMultipleParticipants=function(){return this.serviceInfo.numberOfParticipants&&this.isMoreThanOneRoomsLeft()},b.prototype.isMoreThanOneRoomsLeft=function(){return this.appointmentTime.groupInstance.capacity-this.appointmentTime.groupInstance.registered>1},b}(c);b.GroupCongratulationsController=d,angular.module("schedulerAngularClientAppInternal").controller("GroupCongratulationsController",d),angular.module("schedulerAngularClientAppInternal").component("boostGroupCongratulationsPage",{templateUrl:["appConfig",function(a){return c.getTemplateUrl(a.getIsMobile())}],controller:d})}(c=b.groups||(b.groups={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m){var n=a.call(this,b,c,d,e,f,h,i,j,k,l)||this;n.bookAnotherPage=g.VISITOR_SERVICES;var o=m.getKeys().congratulations;return n.type=o.design.offeringType,n.bookAnotherKeys={translate:o.text.bookAnotherTranslateKey,settings:o.text.bookAnother},n.instructionsKeys={translate:o.text.instructionsTranslateKey,settings:o.text.instructions},n.googleKeys={translate:o.text.googleTranslateKey,settings:o.text.google},n.messageKeys={translate:o.text.messageTranslateKry,settings:o.text.message},n}return __extends(b,a),b.$inject=["$window","$q","appointmentService","servicesSrv","routeManager","clientPages","visitorBILogger","$route","cacheSrv","$translate","paymentService","offeringSettingKeysGetterSrv"],b}(a.boost.visitor.pages.CongratulationsController);b.CongratulationsPage=c,angular.module("schedulerAngularClientAppInternal").component("bksCongratulationsPage",{templateUrl:["appConfig",function(b){return a.boost.visitor.pages.CongratulationsController.getTemplateUrl(b.getIsMobile())}],controller:c})}(c=b.congrats||(b.congrats={}))}(c=b.visitor||(b.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var OrderByLowerCase=function(){function a(){}return a.prototype.filter=function(b,c){return b.sort(function(b,d){return a.sortByStringNoCase(b[c],d[c])})},a.sortByStringNoCase=function(a,b){var c=a?a.toLowerCase():"",d=b?b.toLowerCase():"";return c>d?1:d>c?-1:0},a}();OrderByLowerCase.FILTER_NAME="boostOrderByLowerCase",angular.module("schedulerAngularClientAppInternal").filter(OrderByLowerCase.FILTER_NAME,function(){return(new OrderByLowerCase).filter});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.currentTime=a,this.originalFrom=b,this.originalTo=c}return Object.defineProperty(a.prototype,"fromPosition",{get:function(){return Math.max(this.originalFrom,0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"toPosition",{get:function(){return Math.max(this.originalTo,0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"nextPosition",{get:function(){var b=a.DEFAULT_DURATION,c=this.calculateDelta(this.toPosition,this.fromPosition),d=this.calculateProgress(this.currentTime,b);return this.calculatePosition(c,d)},enumerable:!0,configurable:!0}),a.prototype.calculateProgress=function(a,b){return a/b*(Math.PI/2)},a.prototype.calculatePosition=function(a,b){return a*Math.sin(b)},a.prototype.calculateDelta=function(a,b){return a-b},a}();b.DEFAULT_DURATION=300,a.SmoothScroll=b;var c=function(){function a(b,c,d,e,f){this.$timeout=c,this.$wix=d,this.$element=e,this.$attrs=f,this.offset=0,b.$on(a.SCROLL_EVENT,this.scroll.bind(this))}return a.$inject=["$scope","$timeout","$wix","$element","$attrs"],a.prototype.scroll=function(a,b){"number"==typeof b.offset&&(this.offset=b.offset),b.toElement===this.$attrs.boostScrollToMe&&this.$wix.getBoundingRectAndOffsets(this.calculateAndScroll.bind(this))},a.prototype.calculateAndScroll=function(b){this.scrollToMyself(this.calculateCurrentPagePosition(b),this.calculateToPosition(b),a.DEFAULT_CURRENT_TIME)},a.prototype.scrollToMyself=function(a,c,d){var e=b.DEFAULT_DURATION;if(!this.isScrollingComplete(d,e)){var f=new b(d,a,c);this.requestScrolling(f.fromPosition,f.nextPosition),this.scheduleNextScroll(f.fromPosition,f.toPosition,f.currentTime)}},a.prototype.isScrollingComplete=function(a,b){return a>=b},a.prototype.scheduleNextScroll=function(b,c,d){var e=this,f=d+a.DEFAULT_INTERVAL;this.$timeout(function(){return e.scrollToMyself(b,c,f)},a.DEFAULT_INTERVAL)},a.prototype.calculateToPosition=function(a){return a.offsets.y+this.$element.offset().top-this.offset},a.prototype.calculateCurrentPagePosition=function(a){return a.offsets.y-a.rect.top},a.prototype.requestScrolling=function(a,b){this.$wix.scrollTo(0,a+b)},a}();c.SCROLL_EVENT="SCROLL_EVENT",c.DEFAULT_INTERVAL=10,c.DEFAULT_CURRENT_TIME=0,a.ScrollToMe=c,angular.module("schedulerAngularClientCommon").directive("boostScrollToMe",function(){return{restrict:"A",controller:c,controllerAs:"$crtl",bindToController:!0}})}(b=a.directives||(a.directives={}))}(b=a.visitor||(a.visitor={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(){var b=a.bookings.accessibility.navigateWithHorizontalArrowWhileOnElement;angular.module("schedulerAngularClientAppInternal").directive("withHorizontalNavigation",function(){return{restrict:"A",link:function(a,c){return c.keydown(function(a){var d=a.which;b(d,c)})}}})}(c=b.directives||(b.directives={}))}(c=b.common||(b.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(){var b=a.bookings.accessibility.navigateWithVerticalArrowWhileOnElement;angular.module("schedulerAngularClientAppInternal").directive("withVerticalNavigation",function(){return{restrict:"A",link:function(a,c,d){return c.keydown(function(a){var e=d.withVerticalNavigation,f=void 0===e?"":e;b(a.which,c,f)})}}})}(c=b.directives||(b.directives={}))}(c=b.common||(b.common={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var WidgetRouteController=function(){function a(a,b,c,d,e){this.$route=a,this.routeManager=b,this.clientPages=c,this.flowManagerSrv=d,this.visitorBILogger=e,this.init(),this.goToService()}return a.$inject=["$route","routeManager","clientPages","flowManagerSrv","visitorBILogger"],a.prototype.goToService=function(){"individual"===this.serviceType?this.individualService():"group"===this.serviceType&&this.groupService()},a.prototype.individualService=function(){var a=this.getIndividual();this.sendBiEvent(),a?this.goToIndividual(a):this.routeManager.gotoPage(this.clientPages.VISITOR_SPLASH)},a.prototype.groupService=function(){var a=this.getGroupService();this.sendBiEvent(),a?this.goToGroup(a):this.routeManager.gotoPage(this.clientPages.VISITOR_SPLASH)},a.prototype.sendBiEvent=function(){this.visitorBILogger.logDeepLinkCalendarOpened({referralInfo:"widget",service_id:this.serviceId,type:this.serviceType})},a.prototype.init=function(){this.groupsList=this.$route.current.locals.groupsList,this.serviceList=this.$route.current.locals.servicesList,this.serviceId=this.$route.current.params.serviceId,this.serviceType=this.$route.current.serviceType},a.prototype.getIndividual=function(){return this.getService(this.serviceList.services)},a.prototype.getGroupService=function(){return this.getService(this.groupsList.classes)},a.prototype.getService=function(a){var b=this,c=a.filter(function(a){return a.id===b.serviceId});return c.length>0?c[0]:null},a.prototype.goToIndividual=function(a){this.setIndividualService(a),this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR)},a.prototype.setIndividualService=function(a){this.flowManagerSrv.initiateIndividual(a)},a.prototype.goToGroup=function(a){this.setGroupService(a),this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR)},a.prototype.setGroupService=function(a){this.flowManagerSrv.initiateGroup(a)},a}();angular.module("schedulerAngularClientAppInternal").component("boostWidgetRoute",{template:"",controller:WidgetRouteController});var ParticipantsSummaryComponent=function(){function a(a,b,c,d,e){var f=this;this.experimentsEnabler=c,this.$translate=e,this.selectedService=a.getSelectedService(),this.selectedTime=a.getSelectedTime(),this.notifyVisibilityChangeIfRequired(),d.getIsMobile()||b.$on(wix.boost.visitor.VisitorSidebar.EVENTS.SERVICE_UPDATED,function(a,b){f.selectedService=b})}return a.$inject=["appointmentService","$rootScope","experimentsEnabler","appConfig","$translate"],a.prototype.isNumberOfParticipantsRequired=function(){return this.isMaxParticipantsOverOne()&&this.isOverOneRoomsLeft()},a.prototype.isMaxParticipantsOverOne=function(){return this.selectedService.maxParticipantsPerOrder>1},a.prototype.isOverOneRoomsLeft=function(){return this.selectedTime&&this.selectedTime.groupInstance?this.selectedTime.groupInstance.capacity-this.selectedTime.groupInstance.registered>1:!1},a.prototype.getTranslateParams=function(){return{numberOfParticipants:this.selectedService.numberOfParticipants||1}},a.prototype.getTranslate=function(){return this.$translate("participants-summary.participants",this.getTranslateParams())},a.prototype.getFullTranslate=function(){return this.$translate("participants-summary.accessibility.participants",this.getTranslateParams())},a.prototype.notifyVisibilityChangeIfRequired=function(){this.onVisibilityChanged&&this.onVisibilityChanged({value:this.isNumberOfParticipantsRequired()})},a}();angular.module("schedulerAngularClientAppInternal").component("boostParticipantsSummary",{template:'<div data-hook="participants-summary-container" ng-if="$ctrl.isNumberOfParticipantsRequired()" aria-label="{{$ctrl.getFullTranslate()}}">{{$ctrl.getTranslate()}}</div>',controller:ParticipantsSummaryComponent,bindings:{onVisibilityChanged:"&"}});var WixPageNavigation=function(){function a(a,b,c,d){this.$wix=a,this.clientPages=b,this.routeManager=c,this.$rootScope=d}return a.$inject=["$wix","clientPages","routeManager","$rootScope"],a.prototype.init=function(){var a=this;this.$wix.getCurrentPageId(function(b){a.pageId=b,a.setListener()})},a.prototype.setListener=function(){var a=this;this.$wix.addEventListener(this.$wix.Events.PAGE_NAVIGATION_IN,function(b){b.toPage===a.pageId&&a.routeFromStorageData()})},a.prototype.routeFromStorageData=function(){var a=this;this.$rootScope.$applyAsync(function(){a.routeManager.suspendFocus=!0,a.routeManager.gotoPage(a.clientPages.VISITOR_SPLASH)})},a}();angular.module("schedulerAngularClientAppInternal").service("wixPageNavigation",WixPageNavigation);var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.userManagementSrv=a,this.$q=b}return a.$inject=["userManagementSrv","$q"],a.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){var a,b;return __generator(this,function(){return a=this.$q.defer(),b=!!this.userManagementSrv.getPreviousPageInfo(),a.resolve(b),[2,a.promise]})})},a.prototype.doRedirect=function(){this.userManagementSrv.restoreLoginState()},a}();a.PostLoginNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("postLoginNavigationSrv",b)}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.serviceConst=a}return a.$inject=["serviceConst"],a.prototype.adjustSelectedOfferingForSidebar=function(a,b){return __assign({},a,{location:this.serviceConst.LOCATION_OTHER,locationText:b.locationInfo,numberOfParticipants:b.numOfParticipants,price:this.totalPrice(b.numOfParticipants,a.price)})},a.prototype.totalPrice=function(a,b){return a*b},a}();a.OfferingDtoModifier=b,angular.module("schedulerAngularClientAppInternal").service("offeringDtoModifierSrv",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h){this.routeManager=a,this.clientPages=b,this.appSettings=c,this.visitorBILogger=d,this.servicesSrv=e,this.groupsSrv=f,this.TABS_ORDER=g,this.overEditor=h,this.firstServiceType=c.getServiceOrderWithoutDefault()}return a.$inject=["routeManager","clientPages","appSettings","visitorBILogger","servicesSrv","groupsSrv","TABS_ORDER","overEditor"],a.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,!0]})})},a.prototype.doRedirect=function(){this.hasBothServiceOrNoServices()&&this.isUserPreferencesDefined()?this.redirectPerUserPreferences():this.redirectPerUserServices()},a.prototype.init=function(a,b){this.servicesList=a,this.groupsList=b},a.prototype.hasBothServiceOrNoServices=function(){return this.hasBothServices()||this.hasNoServices()},a.prototype.hasBothServices=function(){return this.hasIndividual()&&this.hasGroups()},a.prototype.hasNoServices=function(){return!this.hasIndividual()&&!this.hasGroups()},a.prototype.isUserPreferencesDefined=function(){return this.firstServiceType},a.prototype.redirectPerUserServices=function(){this.shouldShowIndividualOnly()?this.goToIndividual():this.goToGroups()},a.prototype.redirectPerUserPreferences=function(){this.firstServiceType===this.TABS_ORDER.INDIVIDUAL_FIRST?this.goToIndividual():this.goToGroups()},a.prototype.shouldShowIndividualOnly=function(){return this.hasIndividual()||!this.hasGroups()},a.prototype.hasGroups=function(){return this.groupsSrv.hasRealGroups(this.groupsList)},a.prototype.hasIndividual=function(){return this.servicesSrv.hasRealServices(this.servicesList)},a.prototype.goToIndividual=function(){this.overEditor.isOverEditor||this.visitorBILogger.servicesPageOpened("private"),this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)},a.prototype.goToGroups=function(){this.overEditor.isOverEditor||this.visitorBILogger.servicesPageOpened("group"),this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS)},a}();a.ServiceTypeNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("serviceTypeNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;
switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i){var j=this;this.routeManager=a,this.clientPages=b,this.$wix=c,this.$timeout=d,this.experimentsEnabler=e,this.offeringFinder=f,this.flowManagerSrv=g,this.visitorBILogger=h,this.$q=i,this.deepLinkEventData=null,c.subscribeToExternalEvent(WidgetDeepLinkConst.DEEP_LINK,function(a){j.deepLinkEventData=a},!0)}return a.$inject=["routeManager","clientPages","$wix","$timeout","experimentsEnabler","offeringFinder","flowManagerSrv","visitorBILogger","$q"],a.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){var a,b=this;return __generator(this,function(){return a=this.$q.defer(),this.hasDataForDeepLink()?a.resolve(!0):this.$timeout(function(){a.resolve(b.hasDataForDeepLink())},200),[2,a.promise]})})},a.prototype.doRedirect=function(){var a=this;if(this.experimentsEnabler.isOfferingsUnificationEnabled()){var b=this.deepLinkEventData.data;this.offeringFinder.find(b[WidgetDeepLinkConst.SERVICE_ID]).then(function(b){a.flowManagerSrv.initiateOfferingWidget(b),a.sendBiEvent(b),a.cleanDeepLinkData()}).then(function(){return a.flowManagerSrv.goToFirstPage()})}else this.redirectPerDeepLinkingData()},a.prototype.hasDataForDeepLink=function(){return null!==this.deepLinkEventData},a.prototype.sendBiEvent=function(a){var b=a.id,c=a.type;return this.visitorBILogger.logDeepLinkCalendarOpened({referralInfo:"widget",service_id:b,type:c}),this.$q.resolve()},a.prototype.redirectPerDeepLinkingData=function(){var a=this.deepLinkEventData.data,b=a[WidgetDeepLinkConst.SERVICE_TYPE],c=a[WidgetDeepLinkConst.SERVICE_ID],d="group"===b?this.clientPages.WIDGET_GROUP:this.clientPages.WIDGET_INDIVIDUAL;this.cleanDeepLinkData(),this.routeManager.gotoPage(d+"/"+c)},a.prototype.cleanDeepLinkData=function(){this.deepLinkEventData=null},a}();a.WidgetDeepLinkNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("widgetDeepLinkNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f){this.routeManager=a,this.boostInjectionPersister=b,this.clientPages=c,this.flowManagerSrv=d,this.offeringFinder=e,this.$q=f}return a.$inject=["routeManager","boostInjectionPersister","clientPages","flowManagerSrv","offeringFinder","$q"],a.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.$q.resolve(this.boostInjectionPersister.isSpecificOfferingRequested())]})})},a.prototype.doRedirect=function(){var a=this;this.offeringFinder.findInjected().then(function(b){a.flowManagerSrv.initiateBookFromOfferPage(b),a.routeManager.gotoPage(a.clientPages.OFFERING_PAGE)})},a}();a.OfferingPageNavigationSrv=b,angular.module("schedulerAngularClientAppInternal").service("offeringPageNavigationSrv",b)}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){var e=this;this.$q=a,this.$timeout=b,this.$wix=c,this.flowManagerSrv=d,this.deepLinkEventData=null,c.subscribeToExternalEvent(MemberAreaDeepLinkConst.BOOK_ANOTHER_DEEP_LINK_NAME,function(a){e.deepLinkEventData=a},!0)}return a.$inject=["$q","$timeout","$wix","flowManagerSrv"],a.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){var a,b=this;return __generator(this,function(){return a=this.$q.defer(),this.hasDataForDeepLink()?a.resolve(!0):this.$timeout(function(){a.resolve(b.hasDataForDeepLink())},200),[2,a.promise]})})},a.prototype.hasDataForDeepLink=function(){return null!==this.deepLinkEventData},a.prototype.doRedirect=function(){var a=this,b=this.extractBookingFromData();this.cleanDeepLinkData(),this.flowManagerSrv.initiateMemberAreaBookAnother(b).then(function(){a.flowManagerSrv.goToFirstPage()})},a.prototype.cleanDeepLinkData=function(){this.deepLinkEventData=null},a.prototype.extractBookingFromData=function(){var a=this.deepLinkEventData.data,b=a[MemberAreaDeepLinkConst.BOOKING];return b},a}();a.MemberAreaBookAnotherDeepLinkNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("memberAreaBookAnotherDeepLinkNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e){var f=this;this.$q=a,this.$wix=b,this.flowManagerSrv=c,this.$timeout=d,this.businessInfoSrv=e,this.deepLinkEventData=null,b.subscribeToExternalEvent(MemberAreaDeepLinkConst.RESCHEDULE_DEEP_LINK_NAME,function(a){f.deepLinkEventData=a},!0)}return a.$inject=["$q","$wix","flowManagerSrv","$timeout","businessInfoSrv"],a.prototype.isRedirectRequired=function(){return __awaiter(this,void 0,void 0,function(){var a,b=this;return __generator(this,function(){return a=this.$q.defer(),this.hasDataForDeepLink()?a.resolve(!0):this.$timeout(function(){a.resolve(b.hasDataForDeepLink())},200),[2,a.promise]})})},a.prototype.hasDataForDeepLink=function(){return null!==this.deepLinkEventData},a.prototype.doRedirect=function(){return __awaiter(this,void 0,void 0,function(){var a,b;return __generator(this,function(c){switch(c.label){case 0:return a=this.extractBookingFromData(),this.cleanDeepLinkData(),[4,this.getTimezone()];case 1:return b=c.sent(),[4,this.flowManagerSrv.initiateMemberAreaReschedule(a,b)];case 2:return c.sent(),this.flowManagerSrv.goToFirstPage(),[2]}})})},a.prototype.cleanDeepLinkData=function(){this.deepLinkEventData=null},a.prototype.extractBookingFromData=function(){var a=this.deepLinkEventData.data,b=a[MemberAreaDeepLinkConst.BOOKING];return b},a.prototype.getTimezone=function(){var a=this.$q.defer();return this.businessInfoSrv.gettingBusinessInfo().then(function(b){return a.resolve(b.timeZone)}),a.promise},a}();a.MemberAreaRescheduleDeepLinkNavigationService=b,angular.module("schedulerAngularClientAppInternal").service("memberAreaRescheduleDeepLinkNavigationSrv",b)}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.clientPagesConst=new ClientPages,b.PERSONAL_INFO=b.clientPagesConst.USER_ACCOUNT_MANAGEMENT_INFO,b.PACKAGES=b.clientPagesConst.USER_ACCOUNT_MANAGEMENT_PACKAGES,b.BOOKINGS=b.clientPagesConst.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS,a.AccountManagementSections=b;var c=function(){function a(){}return a}();c.clientPagesConst=new ClientPages,c.PERSONAL_INFO=c.clientPagesConst.USER_ACCOUNT_MANAGEMENT+"/"+c.clientPagesConst.USER_ACCOUNT_MANAGEMENT_INFO,c.PACKAGES=c.clientPagesConst.USER_ACCOUNT_MANAGEMENT+"/"+c.clientPagesConst.USER_ACCOUNT_MANAGEMENT_PACKAGES,c.BOOKINGS=c.clientPagesConst.USER_ACCOUNT_MANAGEMENT+"/"+c.clientPagesConst.USER_ACCOUNT_MANAGEMENT_APPOINTMENTS,a.AccountManagementPages=c}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){var d={allowedActions:{},numOfParticipants:1};Object.assign(this,d,a),this.offeringDetails=Object.assign({parentOfferingId:a.parentOfferingId},c),this.staffMemberDetails=b}return a}();a.AccountBooking=b}(b=a.bookings||(a.bookings={}))}(b=a.account||(a.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.account.bookings.AccountBooking,d=a.bookings.visitor.offerings.OfferingTypes,e=function(){function a(a,b,c){this.accountManagementApiSrv=a,this.appointmentService=b,this.visitorBILogger=c}return a.$inject=["accountManagementApiSrv","appointmentService","visitorBILogger"],a.prototype.buildBookingList=function(a){var b=this,c=this.createMapById(a.relatedStaff),d=this.createMapById(a.relatedOfferings);return{bookings:a.bookings.map(function(a){return b.buildBooking(a,c[a.staffId],d[a.offeringId])})}},a.prototype.buildBooking=function(a,b,d){return new c(a,b,d)},a.prototype.cancelingBooking=function(a,b){return this.accountManagementApiSrv.cancelingBooking(a.bookings[b]).then(function(){a.bookings=a.bookings.filter(function(a,c){return b!==c})})},a.prototype.gettingBookings=function(){var a=this;return this.accountManagementApiSrv.gettingBookings().then(function(b){return a.buildBookingList(b)})},a.prototype.reschedulingBooking=function(){var a=this,b=this.appointmentService.getCurrentBooking(),c=this.appointmentService.getSelectedTime(),e={staffMemberId:c.staffMember.id,bookingId:b.bookingId,offeringType:b.offeringDetails.type};return Object.assign(e,e.offeringType===d.INDIVIDUAL?{start:c.startTime,end:c.endTime}:{groupInstanceId:c.groupInstance.id,originalGroupInstanceId:b.groupInstanceId}),this.accountManagementApiSrv.rescheduleBooking(e).then(function(c){return a.visitorBILogger.logBookingRescheduleSuccess(b),c})},a.prototype.createMapById=function(a){return a.reduce(function(a,b){return a[b.id]=b,a},{})},a}();b.BookingHistorySrv=e,angular.module("schedulerAngularClientAppInternal").service("bookingHistorySrv",e)}(c=b.account||(b.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.visitor.offerings.OfferingTypes,d=function(){function a(){}return a}();d.API_PREFIX="_api/scheduler-server/site-member/",d.UPDATE_CONTACT="contact",d.CANCEL_BOOKING="booking",d.GET_BOOKINGS="bookings",d.RESCHEDULE_BOOKING="booking",b.AccountManagementApiConst=d;var e=function(){function a(b,c){var e=this;this.$http=b,this.commonApiBase=c,this.updatingContact=this.commonApiBase.httpWrapper(function(a){return e.$http.put(""+d.API_PREFIX+d.UPDATE_CONTACT,a)}),this.cancelingBooking=this.commonApiBase.httpWrapper(function(b){return e.$http.delete(""+d.API_PREFIX+d.CANCEL_BOOKING+"/"+b.offeringDetails.type+"/"+b.bookingId+a.getBookingUrlSuffix(b))}),this.gettingBookings=this.commonApiBase.httpWrapper(function(){return e.$http.get(""+d.API_PREFIX+d.GET_BOOKINGS)}),this.rescheduleBooking=this.commonApiBase.httpWrapper(function(b){return e.$http.put(""+d.API_PREFIX+d.RESCHEDULE_BOOKING+"/"+b.offeringType+"/"+b.bookingId+a.getRescheduleBookingUrlSuffix(b),b)})}return a.$inject=["$http","commonApiBase"],a.getBookingUrlSuffix=function(a){return a.offeringDetails.type===c.GROUP?"/"+a.groupInstanceId:""},a.getRescheduleBookingUrlSuffix=function(a){return a.offeringType===c.GROUP?"/"+a.originalGroupInstanceId:""},a}();b.AccountManagementApiSrv=e,angular.module("schedulerAngularClientAppInternal").service("accountManagementApiSrv",e)}(c=b.account||(b.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){var b={};Object.assign(this,b,a)}return a}(),c=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this.$wix=a,this.boostInjectionPersister=b,this.accountManagementApiSrv=c,this.routeManager=d,this.cacheSrv=e,this.clientPages=f,this.visitorBILogger=g,this.$timeout=h,this.$rootScope=i,this.experimentsEnabler=j,this.$translate=k,this.modal=l,this.wixSdkUtil=n,this.isInApp="site"===this.$wix.Utils.getViewMode(),this.loginIsInit=m.defer(),this.initCurrentMemberStatus()}return a.$inject=["$wix","boostInjectionPersister","accountManagementApiSrv","routeManager","cacheSrv","clientPages","visitorBILogger","$timeout","$rootScope","experimentsEnabler","$translate","modal","$q","wixSdkUtil"],a.prototype.isLoggedIn=function(){return this.isInApp&&this.isCurrentUserPresent},a.prototype.isSiteOwner=function(){return this.isOwner},a.prototype.logoutUser=function(){this.isInApp&&(this.$rootScope.$emit(a.LOGOUT_INITIATED),this.$wix.logOutCurrentMember())},a.prototype.loginUser=function(){var b=this,c=this.$wix.getVisitorId();this.isInApp?this.$wix.requestLogin({mode:"login",language:this.$translate.preferredLanguage()},function(){b.visitorBILogger.logLoginComplete({success:!0,visitorIdAnon:c});var d=b.routeManager.getFullPageDefinition();b.cacheSrv.setToCache(a.POST_LOGIN_PATH_KEY,{preLoginRoute:d,visitorIdAnon:c})}):this.modal.openLoginOutsideSite()},a.prototype.getCurrentSiteMember=function(){return this.currentSiteMember},a.prototype.buildSiteMember=function(a){return new b(a)},a.prototype.updatingSiteMember=function(a){var b=this;return this.accountManagementApiSrv.updatingContact(a).then(function(){b.setCurrentSiteMember(b.buildSiteMember(a))})},a.prototype.restoreLoginState=function(){var b=this,c=this.getPreviousPageInfo();c&&(this.cacheSrv.clearKey(a.POST_LOGIN_PATH_KEY),this.visitorBILogger.logPostLoginComplete({visitorIdAnon:c.visitorIdAnon}),this.loginIsInit.promise.then(function(){return b.routeManager.gotoFullPage(c.preLoginRoute)}))},a.prototype.getPreviousPageInfo=function(){return this.cacheSrv.getFromCache(a.POST_LOGIN_PATH_KEY)},a.prototype.isPathAllowed=function(a){var b=this.isPathProtected(a);return b&&this.isSiteOwner()&&this.modal.openOwnerIsLoggedIn(),this.isLoggedIn()&&!this.isSiteOwner()||!b},a.prototype.isUserLoginAllowed=function(){return this.experimentsEnabler.isSiteMembersLoginEnabled()?this.experimentsEnabler.isNewMemberAreaEnabled()?this.$wix.isMemberAreaInstalled()?!1:"false"!==this.wixSdkUtil.getTextForModel("showMemberLogin_Checkbox",""):"false"!==this.wixSdkUtil.getTextForModel("showMemberLogin_Checkbox",""):!1},a.prototype.isInitialized=function(){return this.initialized},a.prototype.isPathProtected=function(a){return a&&a.indexOf(this.clientPages.USER_ACCOUNT_MANAGEMENT)>-1},a.prototype.initCurrentMemberStatus=function(){var a=this;this.initialized=!1,this.isCurrentUserPresent=!1,this.currentSiteMember={},this.isInApp?this.$wix.currentMember(function(b){a.$timeout(function(){return a.onCurrentMemberRetrieved(b)})}):this.setInitialized()},a.prototype.onCurrentMemberRetrieved=function(a){this.isUserLoginAllowed()&&(this.isCurrentUserPresent=!!a,this.isOwner=a&&a.owner,this.isCurrentUserPresent&&this.setCurrentSiteMember(this.boostInjectionPersister.getCurrentMember()||{}),this.isSiteOwner()&&this.modal.openOwnerIsLoggedIn(),this.setInitialized())},a.prototype.setInitialized=function(){this.loginIsInit.resolve(),this.initialized=!0},a.prototype.setCurrentSiteMember=function(b){this.currentSiteMember=b,this.$rootScope.$emit(a.USER_INFO_CHANGED)},a}();c.POST_LOGIN_PATH_KEY="UserManagementSrv.post-login-path-key",c.LOGOUT_INITIATED="UserManagementSrv.logout-initiated",c.USER_INFO_CHANGED="UserManagementSrv.user-info-changed",a.UserManagementSrv=c,angular.module("schedulerAngularClientAppInternal").service("userManagementSrv",c)}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d,e,f,g){this.userManagementSrv=a,this.experimentsEnabler=b,this.routeManager=c,this.clientPages=d,this.visitorBILogger=e,this.wixSdkUtil=f,this.$timeout=g}return Object.defineProperty(a.prototype,"isUserLoggedIn",{get:function(){return this.userManagementSrv.isLoggedIn()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"userLoginAllowed",{get:function(){return this.userManagementSrv.isInitialized()&&this.userManagementSrv.isUserLoginAllowed()},enumerable:!0,configurable:!0}),a.prototype.login=function(){this.visitorBILogger.logLoginClicked(),this.userManagementSrv.loginUser()},a.prototype.logout=function(){var a=this,b=0;this.visitorBILogger.logSignoutClicked(),this.$timeout(function(){return a.userManagementSrv.logoutUser()},b)},a.prototype.goToUserManagement=function(){this.visitorBILogger.logGoToAccountManagement(),this.routeManager.gotoPage(this.clientPages.USER_ACCOUNT_MANAGEMENT)},Object.defineProperty(a.prototype,"userName",{get:function(){var a=this.userManagementSrv.getCurrentSiteMember().fullName;return a?a.split(" ")[0]:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"userImage",{get:function(){return this.userManagementSrv.getCurrentSiteMember().imageUrl},enumerable:!0,configurable:!0}),a}();a.BaseUserLoginComponent=b}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){return a.call(this,b,c,d,e,f,g,h)||this}return __extends(b,a),b.$inject=["userManagementSrv","experimentsEnabler","routeManager","clientPages","visitorBILogger","wixSdkUtil","$timeout"],b.prototype.onLoginKeyPress=function(a){if(this.experimentsEnabler.isVisitorAccessibilityEnabled()){var b=32,c=13;(b===a.which||c===a.which)&&(a.preventDefault(),this.login())}},b.prototype.onLoginDetailsKeyPress=function(a){if(this.experimentsEnabler.isVisitorAccessibilityEnabled()){var b=32,c=13;(b===a.which||c===a.which)&&(a.preventDefault(),this.goToUserManagement())}},b.prototype.onLogoutKeyPress=function(a){if(this.experimentsEnabler.isVisitorAccessibilityEnabled()){var b=32,c=13;(b===a.which||c===a.which)&&(a.preventDefault(),this.logout())}},b}(a.BaseUserLoginComponent);a.UserLoginComponent=b,angular.module("schedulerAngularClientAppInternal").component("bksUserLogin",{templateUrl:"modules/desktop/user-management/user-login/user-login.preload.html",controller:b})}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d){this.routeManager=a,this.clientPages=b,this.experimentsEnabler=c,this.visitorBILogger=d}return b.prototype.$onInit=function(){this.sections=[{key:"account-management.section.bookings",code:a.AccountManagementSections.BOOKINGS},{key:"account-management.section.personal-info",code:a.AccountManagementSections.PERSONAL_INFO}],this.experimentsEnabler.isPackagesEnabled()&&this.sections.splice(1,0,{key:"account-management.section.packages",code:a.AccountManagementSections.PACKAGES})},b.prototype.gotoServices=function(){this.visitorBILogger.logAccountManagementHeaderBack(this.sectionKey),this.routeManager.gotoPage(this.clientPages.VISITOR_SPLASH)},b.prototype.gotoSection=function(a){this.visitorBILogger.logAccountManagementSectionSelected(a.code),this.routeManager.gotoPage(this.clientPages.USER_ACCOUNT_MANAGEMENT+"/"+a.code)},b.prototype.isSectionSelected=function(a){return a.code===this.sectionKey},b}();a.BaseAccountManagementHeaderController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e){return a.call(this,b,c,d,e)||this}return __extends(b,a),b.$inject=["routeManager","clientPages","experimentsEnabler","visitorBILogger"],b}(a.BaseAccountManagementHeaderController);a.AccountManagementHeaderController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementHeader",{templateUrl:"modules/desktop/account-management/account-management-header/account-management-header.preload.html",controller:b,bindings:{sectionKey:"@section"}})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c){this.userManagementSrv=a,this.$scope=b,this.visitorBILogger=c,this.initSiteMember(),this.isEditMode=!(this.siteMember.phoneNumber&&this.siteMember.fullName)}return Object.defineProperty(b.prototype,"section",{get:function(){return a.AccountManagementSections.PERSONAL_INFO},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"currentSiteMember",{get:function(){return this.siteMember},enumerable:!0,configurable:!0}),b.prototype.onCancelMemberUpdate=function(){this.initSiteMember(),this.isEditMode=!1,this.focusMyInfoTab()},b.prototype.focusMyInfoTab=function(){$('[data-hook="account-management-section-info"]').focus()},b.prototype.onEditMember=function(){this.visitorBILogger.logEditUserInfoClicked(),this.isEditMode=!0,this.focusMyInfoTab()},b.prototype.onSiteMemberSaved=function(a){var b=this;this.visitorBILogger.logUserInfoSaved(a,this.userManagementSrv.getCurrentSiteMember()),this.userManagementSrv.updatingSiteMember(a).then(function(){b.onSaveSuccess(),b.isEditMode=!1})},b.prototype.initSiteMember=function(){this.siteMember=this.userManagementSrv.buildSiteMember(this.userManagementSrv.getCurrentSiteMember())},b}();a.BaseAccountManagementUserInfoController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.save=function(a){this.submittedInvalid=a.$invalid,a.$valid&&this.onSave({siteMember:this.siteMember})},a.prototype.cancel=function(){this.onCancel({siteMember:this.siteMember}),this.userInfoForm.$setPristine()},a.prototype.onFormSavedSuccess=function(){this.userInfoForm.$setPristine()},a}();b.bindings={siteMember:"<",onCancel:"&",onSave:"&"},a.BaseAccountManagementUserInfoFormController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.onEditClick=function(){this.onEdit({siteMember:this.siteMember})},a}();b.bindings={siteMember:"<",onEdit:"&"},a.BaseAccountManagementUserInfoViewController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c){this.bookingHistorySrv=a,this.flowManagerSrv=b,this.visitorBILogger=c}return b.prototype.cancelBooking=function(a,b){this.visitorBILogger.logBookingCancelConfirm(a),this.bookingHistorySrv.cancelingBooking(this.bookingList,b)},b.prototype.rescheduleBooking=function(a){var b=this;this.flowManagerSrv.initiateReschedule(a,this.timezone).then(function(){b.visitorBILogger.logBookingReschedule(a),b.flowManagerSrv.next()})},b.prototype.bookAnotherBooking=function(a){var b=this;this.flowManagerSrv.initiateBookAnother(a).then(function(){b.visitorBILogger.bookIt(!0),b.flowManagerSrv.next()})},Object.defineProperty(b.prototype,"section",{get:function(){return a.AccountManagementSections.BOOKINGS},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"hasBookings",{get:function(){return!!this.bookingList.bookings.length},enumerable:!0,configurable:!0}),b}();b.bindings={bookingList:"=",timezone:"@"},a.BaseAccountManagementBookingsController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){this.$translate=a,this.libs=b,this.$scope=c,this.visitorBILogger=d,this.isExpanded=!1,this.cancelConfirm=!1,this.timeFormat=this.$translate("account-management.bookings.time-format")}return Object.defineProperty(a.prototype,"title",{get:function(){return this.booking.offeringDetails.name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"date",{get:function(){return moment.tz(this.booking.start,this.timezone).format(this.timeFormat)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"staffDetails",{get:function(){return this.$translate("account-management.bookings.staff-format",this.booking.staffMemberDetails)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"location",{get:function(){return this.booking.locationInfo},enumerable:!0,configurable:!0}),a.prototype.isRescheduleAllowed=function(){return this.booking.allowedActions.reschedule},a.prototype.isBookingPassed=function(){return this.booking.start>=Date.now()},a.prototype.isCancelAllowed=function(){return this.booking.allowedActions.cancel},Object.defineProperty(a.prototype,"rescheduleTooltip",{get:function(){return this.$translate("account-management.bookings.action.reschedule"+(this.isRescheduleAllowed()?"":"-not-allowed"))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rescheduleAccessibilityTooltip",{get:function(){return this.$translate("account-management.bookings.action.accessibility.reschedule"+(this.isRescheduleAllowed()?"":"-not-allowed"))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cancelTooltip",{get:function(){return this.$translate("account-management.bookings.action.cancel"+(this.isCancelAllowed()?"":"-not-allowed"))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cancelAccessibilityTooltip",{get:function(){return this.$translate("account-management.bookings.action.accessibility.cancel"+(this.isCancelAllowed()?"":"-not-allowed"))},enumerable:!0,configurable:!0}),a.prototype.isBookAnotherAllowed=function(){return this.booking.allowedActions.bookAnother},a.prototype.onCancelClicked=function(){this.isCancelAllowed()&&(this.visitorBILogger.logBookingCancelClick(this.booking),this.cancelConfirm=!0)},a.prototype.onCancelRevert=function(){this.cancelConfirm=!1},a.prototype.onCancelConfirmed=function(){this.cancelConfirm=!1,this.onCancel({booking:this.booking})},a.prototype.onRescheduleClicked=function(){this.isRescheduleAllowed()&&this.onReschedule({booking:this.booking})},a.prototype.onBookAnotherClicked=function(){this.onBookAnother({booking:this.booking})},a.prototype.applyChanges=function(){return this.$scope.$apply()},a}();b.bindings={booking:"<",onCancel:"&",onReschedule:"&",onBookAnother:"&",timezone:"@"},a.BaseAccountManagementBookingItemController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.reschedule=function(a,b){this.onReschedule({booking:a,index:b})},a.prototype.cancel=function(a,b){this.onCancel({booking:a,index:b})},a.prototype.bookAnother=function(a,b){this.onBookAnother({booking:a,index:b})},a}();b.bindings={bookings:"<",onReschedule:"&",onBookAnother:"&",onCancel:"&",timezone:"@"},a.BaseAccountManagementBookingsListController=b}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b
}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b,c,d)||this;return h.$translate=e,h.modal=f,h.$timeout=g,h}return __extends(b,a),b.$inject=["userManagementSrv","$scope","visitorBILogger","$translate","modal","$timeout"],b.prototype.onSaveSuccess=function(){var a=this.modal.openSuccessMessage(this.$translate("account-management.personal-info.form.save-success"));this.$timeout(function(){$('[data-hook="account-management-section-info"]').focus(),a.dismiss("timeout")},b.MODAL_CLOSE_TIMEOUT)},b}(a.BaseAccountManagementUserInfoController);b.MODAL_CLOSE_TIMEOUT=4e3,a.AccountManagementUserInfoController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementUserInfo",{templateUrl:"modules/desktop/account-management/account-management-user-info/account-management-user-info.preload.html",controller:b})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(a.BaseAccountManagementUserInfoFormController);a.AccountManagementUserInfoFormController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementUserInfoForm",{templateUrl:"modules/desktop/account-management/account-management-user-info/account-management-user-info-form/account-management-user-info-form.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementUserInfoFormController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(a.BaseAccountManagementUserInfoViewController);a.AccountManagementUserInfoViewController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementUserInfoView",{templateUrl:"modules/desktop/account-management/account-management-user-info/account-management-user-info-view/account-management-user-info-view.preload.html",controller:b,bindings:__assign({},a.BaseAccountManagementUserInfoViewController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d){return a.call(this,b,c,d)||this}return __extends(b,a),b.$inject=["bookingHistorySrv","flowManagerSrv","visitorBILogger"],b}(a.BaseAccountManagementBookingsController);a.AccountManagementBookingsController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementBookings",{templateUrl:"modules/desktop/account-management/account-management-bookings/account-management-bookings.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementBookingsController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(a.BaseAccountManagementBookingsListController);a.AccountManagementBookingsListController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementBookingsList",{templateUrl:"modules/desktop/account-management/account-management-bookings/account-management-bookings-list/account-management-bookings-list.preload.html",controller:b,bindings:Object.assign({},a.BaseAccountManagementBookingsListController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e){return a.call(this,b,c,d,e)||this}return __extends(b,a),b.$inject=["$translate","libs","$scope","visitorBILogger"],b}(a.BaseAccountManagementBookingItemController);a.AccountManagementBookingItemController=b,angular.module("schedulerAngularClientAppInternal").component("bksAccountManagementBookingItem",{templateUrl:"modules/desktop/account-management/account-management-bookings/account-management-booking-item/account-management-booking-item.preload.html",controller:b,bindings:__assign({},a.BaseAccountManagementBookingItemController.bindings)})}(b=a.account||(a.account={}))}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var LoggedInContactInfo=function(){function a(){}return a}();angular.module("schedulerAngularClientAppInternal").component("bksLoggedInContactInfo",{controller:LoggedInContactInfo,templateUrl:"modules/logged-in-contact-info/logged-in-contact-info.preload.html",bindings:{contactInfo:"="}});var wix;!function(a){var b;!function(a){var b;!function(a){a.USATimezone=new Set(["America/Boise","EST","EST5EDT","Etc/GMT+5","America/Cambridge_Bay","America/North_Dakota/Center","America/Chicago","America/Dawson_Creek","America/Dawson","America/Denver","Etc/GMT+7","MST","MST7MDT","America/Detroit","America/Edmonton","America/Hermosillo","CST6CDT","Etc/GMT+6","America/Indiana/Indianapolis","America/Inuvik","America/Iqaluit","America/Indiana/Knox","America/Los_Angeles","America/Kentucky/Louisville","America/Indiana/Marengo","America/Menominee","America/Kentucky/Monticello","America/Montreal","America/North_Dakota/New_Salem","America/New_York","America/Nipigon","America/Pangnirtung","America/Indiana/Petersburg","America/Phoenix","America/Rainy_River","America/Rankin_Inlet","America/Regina","America/Resolute","Etc/GMT+8","PST8PDT","America/Swift_Current","America/Indiana/Tell_City","America/Thunder_Bay","America/Toronto","America/Vancouver","America/Indiana/Vevay","America/Indiana/Vincennes","America/Whitehorse","America/Indiana/Winamac","America/Winnipeg","America/Yellowknife","America/Blanc-Sablon","America/Glace_Bay","America/Goose_Bay","America/Halifax"])}(b=a.timezone||(a.timezone={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var NextStepLabelComponent=function(){function a(a,b,c,d){this.paymentService=a,this.$location=b,this.$filter=c,this.$translate=d,this.isLastStep?this.defineLabelForLastStep():this.defineDefaultLabel(),this.enhanceSettingsKey()}return a.$inject=["paymentService","$location","$filter","$translate"],a.prototype.getLabel=function(){return this.overrideLabel||this.$filter("wixSdkTranslate")(this.key,this.settingsKey)},a.prototype.getAriaLabel=function(){return this.isNextStepDisabled?this.$translate("next.step.accessibility.error.message"):this.overrideLabel||this.$filter("wixSdkTranslate")(this.ariaLabelKey,this.settingsKey)},a.prototype.defineDefaultLabel=function(){this.key="calendar.next",this.ariaLabelKey="calendar.accessibility.next",this.settingsKey="textNextStepLabel"},a.prototype.defineLabelForLastStep=function(){this.isOnlyOneOnlinePaymentOption()?(this.key="visitor.confirmation.wizard.next-payment",this.ariaLabelKey="visitor.confirmation.wizard.accessibility.next-payment",this.settingsKey="textPayNowLabel",this.overrideLabel=this.onlinePaymentLabel):(this.key="visitor.confirmation.wizard.next",this.ariaLabelKey="visitor.confirmation.wizard.accessibility.next",this.settingsKey="textBookNowLabel",this.overrideLabel=this.offlinePaymentLabel)},a.prototype.enhanceSettingsKey=function(){this.settingsKey+=this.isGroupsFlow()?a.GROUPS_SUFFIX:""},a.prototype.isOnlyOneOnlinePaymentOption=function(){return this.paymentService.isPaymentNeeded()},a.prototype.isGroupsFlow=function(){return this.$location.path().indexOf("/groups/")>-1},a}();NextStepLabelComponent.GROUPS_SUFFIX="Groups",angular.module("schedulerAngularClientAppInternal").component("boostNextStepLabel",{template:'<span data-hook="next-step-label" aria-label="{{ $ctrl.getAriaLabel() }}">{{ $ctrl.getLabel()}}</span>',controller:NextStepLabelComponent,bindings:{isLastStep:"=",onlinePaymentLabel:"@?",offlinePaymentLabel:"@?",isNextStepDisabled:"="}}),angular.module("schedulerAngularClientAppInternal").directive("bksOnTransitionEnd",function(){return{restrict:"A",scope:{bksOnTransitionEnd:"&"},link:function(a,b){return b.on("transitionend",function(){return a.bksOnTransitionEnd()})}}});var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.clientPages=a,this.routeManager=b,this.flowSteps={}}return a.prototype.addStep=function(a,b){this.flowSteps[a]=b},a.prototype.next=function(a){this.getFlowStep(a).next()},a.prototype.prev=function(a){this.getFlowStep(a).prev()},a.prototype.isNavigationAllowed=function(a,b){var c=this.getFlowStep(a);return!(!c||!c[b])},a.prototype.getFlowStep=function(a){var b=Object.keys(this.flowSteps).find(function(b){return a.startsWith(b)});return this.flowSteps[b]},a.prototype.goToFirstPage=function(){},a}();a.WizardFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.visitor.offerings.OfferingTypes,d=a.bookings.user.account.AccountManagementPages,e=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this,b,c)||this;return i.appointmentService=d,i.selectedOffering=e,i.ServiceTypes=f,i.experimentsEnabler=g,i.isMobile=h,i}return __extends(b,a),b.prototype.init=function(a){this.appointmentService.initiate(this.selectedOffering,a)},b.prototype.addSteps=function(){var a=this,b={prev:angular.noop,next:function(){return a.canNavigateToOfferingPage()?a.goToOfferingPage():a.goToCalendar()},showMoreDetails:function(){return a.routeManager.gotoPage(a.clientPages.OFFERING_PAGE)}};this.addStep(this.clientPages.VISITOR_SERVICES,b),this.addStep(this.clientPages.VISITOR_GROUPS,b),this.addStep(this.clientPages.OFFERING_PAGE,{prev:function(){return a.goToServiceList()},next:function(){return a.goToCalendar()}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.goToContactInfo()},prev:function(){return a.canNavigateToOfferingPage()?a.goToOfferingPage():a.goToServiceList()}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.goToContactInfo()},prev:function(){return a.canNavigateToOfferingPage()?a.goToOfferingPage():a.goToServiceList()}}),this.addStep(this.clientPages.VISITOR_CONTACT_INFO,{prev:function(){return a.goToCalendar()},next:function(){return a.isMobile?a.goToConfirmation():a.goToCongrats()}}),this.addStep(this.clientPages.VISITOR_CONFIRMATION,{prev:function(){return a.goToContactInfo()},next:function(){return a.goToCongrats()}})},b.prototype.goToOfferingPage=function(){this.routeManager.gotoPage(this.clientPages.OFFERING_PAGE)},b.prototype.goToServiceList=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_SERVICES)},b.prototype.goToContactInfo=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONTACT_INFO)},b.prototype.goToCongrats=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONGRATS)},b.prototype.goToConfirmation=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CONFIRMATION)},b.prototype.goToAccountManagementAppointments=function(){this.routeManager.gotoPage(d.BOOKINGS)},b.prototype.goToCalendar=function(){this.selectedOffering.type===c.GROUP?this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR):this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR)},b.prototype.canNavigateToOfferingPage=function(){return this.selectedOffering.description&&0!==this.selectedOffering.description.trim().length&&this.experimentsEnabler.isServicePageEnabled()&&!this.isMobile},b}(b.WizardFlow);b.BookOfferingFlow=e;var f=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this,b,c)||this;return i.appointmentService=d,i.selectedOffering=e,i.ServiceTypes=f,i.experimentsEnabler=g,i.isMobile=h,i}return __extends(b,a),b.prototype.init=function(a){this.initiateOffering(),this.appointmentService.initiate(this.selectedOffering,a)},b.prototype.initiateOffering=function(){this.selectedOffering.type=this.ServiceTypes.INDIVIDUAL},b.prototype.addSteps=function(){this.addIndividualSteps()},b.prototype.selectedOfferingHasDescription=function(){return this.selectedOffering.description&&0!==this.selectedOffering.description.trim().length},b.prototype.addIndividualSteps=function(){var a=this,b={prev:angular.noop,next:function(){return a.routeManager.gotoPage(!a.isMobile&&a.experimentsEnabler.isServicePageEnabled()?a.clientPages.OFFERING_PAGE:a.clientPages.VISITOR_CALENDAR)},showMoreDetails:function(){return a.routeManager.gotoPage(a.clientPages.OFFERING_PAGE)}};this.addStep(this.clientPages.VISITOR_SERVICES,b),this.addStep(this.clientPages.VISITOR_GROUPS,b),this.addStep(this.clientPages.OFFERING_PAGE,{prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_SERVICES)},next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CALENDAR)}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CONTACT_INFO)},prev:function(){a.experimentsEnabler.isServicePageEnabled()&&a.selectedOfferingHasDescription()?a.routeManager.gotoPage(a.clientPages.OFFERING_PAGE):a.routeManager.gotoPage(a.clientPages.VISITOR_SERVICES)}})},b}(b.WizardFlow);b.VisitorIndividualFlow=f;var g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.initiateOffering=function(){this.selectedOffering.type=this.ServiceTypes.GROUP},b.prototype.addSteps=function(){this.addGroupFlowSteps()},b.prototype.addGroupFlowSteps=function(){var a=this,b={prev:angular.noop,next:function(){return a.routeManager.gotoPage(!a.isMobile&&a.experimentsEnabler.isServicePageEnabled()&&a.selectedOfferingHasDescription()?a.clientPages.OFFERING_PAGE:a.clientPages.VISITOR_GROUPS_CALENDAR)},showMoreDetails:function(){return a.routeManager.gotoPage(a.clientPages.OFFERING_PAGE)}};this.addStep(this.clientPages.VISITOR_GROUPS,b),this.addStep(this.clientPages.VISITOR_SERVICES,b),this.addStep(this.clientPages.OFFERING_PAGE,{prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS)},next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CALENDAR)}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CONTACT_INFO)},prev:function(){return a.routeManager.gotoPage(a.experimentsEnabler.isServicePageEnabled()&&a.selectedOfferingHasDescription()?a.clientPages.OFFERING_PAGE:a.clientPages.VISITOR_GROUPS)}})},b}(f);b.VisitorGroupFlow=g}(c=b.flow||(b.flow={}))}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g,h)||this;return i.isMobile=h,i}return __extends(b,a),b.prototype.addSteps=function(){var b=this;a.prototype.addSteps.call(this),this.experimentsEnabler.isOfferingsUnificationEnabled()||(this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return b.routeManager.gotoPage(b.clientPages.VISITOR_CONTACT_INFO)},prev:function(){return b.goToOfferingPage()}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return b.routeManager.gotoPage(b.clientPages.VISITOR_GROUPS_CONTACT_INFO)},prev:function(){return b.goToOfferingPage()}}))},b.prototype.goToFirstPage=function(){this.goToOfferingPage()},b.prototype.canNavigateToOfferingPage=function(){return!this.isMobile},b}(a.BookOfferingFlow);a.VisitorOfferingPageFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.user.account.AccountManagementPages,d=function(a){function b(b,c,d,e,f,g,h){return a.call(this,b,c,d,e,f,g,h)||this}return __extends(b,a),b.prototype.addSteps=function(){var b=this;a.prototype.addSteps.call(this),this.addStep(c.BOOKINGS,{next:function(){return b.goToCalendar()},prev:function(){return b.goToAccountManagementAppointments()}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return b.goToContactInfo()},prev:function(){return b.goToAccountManagementAppointments()}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return b.goToContactInfo()},prev:function(){return b.goToAccountManagementAppointments()}})},b}(b.BookOfferingFlow);b.VisitorAddAnotherFlow=d;var e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.addIndividualSteps=function(){var a=this;this.addStep(c.BOOKINGS,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CALENDAR)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CONTACT_INFO)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}})},b}(b.VisitorIndividualFlow);b.VisitorIndividualAddAnotherFlow=e;var f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.addGroupFlowSteps=function(){var a=this;this.addStep(c.BOOKINGS,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CALENDAR)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CONTACT_INFO)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}})},b}(b.VisitorGroupFlow);b.VisitorGroupAddAnotherFlow=f}(c=b.flow||(b.flow={}))}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g,h)||this;return i.clientPages=b,i.routeManager=c,i.selectedOffering=e,i}return __extends(b,a),b.prototype.goToFirstPage=function(){this.goToCalendar()},b}(a.BookOfferingFlow);a.MemberAreaBookAnotherFlow=b;var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.addGroupFlowSteps=function(){var a=this;this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CONTACT_INFO)},prev:function(){return a.routeManager.gotoPage(a.experimentsEnabler.isServicePageEnabled()&&a.selectedOfferingHasDescription()?a.clientPages.OFFERING_PAGE:a.clientPages.VISITOR_GROUPS)}}),this.addStep(this.clientPages.VISITOR_GROUPS_CONTACT_INFO,{next:function(){return a.routeManager.gotoPage(a.clientPages.GROUPS_VISITOR_CONGRATS)},prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CALENDAR)}}),this.addStep(this.clientPages.OFFERING_PAGE,{prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS)},next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CALENDAR)}})},b.prototype.goToFirstPage=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR)},b}(a.VisitorGroupFlow);a.MemberAreaBookAnotherGroupFlow=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.addIndividualSteps=function(){var a=this;this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CONTACT_INFO)},prev:function(){a.experimentsEnabler.isServicePageEnabled()&&a.selectedOfferingHasDescription()?a.routeManager.gotoPage(a.clientPages.OFFERING_PAGE):a.routeManager.gotoPage(a.clientPages.VISITOR_SERVICES)}}),this.addStep(this.clientPages.VISITOR_CONTACT_INFO,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CONGRATS)},prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CALENDAR)}}),this.addStep(this.clientPages.OFFERING_PAGE,{prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_SERVICES)},next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CALENDAR)}})},b.prototype.goToFirstPage=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR)},b}(a.VisitorIndividualFlow);a.MemberAreaBookAnotherIndividualFlow=d}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k){var l=a.call(this,b,c,d,f,i,j,k)||this;return l.booking=e,l.bookingHistorySrv=g,l.offeringDtoModifierSrv=h,l}return __extends(b,a),b.prototype.init=function(a){this.selectedOffering=this.offeringDtoModifierSrv.locationForSideBar(this.selectedOffering,this.booking.locationInfo),this.appointmentService.initiate(this.selectedOffering,a),this.appointmentService.setCurrentBooking(this.booking)},b.prototype.addSteps=function(){var b=this;a.prototype.addSteps.call(this),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return b.bookingHistorySrv.reschedulingBooking().then(function(){return b.goToCongrats()})},prev:function(){return b.canNavigateToOfferingPage()?b.goToOfferingPage():b.goToServiceList()}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return b.bookingHistorySrv.reschedulingBooking().then(function(){return b.goToCongrats()})},prev:function(){return b.canNavigateToOfferingPage()?b.goToOfferingPage():b.goToServiceList()}})},b.prototype.goToFirstPage=function(){this.goToCalendar()},b}(a.BookOfferingFlow);a.MemberAreaRescheduleFlow=b;var c=function(a){function b(b,c,d,e,f,g,h,i,j,k,l){var m=a.call(this,b,c,d,f,j,k,l)||this;return m.booking=e,m.timezone=g,m.bookingHistorySrv=h,m.serviceConst=i,m}return __extends(b,a),b.prototype.init=function(b){a.prototype.init.call(this,b),this.appointmentService.setCurrentBooking(this.booking)},b.prototype.addGroupFlowSteps=function(){var a=this;this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.bookingHistorySrv.reschedulingBooking().then(function(){return a.routeManager.gotoPage(a.clientPages.GROUPS_VISITOR_CONGRATS)})},prev:function(){a.routeManager.gotoPage(a.experimentsEnabler.isServicePageEnabled()&&a.selectedOfferingHasDescription()?a.clientPages.OFFERING_PAGE:a.clientPages.VISITOR_GROUPS)}}),this.addStep(this.clientPages.OFFERING_PAGE,{prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS)},next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CALENDAR)}})},b.prototype.goToFirstPage=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_GROUPS_CALENDAR)},b}(a.VisitorGroupFlow);a.MemberAreaRescheduleGroupFlow=c;var d=function(a){function b(b,c,d,e,f,g,h,i,j,k,l){var m=a.call(this,b,c,d,f,j,k,l)||this;return m.booking=e,m.timezone=g,m.bookingHistorySrv=h,m.serviceConst=i,m}return __extends(b,a),b.prototype.init=function(b){a.prototype.init.call(this,b),this.appointmentService.setCurrentBooking(this.booking)},b.prototype.initiateOffering=function(){a.prototype.initiateOffering.call(this),this.selectedOffering=__assign({},this.selectedOffering,{location:this.serviceConst.LOCATION_OTHER,locationText:this.booking.locationInfo})},b.prototype.addIndividualSteps=function(){var a=this;this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.bookingHistorySrv.reschedulingBooking().then(function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CONGRATS)})},prev:function(){a.experimentsEnabler.isServicePageEnabled()&&a.selectedOfferingHasDescription()?a.routeManager.gotoPage(a.clientPages.OFFERING_PAGE):a.routeManager.gotoPage(a.clientPages.VISITOR_SERVICES)}}),this.addStep(this.clientPages.OFFERING_PAGE,{prev:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_SERVICES)},next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CALENDAR)}})},b.prototype.goToFirstPage=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_CALENDAR)},b}(a.VisitorIndividualFlow);a.MemberAreaRescheduleIndividualFlow=d}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=a.bookings.user.account.AccountManagementPages,d=function(a){function b(b,c,d,e,f,g,h,i,j,k){var l=a.call(this,b,c,d,f,i,j,k)||this;return l.booking=e,l.bookingHistorySrv=g,l.offeringDtoModifierSrv=h,l}return __extends(b,a),b.prototype.init=function(a){this.selectedOffering=this.offeringDtoModifierSrv.adjustSelectedOfferingForSidebar(this.selectedOffering,this.booking),this.appointmentService.initiate(this.selectedOffering,a),this.appointmentService.setCurrentBooking(this.booking)},b.prototype.addSteps=function(){var b=this;a.prototype.addSteps.call(this),this.addStep(c.BOOKINGS,{next:function(){return b.goToCalendar()},prev:function(){return b.goToAccountManagementAppointments()}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return b.bookingHistorySrv.reschedulingBooking().then(function(){return b.goToCongrats()})},prev:function(){return b.goToAccountManagementAppointments()}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return b.bookingHistorySrv.reschedulingBooking().then(function(){return b.goToCongrats()})},prev:function(){return b.goToAccountManagementAppointments()}})},b}(b.BookOfferingFlow);b.RescheduleFlow=d;var e=function(a){function b(b,c,d,e,f,g,h,i,j,k,l){var m=a.call(this,b,c,d,f,j,k,l)||this;return m.booking=e,m.timezone=g,m.bookingHistorySrv=h,m.serviceConst=i,m}return __extends(b,a),b.prototype.init=function(b){a.prototype.init.call(this,b),this.appointmentService.setCurrentBooking(this.booking)},b.prototype.addSteps=function(){var a=this;this.addStep(c.BOOKINGS,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_GROUPS_CALENDAR)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}}),this.addStep(this.clientPages.VISITOR_GROUPS_CALENDAR,{next:function(){return a.bookingHistorySrv.reschedulingBooking().then(function(){return a.routeManager.gotoPage(a.clientPages.GROUPS_VISITOR_CONGRATS)})},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}})},b}(b.VisitorGroupFlow);b.RescheduleGroupFlow=e;var f=function(a){function b(b,c,d,e,f,g,h,i,j,k,l){var m=a.call(this,b,c,d,f,j,k,l)||this;return m.booking=e,m.timezone=g,m.bookingHistorySrv=h,m.serviceConst=i,m}return __extends(b,a),b.prototype.init=function(b){a.prototype.init.call(this,b),this.appointmentService.setCurrentBooking(this.booking)},b.prototype.initiateOffering=function(){a.prototype.initiateOffering.call(this),this.selectedOffering=Object.assign({},this.selectedOffering,{location:this.serviceConst.LOCATION_OTHER,locationText:this.booking.locationInfo})},b.prototype.addSteps=function(){var a=this;this.addStep(c.BOOKINGS,{next:function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CALENDAR)},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}}),this.addStep(this.clientPages.VISITOR_CALENDAR,{next:function(){return a.bookingHistorySrv.reschedulingBooking().then(function(){return a.routeManager.gotoPage(a.clientPages.VISITOR_CONGRATS)})},prev:function(){return a.routeManager.gotoPage(c.BOOKINGS)}})},b}(b.VisitorIndividualFlow);b.RescheduleIndividualFlow=f}(c=b.flow||(b.flow={}))
}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e){return a.call(this,b,c,null,null,null,d,e)||this}return __extends(b,a),b.prototype.init=function(){},b.prototype.addSteps=function(){this.addIndividualSteps(),this.addGroupFlowSteps()},b}(a.VisitorGroupFlow);a.OverEditorFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g,h)||this;return i.clientPages=b,i.routeManager=c,i.selectedOffering=e,i}return __extends(b,a),b.prototype.goToFirstPage=function(){null===this.selectedOffering?this.routeManager.gotoPage(this.clientPages.VISITOR_SPLASH):this.goToCalendar()},b}(a.BookOfferingFlow);a.WidgetFlow=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b){this.routeManager=a,this.clientPages=b}return a.prototype.prev=function(){this.navigateToDefaultStep()},a.prototype.next=function(){this.navigateToDefaultStep()},a.prototype.navigateToDefaultStep=function(){this.routeManager.gotoPage(this.clientPages.VISITOR_SPLASH)},a}();a.FallbackStep=b}(b=a.flow||(a.flow={}))}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a,b,c){this.wizardCacheAdapter=a,this.currentStepAdapter=b,this.fallbackStepFactoryAdapter=c}return a.prototype.init=function(){this.isRestoreInProgress=!1,this.restoreFlowData()},a.prototype.next=function(){this.doNavigation("next")},a.prototype.prev=function(){this.doNavigation("prev")},a.prototype.showMoreDetails=function(){this.doNavigation("showMoreDetails")},a.prototype.doNavigation=function(a){var b=this.currentStepAdapter();this.isNavigationPossible(b,a)?this.currentFlow.getFlowStep(b)[a]():this.doFallbackNavigation(b,a)},a.prototype.goToFirstPage=function(){var a=this.currentFlow||this.fallbackFlow;a.goToFirstPage()},a.prototype.storeFlowData=function(b,c){this.wizardCacheAdapter.set(a.CACHE_KEY,{flowInitMethod:b,args:Array.prototype.slice.call(c)})},a.prototype.initializeFlowData=function(){this.currentFlow.addSteps(),this.currentFlow.init(this.isRestoreInProgress)},a.prototype.restoreFlowData=function(){this.isRestoreInProgress=!0;var b=this.wizardCacheAdapter.get(a.CACHE_KEY);b&&b.flowInitMethod&&this[b.flowInitMethod].apply(this,b.args),this.isRestoreInProgress=!1},a.prototype.doFallbackNavigation=function(a,b){if(this.fallbackFlowNavigationPossible(a,b))this.fallbackFlow[b](a);else{var c=this.fallbackStepFactoryAdapter();c[b]()}},a.prototype.isNavigationPossible=function(a,b){return this.isNavigationPossibleForFlow(this.currentFlow,a,b)},a.prototype.fallbackFlowNavigationPossible=function(a,b){return this.isNavigationPossibleForFlow(this.fallbackFlow,a,b)},a.prototype.isNavigationPossibleForFlow=function(a,b,c){return a&&a.isNavigationAllowed(b,c)},a}();b.CACHE_KEY="flowManagerData",a.FlowManagerCore=b}(b=a.navigation||(a.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c=a.bookings.navigation.flow.VisitorIndividualAddAnotherFlow,d=a.bookings.navigation.flow.VisitorGroupAddAnotherFlow,e=a.bookings.navigation.flow.RescheduleGroupFlow,f=a.bookings.navigation.flow.RescheduleIndividualFlow,g=a.bookings.navigation.flow.OverEditorFlow,h=a.bookings.navigation.flow.VisitorIndividualFlow,i=a.bookings.navigation.flow.VisitorGroupFlow,j=a.bookings.navigation.flow.FallbackStep,k=a.bookings.navigation.flow.VisitorOfferingPageFlow,l=a.bookings.visitor.offerings.OfferingTypes,m=a.bookings.navigation.flow.BookOfferingFlow,n=a.bookings.navigation.flow.WidgetFlow,o=a.bookings.navigation.flow.MemberAreaBookAnotherFlow,p=a.bookings.navigation.flow.MemberAreaBookAnotherGroupFlow,q=a.bookings.navigation.flow.MemberAreaBookAnotherIndividualFlow,r=a.bookings.navigation.flow.VisitorAddAnotherFlow,s=a.bookings.navigation.flow.RescheduleFlow,t=a.bookings.navigation.flow.MemberAreaRescheduleFlow,u=a.bookings.navigation.flow.MemberAreaRescheduleGroupFlow,v=a.bookings.navigation.flow.MemberAreaRescheduleIndividualFlow,w=function(a){function b(b,c,d,e,f,g,h,i,k,l,m,n,o,p,q){var r=a.call(this,{set:function(a,b){return r.cacheSrv.setToCache(a,b)},get:function(a){return r.cacheSrv.getFromCache(a)}},function(){return b.getCurrentPagePartialPath()},function(){return new j(b,r.clientPages)})||this;return r.routeManager=b,r.appointmentService=c,r.cacheSrv=d,r.clientPages=e,r.ServiceTypes=f,r.serviceConst=g,r.servicesSrv=h,r.groupsSrv=i,r.appConfig=k,r.overEditor=l,r.$q=m,r.offeringDtoModifierSrv=n,r.offeringFinder=o,r.bookingHistorySrv=p,r.experimentsEnabler=q,r.init(),r}return __extends(b,a),b.$inject=["routeManager","appointmentService","cacheSrv","clientPages","ServiceTypes","serviceConst","servicesSrv","groupsSrv","appConfig","overEditor","$q","offeringDtoModifierSrv","offeringFinder","bookingHistorySrv","experimentsEnabler"],b.prototype.init=function(){this.overEditor.isOverEditor&&(this.fallbackFlow=new g(this.clientPages,this.routeManager,this.experimentsEnabler,this.appConfig.getIsMobile()),this.fallbackFlow.addSteps()),a.prototype.init.call(this)},b.prototype.initiateOfferingWidget=function(a){return this.storeFlowData("initiateOfferingWidget",arguments),this.currentFlow=new n(this.clientPages,this.routeManager,this.appointmentService,a,this.ServiceTypes,this.experimentsEnabler,this.appConfig.getIsMobile()),this.initializeFlowData(),this.$q.when()},b.prototype.initiateOfferingSelection=function(a){return this.storeFlowData("initiateOfferingSelection",arguments),this.currentFlow=new m(this.clientPages,this.routeManager,this.appointmentService,a,this.ServiceTypes,this.experimentsEnabler,this.appConfig.getIsMobile()),this.initializeFlowData(),this.$q.when()},b.prototype.initiateIndividual=function(a){return this.storeFlowData("initiateIndividual",arguments),this.startOfferingFlowByType(l.INDIVIDUAL,a)},b.prototype.initiateGroup=function(a){return this.storeFlowData("initiateGroup",arguments),this.startOfferingFlowByType(l.GROUP,a)},b.prototype.startOfferingFlowByType=function(a,b){var c=a===l.GROUP?i:h;return this.currentFlow=new c(this.clientPages,this.routeManager,this.appointmentService,b,this.ServiceTypes,this.experimentsEnabler,this.appConfig.getIsMobile()),this.initializeFlowData(),this.$q.when()},b.prototype.initiateReschedule=function(a){var b=this;if(this.storeFlowData("initiateReschedule",arguments),this.experimentsEnabler.isOfferingsUnificationEnabled())return this.offeringFinder.find(a.offeringDetails.id).then(function(c){b.currentFlow=new s(b.clientPages,b.routeManager,b.appointmentService,a,c,b.bookingHistorySrv,b.offeringDtoModifierSrv,b.ServiceTypes,b.experimentsEnabler,b.appConfig.getIsMobile())}).then(function(){return b.initializeFlowData()});var c=a.offeringDetails.type===l.GROUP?this.rescheduleGroup:this.rescheduleIndividual;return c.apply(this,arguments)},b.prototype.initiateBookAnother=function(a){var b=this;if(this.storeFlowData("initiateBookAnother",arguments),this.experimentsEnabler.isOfferingsUnificationEnabled())return this.offeringFinder.find(a.offeringDetails.id).then(function(a){b.currentFlow=new r(b.clientPages,b.routeManager,b.appointmentService,a,b.ServiceTypes,b.experimentsEnabler,b.appConfig.getIsMobile())}).then(function(){return b.initializeFlowData()});var c=a.offeringDetails.type===l.GROUP?this.bookAnotherGroup:this.bookAnotherIndividual;return c.apply(this,arguments)},b.prototype.initiateMemberAreaBookAnother=function(a){this.storeFlowData("initiateMemberAreaBookAnother",arguments);var b;return b=this.experimentsEnabler.isOfferingsUnificationEnabled()?this.bookAnotherMemberArea:a.offeringDetails.type===l.GROUP?this.bookAnotherMemberAreaGroup:this.bookAnotherMemberAreaIndividual,b.apply(this,arguments)},b.prototype.initiateMemberAreaReschedule=function(a){this.storeFlowData("initiateMemberAreaReschedule",arguments);var b;return b=this.experimentsEnabler.isOfferingsUnificationEnabled()?this.rescheduleMemberArea:a.offeringDetails.type===l.GROUP?this.rescheduleMemberAreaGroup:this.rescheduleMemberAreaIndividual,b.apply(this,arguments)},b.prototype.getOfferingForBooking=function(a){return this.offeringFinder.find(a.offeringDetails.parentOfferingId||a.offeringDetails.id)},b.prototype.initiateBookFromOfferPage=function(a){this.storeFlowData("initiateBookFromOfferPage",arguments),this.currentFlow=new k(this.clientPages,this.routeManager,this.appointmentService,a,this.ServiceTypes,this.experimentsEnabler,this.appConfig.getIsMobile()),this.initializeFlowData()},b.prototype.isRescheduleFlow=function(){return!!this.appointmentService.getCurrentBooking()},b.prototype.rescheduleIndividual=function(a,b){return this.rescheduleIndividualBase(a,b,f)},b.prototype.rescheduleMemberAreaIndividual=function(a,b){return this.rescheduleIndividualBase(a,b,v)},b.prototype.rescheduleGroup=function(a,b){return this.rescheduleGroupBase(a,b,e)},b.prototype.rescheduleMemberAreaGroup=function(a,b){return this.rescheduleGroupBase(a,b,u)},b.prototype.rescheduleGroupBase=function(a,b,c){var d=this;return this.groupsSrv.gettingGroupsList().then(function(e){d.rescheduleBookingBase(e.classes,a,b,c)})},b.prototype.rescheduleIndividualBase=function(a,b,c){var d=this;return this.servicesSrv.gettingServices().then(function(e){d.rescheduleBookingBase(e.services,a,b,c)})},b.prototype.bookAnotherGroup=function(a){return this.bookAnotherGroupBase(a,d)},b.prototype.bookAnotherIndividual=function(a){return this.bookAnotherIndividualBase(a,c)},b.prototype.bookAnotherMemberAreaGroup=function(a){return this.bookAnotherGroupBase(a,p)},b.prototype.bookAnotherMemberAreaIndividual=function(a){return this.bookAnotherIndividualBase(a,q)},b.prototype.bookAnotherMemberArea=function(a){var b=this;return this.getOfferingForBooking(a).then(function(a){b.currentFlow=new o(b.clientPages,b.routeManager,b.appointmentService,a,b.ServiceTypes,b.experimentsEnabler,b.appConfig.getIsMobile()),b.initializeFlowData()})},b.prototype.rescheduleMemberArea=function(a){var b=this;return this.getOfferingForBooking(a).then(function(c){b.currentFlow=new t(b.clientPages,b.routeManager,b.appointmentService,a,c,b.bookingHistorySrv,b.offeringDtoModifierSrv,b.ServiceTypes,b.experimentsEnabler,b.appConfig.getIsMobile()),b.initializeFlowData()})},b.prototype.bookAnotherGroupBase=function(a,b){var c=this;return this.groupsSrv.gettingGroupsList().then(function(d){c.bookAnotherOfferingBase(d.classes,a,b)})},b.prototype.bookAnotherIndividualBase=function(a,b){var c=this;return this.servicesSrv.gettingServices().then(function(d){c.bookAnotherOfferingBase(d.services,a,b)})},b.prototype.rescheduleBookingBase=function(a,b,c,d){var e=this;this.createFlowWithRelevantOffering(a,b,function(a){return new d(e.clientPages,e.routeManager,e.appointmentService,b,a,c,e.bookingHistorySrv,e.serviceConst,e.ServiceTypes,e.experimentsEnabler,e.appConfig.getIsMobile())}),this.initializeFlowData()},b.prototype.bookAnotherOfferingBase=function(a,b,c){var d=this;this.createFlowWithRelevantOffering(a,b,function(a){return new c(d.clientPages,d.routeManager,d.appointmentService,a,d.ServiceTypes,d.experimentsEnabler)}),this.initializeFlowData()},b.prototype.createFlowWithRelevantOffering=function(a,b,c){var d=this.findOfferingByBooking(a,b);d&&(this.currentFlow=c(d))},b.prototype.findOfferingByBooking=function(a,b){var c=b.offeringDetails.parentOfferingId||b.offeringDetails.id;return a.find(function(a){return c===a.id})},b}(b.FlowManagerCore);b.FlowManagerSrv=w,angular.module("schedulerAngularClientAppInternal").service("flowManagerSrv",w)}(c=b.navigation||(b.navigation={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){function c(a,b){return a===d.INDIVIDUAL?0===b%3?"CUSTOMER":1===b%3?"BUSINESS":"OTHER":0===b%2?"BUSINESS":"OTHER"}var d=a.bookings.visitor.offerings.OfferingTypes;b.createBookingHistoryStaffList=function(a){return new Array(a).fill(null).map(function(a,b){return{id:"staff-id-"+b,fullName:"Staff Name "+b}})},b.createBookingHistoryOfferings=function(a){return new Array(a).fill(null).map(function(a,b){var e=b%2?d.INDIVIDUAL:d.GROUP;return{type:e,id:"offering-id-"+b,name:"Offering: "+b+" - "+e,duration:10*(b+1),price:10.5,minCharge:0===b%2?2:null,currency:"USD",location:c(e,b),categoryId:0===b%2?"cat_id_1":"cat_id_2",locationText:0===b%2?"Other Location "+b:""}})},b.createBookingsFromServer=function(a,b,c){return new Array(a).fill(null).map(function(a,e){return{bookingId:"booking-id-"+e,start:Date.now()+1e7,end:Date.now()+1e8,staffId:b[e%b.length].id,offeringId:c[e%c.length].id,locationInfo:"At the park, near bench "+e,numOfParticipants:1,allowedActions:{cancel:!!(e%5),reschedule:!!(e%3),bookAnother:!!(e%2)},groupInstanceId:c[e%c.length].type===d.GROUP?"id_"+e:null}})},b.createTestingBookingList=function(a){var b;inject(function(a){return b=a});var c=new Array(a).fill(null).map(function(a,c){var e={name:"some offering name",id:"related-offering-id-"+c,type:d.INDIVIDUAL},f={fullName:"Staff Name",id:"related-staff-id-"+c};return b.buildBooking({bookingId:"booking-id-"+c,staffId:f.id,offeringId:e.id,start:Date.now()+1e5,end:Date.now()+1e8,location:"Some location "+c,allowedActions:{cancel:!0,reschedule:!0,bookAnother:!0}},f,e)});return{bookings:c}}}(c=b.account||(b.account={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();a.LoggedInUserIsOwner=b,angular.module("schedulerAngularClientAppInternal").component("bksNotificationModal",{template:'<div data-hook="notification-modal" class="notification-modal">\n                    <div class="notification-modal__content">\n                        <div data-hook="notification-modal-close" \n                             class="notification-modal__close scheduler-svg-font-icons-close"\n                             ng-click="$ctrl.dismiss()"></div>\n                        <div data-hook="notification-modal-message"\n                             class="notification-modal__message"\n                             ng-transclude></div>\n                        <button type="button" \n                              data-hook="notification-modal-confirm-button"\n                              ng-click="$ctrl.confirm()"\n                              class="notification-modal__action btn-primary">{{$ctrl.okLabel}}</button>\n                    </div>\n                 </div>',controller:b,transclude:!0,bindings:{dismiss:"&",confirm:"&",okLabel:"@"}})}(b=a.user||(a.user={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.URL_PREFIX="_api/scheduler-server/visitor/",b.VISITOR_OFFERINGS="offerings/",a.OfferingsApiConst=b;var c=function(){function a(a,c){var d=this;this.commonApiBase=a,this.$http=c,this.gettingOfferingsList=this.commonApiBase.httpWrapper(function(){return d.$http.get(b.URL_PREFIX+b.VISITOR_OFFERINGS)})}return a.$inject=["commonApiBase","$http"],a}();a.OfferingsApi=c,angular.module("schedulerAngularClientAppInternal").service("offeringsApi",c)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.fromDto=function(a){return new c(a)},a}();a.OfferingFactory=b;var c=function(){function b(a){this.dto=a,this.dummy=!1}return b.prototype.toDto=function(){return this.dto},Object.defineProperty(b.prototype,"id",{get:function(){return this.dto.id},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"type",{get:function(){return this.dto.type},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"categoryId",{get:function(){return this.dto.categoryId},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"order",{get:function(){return this.dto.order},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"name",{get:function(){return this.dto.info.name},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"description",{get:function(){return this.dto.info.description},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"images",{get:function(){return this.dto.info.images},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"capacity",{get:function(){return this.dto.schedulePolicy.capacity},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"duration",{get:function(){return this.dto.schedule.durationInMinutes},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"currency",{get:function(){return this.dto.payment.currency},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"price",{get:function(){return this.dto.payment.price},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isFree",{get:function(){return this.dto.payment.isFree},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"priceText",{get:function(){return this.dto.payment.priceText},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"paymentType",{get:function(){return this.dto.payment.paymentType},enumerable:!0,configurable:!0}),b.prototype.toLegacyService=function(){return a.OfferingDomainToLegacyServiceMapper.map(this)},b}();a.Offering=c}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(b){var c=this;this.dto=b,this.categoryToOfferingsMapping=new Map,this.offeringDomains=b.offerings.map(function(b){return a.OfferingFactory.fromDto(b)}),this.offeringDomains.forEach(function(a){return c.addOfferingDomainToMap(a)})}return Object.defineProperty(b.prototype,"categories",{get:function(){return this.dto.categories},enumerable:!0,configurable:!0}),b.prototype.getForCategoryId=function(a){return this.categoryToOfferingsMapping.get(a)||[]},b.prototype.getAll=function(){return this.offeringDomains},b.prototype.find=function(a){return this.offeringDomains.find(function(b){return b.id===a})||null},b.prototype.addOfferingDomainToMap=function(a){var b=a.categoryId;this.categoryToOfferingsMapping.has(b)||this.categoryToOfferingsMapping.set(b,[]),this.categoryToOfferingsMapping.get(b).push(a)},b}();a.OfferingsProvider=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function b(a,b,c,d){this.offeringsApi=a,this.boostInjectionPersister=b,this.overEditor=c,this.$q=d}return b.$inject=["offeringsApi","boostInjectionPersister","overEditor","$q"],b.prototype.gettingOfferingsList=function(){return this.gettingRawOfferings().then(function(b){return new a.OfferingsProvider(b)})},b.prototype.getBy=function(a){return this.gettingOfferingsList().then(function(b){return b.find(a)})},b.prototype.gettingRawOfferings=function(){var a=this;return this.gettingOfferingFromServer().then(function(b){return a.overEditor.enrichOfferingListIfOverEditor(b)})},b.prototype.gettingOfferingFromServer=function(){var a=this.boostInjectionPersister.getOfferingsList();return a?this.$q.when(a):this.offeringsApi.gettingOfferingsList()},b}();a.OfferingsListGetterSrv=b,angular.module("schedulerAngularClientAppInternal").service("offeringsListGetterSrv",b)}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a}();b.mainDataMapper=function(a){return{id:a.id,type:a.type,order:a.order,urlName:a.urlName,categoryId:a.categoryId}},b.infoMapper=function(a){return __assign({},a.info)},b.locationMapper=function(a){return{locationText:a.location.locationText,location:a.location.type}},b.paymentMapper=function(a){return __assign({},a.payment)},b.scheduleMapper=function(a){return __assign({},a.schedule,{duration:a.schedule.durationInMinutes})},b.schedulePolicyMapper=function(a){return __assign({},a.schedulePolicy,{numberOfParticipants:a.schedulePolicy.maxParticipantsPerOrder})},b.groupScheduleMapper=function(a){return __assign({},b.scheduleMapper(a),{classHours:a.schedule.classHours})},b.groupSchedulePolicyMapper=function(a){return __assign({},b.schedulePolicyMapper(a))},b.individualScheduleMapper=function(a){return __assign({},b.scheduleMapper(a))},b.individualSchedulePolicyMapper=function(a){return __assign({},b.schedulePolicyMapper(a),{staffMembersIds:a.schedulePolicy.staffMembersIds})},b.commonMapper=function(a){return __assign({},b.infoMapper(a),b.locationMapper(a),b.paymentMapper(a),b.mainDataMapper(a))},b.groupOfferingMapper=function(a){return __assign({},b.groupSchedulePolicyMapper(a),b.groupScheduleMapper(a),b.commonMapper(a))},b.individualOfferingMapper=function(a){return __assign({},b.individualSchedulePolicyMapper(a),b.individualScheduleMapper(a),b.commonMapper(a))},b.map=function(c){var d,e=c.toDto();switch(e.type){case a.OfferingTypes.GROUP:d=b.groupOfferingMapper;break;case a.OfferingTypes.INDIVIDUAL:d=b.individualOfferingMapper}return __assign({},d(e),{dummy:c.dummy})},a.OfferingDomainToLegacyServiceMapper=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(a){this.domain=a,this.showFullText=!1}return Object.defineProperty(a.prototype,"id",{get:function(){return this.domain.id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"type",{get:function(){return this.domain.type},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return this.domain.name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"description",{get:function(){return this.domain.description},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"images",{get:function(){return this.domain.images},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"capacity",{get:function(){return this.domain.capacity},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){return this.domain.duration},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currency",{get:function(){return this.domain.currency},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"price",{get:function(){return this.domain.price},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isFree",{get:function(){return this.domain.isFree},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"priceText",{get:function(){return this.domain.priceText},enumerable:!0,configurable:!0}),a.prototype.toLegacyService=function(){return this.domain.toLegacyService()},a}();a.OfferingListItemVm=b}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(){var a=function(){function a(a,b){this.$filter=a,this.offeringSettingKeysGetterSrv=b}return a.$inject=["$filter","offeringSettingKeysGetterSrv"],a.prototype.getButtonText=function(){var a=this.settingKeys.text.bookButtonText;return this.$filter("wixSdkTranslate")("service-select-button",a)},a.prototype.getCustomClass=function(){return this.settingKeys.design.offeringType},Object.defineProperty(a.prototype,"settingKeys",{get:function(){return this.offeringSettingKeysGetterSrv.getKeys().offeringsList},enumerable:!0,configurable:!0}),a}();angular.module("schedulerAngularClientAppInternal").component("bksOfferingTile",{template:'<boost-service-tile service="$ctrl.offering"\n                                       size="{{$ctrl.size}}"\n                                       template="{{$ctrl.template}}"\n                                       config="$ctrl.tileConfig"\n                                       button-text="{{$ctrl.getButtonText()}}"\n                                       custom-class="{{$ctrl.getCustomClass()}}"\n                                       style="width:100%;"></boost-service-tile>',controller:a,bindings:{offering:"=",size:"@",template:"@",tileConfig:"=config"}})}(b=a.offerings||(a.offerings={}))}(b=a.visitor||(a.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(a){function c(c,d){var e,f=a.call(this,c,d)||this;return f.offeringTypeForStyles===b.OfferingTypes.INDIVIDUAL?(f.tileTemplate=c.getServiceListTemplate(),f.tileConfig=c.getServiceTileConfig(),e=c.getIndividualCategoryLayout()):(f.tileTemplate=c.getGroupListTemplate(),f.tileConfig=c.getGroupsTileConfig(),e=c.getGroupsCategoryLayoutType()),f.columnsAmount=c.getNumberOfColumns(f.tileTemplate,e),f.serviceItemClass=f.mapColumnsAmountToClass(),f}return __extends(c,a),c.$inject=["appSettings","SERVICE_CATEGORY_LAYOUT"],c}(a.boost.visitor.ServicesList);angular.module("schedulerAngularClientAppInternal").component("bksOfferingItemsList",{templateUrl:"modules/offering/offering-list/offering-items-list/offering-items-list.preload.html",bindings:{offerings:"=",offeringTypeForStyles:"@",category:"="},controller:c})}(c=b.offerings||(b.offerings={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var wix;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function c(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this;this.$scope=a,this.$rootScope=c,this.SERVICE_CATEGORY_LAYOUT=d,this.groupsSrv=e,this.flowManagerSrv=f,this.clientPages=g,this.TILE_LIST_EVENTS=h,this.overEditor=i,this.visitorBILogger=j,this.activeFeatures=k,this.features=l,this.appSettings=m,this.IS_ONBOARDING=n,this.offeringSettingKeysGetterSrv=o,this.$filter=p,this.groupSelectedButNotPremium=!1,this.updateOfferingsPerCategory=function(a){q.updateCategoryId(a),q.currentOfferings=q.getOfferingsForCategory(a)},this.categories=this.offeringsList.categories,this.isNoServicesOverEditor=i.isOverEditor&&this.offeringsList.getAll().length&&this.offeringsList.getAll()[0].dummy,this.serviceStyleClass=this.offeringSettingKeysGetterSrv.getKeys().offeringsList.design.offeringType,this.offeringTypeForSettings="service"===this.serviceStyleClass?b.OfferingTypes.INDIVIDUAL:b.OfferingTypes.GROUP,this.categoriesType=this.offeringTypeForSettings===b.OfferingTypes.INDIVIDUAL?m.getIndividualCategoryLayout(this.categories.length):m.getGroupsCategoryLayoutType(this.categories.length),this.registerListeners(),this.categories&&this.categories.length>0&&this.updateOfferingsPerCategory(this.categories[0].id)}return c.$inject=["$scope","$rootScope","SERVICE_CATEGORY_LAYOUT","groupsSrv","flowManagerSrv","clientPages","TILE_LIST_EVENTS","overEditor","visitorBILogger","activeFeatures","features","appSettings","IS_ONBOARDING","offeringSettingKeysGetterSrv","$filter"],c.prototype.registerListeners=function(){var a=this;this.$scope.$on(this.TILE_LIST_EVENTS.TILE_SELECTED,function(b,c){a.navigate(c,"next")}),this.$scope.$on(this.TILE_LIST_EVENTS.TILE_SHOW_DETAILS,function(b,c){a.navigate(c,"showMoreDetails")})},c.prototype.isPageTitleShown=function(){return this.offeringSettingKeysGetterSrv.getOfferingTitleDefinitions().titleCanBeVisible&&!!this.getTitleText()},c.prototype.getPageTitle=function(){var a=this.offeringSettingKeysGetterSrv.getOfferingTitleDefinitions().titleOverrideValue;return a||this.getTitleText()},c.prototype.getTitleText=function(){var a=this.offeringSettingKeysGetterSrv.getKeys().offeringsList.text.title;return this.$filter("wixSdkTranslate")("offering-list.title",a)},c.prototype.hasOfferings=function(){return this.currentOfferings&&this.currentOfferings.length>0},c.prototype.isShowInstruction=function(){return this.overEditor.isEditModeAndNotVisitedOwner()&&this.IS_ONBOARDING},c.prototype.isCategoriesAvailable=function(){return this.categoriesType!==this.SERVICE_CATEGORY_LAYOUT.NONE},c.prototype.updateCategoryId=function(a){this.selectedCategory=a},c.prototype.navigate=function(a,c){this.flowManagerSrv.initiateOfferingSelection(a.toLegacyService()),this.visitorBILogger.bookIt(),a.type!==b.OfferingTypes.GROUP||this.isGroupSelectionAllowed()?this.flowManagerSrv.doNavigation(c):(this.visitorBILogger.bookedGroupButNotPremium(),this.groupsSrv.notifyingNonPremiumEnrollmentAttempt(),this.showGroupButNotPremiumNotification())},c.prototype.showGroupButNotPremiumNotification=function(){this.groupSelectedButNotPremium=!0,this.$rootScope.$broadcast(a.boost.visitor.directives.ScrollToMe.SCROLL_EVENT,{toElement:"appMessage"})},c.prototype.isGroupSelectionAllowed=function(){return this.activeFeatures[this.features.GROUPS]||this.overEditor.isDemoFlow},c.prototype.getOfferingsForCategory=function(a){var c=this.isCategoriesAvailable()?this.offeringsList.getForCategoryId(a):this.offeringsList.getAll();return c.map(function(a){return new b.OfferingListItemVm(a)})},c}();b.OfferingListPage=c,angular.module("schedulerOfferingsAppInternal").component("bksOfferingListPage",{templateUrl:"modules/offering/offering-list/offering-list-page/desktop/offering-list-page.preload.html",bindings:{offeringsList:"="},controller:c})}(c=b.offerings||(b.offerings={}))}(c=b.visitor||(b.visitor={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d["throw"](a))
}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,f&&(g=f[2&c[0]?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;switch(f=0,g&&(c=[0,g.value]),c[0]){case 0:case 1:g=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,f=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(g=i.trys,!(g=g.length>0&&g[g.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3])){i.label=c[1];break}if(6===c[0]&&i.label<g[1]){i.label=g[1],g=c;break}if(g&&i.label<g[2]){i.label=g[2],i.ops.push(c);break}g[2]&&i.ops.pop(),i.trys.pop();continue}c=b.call(a,i)}catch(d){c=[6,d],f=0}finally{e=g=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,f,g,h,i={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return h={next:c(0),"throw":c(1),"return":c(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},wix;!function(a){var b;!function(b){var c;!function(b){var c=a.boost.visitor.directives.ScrollToMe,d=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=a.call(this,b,d,e,c)||this;return s.$rootScope=c,s.experimentManager=f,s.$wix=g,s.flowManagerSrv=h,s.ServiceTypes=i,s.routeManager=j,s.clientPages=k,s.activeFeatures=l,s.features=m,s.overEditor=n,s.groupsSrv=o,s.visitorBILogger=p,s.$timeout=q,s.wixBiLogger=r,s.shouldShowPremiumGroupMessage=!1,s.defineProps(),s}return __extends(b,a),b.$inject=["$locale","$rootScope","wixAngularTopology","commonApiConst","experimentManager","$wix","flowManagerSrv","ServiceTypes","routeManager","clientPages","activeFeatures","features","overEditor","groupsSrv","visitorBILogger","$timeout","wixBiLogger"],b.prototype.defineProps=function(){this.initExperiments(),this.initBiParams(),this.initOnBookAction(),this.initOffering(),this.initBusinessInfo(),this.initOnOfferingsListRequestedAction()},b.prototype.initOnOfferingsListRequestedAction=function(){var a=this;this.props.onOfferingsListRequested=function(){return a.flowManagerSrv.prev()}},b.prototype.navigateToCalendar=function(){this.flowManagerSrv.next()},b.prototype.initOffering=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return this.props.offering=this.offering,[2]})})},b.prototype.initExperiments=function(){this.props.experiments=this.experimentManager.provider.experiments},b.prototype.initBusinessInfo=function(){this.props.businessInfo=this.businessInfo},b.prototype.initOnBookAction=function(){var a=this;this.props.onBook=function(){a.offering.type!==a.ServiceTypes.GROUP||a.isGroupSelectionAllowed()?a.navigateToCalendar():(a.shouldShowPremiumGroupMessage=!0,a.scrollToErrorMessage(),a.visitorBILogger.bookedGroupButNotPremium(),a.groupsSrv.notifyingNonPremiumEnrollmentAttempt())}},b.prototype.scrollToErrorMessage=function(){var a=this;this.$timeout(function(){a.$rootScope.$broadcast(c.SCROLL_EVENT,{toElement:"appMessage"})})},b.prototype.isGroupSelectionAllowed=function(){return this.activeFeatures[this.features.GROUPS]||this.overEditor.isDemoFlow},b.prototype.initBiParams=function(){this.props.defaultBIParams=this.wixBiLogger.getConfig().defaultEventArgs},b.prototype.getModuleName=function(){return b.MODULE},b}(a.bookings.common.ReactRendererCtrl);d.MODULE="bookings-offering-page",b.OfferingPage=d,angular.module("schedulerAngularClientAppInternal").component("bksOfferingPage",{template:'\n       <div ng-class="{\'offering-page-wrapper\': $ctrl.shouldShowPremiumGroupMessage}" data-hook="offering-page">\n          <app-message class="offering-page__message" ng-if="$ctrl.shouldShowPremiumGroupMessage" boost-scroll-to-me="appMessage" data-hook="premium-groups-app-message" type="error" text="{{\'groups-list.premium-not-enabled.message\' | translate}}"></app-message>\n          '+a.bookings.common.ReactRendererCtrl.getTemplate("BookingsOfferingPage")+"\n      </div>",bindings:{offering:"<",businessInfo:"<"},controller:d}).factory("BookingsOfferingPage",function(){return WixBookingsUoUOfferingPage.default})}(c=b.offering_page||(b.offering_page={}))}(b=a.bookings||(a.bookings={}))}(wix||(wix={}));
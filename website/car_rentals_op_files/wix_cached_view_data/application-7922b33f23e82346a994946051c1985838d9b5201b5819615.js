function select_all(obj){var text_val=eval(obj);text_val.focus(),text_val.select()}function setDefault(e,t){return"undefined"==typeof e||null==e||""===e?t:e}function loadFonts(e){var t=["Courier New","Georgia","Palatino Linotype","Times New Roman","Arial","Arial Black","Comic Sans","Tahoma","Verdana","Lucida Sans Unicode","Lucida Console","Comic sans ms","Impact"],i=[];for(a in e)0!=e[a].length&&-1==$.inArray(e[a],t)&&-1==e[a].search(",")&&i.push(e[a]);for(e=i,a=0;a<e.length;a++)e[a]=replaceAll("-"," ",e[a]);"undefined"==typeof ALL_FONTS&&(ALL_FONTS=[]);var n=!1;for(var a in e){var r=e[a];-1==$.inArray(r,ALL_FONTS)&&(ALL_FONTS.push(r),n=!0)}0!=n&&"undefined"!=typeof WebFont&&WebFont.load({google:{families:e}})}function replaceAll(e,t,i){return"undefined"==typeof i?i:i.replace(new RegExp(e,"g"),t)}function ajaxController(e,t){var i=this;i.url=e.url,i.data=e.data,"undefined"!=typeof e.errorsElement&&(i.errorsElement=e.errorsElement,i.err=new errorHandler(i.errorsElement),i.err.clearErrors()),"undefined"!=typeof e.buttonElement&&(i.buttonElement=e.buttonElement,i.buttonElement.toggleButton()),"undefined"!=typeof e.successElement&&(i.successElement=e.successElement,i.successElement.fadeOut("fast")),i.type="undefined"==typeof e.type?"POST":e.type,i.flashSuccess="undefined"==typeof e.flashSuccess?!0:e.flashSuccess;var n={url:i.url,type:i.type,data:i.data,beforeSend:e.skipCSRF?function(){}:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},dataType:"json"};e&&["contentType","processData"].forEach(function(t){t in e&&(n[t]=e[t])});var a=$.ajax(n);a.done(function(e){if(debug()("Ajax Response:",e),1==e.success)"undefined"!=typeof i.successElement&&(i.successElement.fadeIn("fast"),i.flashSuccess&&setTimeout(function(){i.successElement.fadeOut("fast")},2e3));else if("undefined"!=typeof i.errorsElement&&"undefined"!=typeof e.errors&&e.errors.length>0){for(var n=0;n<e.errors.length;n++)i.err.addError(e.errors[n]);var a=i.err.errors.join(", "),r="<div class='alert alert-danger text-center'>"+a+"</div>";$(".flash-error").html(r)}"undefined"!=typeof i.buttonElement&&i.buttonElement.toggleButton(),"undefined"!=typeof t&&t(e)}),a.fail(function(e){try{var n=e.responseJSON.error,a="<div class='alert alert-danger text-center'>"+n+"</div>";$(".flash-error").html(a)}catch(r){if("undefined"!=typeof i.errorsElement){i.err.addError('Difficulty contacting server. Please try again or contact <a href="mailto:support@powr.io"><u>support</u></a>');var n=i.err.errors.join(", "),a="<div class='alert alert-danger text-center'>"+n+"</div>";$(".flash-error").html(a)}}finally{if("undefined"!=typeof i.buttonElement&&i.buttonElement.toggleButton(),"undefined"!=typeof t){var e={success:!1};t(e)}}})}function errorHandler(e){var t=this;t.errors=[],t.element=e,t.addError=function(e){t.errors.push(e)},t.displayErrors=function(){if(t.errors.length>0){text="",text+="<ul>";for(var e=0;e<t.errors.length;e++)text+="<li>"+t.errors[e]+"</li>";text+="</ul>",t.element.html(text),t.element.fadeIn("slow")}},t.clearErrors=function(){t.errors=[],t.element.hide().html("")}}function flashMessage(e,t){t=setDefault(t,3e3),e.fadeIn("fast"),setTimeout(function(){e.fadeOut("fast")},t)}function htmlSafe(e){return e=replaceAll("'","&#x27;",e),e=replaceAll('"',"&quot;",e)}function inputSafe(e){return e.replace(/\\/g,"").replace(/(['"])/g,"\\$1"),e}function unHtmlSafe(e){return e=replaceAll("&#x27;","'",e),e=replaceAll("&quot;",'"',e)}function convertSecondsToComponents(e){var t=e,i=Math.max(0,Math.floor(t/86400));t-=86400*i;var n=Math.max(0,Math.floor(t/3600));t-=3600*n;var a=Math.max(0,Math.floor(t/60));return t=Math.max(0,t-60*a),{days:i,hours:n,minutes:a,seconds:t}}function initializeAhoy(){!function(e){"use strict";function t(){return _.urlPrefix+_.visitsUrl}function i(){return _.urlPrefix+_.eventsUrl}function n(){return(_.useBeacon||_.trackNow)&&A&&"undefined"!=typeof e.navigator.sendBeacon}function a(e,t,i){var n="",a="";if(i){var r=new Date;r.setTime(r.getTime()+60*i*1e3),n="; expires="+r.toGMTString()}var o=_.cookieDomain||_.domain;o&&(a="; domain="+o),document.cookie=e+"="+escape(t)+n+a+"; path=/"}function r(e){var t,i,n=e+"=",a=document.cookie.split(";");for(t=0;t<a.length;t++){for(i=a[t];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(n))return unescape(i.substring(n.length,i.length))}return null}function o(e){a(e,"",-1)}function s(t){r("ahoy_debug")&&e.console.log(t)}function l(){for(var e;e=O.shift();)e();I=!0}function c(e){I?e():O.push(e)}function d(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})}function u(){A&&a("ahoy_events",JSON.stringify(M),1)}function f(){return C("meta[name=csrf-token]").attr("content")}function p(){return C("meta[name=csrf-param]").attr("content")}function h(e){var t=f();t&&e.setRequestHeader("X-CSRF-Token",t)}function m(e,t,i){A&&C.ajax({type:"POST",url:e,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:h,success:i})}function g(e){var t={events:[e],visit_token:e.visit_token,visitor_token:e.visitor_token};return delete e.visit_token,delete e.visitor_token,t}function v(){c(function(){})}function y(e){c(function(){var t=g(e),n=p(),a=f();n&&a&&(t[n]=a);var r=new Blob([JSON.stringify(t)],{type:"application/json; charset=utf-8"});navigator.sendBeacon(i(),r)})}function b(){return _.page||e.location.pathname}function w(e){var t=C(e.currentTarget);return{tag:t.get(0).tagName.toLowerCase(),id:t.attr("id"),"class":t.attr("class"),page:b(),section:t.closest("*[data-section]").data("section")}}function $(){if(I=!1,x=null,k=null,T=null,x&&k&&!T)s("Active visit"),l();else if(T&&o("ahoy_track"),x||(x=d(),a("ahoy_visit",x,E)),r("ahoy_visit")){s("Visit started"),k||(k=d(),a("ahoy_visitor",k,P));var i={visit_token:x,visitor_token:k,platform:_.platform,landing_page:e.location.href,screen_width:e.screen.width,screen_height:e.screen.height,app_id:e.APP_MODEL.meta.id};document.referrer.length>0&&(i.referrer=document.referrer),s(i),m(t(),i,l)}else s("Cookies disabled"),l()}var _={urlPrefix:"",visitsUrl:counterUri()+"/"+APP_MODEL.meta.id,eventsUrl:counterUri()+"/ahoy/events",cookieDomain:null,page:null,platform:"Web",useBeacon:!1,startOnReady:!0},S=e.ahoy||e.Ahoy||{};S.configure=function(e){for(var t in e)e.hasOwnProperty(t)&&(_[t]=e[t])},S.configure(S);var x,k,T,C=e.jQuery||e.Zepto||e.$,E=240,P=1051200,I=!1,O=[],A="undefined"!=typeof JSON&&"undefined"!=typeof JSON.stringify,M=[];S.getVisitId=S.getVisitToken=function(){return r("ahoy_visit")},S.getAppId=S.getVisitToken=function(){return e.APP_MODEL.meta.id},S.getVisitorId=S.getVisitorToken=function(){return r("ahoy_visitor")},S.reset=function(){return o("ahoy_visit"),o("ahoy_visitor"),o("ahoy_events"),o("ahoy_track"),!0},S.debug=function(e){return e===!1?o("ahoy_debug"):a("ahoy_debug","t",525600),!0},S.track=function(e,t){var i={id:d(),name:e,properties:t||{},time:(new Date).getTime()/1e3};C(function(){s(i)}),c(function(){S.getVisitId()||$(),i.visit_token=S.getVisitId(),i.visitor_token=S.getVisitorId(),i.app_id=S.getAppId(),n()?y(i):(M.push(i),u(),setTimeout(function(){v(i)},1e3))})},S.trackView=function(t){var i={url:e.location.href,title:document.title,page:b()};if(t)for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);S.track("$view",i)},S.trackClicks=function(){C(document).on("click","a, button, input[type=submit]",function(e){var t=C(e.currentTarget),i=w(e);i.text="input"==i.tag?t.val():C.trim(t.text().replace(/[\s\r\n]+/g," ")),i.href=t.attr("href"),S.track("$click",i)})},S.trackSubmits=function(){C(document).on("submit","form",function(e){var t=w(e);S.track("$submit",t)})},S.trackChanges=function(){C(document).on("change","input, textarea, select",function(e){var t=w(e);S.track("$change",t)})},S.trackAll=function(){S.trackView(),S.trackClicks(),S.trackSubmits(),S.trackChanges()};try{M=JSON.parse(r("ahoy_events")||"[]")}catch(R){}for(var F=0;F<M.length;F++)v(M[F]);S.start=function(){$(),S.start=function(){}},C(function(){_.startOnReady&&S.start()}),e.ahoy=S}(window),ahoy.trackAll()}function flashSale(){$("#userNotification").modal()}function debug(){return"undefined"==typeof ENVIRONMENT||"production"==ENVIRONMENT?function(){}:console.log.bind(window.console)}function imageThumbUrl(e){var t=["large","medium","original"],i=e;for(var n in t)i=i.replace("/"+t[n]+"/","/thumb/");return i}function imageUrl(e,t){var i=["thumb","large","medium","original"],n=e;for(var a in i)n=n.replace("/"+i[a]+"/","/"+t+"/");return n}function baseUri(){var e=document.location;return e.protocol+"//"+e.host}function nodeUri(e){var e=e||"",t=ENVIRONMENT;switch(t){case"development":return"https://localhost:3001"+e;case"staging":return"https://powr-outlet-staging.herokuapp.com"+e;case"production":return"https://powr-outlet.herokuapp.com"+e}return"https://powr-outlet-staging.herokuapp.com"}function counterUri(){var e=ENVIRONMENT;switch(e){case"development":return"https://localhost:4567";case"staging":return"https://powr-counter-staging.herokuapp.com";case"production":return"https://powr-counter.herokuapp.com"}}function cloudfrontNodeUri(){var e=ENVIRONMENT;switch(e){case"development":return nodeUri();case"staging":return"";case"production":return""}return"https://powr-outlet-staging.herokuapp.com"}function validateUrl(e){var t=e.find(".urlValidationError"),i=e.find("input"),n=i.val(),a=/^http([s]?):\/\/.*/;a.test(n)===!0||0==n.length?(t.hide(),debug()("Url is valid")):(t.html("Url is not valid!").fadeIn(),debug()("Url is not valid"))}function parseVideo(e){var t=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/,i=e.match(t);return i&&11==i[2].length?{valid:!0,type:"youtube",id:i[2]}:(t=/http(s)?:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/,i=e.match(t),i?{valid:!0,type:"vimeo",id:i[3]}:{valid:!1})}function urlFormat(e){return e=$.trim(e),e.match(/^http([s]?):\/\/.*/)||e.match(/^mailto:.*/)||e.match(/^tel:.*/)?e:"http://"+e}function isValidUrl(e){return/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}function collapse(e,t,i){var n=parseInt(APP_MODEL.get("pluginWidth")),a=parseInt($("#appView").outerWidth());return e>n||e>a?i:t}function testStringWidth(e,t,i){var n=t+"px "+i,a=$("<div>"+e+"</div>").css({position:"absolute","float":"left","white-space":"nowrap",visibility:"hidden",font:n}).appendTo($("body")),r=a.width();return a.remove(),r}function fitText(e){e.each(function(){var e=$(this).data("orig-font-size");if(void 0==e){var e=parseInt($(this).css("fontSize"));$(this).data("orig-font-size",e)}var t=0,i=parseInt($(this).data("fit-text-width"));t=i?i:$(this).parents(".fitTextParent").length>0?$(this).parents(".fitTextParent").width():$(this).parent().width();var n=$(this).css("fontFamily"),a=$(this).text();if($(this).find("br").length>0){var r=$(this).clone();r.find("br").replaceWith(" "),a=r.text()}var o=$.trim(a);"undefined"==typeof LONGEST_WORDS&&(LONGEST_WORDS={}),null==LONGEST_WORDS[n]&&(LONGEST_WORDS[n]={}),"undefined"==typeof TOO_LONG_WORDS&&(TOO_LONG_WORDS={}),null==TOO_LONG_WORDS[n]&&(TOO_LONG_WORDS[n]={});var s="",l=TOO_LONG_WORDS[n].hasOwnProperty(o)||!1;if(null==LONGEST_WORDS[n][o]){for(var c=o.split(/\s/),d=[],u=0,f=25,p=0;p<c.length;p++)c[p].length>=s.length-5?(c[p].length>s.length&&c[p].length<f&&(s=c[p]),d.push(c[p])):c[p].length>=f&&(l=!0,(!TOO_LONG_WORDS[n].hasOwnProperty(o)||TOO_LONG_WORDS[n][o].length<c[p].length)&&(TOO_LONG_WORDS[n][o]=c[p]));for(var p=0;p<d.length;p++)if(d[p].length>=s.length-5&&d[p].length<f){var h=computeWidth(d[p],100,n);h>u&&(s=d[p],u=h)}else d[p].length>=f&&(l=!0,TOO_LONG_WORDS[n][o]=TOO_LONG_WORDS[n][o]||d[p]);LONGEST_WORDS[n][o]=s}else s=LONGEST_WORDS[n][o];$(this).hasClass("fitTextNoWrap")&&(s=" "+o+" ");var m=computeMaxFontSize(s,t,n);if(l){var g=computeWidth(TOO_LONG_WORDS[n][o],Math.min(m,parseInt(e)),n);l=g>=t}var v="inline-block"==$(this).css("display")||"block"==$(this).css("display"),y=l?{"-ms-word-break":"break-all","word-wrap":"break-word","word-break":v?"":"break-all","-webkit-hyphens":"auto","-moz-hyphens":"auto",hyphens:"auto"}:{};m<parseInt(e)?($(this).css($.extend({},{fontSize:m+"px"},y)),$(this).children().css($.extend({},{fontSize:m+"px"},y))):($(this).css($.extend({},{fontSize:e+"px"},y)),$(this).children().css($.extend({},{fontSize:e+"px"},y)))})}function computeMaxFontSize(e,t,i){"undefined"==typeof FONT_WIDTHS&&(FONT_WIDTHS={}),void 0==FONT_WIDTHS[i]&&(FONT_WIDTHS[i]={});var n=computeWidth(e,100,i),a=Math.floor(t/(FONT_FUDGE_FACTOR*n));return a>100&&(a=100),a}function computeWidth(e,t,i){return 55*e.length*FONT_FUDGE_FACTOR*t}function isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:!1}function isMobileSafari(){return navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/)}function isWebview(){var e=window.navigator.userAgent.toLowerCase(),t=/safari/.test(e),i=/iphone|ipod|ipad/.test(e),n=/version/.test(e);return i&&!t||i&&t&&n?!0:!1}function supportedVideoFormats(){if(window.SUPPORTED_VIDEO_FORMATS)return window.SUPPORTED_VIDEO_FORMATS;var e=document.createElement("video"),t={mpeg4:!1,h264:!1,ogg:!1,webm:!1};return e.canPlayType&&(t.mpeg4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=""!==e.canPlayType('video/webm; codecs="vp8, vorbis"')),window.SUPPORTED_VIDEO_FORMATS=t,t}function stripHTML(e){return e.replace(/<(?:.|\n)*?>/gm,"")}function safeAttr(e){return"string"!=typeof e?e:e.replace(new RegExp('"',"g"),"'")}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function toCamel(e){return e.replace(/[-_]([a-z])/g,function(e){return e[1].toUpperCase()})}function analyticsEvent(e,t,i){try{_gaq.push(["powr._trackEvent",e,t,i])}catch(n){}}function adrollEvent(e){try{analyticsEvent("adroll",e),__adroll.record_user({adroll_segments:e})}catch(t){debug()("Couldn't track",t)}}function parseQuery(e){if(""==e)return{};e=e.split("&");for(var t={},i=0;i<e.length;++i){var n=e[i].split("=",2);t[n[0]]=1==n.length?"":decodeURIComponent(n[1].replace(/\+/g," "))}return t}function isEmpty(e){return"number"==typeof e?!1:_.isEmpty(e)}function setCookie(e,t,i,n){var a=new Date;ex_timestamp=a.setDate(a.getDate()+i);var r=escape(t)+(null==i?"":"; expires="+a.toUTCString()+";path=/");if(document.cookie=e+"="+r,void 0==getCookie(e)&&"undefined"!=typeof n&&n)try{localStorage.setItem(e,JSON.stringify({value:t,expiration:ex_timestamp}))}catch(o){debug()("Local storage error:",o)}}function getCookie(e,t){var i,n,a,r=document.cookie.split(";");for(i=0;i<r.length;i++)if(n=r[i].substr(0,r[i].indexOf("=")),a=r[i].substr(r[i].indexOf("=")+1),n=n.replace(/^\s+|\s+$/g,""),n==e){var o=unescape(a);break}if(void 0==o&&"undefined"!=typeof t&&t){var s=localStorage.getItem(e);if(void 0==s||null==s||"null"==s)return;return s=JSON.parse(s),s.expiration<(new Date).getTime()?void localStorage.removeItem(e):s.value}return o}function originalQuery(){return document.location.search.replace("?","")}function getURLParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function pluginIcon(e){return"https://s3-us-west-1.amazonaws.com/powr/plugins/"+e+"/318x318.jpg"}function truncate(e,t){return e.length>t?e.substring(0,t-3)+"...":e}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function loadNodeImages(e){"undefined"==typeof e&&(e=$(document)),e.find("[data-node-image]").each(function(){var e=$(this).data("node-image");if(-1==e.search("amazonaws"))var t=e;else{if(e=e.replace(/[\+#]/g,function(e){return"%25"+encodeURIComponent(e).substr(1)}),$(this).parents(".nodeImageParent").length>0)var i=$(this).parents(".nodeImageParent");else var i=$(this).parent();var n=i.width();size=void 0==n||0==n?"large":n>=600?"large":n>=150?"medium":"small",e=encodeURIComponent(e),e=replaceAll("\\.","%2E",e);var t=nodeUri()+"/resize-image?url="+e+"&size="+size}$(this).attr("src",t)})}function hashEmail(e){if("string"!=typeof e||-1==e.search("@")||-1==e.search(".")||"undefined"==typeof CryptoJS)return"";e=$.trim(e);var t=CryptoJS.MD5(e.toLowerCase()).toString(CryptoJS.enc.Hex),i=CryptoJS.SHA1(e.toLowerCase()).toString(CryptoJS.enc.Hex),n=CryptoJS.SHA256(e.toLowerCase()).toString(CryptoJS.enc.Hex);return"it=4&iv="+t+"&it=4&iv="+i+"&it=4&iv="+n}function loadCrypto(e){"undefined"==typeof CRYPTO_LOADED?$.ajax({url:"/public-assets/crypto.min.js",cache:!0,dataType:"script",success:function(){CRYPTO_LOADED=!0,"undefined"!=typeof e&&e()}}):"undefined"!=typeof e&&e()}function _deliverHash(e){var t=hashEmail(e);if(0!=t.length&&"undefined"==typeof DELIVER_HASH){debug()("Delivering hash"),DELIVER_HASH=!0;var i=document.createElement("script");i.async=!0,i.src="//pippio.com/api/sync?pid=7876&"+t;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n),analyticsEvent("hashed_data",t)}}function deliverHash(e){0!=e.length&&void 0==getCookie("anonymized_user")&&(setCookie("anonymized_user",!0,1),loadCrypto(function(){_deliverHash(e)}))}function uniqueLabel(e){if("undefined"==typeof e&&(e={temp_label:!1}),0==e.temp_label){if("undefined"!=typeof APP_MODEL&&APP_MODEL.meta&&APP_MODEL.meta.unique_label)return APP_MODEL.meta.unique_label;if("undefined"!=typeof UNIQUE_LABEL)return UNIQUE_LABEL}var t="xxxxxxxx_".replace(/[x]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})+(new Date).getTime();return 0==e.temp_label&&("undefined"!=typeof APP_MODEL&&APP_MODEL.meta?APP_MODEL.meta.unique_label=t:UNIQUE_LABEL=t),t}function successometerModule(e,t){this.steps=e,this.$progressBarContainer=$(".progressBarContainer"),this.$progressBar=$(".progress-bar"),this.$progressTextSuccess=$(".progressTextSuccess"),this.$progressTextInProgress=$(".progressTextInProgress");for(var i in t)this[i]=t[i];this.initialize()}function walkthroughModule(e,t){this.steps=e,this.currentStep=0,this.$clickwheel=$(".clickwheel"),this.$walkthrough=$(".powrWalkthrough"),this.$walkthroughArrow=$(".walkthroughArrow"),this.$nextButton=$(".walkthroughNext"),this.$walkthroughTriggerNext=$(".walkthroughTriggerNext"),this.$walkthroughGetStarted=$(".walkthroughGetStarted"),this.$walkthroughNext=$(".walkthroughNext"),this.$walkthroughDone=$(".walkthroughDone"),this.$walkthroughSkip=$(".walkthroughSkip"),this.$prevButton=$(".walkthroughPrev"),this.$cancelButton=$(".walkthroughCancel"),this.$title=$(".walkthroughTitle"),this.$text=$(".walkthroughText"),this.$scrollListeners=$(".section, .scroll.wixSection"),this.transitionTime=1500;for(var i in t)this[i]=t[i];this.initialize()}function loadFile(e,t){var i=t.substring(t.lastIndexOf("%2F")+3);e.find(".fileName").val(i),e.find(".fileUrl").val(t),e.find(".existingTitle").html("Current file: "+i).attr("href",t),e.find(".addFile i").html(" "+POWr.simpleCopies("replace_file")),e.find(".noImage").addClass("hid")}function loadImage(e,t){e.find("img").attr("src",t),e.find("input").val(t),e.fadeIn("fast"),e.find(".addImage i").html(" Replace"),e.find(".noImage").addClass("hid")}function add_container(e,t,i){if("false"===t.attr("active"))return!1;if(t.hasClass("premium")||t.hasClass("ignore"))return!1;if(".modWrapper"===$(this).data("add-target")){$($(this).data("add-target"))}else if(t.parents(".multiAdd").length>0)var n=$(".prototype-wrapper");else var n=t.prev(".prototype-wrapper");n.addPrototype(function(n){if(n.find(".innerPanelToggle").click(),n.children(".mediaBar").find(".toggleSpace").click(),APP_SETTINGS.updatePremiumContent(),$(".add[data-type=image]").hasClass("premium")&&$(".add[data-type=image]").popover("show"),APP_SETTINGS.afterAdd(n,t),APP_SETTINGS.update(),"file"===e)var a=n.find(".fileInput");else if("image"===e)var a=n.find(".imageWrapper");i({success:!0,$file_wrapper:a})},{speed:"instant"})}function initialize_manager(e,t,i,n){var a=_.template(t.html(),{opts:{name:e,capitalName:e.humanize,accept:"*",hideUrl:n}});t.after(a),"file"===e?FILE_MANAGER=createFileManager({app_id:i,el:$("#fileManager")}):IMAGE_MANAGER=new imageManager({app_id:i,el:$("#imageManager")})}function show_file_manager(e,t){FILE_MANAGER.show(function(i){if(debug()("Response from file manager:",i),i.success)for(var n=0;n<i.images.length;n++){{i.images[n].medium_url}e===!0?add_container("file",t,function(e){var t=e.$file_wrapper;loadFile(t,i.images[n].medium_url),APP_SETTINGS.update()}):(loadFile(t,i.images[n].medium_url),APP_SETTINGS.update())}})}function show_image_manager(e,t,i,n){"wix"==HOST?Wix.Settings.openMediaDialog(Wix.Settings.MediaType.IMAGE,!0,function(i){if(debug()("Wix image data: ",i),"undefined"==typeof WIX_IMAGE_RESPONSE_LIMITER||!WIX_IMAGE_RESPONSE_LIMITER){WIX_IMAGE_RESPONSE_LIMITER=!0,setTimeout(function(){WIX_IMAGE_RESPONSE_LIMITER=!1},5e3);for(var n=0;n<i.length;n++){var a=i[n].relativeUri,o=Wix.Utils.Media.getResizedImageUrl(a,1200,1200);e===!0?add_container("image",t,function(e){var t=e.$file_wrapper;loadImage(t,o),APP_SETTINGS.update()}):(loadImage(t,r.images[n].medium_url),APP_SETTINGS.update())}}}):IMAGE_MANAGER.show(function(a){if(a.success)for(var r=0;r<a.images.length;r++){var o=a.images[r].medium_url;if(i){var s=$("#radio-custom-image").find("input"),l=$("#radio-custom-image").find("img");$(l).attr("src",o),$(s).val(o),$(s).attr("name",n),t.before($("#radio-custom-image").html()),APP_MODEL.set(n,o),$("#custom--upload").hide(),$(".replaceCustomUpload").click(function(){$(this).parent(".customRadioContainer").remove(),$("#custom--upload").show()})}else e===!0?add_container("image",t,function(e){var t=e.$file_wrapper;loadImage(t,a.images[r].medium_url),APP_SETTINGS.update()}):(loadImage(t,a.images[r].medium_url),APP_SETTINGS.update())}})}function shakeButton(e){e.addClass("shake"),setTimeout(function(){$(".newUpgrade").removeClass("shake")},2e3)}!function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var i,n=e(document);e.rails=i={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var i=e('meta[name="csrf-token"]').attr("content");i&&t.setRequestHeader("X-CSRF-Token",i)},refreshCSRFTokens:function(){var t=e("meta[name=csrf-token]").attr("content"),i=e("meta[name=csrf-param]").attr("content");e('form input[name="'+i+'"]').val(t)},fire:function(t,i,n){var a=e.Event(i);return t.trigger(a,n),a.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(n){var a,r,o,s,l,c,d,u;if(i.fire(n,"ajax:before")){if(s=n.data("cross-domain"),l=s===t?null:s,c=n.data("with-credentials")||null,d=n.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,n.is("form")){a=n.attr("method"),r=n.attr("action"),o=n.serializeArray();var f=n.data("ujs:submit-button");f&&(o.push(f),n.data("ujs:submit-button",null))}else n.is(i.inputChangeSelector)?(a=n.data("method"),r=n.data("url"),o=n.serialize(),n.data("params")&&(o=o+"&"+n.data("params"))):n.is(i.buttonClickSelector)?(a=n.data("method")||"get",r=n.data("url"),o=n.serialize(),n.data("params")&&(o=o+"&"+n.data("params"))):(a=n.data("method"),r=i.href(n),o=n.data("params")||null);u={type:a||"GET",data:o,dataType:d,beforeSend:function(e,a){return a.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+a.accepts.script),i.fire(n,"ajax:beforeSend",[e,a])},success:function(e,t,i){n.trigger("ajax:success",[e,t,i])},complete:function(e,t){n.trigger("ajax:complete",[e,t])},error:function(e,t,i){n.trigger("ajax:error",[e,t,i])},crossDomain:l},c&&(u.xhrFields={withCredentials:c}),r&&(u.url=r);var p=i.ajax(u);return n.trigger("ajax:send",p),p}return!1},handleMethod:function(n){var a=i.href(n),r=n.data("method"),o=n.attr("target"),s=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),c=e('<form method="post" action="'+a+'"></form>'),d='<input name="_method" value="'+r+'" type="hidden" />';l!==t&&s!==t&&(d+='<input name="'+l+'" value="'+s+'" type="hidden" />'),o&&c.attr("target",o),c.hide().append(d).appendTo("body"),c.submit()},disableFormElements:function(t){t.find(i.disableSelector).each(function(){var t=e(this),i=t.is("button")?"html":"val";t.data("ujs:enable-with",t[i]()),t[i](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(i.enableSelector).each(function(){var t=e(this),i=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[i](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t,n=e.data("confirm"),a=!1;return n?(i.fire(e,"confirm")&&(a=i.confirm(n),t=i.fire(e,"confirm:complete",[a])),a&&t):!0},blankInputs:function(t,i,n){var a,r,o=e(),s=i||"input,textarea",l=t.find(s);return l.each(function(){if(a=e(this),r=a.is("input[type=checkbox],input[type=radio]")?a.is(":checked"):a.val(),!r==!n){if(a.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+a.attr("name")+'"]').length)return!0;o=o.add(a)}}),o.length?o:!1},nonBlankInputs:function(e,t){return i.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return i.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},i.fire(n,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,n){e.crossDomain||i.CSRFProtection(n)}),n.delegate(i.linkDisableSelector,"ajax:complete",function(){i.enableElement(e(this))}),n.delegate(i.linkClickSelector,"click.rails",function(n){var a=e(this),r=a.data("method"),o=a.data("params"),s=n.metaKey||n.ctrlKey;if(!i.allowAction(a))return i.stopEverything(n);if(!s&&a.is(i.linkDisableSelector)&&i.disableElement(a),a.data("remote")!==t){if(s&&(!r||"GET"===r)&&!o)return!0;var l=i.handleRemote(a);return l===!1?i.enableElement(a):l.error(function(){i.enableElement(a)}),!1}return a.data("method")?(i.handleMethod(a),!1):void 0}),n.delegate(i.buttonClickSelector,"click.rails",function(t){var n=e(this);return i.allowAction(n)?(i.handleRemote(n),!1):i.stopEverything(t)}),n.delegate(i.inputChangeSelector,"change.rails",function(t){var n=e(this);return i.allowAction(n)?(i.handleRemote(n),!1):i.stopEverything(t)}),n.delegate(i.formSubmitSelector,"submit.rails",function(n){var a=e(this),r=a.data("remote")!==t,o=i.blankInputs(a,i.requiredInputSelector),s=i.nonBlankInputs(a,i.fileInputSelector);if(!i.allowAction(a))return i.stopEverything(n);if(o&&a.attr("novalidate")==t&&i.fire(a,"ajax:aborted:required",[o]))return i.stopEverything(n);if(r){if(s){setTimeout(function(){i.disableFormElements(a)},13);var l=i.fire(a,"ajax:aborted:file",[s]);return l||setTimeout(function(){i.enableFormElements(a)},13),l}return i.handleRemote(a),!1}setTimeout(function(){i.disableFormElements(a)},13)}),n.delegate(i.formInputClickSelector,"click.rails",function(t){var n=e(this);if(!i.allowAction(n))return i.stopEverything(t);var a=n.attr("name"),r=a?{name:a,value:n.val()}:null;n.closest("form").data("ujs:submit-button",r)}),n.delegate(i.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&i.disableFormElements(e(this))}),n.delegate(i.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&i.enableFormElements(e(this))}),e(function(){i.refreshCSRFTokens()}))}(jQuery),function(){var e,t=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};!function(i,n){var a;a=function(e,t){this.elem=e,this.$elem=i(e),this.options=t,this.cb_timer_id=null,this.stop_requested=!1},a.prototype={defaults:{event_name:"css-change",data_attr_name:"css-watch-data",use_event:!0,callback:null,props:"",props_functions:{}},init:function(){return this.config=i.extend({},this.defaults,this.options,this.metadata),this.config.props=this.splitAndTrimProps(this.config.props),this.config.props.length>0&&(this.setInitialData(),this.start()),this},splitAndTrimProps:function(e){var t,i,n;for(t=e.split(","),n=[],i=0;i<t.length;)n.push(t[i].trim()),i++;return n},setInitialData:function(){var e;for(e=0;e<this.config.props.length;)this.setData(this.config.props[e],this.getPropertyValue(this.config.props[e])),e++},setData:function(e,t){return this.$elem.data(""+this.config.data_attr_name+"-"+e,t)},updateDataFromChanges:function(e){var t,i,n,a,r;for(r=Object.keys(e),i=n=0,a=r.length;a>n;i=++n)t=r[i],this.setData(t,e[t])},getDataValue:function(e){return this.$elem.data(""+this.config.data_attr_name+"-"+e)},getPropertyValue:function(i){var a;if(0===Object.keys(this.config.props_functions).length)return this.$elem.css(i);if(a=null,t.call(Object.keys(this.config.props_functions),i)>=0&&(a=this.config.props_functions[i]),null!==a){if(n.ExecuteMethod)return e.executeMethodByFunctionName(a,this.$elem);console.log("You are missing the ExecuteMethod library.")}return this.$elem.css(i)},changedProperties:function(){var e,t;for(e=0,t={};e<this.config.props.length;)this.getPropertyValue(this.config.props[e])!==this.getDataValue(this.config.props[e])&&(t[this.config.props[e]]=this.getPropertyValue(this.config.props[e])),e++;return t},stop:function(){var e;if("undefined"!=typeof this.config&&null!==this.config)return e=!0,n.cssWatchCancelAnimationFrame(this.cb_timer_id)},start:function(){var e=this;"undefined"!=typeof this.config&&null!==this.config&&(this.stop_requested=!1,this.cb_timer_id=n.cssWatchRequestAnimationFrame(function(){e.check()}))},check:function(){var e,t=this;return"undefined"==typeof this.config||null===this.config?!1:this.stop_requested===!0?!1:(e=this.changedProperties(),Object.keys(e).length>0&&(this.config.use_event&&this.$elem.trigger(this.config.event_name,e),null!==this.config.callback&&this.config.callback.apply(null,[e]),this.updateDataFromChanges(e)),this.cb_timer_id=n.cssWatchRequestAnimationFrame(function(){t.check()}),!1)},destroy:function(){return this.stop(),this.$elem.removeData("css-watch-object"),this.$elem.removeData(this.config.data_attr_name),null}},a.defaults=a.prototype.defaults,i.fn.csswatch=function(e){return this.each(function(){var t,n;if("object"!=typeof e&&e){if("string"==typeof e&&(n=i(this).data("css-watch-object"),n&&n[e]))return n[e].apply(this)}else t=i(this).data("css-watch-object"),t||(n=new a(this,e),i(this).data("css-watch-object",n),n.init())})}}(jQuery,window,document),Object.keys||(Object.keys=function(e){var t,i;if(e!==Object(e))throw new TypeError("Object.keys called on non-object");i=[],t=void 0;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.push(t);return i}),window.cssWatchRequestAnimationFrame||(window.cssWatchRequestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)
}}()),window.cssWatchCancelAnimationFrame||(window.cssWatchCancelAnimationFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||function(e){return window.clearTimeout(e)}}()),e={getFunctionsAndProperties:function(t){var i,n,a;for(i=t.split("."),n=0,a=[];n<i.length;)a.push(e.getFunctionAndParameters(i[n])),n++;return a},getFunctionAndParameters:function(t){var i,n,a;return e.isFunction(t)?(a=t.substring(t.indexOf("(")+1,t.indexOf(")")),a=a.length>0?e.splitAndTypeCastParameters(a):[],i=t.substring(0,t.indexOf("(")),n=!0):(i=t,a=null,n=!1),{func:i,params:a,isfunc:n}},splitAndTypeCastParameters:function(t){var i,n,a;for(i=t.split(","),a=[],n=0,a=[];n<i.length;)a.push(e.typecastParameter(i[n])),n++;return a},isFunction:function(t){return-1!==e.regexIndexOf(t,/(\([\d|\D]+\))|(\(\))/,0)?!0:!1},regexIndexOf:function(e,t,i){var n;return n=e.substring(i||0).search(t),n>=0?n+(i||0):n},typecastParameter:function(e){return e=e.trim(),e=e.replace(/^"/,""),e=e.replace(/"$/m,""),0===e.search(/^\d+$/)?parseInt(e):0===e.search(/^\d+\.\d+$/)?parseFloat(e):"false"===e?!1:"true"===e?!0:e},executeSingleFunction:function(e,t,i,n){return i[e].apply(n,t)},getSingleProperty:function(e,t){return t[e]},executeMethodByFunctionName:function(t,i){var n,a,r,o;for(r=e.getFunctionsAndProperties(t),o=0,n=i,a=null;o<r.length;)n=r[o].isfunc===!0?e.executeSingleFunction(r[o].func,r[o].params,n,i):e.getSingleProperty(r[o].func,n),o++;return n}},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),("undefined"===window.ExecuteMethod||null===window.ExecuteMethod||void 0===window.ExecuteMethod)&&(window.ExecuteMethod=e)}.call(this),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,a,r,o,s=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,i=0;r>i;i+=1)o[i]=str(i,l)||"null";return a=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,a}if(rep&&"object"==typeof rep)for(r=rep.length,i=0;r>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],a=str(n,l),a&&o.push(quote(n)+(gap?": ":":")+a));else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(a=str(n,l),a&&o.push(quote(n)+(gap?": ":":")+a));return a=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var i,n,a=e[t];if(a&&"object"==typeof a)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n=walk(a,i),void 0!==n?a[i]=n:delete a[i]);return reviver.call(e,t,a)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){var e=this,t=e._,i={},n=Array.prototype,a=Object.prototype,r=Function.prototype,o=n.push,s=n.slice,l=n.concat,c=a.toString,d=a.hasOwnProperty,u=n.forEach,f=n.map,p=n.reduce,h=n.reduceRight,m=n.filter,g=n.every,v=n.some,y=n.indexOf,b=n.lastIndexOf,w=Array.isArray,$=Object.keys,_=r.bind,S=function(e){return e instanceof S?e:this instanceof S?void(this._wrapped=e):new S(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=S),exports._=S):e._=S,S.VERSION="1.5.2";var x=S.each=S.forEach=function(e,t,n){if(null!=e)if(u&&e.forEach===u)e.forEach(t,n);else if(e.length===+e.length){for(var a=0,r=e.length;r>a;a++)if(t.call(n,e[a],a,e)===i)return}else for(var o=S.keys(e),a=0,r=o.length;r>a;a++)if(t.call(n,e[o[a]],o[a],e)===i)return};S.map=S.collect=function(e,t,i){var n=[];return null==e?n:f&&e.map===f?e.map(t,i):(x(e,function(e,a,r){n.push(t.call(i,e,a,r))}),n)};var k="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=S.bind(t,n)),a?e.reduce(t,i):e.reduce(t);if(x(e,function(e,r,o){a?i=t.call(n,i,e,r,o):(i=e,a=!0)}),!a)throw new TypeError(k);return i},S.reduceRight=S.foldr=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),h&&e.reduceRight===h)return n&&(t=S.bind(t,n)),a?e.reduceRight(t,i):e.reduceRight(t);var r=e.length;if(r!==+r){var o=S.keys(e);r=o.length}if(x(e,function(s,l,c){l=o?o[--r]:--r,a?i=t.call(n,i,e[l],l,c):(i=e[l],a=!0)}),!a)throw new TypeError(k);return i},S.find=S.detect=function(e,t,i){var n;return T(e,function(e,a,r){return t.call(i,e,a,r)?(n=e,!0):void 0}),n},S.filter=S.select=function(e,t,i){var n=[];return null==e?n:m&&e.filter===m?e.filter(t,i):(x(e,function(e,a,r){t.call(i,e,a,r)&&n.push(e)}),n)},S.reject=function(e,t,i){return S.filter(e,function(e,n,a){return!t.call(i,e,n,a)},i)},S.every=S.all=function(e,t,n){t||(t=S.identity);var a=!0;return null==e?a:g&&e.every===g?e.every(t,n):(x(e,function(e,r,o){return(a=a&&t.call(n,e,r,o))?void 0:i}),!!a)};var T=S.some=S.any=function(e,t,n){t||(t=S.identity);var a=!1;return null==e?a:v&&e.some===v?e.some(t,n):(x(e,function(e,r,o){return a||(a=t.call(n,e,r,o))?i:void 0}),!!a)};S.contains=S.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):T(e,function(e){return e===t})},S.invoke=function(e,t){var i=s.call(arguments,2),n=S.isFunction(t);return S.map(e,function(e){return(n?t:e[t]).apply(e,i)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.where=function(e,t,i){return S.isEmpty(t)?i?void 0:[]:S[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},S.findWhere=function(e,t){return S.where(e,t,!0)},S.max=function(e,t,i){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-1/0;var n={computed:-1/0,value:-1/0};return x(e,function(e,a,r){var o=t?t.call(i,e,a,r):e;o>n.computed&&(n={value:e,computed:o})}),n.value},S.min=function(e,t,i){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return x(e,function(e,a,r){var o=t?t.call(i,e,a,r):e;o<n.computed&&(n={value:e,computed:o})}),n.value},S.shuffle=function(e){var t,i=0,n=[];return x(e,function(e){t=S.random(i++),n[i-1]=n[t],n[t]=e}),n},S.sample=function(e,t,i){return arguments.length<2||i?e[S.random(e.length-1)]:S.shuffle(e).slice(0,Math.max(0,t))};var C=function(e){return S.isFunction(e)?e:function(t){return t[e]}};S.sortBy=function(e,t,i){var n=C(t);return S.pluck(S.map(e,function(e,t,a){return{value:e,index:t,criteria:n.call(i,e,t,a)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index-t.index}),"value")};var E=function(e){return function(t,i,n){var a={},r=null==i?S.identity:C(i);return x(t,function(i,o){var s=r.call(n,i,o,t);e(a,s,i)}),a}};S.groupBy=E(function(e,t,i){(S.has(e,t)?e[t]:e[t]=[]).push(i)}),S.indexBy=E(function(e,t,i){e[t]=i}),S.countBy=E(function(e,t){S.has(e,t)?e[t]++:e[t]=1}),S.sortedIndex=function(e,t,i,n){i=null==i?S.identity:C(i);for(var a=i.call(n,t),r=0,o=e.length;o>r;){var s=r+o>>>1;i.call(n,e[s])<a?r=s+1:o=s}return r},S.toArray=function(e){return e?S.isArray(e)?s.call(e):e.length===+e.length?S.map(e,S.identity):S.values(e):[]},S.size=function(e){return null==e?0:e.length===+e.length?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:s.call(e,0,t)},S.initial=function(e,t,i){return s.call(e,0,e.length-(null==t||i?1:t))},S.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},S.rest=S.tail=S.drop=function(e,t,i){return s.call(e,null==t||i?1:t)},S.compact=function(e){return S.filter(e,S.identity)};var P=function(e,t,i){return t&&S.every(e,S.isArray)?l.apply(i,e):(x(e,function(e){S.isArray(e)||S.isArguments(e)?t?o.apply(i,e):P(e,t,i):i.push(e)}),i)};S.flatten=function(e,t){return P(e,t,[])},S.without=function(e){return S.difference(e,s.call(arguments,1))},S.uniq=S.unique=function(e,t,i,n){S.isFunction(t)&&(n=i,i=t,t=!1);var a=i?S.map(e,i,n):e,r=[],o=[];return x(a,function(i,n){(t?n&&o[o.length-1]===i:S.contains(o,i))||(o.push(i),r.push(e[n]))}),r},S.union=function(){return S.uniq(S.flatten(arguments,!0))},S.intersection=function(e){var t=s.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=l.apply(n,s.call(arguments,1));return S.filter(e,function(e){return!S.contains(t,e)})},S.zip=function(){for(var e=S.max(S.pluck(arguments,"length").concat(0)),t=new Array(e),i=0;e>i;i++)t[i]=S.pluck(arguments,""+i);return t},S.object=function(e,t){if(null==e)return{};for(var i={},n=0,a=e.length;a>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},S.indexOf=function(e,t,i){if(null==e)return-1;var n=0,a=e.length;if(i){if("number"!=typeof i)return n=S.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,a+i):i}if(y&&e.indexOf===y)return e.indexOf(t,i);for(;a>n;n++)if(e[n]===t)return n;return-1},S.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(b&&e.lastIndexOf===b)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var a=n?i:e.length;a--;)if(e[a]===t)return a;return-1},S.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),a=0,r=new Array(n);n>a;)r[a++]=e,e+=i;return r};var I=function(){};S.bind=function(e,t){var i,n;if(_&&e.bind===_)return _.apply(e,s.call(arguments,1));if(!S.isFunction(e))throw new TypeError;return i=s.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,i.concat(s.call(arguments)));I.prototype=e.prototype;var a=new I;I.prototype=null;var r=e.apply(a,i.concat(s.call(arguments)));return Object(r)===r?r:a}},S.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},S.bindAll=function(e){var t=s.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return x(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var i={};return t||(t=S.identity),function(){var n=t.apply(this,arguments);return S.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},S.delay=function(e,t){var i=s.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(s.call(arguments,1)))},S.throttle=function(e,t,i){var n,a,r,o=null,s=0;i||(i={});var l=function(){s=i.leading===!1?0:new Date,o=null,r=e.apply(n,a)};return function(){var c=new Date;s||i.leading!==!1||(s=c);var d=t-(c-s);return n=this,a=arguments,0>=d?(clearTimeout(o),o=null,s=c,r=e.apply(n,a)):o||i.trailing===!1||(o=setTimeout(l,d)),r}},S.debounce=function(e,t,i){var n,a,r,o,s;return function(){r=this,a=arguments,o=new Date;var l=function(){var c=new Date-o;t>c?n=setTimeout(l,t-c):(n=null,i||(s=e.apply(r,a)))},c=i&&!n;return n||(n=setTimeout(l,t)),c&&(s=e.apply(r,a)),s}},S.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},S.wrap=function(e,t){return function(){var i=[e];return o.apply(i,arguments),t.apply(this,i)}},S.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},S.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},S.keys=$||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)S.has(e,i)&&t.push(i);return t},S.values=function(e){for(var t=S.keys(e),i=t.length,n=new Array(i),a=0;i>a;a++)n[a]=e[t[a]];return n},S.pairs=function(e){for(var t=S.keys(e),i=t.length,n=new Array(i),a=0;i>a;a++)n[a]=[t[a],e[t[a]]];return n},S.invert=function(e){for(var t={},i=S.keys(e),n=0,a=i.length;a>n;n++)t[e[i[n]]]=i[n];return t},S.functions=S.methods=function(e){var t=[];for(var i in e)S.isFunction(e[i])&&t.push(i);return t.sort()},S.extend=function(e){return x(s.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},S.pick=function(e){var t={},i=l.apply(n,s.call(arguments,1));return x(i,function(i){i in e&&(t[i]=e[i])}),t},S.omit=function(e){var t={},i=l.apply(n,s.call(arguments,1));for(var a in e)S.contains(i,a)||(t[a]=e[a]);return t},S.defaults=function(e){return x(s.call(arguments,1),function(t){if(t)for(var i in t)void 0===e[i]&&(e[i]=t[i])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e};var O=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof S&&(e=e._wrapped),t instanceof S&&(t=t._wrapped);var a=c.call(e);if(a!=c.call(t))return!1;switch(a){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var r=i.length;r--;)if(i[r]==e)return n[r]==t;var o=e.constructor,s=t.constructor;if(o!==s&&!(S.isFunction(o)&&o instanceof o&&S.isFunction(s)&&s instanceof s))return!1;i.push(e),n.push(t);var l=0,d=!0;if("[object Array]"==a){if(l=e.length,d=l==t.length)for(;l--&&(d=O(e[l],t[l],i,n)););}else{for(var u in e)if(S.has(e,u)&&(l++,!(d=S.has(t,u)&&O(e[u],t[u],i,n))))break;if(d){for(u in t)if(S.has(t,u)&&!l--)break;d=!l}}return i.pop(),n.pop(),d};S.isEqual=function(e,t){return O(e,t,[],[])},S.isEmpty=function(e){if(null==e)return!0;if(S.isArray(e)||S.isString(e))return 0===e.length;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!(!e||1!==e.nodeType)},S.isArray=w||function(e){return"[object Array]"==c.call(e)},S.isObject=function(e){return e===Object(e)},x(["Arguments","Function","String","Number","Date","RegExp"],function(e){S["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),S.isArguments(arguments)||(S.isArguments=function(e){return!(!e||!S.has(e,"callee"))}),"function"!=typeof/./&&(S.isFunction=function(e){return"function"==typeof e}),S.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},S.isNaN=function(e){return S.isNumber(e)&&e!=+e},S.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},S.isNull=function(e){return null===e},S.isUndefined=function(e){return void 0===e},S.has=function(e,t){return d.call(e,t)},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,i){for(var n=Array(Math.max(0,e)),a=0;e>a;a++)n[a]=t.call(i,a);return n},S.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};A.unescape=S.invert(A.escape);var M={escape:new RegExp("["+S.keys(A.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys(A.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(e){S[e]=function(t){return null==t?"":(""+t).replace(M[e],function(t){return A[e][t]})}}),S.result=function(e,t){if(null==e)return void 0;var i=e[t];return S.isFunction(i)?i.call(e):i},S.mixin=function(e){x(S.functions(e),function(t){var i=S[t]=e[t];S.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),W.call(this,i.apply(S,e))}})};var R=0;S.uniqueId=function(e){var t=++R+"";return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(e,t,i){var n;i=S.defaults({},i,S.templateSettings);var a=new RegExp([(i.escape||F).source,(i.interpolate||F).source,(i.evaluate||F).source].join("|")+"|$","g"),r=0,o="__p+='";e.replace(a,function(t,i,n,a,s){return o+=e.slice(r,s).replace(D,function(e){return"\\"+N[e]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),a&&(o+="';\n"+a+"\n__p+='"),r=s+t.length,t}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(s){throw s.source=o,s}if(t)return n(t,S);var l=function(e){return n.call(this,e,S)};return l.source="function("+(i.variable||"obj")+"){\n"+o+"}",l},S.chain=function(e){return S(e).chain()};var W=function(e){return this._chain?S(e).chain():e};S.mixin(S),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];S.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],W.call(this,i)}}),x(["concat","join","slice"],function(e){var t=n[e];S.prototype[e]=function(){return W.call(this,t.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){{var e,t=this,i=t.Backbone,n=[],a=(n.push,n.slice);n.splice}e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.1.0";var r=t._;r||"undefined"==typeof require||(r=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var o=e.Events={on:function(e,t,i){if(!l(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,i){if(!l(this,"once",e,[t,i])||!t)return this;var n=this,a=r.once(function(){n.off(e,a),t.apply(this,arguments)});return a._callback=t,this.on(e,a,i)},off:function(e,t,i){var n,a,o,s,c,d,u,f;if(!this._events||!l(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(s=e?[e]:r.keys(this._events),c=0,d=s.length;d>c;c++)if(e=s[c],o=this._events[e]){if(this._events[e]=n=[],t||i)for(u=0,f=o.length;f>u;u++)a=o[u],(t&&t!==a.callback&&t!==a.callback._callback||i&&i!==a.context)&&n.push(a);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!l(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&c(i,t),n&&c(n,arguments),this},stopListening:function(e,t,i){var n=this._listeningTo;if(!n)return this;var a=!t&&!i;i||"object"!=typeof t||(i=this),e&&((n={})[e._listenId]=e);for(var o in n)e=n[o],e.off(t,i,this),(a||r.isEmpty(e._events))&&delete this._listeningTo[o];return this}},s=/\s+/,l=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var a in i)e[t].apply(e,[a,i[a]].concat(n));return!1}if(s.test(i)){for(var r=i.split(s),o=0,l=r.length;l>o;o++)e[t].apply(e,[r[o]].concat(n));return!1}return!0},c=function(e,t){var i,n=-1,a=e.length,r=t[0],o=t[1],s=t[2];switch(t.length){case 0:for(;++n<a;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<a;)(i=e[n]).callback.call(i.ctx,r);return;case 2:for(;++n<a;)(i=e[n]).callback.call(i.ctx,r,o);return;case 3:for(;++n<a;)(i=e[n]).callback.call(i.ctx,r,o,s);return;default:for(;++n<a;)(i=e[n]).callback.apply(i.ctx,t)}},d={listenTo:"on",listenToOnce:"once"};r.each(d,function(e,t){o[t]=function(t,i,n){var a=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=r.uniqueId("l"));return a[o]=t,n||"object"!=typeof i||(n=this),t[e](i,n,this),this}}),o.bind=o.on,o.unbind=o.off,r.extend(e,o);var u=e.Model=function(e,t){var i=e||{};t||(t={}),this.cid=r.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=r.defaults({},i,r.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};r.extend(u.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return r.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return r.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var n,a,o,s,l,c,d,u;if(null==e)return this;if("object"==typeof e?(a=e,i=t):(a={})[e]=t,i||(i={}),!this._validate(a,i))return!1;o=i.unset,l=i.silent,s=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=r.clone(this.attributes),this.changed={}),u=this.attributes,d=this._previousAttributes,this.idAttribute in a&&(this.id=a[this.idAttribute]);for(n in a)t=a[n],r.isEqual(u[n],t)||s.push(n),r.isEqual(d[n],t)?delete this.changed[n]:this.changed[n]=t,o?delete u[n]:u[n]=t;if(!l){s.length&&(this._pending=!0);for(var f=0,p=s.length;p>f;f++)this.trigger("change:"+s[f],this,u[s[f]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,r.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,r.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!r.isEmpty(this.changed):r.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?r.clone(this.changed):!1;var t,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var a in e)r.isEqual(n[a],t=e[a])||((i||(i={}))[a]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(e){e=e?r.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},N(this,e),this.sync("read",this,e)},save:function(e,t,i){var n,a,o,s=this.attributes;if(null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,i=r.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=r.extend({},s,n)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=s;var t=l.parse(e,i);return i.wait&&(t=r.extend(n||{},t)),r.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),void l.trigger("sync",l,e,i))},N(this,i),a=this.isNew()?"create":i.patch?"patch":"update","patch"===a&&(i.attrs=n),o=this.sync(a,this,i),n&&i.wait&&(this.attributes=s),o},destroy:function(e){e=e?r.clone(e):{};var t=this,i=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(a){(e.wait||t.isNew())&&n(),i&&i(t,a,e),t.isNew()||t.trigger("sync",t,a,e)},this.isNew())return e.success(),!1;N(this,e);var a=this.sync("delete",this,e);return e.wait||n(),a},url:function(){var e=r.result(this,"urlRoot")||r.result(this.collection,"url")||F();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},r.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=r.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,r.extend(t,{validationError:i})),!1):!0}});var f=["keys","values","pairs","invert","pick","omit"];r.each(f,function(e){u.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.attributes),r[e].apply(r,t)}});var p=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,r.extend({silent:!0},t))},h={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};r.extend(p.prototype,o,{model:u,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,r.extend({merge:!1},t,m))},remove:function(e,t){var i=!r.isArray(e);e=i?[e]:r.clone(e),t||(t={});var n,a,o,s;for(n=0,a=e.length;a>n;n++)s=e[n]=this.get(e[n]),s&&(delete this._byId[s.id],delete this._byId[s.cid],o=this.indexOf(s),this.models.splice(o,1),this.length--,t.silent||(t.index=o,s.trigger("remove",s,this,t)),this._removeReference(s));return i?e[0]:e},set:function(e,t){t=r.defaults({},t,h),t.parse&&(e=this.parse(e,t));var i=!r.isArray(e);e=i?e?[e]:[]:r.clone(e);var n,a,o,s,l,c,d,f=t.at,p=this.model,m=this.comparator&&null==f&&t.sort!==!1,g=r.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},w=t.add,$=t.merge,_=t.remove,S=!m&&w&&_?[]:!1;for(n=0,a=e.length;a>n;n++){if(l=e[n],o=l instanceof u?s=l:l[p.prototype.idAttribute],c=this.get(o))_&&(b[c.cid]=!0),$&&(l=l===s?s.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),m&&!d&&c.hasChanged(g)&&(d=!0)),e[n]=c;else if(w){if(s=e[n]=this._prepareModel(l,t),!s)continue;v.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)}S&&S.push(c||s)}if(_){for(n=0,a=this.length;a>n;++n)b[(s=this.models[n]).cid]||y.push(s);y.length&&this.remove(y,t)}if(v.length||S&&S.length)if(m&&(d=!0),this.length+=v.length,null!=f)for(n=0,a=v.length;a>n;n++)this.models.splice(f+n,0,v[n]);else{S&&(this.models.length=0);var x=S||v;for(n=0,a=x.length;a>n;n++)this.models.push(x[n])}if(d&&this.sort({silent:!0}),!t.silent){for(n=0,a=v.length;a>n;n++)(s=v[n]).trigger("add",s,this,t);(d||S&&S.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),e=this.add(e,r.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,r.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,r.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return a.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e.id]||this._byId[e.cid]||this._byId[e]},at:function(e){return this.models[e]},where:function(e,t){return r.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),r.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(r.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return r.invoke(this.models,"get",e)},fetch:function(e){e=e?r.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var a=e.reset?"reset":"set";i[a](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},N(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?r.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,n=t.success;return t.success=function(e,t,a){a.wait&&i.add(e,a),n&&n(e,t,a)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof u)return e.collection||(e.collection=this),e;t=t?r.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];r.each(g,function(e){p.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),r[e].apply(r,t)}});var v=["groupBy","countBy","sortBy"];r.each(v,function(e){p.prototype[e]=function(t,i){var n=r.isFunction(t)?t:function(e){return e.get(t)};return r[e](this.models,n,i)}});var y=e.View=function(e){this.cid=r.uniqueId("view"),e||(e={}),r.extend(this,r.pick(e,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];r.extend(y.prototype,o,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=r.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(r.isFunction(i)||(i=this[e[t]]),i){var n=t.match(b),a=n[1],o=n[2];i=r.bind(i,this),a+=".delegateEvents"+this.cid,""===o?this.$el.on(a,i):this.$el.on(a,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(r.result(this,"el"),!1);else{var t=r.extend({},r.result(this,"attributes"));this.id&&(t.id=r.result(this,"id")),this.className&&(t["class"]=r.result(this,"className"));var i=e.$("<"+r.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,n){var a=_[t];r.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:a,dataType:"json"};if(n.url||(o.url=r.result(i,"url")||F()),null!=n.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){o.type="POST",n.emulateJSON&&(o.data._method=a);var s=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",a),s?s.apply(this,arguments):void 0}}"GET"===o.type||n.emulateJSON||(o.processData=!1),"PATCH"===o.type&&$&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=e.ajax(r.extend(o,n));return i.trigger("request",i,l,n),l};var $=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),_={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};
e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var S=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},x=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,T=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;r.extend(S.prototype,o,{initialize:function(){},route:function(t,i,n){r.isRegExp(t)||(t=this._routeToRegExp(t)),r.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var a=this;return e.history.route(t,function(r){var o=a._extractParameters(t,r);n&&n.apply(a,o),a.trigger.apply(a,["route:"+i].concat(o)),a.trigger("route",i,o),e.history.trigger("route",a,i,o)}),this},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=r.result(this,"routes");for(var e,t=r.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(C,"\\$&").replace(x,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(T,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return r.map(i,function(e){return e?decodeURIComponent(e):null})}});var E=e.History=function(){this.handlers=[],r.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},P=/^[#\/]|\s+$/g,I=/^\/+|\/+$/g,O=/msie [\w.]+/,A=/\/$/,M=/[?#].*$/;E.started=!1,r.extend(E.prototype,o,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(A,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(P,"")},start:function(t){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=r.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,a=O.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(I,"/"),a&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!a?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var o=this.location,s=o.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&s&&o.hash&&(this.fragment=this.getHash().replace(P,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),r.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!E.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(M,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),e.history=new E;var R=function(e,t){var i,n=this;i=e&&r.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},r.extend(i,n,t);var a=function(){this.constructor=i};return a.prototype=n.prototype,i.prototype=new a,e&&r.extend(i.prototype,e),i.__super__=n.prototype,i};u.extend=p.extend=S.extend=y.extend=E.extend=R;var F=function(){throw new Error('A "url" property or function must be specified')},N=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}}}.call(this),jQuery.fn.fxnMap=function(e){var t=[];return this.each(function(){t.push(e.call(this))}),t},jQuery.fn.findAndSelf=function(e){return this.find(e).addBack(e)},jQuery.fn.addPrototype=function(e,t){var i=$(this[0]),n=i.children(".prototype"),a=(n.outerHeight(!0)+"px",n.clone().removeClass("prototype"));return 0==n.length?(debug&&console.log("No prototype length"),"function"==typeof e&&e(a),a):("undefined"!=typeof id&&a.attr("id",id),t&&"instant"==t.speed?(a.appendTo(i),"function"==typeof e&&e(a),a):(a.hide().appendTo(i).hide().slideDown(200,function(){"function"==typeof e&&e(a)}),a))},jQuery.fn.deleteAnimate=function(e){var t=$(this[0]);t.slideUp(200,function(){t.remove(),"function"==typeof e&&e()})},jQuery.fn.formToObject=function(e){if(e&&e.ignoreWithParent)var t=e.ignoreWithParent;else var t=!1;if(e&&e.ignoreWithClass)var i=e.ignoreWithClass;else var i=!1;var n=$(this),a=new Object,r=n.find('input[type="number"], input[type="text"], input[type="date"], input[type="email"], input[type="password"], input[type="hidden"], textarea, select, input[type="radio"]:checked, input[type="checkbox"]');return r.each(function(){if(!(i&&$(this).hasClass(i)||t&&$(this).parents(t).length>0)){var e=$(this).attr("name"),n=$(this).val(),r=$(this).attr("type");"undefined"!=typeof e&&(a[e]="checkbox"==r?$(this).prop("checked")?!0:!1:n)}}),a},jQuery.fn.objectToForm=function(e){var t=$(this);for(var i in e){var n=e[i];if("string"==typeof n||"number"==typeof n||"boolean"==typeof n){var a='[name="'+i+'"]',r='input[type="number"]'+a+', input[type="text"]'+a+', input[type="email"]'+a+', input[type="date"]'+a+', input[type="hidden"]'+a+", textarea"+a+", select"+a;if(t.find(r).val(n),"string"==typeof n)var o=n.replace(/\\/g,"").replace(/(['"])/g,"\\$1");else var o="";a='[name="'+i+'"][value="'+o+'"]',r='input[type="radio"]'+a,t.find(r).prop("checked",!0),1==e[i]&&(a='[name="'+i+'"]',r='input[type="checkbox"]'+a,t.find(r).prop("checked",!0)),0==e[i]&&(a='[name="'+i+'"]',r='input[type="checkbox"]'+a,t.find(r).prop("checked",!1))}}return this},jQuery.fn.reloadHtml=function(){var e=$(this);e.each(function(){var e=$(this).html();$(this).html(e)})},jQuery.fn.computeMaxHeight=function(){var e=$(this),t=0;return e.each(function(){$(this).height()>t&&(t=$(this).height())}),t},jQuery.fn.transition=function(e,t,i){var n=$(this[0]),a=n.css("width"),r=n.css("height");switch(e){case"fadeOut":n.fadeOut(t,i);break;case"fadeIn":n.fadeIn(t,i);break;case"slideLeft":n.show().animate({left:"-="+a},t,i);break;case"slideRight":n.show().animate({left:"+="+a},t,i);break;case"slideUp":n.show().animate({top:"+="+r},t,i);break;case"slideDown":n.show().animate({top:"-="+r},t,i);break;case"slideInLeft":n.css("left","+="+a).animate({left:"-="+a},t,i);break;case"slideInRight":n.css("left","-="+a).animate({left:"+="+a},t,i);break;case"slideInUp":n.css("top","-="+r).animate({top:"+="+r},t,i);break;case"slideInDown":n.css("top","+="+r).animate({top:"-="+r},t,i)}},jQuery.fn.toggleButton=function(){var e=$(this);e.each(function(){this.disabled=!this.disabled,$(this).toggleClass("loading")})},jQuery.fn.clearInputs=function(){$(this).find('input:not([type="submit"]), textarea').val("")},window.Modernizr=function(e,t,i){function n(e){y.cssText=e}function a(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var n in e){var a=e[n];if(!r(a,"-")&&y[a]!==i)return"pfx"==t?a:!0}return!1}function s(e,t,n){for(var r in e){var o=t[e[r]];if(o!==i)return n===!1?e[r]:a(o,"function")?o.bind(n||t):o}return!1}function l(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+S.join(n+" ")+n).split(" ");return a(t,"string")||a(t,"undefined")?o(r,t):(r=(e+" "+x.join(n+" ")+n).split(" "),s(r,t,i))}function c(){p.input=function(i){for(var n=0,a=i.length;a>n;n++)C[i[n]]=i[n]in b;return C.list&&(C.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),C}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),p.inputtypes=function(e){for(var n,a,r,o=0,s=e.length;s>o;o++)b.setAttribute("type",a=e[o]),n="text"!==b.type,n&&(b.value=w,b.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(a)&&b.style.WebkitAppearance!==i?(m.appendChild(b),r=t.defaultView,n=r.getComputedStyle&&"textfield"!==r.getComputedStyle(b,null).WebkitAppearance&&0!==b.offsetHeight,m.removeChild(b)):/^(search|tel)$/.test(a)||(n=/^(url|email)$/.test(a)?b.checkValidity&&b.checkValidity()===!1:b.value!=w)),T[e[o]]=!!n;return T}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d,u,f="2.7.1",p={},h=!0,m=t.documentElement,g="modernizr",v=t.createElement(g),y=v.style,b=t.createElement("input"),w=":)",$=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),_="Webkit Moz O ms",S=_.split(" "),x=_.toLowerCase().split(" "),k={},T={},C={},E=[],P=E.slice,I=function(e,i,n,a){var r,o,s,l,c=t.createElement("div"),d=t.body,u=d||t.createElement("body");if(parseInt(n,10))for(;n--;)s=t.createElement("div"),s.id=a?a[n]:g+(n+1),c.appendChild(s);return r=["&#173;",'<style id="s',g,'">',e,"</style>"].join(""),c.id=g,(d?c:u).innerHTML+=r,u.appendChild(c),d||(u.style.background="",u.style.overflow="hidden",l=m.style.overflow,m.style.overflow="hidden",m.appendChild(u)),o=i(c,e),d?c.parentNode.removeChild(c):(u.parentNode.removeChild(u),m.style.overflow=l),!!o},O={}.hasOwnProperty;u=a(O,"undefined")||a(O.call,"undefined")?function(e,t){return t in e&&a(e.constructor.prototype[t],"undefined")}:function(e,t){return O.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=P.call(arguments,1),n=function(){if(this instanceof n){var a=function(){};a.prototype=t.prototype;var r=new a,o=t.apply(r,i.concat(P.call(arguments)));return Object(o)===o?o:r}return t.apply(e,i.concat(P.call(arguments)))};return n}),k.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},k.geolocation=function(){return"geolocation"in navigator},k.csstransforms3d=function(){var e=!!l("perspective");return e&&"webkitPerspective"in m.style&&I("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e},k.csstransitions=function(){return l("transition")},k.video=function(){var e=t.createElement("video"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),i.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),i.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(n){}return i},k.audio=function(){var e=t.createElement("audio"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),i.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),i.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return i};for(var A in k)u(k,A)&&(d=A.toLowerCase(),p[d]=k[A](),E.push((p[d]?"":"no-")+d));return p.input||c(),p.addTest=function(e,t){if("object"==typeof e)for(var n in e)u(e,n)&&p.addTest(n,e[n]);else{if(e=e.toLowerCase(),p[e]!==i)return p;t="function"==typeof t?t():t,"undefined"!=typeof h&&h&&(m.className+=" "+(t?"":"no-")+e),p[e]=t}return p},n(""),v=b=null,function(e,t){function i(e,t){var i=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return i.innerHTML="x<style>"+t+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var e=y.elements;return"string"==typeof e?e.split(" "):e}function a(e){var t=v[e[m]];return t||(t={},g++,e[m]=g,v[g]=t),t}function r(e,i,n){if(i||(i=t),d)return i.createElement(e);n||(n=a(i));var r;return r=n.cache[e]?n.cache[e].cloneNode():h.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),!r.canHaveChildren||p.test(e)||r.tagUrn?r:n.frag.appendChild(r)}function o(e,i){if(e||(e=t),d)return e.createDocumentFragment();i=i||a(e);for(var r=i.frag.cloneNode(),o=0,s=n(),l=s.length;l>o;o++)r.createElement(s[o]);return r}function s(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(i){return y.shivMethods?r(i,e,t):t.createElem(i)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(y,t.frag)}function l(e){e||(e=t);var n=a(e);return y.shivCSS&&!c&&!n.hasCSS&&(n.hasCSS=!!i(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),d||s(e,n),e}var c,d,u="3.7.0",f=e.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,h=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",g=0,v={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",c="hidden"in e,d=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(i){c=!0,d=!0}}();var y={elements:f.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:u,shivCSS:f.shivCSS!==!1,supportsUnknownElements:d,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:l,createElement:r,createDocumentFragment:o};e.html5=y,l(t)}(this,t),p._version=f,p._prefixes=$,p._domPrefixes=x,p._cssomPrefixes=S,p.testProp=function(e){return o([e])},p.testAllProps=l,p.testStyles=I,p.prefixed=function(e,t,i){return t?l(e,t,i):l(e,"pfx")},m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(h?" js "+E.join(" "):""),p}(this,this.document),function(e,t,i){function n(e){return"[object Function]"==g.call(e)}function a(e){return"string"==typeof e}function r(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function s(){var e=v.shift();y=1,e?e.t?h(function(){("c"==e.t?f.injectCss:f.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),s()):y=0}function l(e,i,n,a,r,l,c){function d(t){if(!p&&o(u.readyState)&&(b.r=p=1,!y&&s(),u.onload=u.onreadystatechange=null,t)){"img"!=e&&h(function(){$.removeChild(u)},50);for(var n in T[i])T[i].hasOwnProperty(n)&&T[i][n].onload()}}var c=c||f.errorTimeout,u=t.createElement(e),p=0,g=0,b={t:n,s:i,e:r,a:l,x:c};1===T[i]&&(g=1,T[i]=[]),"object"==e?u.data=i:(u.src=i,u.type=e),u.width=u.height="0",u.onerror=u.onload=u.onreadystatechange=function(){d.call(this,g)},v.splice(a,0,b),"img"!=e&&(g||2===T[i]?($.insertBefore(u,w?null:m),h(d,c)):T[i].push(u))}function c(e,t,i,n,r){return y=0,t=t||"j",a(e)?l("c"==t?S:_,e,t,this.i++,i,n,r):(v.splice(this.i++,0,e),1==v.length&&s()),this}function d(){var e=f;return e.loader={load:c,i:0},e}var u,f,p=t.documentElement,h=e.setTimeout,m=t.getElementsByTagName("script")[0],g={}.toString,v=[],y=0,b="MozAppearance"in p.style,w=b&&!!t.createRange().compareNode,$=w?p:m.parentNode,p=e.opera&&"[object Opera]"==g.call(e.opera),p=!!t.attachEvent&&!p,_=b?"object":p?"script":"img",S=p?"script":_,x=Array.isArray||function(e){return"[object Array]"==g.call(e)},k=[],T={},C={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};f=function(e){function t(e){var t,i,n,e=e.split("!"),a=k.length,r=e.pop(),o=e.length,r={url:r,origUrl:r,prefixes:e};for(i=0;o>i;i++)n=e[i].split("="),(t=C[n.shift()])&&(r=t(r,n));for(i=0;a>i;i++)r=k[i](r);return r}function o(e,a,r,o,s){var l=t(e),c=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(a&&(a=n(a)?a:a[e]||a[o]||a[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,a,r,o,s):(T[l.url]?l.noexec=!0:T[l.url]=1,r.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":i,l.noexec,l.attrs,l.timeout),(n(a)||n(c))&&r.load(function(){d(),a&&a(l.origUrl,s,o),c&&c(l.origUrl,s,o),T[l.url]=2})))}function s(e,t){function i(e,i){if(e){if(a(e))i||(u=function(){var e=[].slice.call(arguments);f.apply(this,e),p()}),o(e,u,t,0,c);else if(Object(e)===e)for(l in s=function(){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i}(),e)e.hasOwnProperty(l)&&(!i&&!--s&&(n(u)?u=function(){var e=[].slice.call(arguments);f.apply(this,e),p()}:u[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),p()}}(f[l])),o(e[l],u,t,l,c))}else!i&&p()}var s,l,c=!!e.test,d=e.load||e.both,u=e.callback||r,f=u,p=e.complete||r;i(c?e.yep:e.nope,!!d),d&&i(d)}var l,c,u=this.yepnope.loader;if(a(e))o(e,0,u,0);else if(x(e))for(l=0;l<e.length;l++)c=e[l],a(c)?o(c,0,u,0):x(c)?f(c):Object(c)===c&&s(c,u);else Object(e)===e&&s(e,u)},f.addPrefix=function(e,t){C[e]=t},f.addFilter=function(e){k.push(e)},f.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",u=function(){t.removeEventListener("DOMContentLoaded",u,0),t.readyState="complete"},0)),e.yepnope=d(),e.yepnope.executeStack=s,e.yepnope.injectJs=function(e,i,n,a,l,c){var d,u,p=t.createElement("script"),a=a||f.errorTimeout;p.src=e;for(u in n)p.setAttribute(u,n[u]);i=c?s:i||r,p.onreadystatechange=p.onload=function(){!d&&o(p.readyState)&&(d=1,i(),p.onload=p.onreadystatechange=null)},h(function(){d||(d=1,i(1))},a),l?p.onload():m.parentNode.insertBefore(p,m)},e.yepnope.injectCss=function(e,i,n,a,o,l){var c,a=t.createElement("link"),i=l?s:i||r;a.href=e,a.rel="stylesheet",a.type="text/css";for(c in n)a.setAttribute(c,n[c]);o||(m.parentNode.insertBefore(a,m),h(i,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},function(e){"undefined"==typeof WSDEBUG&&(window.WSDEBUG=!0);var t=function(){window.asyncWebshims||(window.asyncWebshims={cfg:[],ready:[]})},i=function(){window.jQuery&&(e(jQuery),e=function(){return window.webshims})};window.webshims={setOptions:function(){t(),window.asyncWebshims.cfg.push(arguments)},ready:function(){t(),window.asyncWebshims.ready.push(arguments)},activeLang:function(e){t(),window.asyncWebshims.lang=e},polyfill:function(e){t(),window.asyncWebshims.polyfill=e},_curScript:function(){var e,t,i,n=document.currentScript;if(WSDEBUG&&(n=!1),!n){try{throw new Error("")}catch(a){i=(a.sourceURL||a.stack||"").split("\n"),i=((i[i.length-1]||i[i.length-2]||"").match(/(?:fil|htt|wid|abo|app|res)(.)+/i)||[""])[0].replace(/[\:\s\(]+[\d\:\)\(\s]+$/,"")}for(e=document.scripts||document.getElementsByTagName("script"),t=0;t<e.length;t++)if(e[t].getAttribute("src")&&(n=e[t],"interactive"==e[t].readyState||i==e[t].src)){WSDEBUG&&(n.wsFoundCurrent=!0);break}}return n}()},window.webshim=window.webshims,window.webshims.timer=setInterval(i,0),i(),"function"==typeof define&&define.amd&&define.amd.jQuery&&define("polyfiller",["jquery"],e)}(function(e){"use strict";var t,i,n=window.webshims,a="dom-support",r=e.event.special,o=e([]),s=window.Modernizr,l=window.asyncWebshims,c=s.addTest,d=window.Object,u=function(e){return e+"\n//# sourceURL="+this.url};s.advancedObjectProperties=s.objectAccessor=s.ES5=!!("create"in d&&"seal"in d),!s.ES5||"toJSON"in Date.prototype||(s.ES5=!1),clearInterval(n.timer),i=e.support.hrefNormalized===!1?n._curScript.getAttribute("src",4):n._curScript.src,i=i.split("?")[0].slice(0,i.lastIndexOf("/")+1)+"shims/",e.extend(n,{version:"1.12.4",cfg:{waitReady:!0,loadStyles:!0,wsdoc:document,wspopover:{appendTo:"auto",hideOnBlur:!0},ajax:{},loadScript:function(t,i){e.ajax(e.extend({},f.ajax,{url:t,success:i,dataType:"script",cache:!0,global:!1,dataFilter:u}))},basePath:i},bugs:{},modules:{},features:{},featureList:[],setOptions:function(t,i){"string"==typeof t&&arguments.length>1?f[t]=e.isPlainObject(i)?e.extend(!0,f[t]||{},i):i:"object"==typeof t&&e.extend(!0,f,t)},addPolyfill:function(t,i){i=i||{};var a=i.f||t;p[a]||(p[a]=[],n.featureList.push(a),f[a]={}),!p[a].failedM&&i.nM&&e.each(i.nM.split(" "),function(e,t){return t in s?void 0:(p[a].failedM=t,!1)}),p[a].failedM&&(i.test=WSDEBUG?function(){return n.error("webshims needs Modernizr."+p[a].failedM+" to implement feature: "+a),!0}:!0),p[a].push(t),i.options=e.extend(f[a],i.options),w(t,i),i.methodNames&&e.each(i.methodNames,function(e,t){n.addMethodName(t)})},polyfill:function(){var e={};return function(t){if(t||(t=n.featureList,WSDEBUG&&n.warn("loading all features without specifing might be bad for performance")),"string"==typeof t&&(t=t.split(" ")),WSDEBUG)for(var i=0;i<t.length;i++)e[t[i]],e[t[i]]=!0;return n._polyfill(t)}}(),_polyfill:function(i){var a=[];t(),-1==e.inArray("forms",i)&&-1!==e.inArray("forms-ext",i)&&(i.push("forms"),WSDEBUG&&n.error("need to load forms feature to use forms-ext feature.")),f.waitReady&&(e.readyWait++,m(i,function(){e.ready(!0)})),e.each(i,function(e,t){return p[t]?(t!==p[t][0]&&m(p[t],function(){h(t,!0)}),void(a=a.concat(p[t]))):(WSDEBUG&&n.error("could not find webshims-feature (aborted): "+t),void h(t,!0))}),f.loadStyles&&y.loadCSS("styles/shim.css"),b(a)},reTest:function(){var t,i=function(i,n){var a,o=v[n],s=n+"Ready";!o||o.loaded||(o.test&&e.isFunction(o.test)?o.test([]):o.test)||(r[s]&&delete r[s],a=p[o.f],t.push(n))};return function(n){"string"==typeof n&&(n=n.split(" ")),t=[],e.each(n,i),b(t)}}(),isReady:function(t,i){if(t+="Ready",i){if(r[t]&&r[t].add)return!0;r[t]=e.extend(r[t]||{},{add:function(e){e.handler.call(this,t)}}),e(document).triggerHandler(t)}return!(!r[t]||!r[t].add)||!1},ready:function(t,i){var a=arguments[2];if("string"==typeof t&&(t=t.split(" ")),a||(t=e.map(e.grep(t,function(e){return!h(e)}),function(e){return e+"Ready"})),!t.length)return void i(e,n,window,document);var r=t.shift(),o=function(){m(t,i,!0)};e(document).one(r,o)},capturingEvents:function(t,i){document.addEventListener&&("string"==typeof t&&(t=[t]),e.each(t,function(t,a){var o=function(t){return t=e.event.fix(t),i&&n.capturingEventPrevented&&n.capturingEventPrevented(t),e.event.dispatch.call(this,t)};r[a]=r[a]||{},r[a].setup||r[a].teardown||e.extend(r[a],{setup:function(){this.addEventListener(a,o,!0)},teardown:function(){this.removeEventListener(a,o,!0)}})}))},register:function(t,i){var a=v[t];if(!a)return void n.error("can't find module: "+t);a.loaded=!0;var r=function(){i(e,n,window,document,void 0,a.options),h(t,!0)};a.d&&a.d.length?m(a.d,r):r()},c:{},loader:{addModule:function(t,i){v[t]=i,i.name=i.name||t,i.c||(i.c=[]),e.each(i.c,function(e,i){n.c[i]||(n.c[i]=[]),n.c[i].push(t)})},loadList:function(){var t=[],i=function(i,n){"string"==typeof n&&(n=[n]),e.merge(t,n),y.loadScript(i,!1,n)},a=function(i,n){if(h(i)||-1!=e.inArray(i,t))return!0;{var a,r=v[i];f[r.f||i]||{}}return r?(a=r.test&&e.isFunction(r.test)?r.test(n):r.test,a?(h(i,!0),!0):!1):!0},r=function(t,i){if(t.d&&t.d.length){var n=function(t,n){a(n,i)||-1!=e.inArray(n,i)||i.push(n)};e.each(t.d,function(t,i){v[i]?v[i].loaded||n(t,i):p[i]&&(e.each(p[i],n),m(p[i],function(){h(i,!0)}))}),t.noAutoCallback||(t.noAutoCallback=!0)}};return function(o){var s,l,c,d,u=[],p=function(a,r){return d=r,e.each(n.c[r],function(i,n){return-1==e.inArray(n,u)||-1!=e.inArray(n,t)?(d=!1,!1):void 0}),d?(i("combos/"+d,n.c[d]),!1):void 0};for(l=0;l<o.length;l++)s=v[o[l]],s&&!a(s.name,o)?(s.css&&f.loadStyles&&y.loadCSS(s.css),s.loadInit&&s.loadInit(),r(s,o),s.loaded||u.push(s.name),s.loaded=!0):WSDEBUG&&!s&&n.warn("could not find: "+o[l]);for(l=0,c=u.length;c>l;l++)d=!1,s=u[l],-1==e.inArray(s,t)&&("noCombo"!=f.debug&&e.each(v[s].c,p),d||i(v[s].src||s,s))}}(),makePath:function(e){return-1!=e.indexOf("//")||0===e.indexOf("/")?e:(-1==e.indexOf(".")&&(e+=".js"),f.addCacheBuster&&(e+=f.addCacheBuster),f.basePath+e)},loadCSS:function(){var t,i={};return function(n){n=this.makePath(n),i[n]||(t=t||e("link, style")[0]||e("script")[0],i[n]=1,e('<link rel="stylesheet" />').insertBefore(t).attr({href:n}))}}(),loadScript:function(){var t={};return function(i,n,a,r){if(r||(i=y.makePath(i)),!t[i]){var o=function(){n&&n(),a&&("string"==typeof a&&(a=a.split(" ")),e.each(a,function(e,t){v[t]&&(v[t].afterLoad&&v[t].afterLoad(),h(v[t].noAutoCallback?t+"FileLoaded":t,!0))}))};t[i]=1,f.loadScript(i,o,e.noop)}}}()}}),e.webshims=n;var f=n.cfg,p=n.features,h=n.isReady,m=n.ready,g=n.addPolyfill,v=n.modules,y=n.loader,b=y.loadList,w=y.addModule,$=n.bugs,_=[],S={warn:1,error:1};return n.addMethodName=function(t){t=t.split(":");var i=t[1];1==t.length?(i=t[0],t=t[0]):t=t[0],e.fn[t]=function(){return this.callProp(i,arguments)}},e.fn.callProp=function(t,i){var a;return i||(i=[]),this.each(function(){var r=e.prop(this,t);if(r&&r.apply){if(a=r.apply(this,i),void 0!==a)return!1}else n.warn(t+" is not a method of "+this)}),void 0!==a?a:this},n.activeLang=function(){var t=e("html").attr("lang")||navigator.browserLanguage||navigator.language||"";return m("webshimLocalization",function(){n.activeLang(t)}),function(e){if(e)if("string"==typeof e)t=e;else if("object"==typeof e){var i=arguments,a=this;m("webshimLocalization",function(){n.activeLang.apply(a,i)})}return t}}(),n.errorLog=[],e.each(["log","error","warn","info"],function(e,t){n[t]=function(e){(S[t]&&f.debug!==!1||f.debug)&&(n.errorLog.push(e),window.console&&console.log&&console[console[t]?t:"log"](e))}}),WSDEBUG&&(n._curScript.wsFoundCurrent||n.error("Could not detect currentScript! Use basePath to set script path.")),function(){e.isDOMReady=e.isReady;var i=function(){e.isDOMReady=!0,h("DOM",!0),setTimeout(function(){h("WINDOWLOAD",!0)},9999)};t=function(){if(!t.run){if((f.debug||!("crossDomain"in f.ajax)&&location.protocol.indexOf("http"))&&(f.ajax.crossDomain=!0),e.mobile&&(e.mobile.textinput||e.mobile.rangeslider||e.mobile.button)&&(WSDEBUG&&n.warn('jQM textinput/rangeslider/button detected waitReady was set to false. Use webshims.ready("featurename") to script against polyfilled methods/properties'),f.readyEvt||(f.readyEvt="pageinit"),f.waitReady=!1),WSDEBUG&&f.waitReady&&e.isReady&&n.warn("Call webshims.polyfill before DOM-Ready or set waitReady to false."),!e.isDOMReady&&f.waitReady){var a=e.ready;e.ready=function(t){return t!==!0&&document.body&&(i(),e.ready=a),a.apply(this,arguments)},e.ready.promise=a.promise}f.readyEvt?e(document).one(f.readyEvt,i):e(i)}t.run=!0},e(window).on("load",function(){i(),setTimeout(function(){h("WINDOWLOAD",!0)},9)});var a=[],r=function(){1==this.nodeType&&n.triggerDomUpdate(this)};e.extend(n,{addReady:function(e){var t=function(t,i){n.ready("DOM",function(){e(t,i)})};a.push(t),f.wsdoc&&t(f.wsdoc,o)},triggerDomUpdate:function(t){if(!t||!t.nodeType)return void(t&&t.jquery&&t.each(function(){n.triggerDomUpdate(this)}));var i=t.nodeType;if(1==i||9==i){var r=t!==document?e(t):o;e.each(a,function(e,i){i(t,r)})}}}),e.fn.htmlPolyfill=function(t){var i=e.fn.html.call(this,t);return i===this&&e.isDOMReady&&this.each(r),i},e.fn.jProp=function(){return this.pushStack(e(e.fn.prop.apply(this,arguments)||[]))},e.each(["after","before","append","prepend","replaceWith"],function(t,i){e.fn[i+"Polyfill"]=function(t){return t=e(t),e.fn[i].call(this,t),e.isDOMReady&&t.each(r),this}}),e.each(["insertAfter","insertBefore","appendTo","prependTo","replaceAll"],function(t,i){e.fn[i.replace(/[A-Z]/,function(e){return"Polyfill"+e})]=function(){return e.fn[i].apply(this,arguments),e.isDOMReady&&n.triggerDomUpdate(this),this}}),e.fn.updatePolyfill=function(){return e.isDOMReady&&n.triggerDomUpdate(this),this},e.each(["getNativeElement","getShadowElement","getShadowFocusElement"],function(t,i){e.fn[i]=function(){return this.pushStack(this)}})}(),WSDEBUG&&(f.debug=!0),function(){var t="defineProperty",i=d.prototype.hasOwnProperty,a=["configurable","enumerable","writable"],r=function(e){for(var t=0;3>t;t++)void 0!==e[a[t]]||"writable"===a[t]&&void 0===e.value||(e[a[t]]=!0)},o=function(e){if(e)for(var t in e)i.call(e,t)&&r(e[t])};d.create&&(n.objectCreate=function(t,i,n){o(i);var a=d.create(t,i);return n&&(a.options=e.extend(!0,{},a.options||{},n),n=a.options),a._create&&e.isFunction(a._create)&&a._create(n),a}),d[t]&&(n[t]=function(e,i,n){return r(n),d[t](e,i,n)}),d.defineProperties&&(n.defineProperties=function(e,t){return o(t),d.defineProperties(e,t)}),n.getOwnPropertyDescriptor=d.getOwnPropertyDescriptor,n.getPrototypeOf=d.getPrototypeOf}(),w("swfmini",{test:function(){return window.swfobject&&!window.swfmini&&(window.swfmini=window.swfobject),"swfmini"in window},c:[16,7,2,8,1,12,19,25,23,27]}),v.swfmini.test(),w("sizzle",{test:e.expr.filters}),w("jajax",{test:e.ajax}),g("es5",{test:!(!s.ES5||!Function.prototype.bind),c:[18,19,25,20,32]}),g("dom-extend",{f:a,noAutoCallback:!0,d:["es5"],c:[16,7,2,15,30,3,8,4,9,10,25,19,20,26,31]}),g("geolocation",{test:s.geolocation,options:{destroyWrite:!0},d:["json-storage"],c:[21],nM:"geolocation"}),function(){g("canvas",{src:"excanvas",test:s.canvas,options:{type:"flash"},noAutoCallback:!0,loadInit:function(){var e=this.options.type;!e||-1===e.indexOf("flash")||v.swfmini.test()&&!swfmini.hasFlashPlayerVersion("9.0.0")||(this.src="flash"==e?"FlashCanvas/flashcanvas":"FlashCanvasPro/flashcanvas")},methodNames:["getContext"],d:[a],nM:"canvas"})}(),function(){var t,i,r,o="form-shim-extend",l=s.input,d=s.inputtypes,u="formvalidation",p="form-number-date-api",h=!1,m=!1,y=function(){var i,n;if(!y.run){if(n=e('<fieldset><textarea required="" /></fieldset>')[0],c(u,!(!l.required||!l.pattern)),c("fieldsetelements",i="elements"in n),"disabled"in n){if(!i)try{e("textarea",n).is(":invalid")&&(n.disabled=!0,i=e("textarea",n).is(":valid"))}catch(a){}c("fieldsetdisabled",i)}s[u]?(m=!(s.fieldsetdisabled&&s.fieldsetelements&&"value"in document.createElement("progress")&&"value"in document.createElement("output")),$.bustedValidity=h=window.opera||$.bustedValidity||m||!l.list):$.bustedValidity=!1,t=s[u]&&!h?"form-native-extend":o}return y.run=!0,!1};document.createElement("datalist"),n.validationMessages=n.validityMessages={langSrc:"i18n/formcfg-",availableLangs:["ar","cs","el","es","fr","he","hi","hu","it","ja","lt","nl","pl","pt","pt-BR","pt-PT","ru","sv","zh-CN"]},n.formcfg=e.extend({},n.validationMessages),n.inputTypes={},g("form-core",{f:"forms",d:["es5"],test:y,options:{placeholderType:"value",messagePopover:{},list:{popover:{constrainWidth:!0}},iVal:{sel:".ws-validate",handleBubble:"hide",recheckDelay:400}},methodNames:["setCustomValidity","checkValidity","setSelectionRange"],c:[16,7,2,8,1,15,30,3,31],nM:"input"}),i=f.forms,g("form-native-extend",{f:"forms",test:function(t){return!s[u]||h||-1==e.inArray(p,t||[])||v[p].test()},d:["form-core",a,"form-message"],c:[6,5,14,29]}),g(o,{f:"forms",test:function(){return s[u]&&!h},d:["form-core",a,"sizzle"],c:[16,15,24,28]}),g(o+"2",{f:"forms",test:function(){return s[u]&&!m},d:[o],c:[24]}),g("form-message",{f:"forms",test:function(e){return!(i.customMessages||!s[u]||h||!v[t].test(e))},d:[a],c:[16,7,15,30,3,8,4,14,28]}),r={noAutoCallback:!0,options:i},w("form-validation",e.extend({d:["form-message","form-core"]},r)),w("form-validators",e.extend({},r)),g(p,{f:"forms-ext",options:{types:"date time range number"},test:function(){var t=!0,i=this.options;return i._types||(i._types=i.types.split(" ")),y(),e.each(i._types,function(e,i){return i in d&&!d[i]?(t=!1,!1):void 0}),t},methodNames:["stepUp","stepDown"],d:["forms",a],c:[6,5,18,17,14,28,29,32,33],nM:"input inputtypes"}),w("range-ui",{options:{},noAutoCallback:!0,test:function(){return!!e.fn.rangeUI},d:["es5"],c:[6,5,9,10,18,17,11]}),g("form-number-date-ui",{f:"forms-ext",test:function(){var e=this.options;return y(),m&&!e.replaceUI&&/Android/i.test(navigator.userAgent)&&(e.replaceUI=!0),!e.replaceUI&&v[p].test()},d:["forms",a,p,"range-ui"],css:"styles/forms-ext.css",options:{widgets:{calculateWidth:!0,animate:!0}},c:[6,5,9,10,18,17,11]}),g("form-datalist",{f:"forms",test:function(){return y(),l.list&&!i.fD
},d:["form-core",a],c:[16,7,6,2,9,15,30,31,28,32,33]})}(),g("filereader",{test:"FileReader"in window,d:["swfmini",a],c:[25,26,27]}),"details"in s||c("details",function(){return"open"in document.createElement("details")}),g("details",{test:s.details,d:[a],options:{text:"Details"},c:[21,22]}),function(){n.mediaelement={},c({texttrackapi:"addTextTrack"in document.createElement("video"),track:"kind"in document.createElement("track")}),g("mediaelement-core",{f:"mediaelement",noAutoCallback:!0,options:{preferFlash:!1,vars:{},params:{},attrs:{},changeSWF:e.noop},methodNames:["play","pause","canPlayType","mediaLoad:load"],d:["swfmini"],c:[16,7,2,8,1,12,13,19,25,20,23],nM:"audio video"}),g("mediaelement-jaris",{f:"mediaelement",d:["mediaelement-core","swfmini",a],test:function(){var e=this.options;return s.audio&&s.video&&!n.mediaelement.loadSwf?(e.preferFlash&&!v.swfmini.test()&&(e.preferFlash=!1),!(e.preferFlash&&swfmini.hasFlashPlayerVersion("10.0.3"))):!1},c:[21,19,25,20]}),$.track=!window.TextTrackCue||!s.texttrackapi,g("track",{options:{positionDisplay:!0,override:$.track},test:function(){return!this.options.override&&!$.track},d:["mediaelement",a],methodNames:["addTextTrack"],c:[21,12,13,22]}),w("track-ui",{d:["track",a]})}(),g("feature-dummy",{test:!0,loaded:!0,c:_}),n.$=e,n.M=s,window.webshims=n,n.callAsync=function(){n.callAsync=e.noop,e(document.scripts||"script").filter("[data-polyfill-cfg]").each(function(){try{n.setOptions(e(this).data("polyfillCfg"))}catch(t){n.warn("error parsing polyfill cfg: "+t)}}).end().filter("[data-polyfill]").each(function(){n.polyfill(e.trim(e(this).data("polyfill")||""))}),l&&(l.cfg&&(l.cfg.length||(l.cfg=[[l.cfg]]),e.each(l.cfg,function(e,t){n.setOptions.apply(n,t)})),l.ready&&e.each(l.ready,function(e,t){n.ready.apply(n,t)}),l.lang&&n.activeLang(l.lang),"polyfill"in l&&n.polyfill(l.polyfill)),n.isReady("jquery",!0)},n.callAsync(),n}),function(e,t,i){"use strict";function n(e,i,n,a){for(var r=[],o=0;o<e.length;o++){var s=e[o];if(s){var l=tinycolor(s),c=l.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(i,s)?" sp-thumb-active":"";var d=l.toString(a.preferredFormat||"rgb"),u=g?"background-color:"+l.toRgbString():"filter:"+l.toFilter();r.push('<span title="'+d+'" data-color="'+l.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+u+';" /></span>')}else{var f="sp-clear-display";r.push(t("<div />").append(t('<span data-color="" style="background-color:transparent;" class="'+f+'"></span>').attr("title",a.noColorSelectedText)).html())}}return"<div class='sp-cf "+n+"'>"+r.join("")+"</div>"}function a(){for(var e=0;e<h.length;e++)h[e]&&h[e].hide()}function r(e,i){var n=t.extend({},p,e);return n.callbacks={move:d(n.move,i),change:d(n.change,i),show:d(n.show,i),hide:d(n.hide,i),beforeShow:d(n.beforeShow,i)},n}function o(o,l){function d(){if(B.showPaletteOnly&&(B.showPalette=!0),Ft.text(B.showPaletteOnly?B.togglePaletteMoreText:B.togglePaletteLessText),B.palette){dt=B.palette.slice(0),ut=t.isArray(dt[0])?dt:[dt],ft={};for(var e=0;e<ut.length;e++)for(var i=0;i<ut[e].length;i++){var n=tinycolor(ut[e][i]).toRgbString();ft[n]=!0}}wt.toggleClass("sp-flat",V),wt.toggleClass("sp-input-disabled",!B.showInput),wt.toggleClass("sp-alpha-enabled",B.showAlpha),wt.toggleClass("sp-clear-enabled",Jt),wt.toggleClass("sp-buttons-disabled",!B.showButtons),wt.toggleClass("sp-palette-buttons-disabled",!B.togglePaletteOnly),wt.toggleClass("sp-palette-disabled",!B.showPalette),wt.toggleClass("sp-palette-only",B.showPaletteOnly),wt.toggleClass("sp-initial-disabled",!B.showInitial),wt.addClass(B.className).addClass(B.containerClassName),U()}function p(){function e(e){return e.data&&e.data.ignore?(A(t(e.target).closest(".sp-thumb-el").data("color")),F()):(A(t(e.target).closest(".sp-thumb-el").data("color")),F(),W(!0),B.hideAfterPaletteSelect&&I()),!1}if(m&&wt.find("*:not(input)").attr("unselectable","on"),d(),Wt&&yt.after(Ut).hide(),Jt||Mt.hide(),V)yt.after(wt).hide();else{var i="parent"===B.appendTo?yt.parent():t(B.appendTo);1!==i.length&&(i=t("body")),i.append(wt)}w(),Lt.bind("click.spectrum touchstart.spectrum",function(e){bt||E(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(yt.is(":disabled")||B.disabled===!0)&&H(),wt.click(c),Pt.change(C),Pt.bind("paste",function(){setTimeout(C,1)}),Pt.keydown(function(e){13==e.keyCode&&C()}),At.text(B.cancelText),At.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),I("cancel")}),Mt.attr("title",B.clearText),Mt.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),qt=!0,F(),V&&W(!0)}),Rt.text(B.chooseText),Rt.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),R()&&(W(!0),I())}),Ft.text(B.showPaletteOnly?B.togglePaletteMoreText:B.togglePaletteLessText),Ft.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),B.showPaletteOnly=!B.showPaletteOnly,B.showPaletteOnly||V||wt.css("left","-="+($t.outerWidth(!0)+5)),d()}),u(Ct,function(e,t,i){ct=e/nt,qt=!1,i.shiftKey&&(ct=Math.round(10*ct)/10),F()},k,T),u(xt,function(e,t){ot=parseFloat(t/tt),qt=!1,B.showAlpha||(ct=1),F()},k,T),u(_t,function(e,t,i){if(i.shiftKey){if(!gt){var n=st*Y,a=Z-lt*Z,r=Math.abs(e-n)>Math.abs(t-a);gt=r?"x":"y"}}else gt=null;var o=!gt||"x"===gt,s=!gt||"y"===gt;o&&(st=parseFloat(e/Y)),s&&(lt=parseFloat((Z-t)/Z)),qt=!1,B.showAlpha||(ct=1),F()},k,T),zt?(A(zt),N(),Vt=Bt||tinycolor(zt).format,$(zt)):N(),V&&P();var n=m?"mousedown.spectrum":"click.spectrum touchstart.spectrum";It.delegate(".sp-thumb-el",n,e),Ot.delegate(".sp-thumb-el:nth-child(1)",n,{ignore:!0},e)}function w(){if(q&&e.localStorage){try{var i=e.localStorage[q].split(",#");i.length>1&&(delete e.localStorage[q],t.each(i,function(e,t){$(t)}))}catch(n){}try{pt=e.localStorage[q].split(";")}catch(n){}}}function $(i){if(G){var n=tinycolor(i).toRgbString();if(!ft[n]&&-1===t.inArray(n,pt))for(pt.push(n);pt.length>ht;)pt.shift();if(q&&e.localStorage)try{e.localStorage[q]=pt.join(";")}catch(a){}}}function _(){var e=[];if(B.showPalette)for(var t=0;t<pt.length;t++){var i=tinycolor(pt[t]).toRgbString();ft[i]||e.push(pt[t])}return e.reverse().slice(0,B.maxSelectionSize)}function S(){var e=M(),i=t.map(ut,function(t,i){return n(t,e,"sp-palette-row sp-palette-row-"+i,B)});w(),pt&&i.push(n(_(),e,"sp-palette-row sp-palette-row-selection",B)),It.html(i.join(""))}function x(){if(B.showInitial){var e=Ht,t=M();Ot.html(n([e,t],t,"sp-palette-row-initial",B))}}function k(){(0>=Z||0>=Y||0>=tt)&&U(),wt.addClass(mt),gt=null,yt.trigger("dragstart.spectrum",[M()])}function T(){wt.removeClass(mt),yt.trigger("dragstop.spectrum",[M()])}function C(){var e=Pt.val();if(null!==e&&""!==e||!Jt){var t=tinycolor(e);t.isValid()?(A(t),W(!0)):Pt.addClass("sp-validation-error")}else A(null),W(!0)}function E(){K?I():P()}function P(){var i=t.Event("beforeShow.spectrum");return K?void U():(yt.trigger(i,[M()]),void(X.beforeShow(M())===!1||i.isDefaultPrevented()||(a(),K=!0,t(vt).bind("click.spectrum",I),t(e).bind("resize.spectrum",Q),Ut.addClass("sp-active"),wt.removeClass("sp-hidden"),U(),N(),Ht=M(),x(),X.show(Ht),yt.trigger("show.spectrum",[Ht]))))}function I(i){if((!i||"click"!=i.type||2!=i.button)&&K&&!V){K=!1,t(vt).unbind("click.spectrum",I),t(e).unbind("resize.spectrum",Q),Ut.removeClass("sp-active"),wt.addClass("sp-hidden");var n=!tinycolor.equals(M(),Ht);n&&(Gt&&"cancel"!==i?W(!0):O()),X.hide(M()),yt.trigger("hide.spectrum",[M()])}}function O(){A(Ht,!0)}function A(e,t){if(tinycolor.equals(e,M()))return void N();var i,n;!e&&Jt?qt=!0:(qt=!1,i=tinycolor(e),n=i.toHsv(),ot=n.h%360/360,st=n.s,lt=n.v,ct=n.a),N(),i&&i.isValid()&&!t&&(Vt=Bt||i.getFormat())}function M(e){return e=e||{},Jt&&qt?null:tinycolor.fromRatio({h:ot,s:st,v:lt,a:Math.round(100*ct)/100},{format:e.format||Vt})}function R(){return!Pt.hasClass("sp-validation-error")}function F(){N(),X.move(M()),yt.trigger("move.spectrum",[M()])}function N(){Pt.removeClass("sp-validation-error"),D();var e=tinycolor.fromRatio({h:ot,s:1,v:1});_t.css("background-color",e.toHexString());var t=Vt;1>ct&&(0!==ct||"name"!==t)&&("hex"===t||"hex3"===t||"hex6"===t||"name"===t)&&(t="rgb");var i=M({format:t}),n="";if(jt.removeClass("sp-clear-display"),jt.css("background-color","transparent"),!i&&Jt)jt.addClass("sp-clear-display");else{var a=i.toHexString(),r=i.toRgbString();if(g||1===i.alpha?jt.css("background-color",r):(jt.css("background-color","transparent"),jt.css("filter",i.toFilter())),B.showAlpha){var o=i.toRgb();o.a=0;var s=tinycolor(o).toRgbString(),l="linear-gradient(left, "+s+", "+a+")";m?Tt.css("filter",tinycolor(s).toFilter({gradientType:1},a)):(Tt.css("background","-webkit-"+l),Tt.css("background","-moz-"+l),Tt.css("background","-ms-"+l),Tt.css("background","linear-gradient(to right, "+s+", "+a+")"))}n=i.toString(t)}B.showInput&&Pt.val(n),B.showPalette&&S(),x()}function D(){var e=st,t=lt;if(Jt&&qt)Et.hide(),kt.hide(),St.hide();else{Et.show(),kt.show(),St.show();var i=e*Y,n=Z-t*Z;i=Math.max(-et,Math.min(Y-et,i-et)),n=Math.max(-et,Math.min(Z-et,n-et)),St.css({top:n+"px",left:i+"px"});var a=ct*nt;Et.css({left:a-at/2+"px"});var r=ot*tt;kt.css({top:r-rt+"px"})}}function W(e){var t=M(),i="",n=!tinycolor.equals(t,Ht);t&&(i=t.toString(Vt),$(t)),Nt&&yt.val(i),Ht=t,e&&n&&(X.change(t),yt.trigger("change",[t]))}function U(){Y=_t.width(),Z=_t.height(),et=St.height(),it=xt.width(),tt=xt.height(),rt=kt.height(),nt=Ct.width(),at=Et.width(),V||(wt.css("position","absolute"),wt.offset(s(wt,Lt))),D(),B.showPalette&&S(),yt.trigger("reflow.spectrum")}function L(){yt.show(),Lt.unbind("click.spectrum touchstart.spectrum"),wt.remove(),Ut.remove(),h[Xt.id]=null}function j(e,n){return e===i?t.extend({},B):n===i?B[e]:(B[e]=n,void d())}function z(){bt=!1,yt.attr("disabled",!1),Lt.removeClass("sp-disabled")}function H(){I(),bt=!0,yt.attr("disabled",!0),Lt.addClass("sp-disabled")}var B=r(l,o),V=B.flat,G=B.showSelectionPalette,q=B.localStorageKey,J=B.theme,X=B.callbacks,Q=f(U,10),K=!1,Y=0,Z=0,et=0,tt=0,it=0,nt=0,at=0,rt=0,ot=0,st=0,lt=0,ct=1,dt=[],ut=[],ft={},pt=B.selectionPalette.slice(0),ht=B.maxSelectionSize,mt="sp-dragging",gt=null,vt=o.ownerDocument,yt=(vt.body,t(o)),bt=!1,wt=t(b,vt).addClass(J),$t=wt.find(".sp-picker-container"),_t=wt.find(".sp-color"),St=wt.find(".sp-dragger"),xt=wt.find(".sp-hue"),kt=wt.find(".sp-slider"),Tt=wt.find(".sp-alpha-inner"),Ct=wt.find(".sp-alpha"),Et=wt.find(".sp-alpha-handle"),Pt=wt.find(".sp-input"),It=wt.find(".sp-palette"),Ot=wt.find(".sp-initial"),At=wt.find(".sp-cancel"),Mt=wt.find(".sp-clear"),Rt=wt.find(".sp-choose"),Ft=wt.find(".sp-palette-toggle"),Nt=yt.is("input"),Dt=Nt&&v&&"color"===yt.attr("type"),Wt=Nt&&!V,Ut=Wt?t(y).addClass(J).addClass(B.className).addClass(B.replacerClassName):t([]),Lt=Wt?Ut:yt,jt=Ut.find(".sp-preview-inner"),zt=B.color||Nt&&yt.val(),Ht=!1,Bt=B.preferredFormat,Vt=Bt,Gt=!B.showButtons||B.clickoutFiresChange,qt=!zt,Jt=B.allowEmpty&&!Dt;p();var Xt={show:P,hide:I,toggle:E,reflow:U,option:j,enable:z,disable:H,set:function(e){A(e),W()},get:M,destroy:L,container:wt};return Xt.id=h.push(Xt)-1,Xt}function s(e,i){var n=0,a=e.outerWidth(),r=e.outerHeight(),o=i.outerHeight(),s=e[0].ownerDocument,l=s.documentElement,c=l.clientWidth+t(s).scrollLeft(),d=l.clientHeight+t(s).scrollTop(),u=i.offset();return u.top+=o,u.left-=Math.min(u.left,u.left+a>c&&c>a?Math.abs(u.left+a-c):0),u.top-=Math.min(u.top,u.top+r>d&&d>r?Math.abs(r+o-n):n),u}function l(){}function c(e){e.stopPropagation()}function d(e,t){var i=Array.prototype.slice,n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}function u(i,n,a,r){function o(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function s(e){if(u){if(m&&document.documentMode<9&&!e.button)return c();var t=e.originalEvent.touches,a=t?t[0].pageX:e.pageX,r=t?t[0].pageY:e.pageY,s=Math.max(0,Math.min(a-f.left,h)),l=Math.max(0,Math.min(r-f.top,p));g&&o(e),n.apply(i,[s,l,e])}}function l(e){{var n=e.which?3==e.which:2==e.button;e.originalEvent.touches}n||u||a.apply(i,arguments)!==!1&&(u=!0,p=t(i).height(),h=t(i).width(),f=t(i).offset(),t(d).bind(v),t(d.body).addClass("sp-dragging"),g||s(e),o(e))}function c(){u&&(t(d).unbind(v),t(d.body).removeClass("sp-dragging"),r.apply(i,arguments)),u=!1}n=n||function(){},a=a||function(){},r=r||function(){};var d=i.ownerDocument||document,u=!1,f={},p=0,h=0,g="ontouchstart"in e,v={};v.selectstart=o,v.dragstart=o,v["touchmove mousemove"]=s,v["touchend mouseup"]=c,t(i).bind("touchstart mousedown",l)}function f(e,t,i){var n;return function(){var a=this,r=arguments,o=function(){n=null,e.apply(a,r)};i&&clearTimeout(n),(i||!n)&&(n=setTimeout(o,t))}}var p={beforeShow:l,move:l,change:l,show:l,hide:l,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"Cancel",chooseText:"Select",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1},h=[],m=!!/msie/i.exec(e.navigator.userAgent),g=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div"),i=t.style;return i.cssText="background-color:rgba(0,0,0,.5)",e(i.backgroundColor,"rgba")||e(i.backgroundColor,"hsla")}(),v=function(){var e=t("<input type='color' value='#ffffff' />")[0];return"color"===e.type&&"#ffffff"!==e.value}(),y=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),b=function(){var e="";if(m)for(var t=1;6>=t;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden scheme-3'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<div type='button' class='sp-choose powrbutton width100 text-center'></div>","</div>","</div>","</div>"].join("")}(),w="spectrum.id";t.fn.spectrum=function(e){if("string"==typeof e){var i=this,n=Array.prototype.slice.call(arguments,1);return this.each(function(){var a=h[t(this).data(w)];if(a){var r=a[e];if(!r)throw new Error("Spectrum: no such method: '"+e+"'");"get"==e?i=a.get():"container"==e?i=a.container:"option"==e?i=a.option.apply(a,n):"destroy"==e?(a.destroy(),t(this).removeData(w)):r.apply(a,n)}}),i}return this.spectrum("destroy").each(function(){var i=t.extend({},e,t(this).data()),n=o(this,i);t(this).data(w,n.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=u,t.fn.spectrum.defaults=p,t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){v||t("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function t(e){var t={r:0,g:0,b:0},n=1,r=!1,s=!1;return"string"==typeof e&&(e=M(e)),"object"==typeof e&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(t=i(e.r,e.g,e.b),r=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=I(e.s),e.v=I(e.v),t=o(e.h,e.s,e.v),r=!0,s="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=I(e.s),e.l=I(e.l),t=a(e.h,e.s,e.l),r=!0,s="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=S(n),{ok:r,format:e.format||s,r:U(255,L(t.r,0)),g:U(255,L(t.g,0)),b:U(255,L(t.b,0)),a:n}}function i(e,t,i){return{r:255*x(e,255),g:255*x(t,255),b:255*x(i,255)}}function n(e,t,i){e=x(e,255),t=x(t,255),i=x(i,255);var n,a,r=L(e,t,i),o=U(e,t,i),s=(r+o)/2;if(r==o)n=a=0;else{var l=r-o;switch(a=s>.5?l/(2-r-o):l/(r+o),r){case e:n=(t-i)/l+(i>t?6:0);break;case t:n=(i-e)/l+2;break;case i:n=(e-t)/l+4}n/=6}return{h:n,s:a,l:s}}function a(e,t,i){function n(e,t,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?e+6*(t-e)*i:.5>i?t:2/3>i?e+(t-e)*(2/3-i)*6:e}var a,r,o;if(e=x(e,360),t=x(t,100),i=x(i,100),0===t)a=r=o=i;else{var s=.5>i?i*(1+t):i+t-i*t,l=2*i-s;a=n(l,s,e+1/3),r=n(l,s,e),o=n(l,s,e-1/3)}return{r:255*a,g:255*r,b:255*o}}function r(e,t,i){e=x(e,255),t=x(t,255),i=x(i,255);var n,a,r=L(e,t,i),o=U(e,t,i),s=r,l=r-o;if(a=0===r?0:l/r,r==o)n=0;else{switch(r){case e:n=(t-i)/l+(i>t?6:0);break;case t:n=(i-e)/l+2;break;case i:n=(e-t)/l+4}n/=6}return{h:n,s:a,v:s}}function o(e,t,i){e=6*x(e,360),t=x(t,100),i=x(i,100);var n=D.floor(e),a=e-n,r=i*(1-t),o=i*(1-a*t),s=i*(1-(1-a)*t),l=n%6,c=[i,o,r,r,s,i][l],d=[s,i,i,o,r,r][l],u=[r,r,s,i,i,o][l];return{r:255*c,g:255*d,b:255*u}}function s(e,t,i,n){var a=[P(W(e).toString(16)),P(W(t).toString(16)),P(W(i).toString(16))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function l(e,t,i,n){var a=[P(O(n)),P(W(e).toString(16)),P(W(t).toString(16)),P(W(i).toString(16))];return a.join("")}function c(e,t){t=0===t?0:t||10;var i=z(e).toHsl();return i.s-=t/100,i.s=k(i.s),z(i)}function d(e,t){t=0===t?0:t||10;var i=z(e).toHsl();return i.s+=t/100,i.s=k(i.s),z(i)}function u(e){return z(e).desaturate(100)}function f(e,t){t=0===t?0:t||10;var i=z(e).toHsl();return i.l+=t/100,i.l=k(i.l),z(i)}function p(e,t){t=0===t?0:t||10;var i=z(e).toRgb();return i.r=L(0,U(255,i.r-W(255*-(t/100)))),i.g=L(0,U(255,i.g-W(255*-(t/100)))),i.b=L(0,U(255,i.b-W(255*-(t/100)))),z(i)}function h(e,t){t=0===t?0:t||10;var i=z(e).toHsl();return i.l-=t/100,i.l=k(i.l),z(i)}function m(e,t){var i=z(e).toHsl(),n=(W(i.h)+t)%360;return i.h=0>n?360+n:n,z(i)}function g(e){var t=z(e).toHsl();return t.h=(t.h+180)%360,z(t)}function v(e){var t=z(e).toHsl(),i=t.h;return[z(e),z({h:(i+120)%360,s:t.s,l:t.l}),z({h:(i+240)%360,s:t.s,l:t.l})]}function y(e){var t=z(e).toHsl(),i=t.h;return[z(e),z({h:(i+90)%360,s:t.s,l:t.l}),z({h:(i+180)%360,s:t.s,l:t.l}),z({h:(i+270)%360,s:t.s,l:t.l})]}function b(e){var t=z(e).toHsl(),i=t.h;return[z(e),z({h:(i+72)%360,s:t.s,l:t.l}),z({h:(i+216)%360,s:t.s,l:t.l})]}function w(e,t,i){t=t||6,i=i||30;var n=z(e).toHsl(),a=360/i,r=[z(e)];for(n.h=(n.h-(a*t>>1)+720)%360;--t;)n.h=(n.h+a)%360,r.push(z(n));return r}function $(e,t){t=t||6;for(var i=z(e).toHsv(),n=i.h,a=i.s,r=i.v,o=[],s=1/t;t--;)o.push(z({h:n,s:a,v:r})),r=(r+s)%1;return o}function _(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t}function S(e){return e=parseFloat(e),(isNaN(e)||0>e||e>1)&&(e=1),e}function x(e,t){C(e)&&(e="100%");var i=E(e);return e=U(t,L(0,parseFloat(e))),i&&(e=parseInt(e*t,10)/100),D.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function k(e){return U(1,L(0,e))}function T(e){return parseInt(e,16)}function C(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)}function E(e){return"string"==typeof e&&-1!=e.indexOf("%")}function P(e){return 1==e.length?"0"+e:""+e}function I(e){return 1>=e&&(e=100*e+"%"),e}function O(e){return Math.round(255*parseFloat(e)).toString(16)}function A(e){return T(e)/255}function M(e){e=e.replace(R,"").replace(F,"").toLowerCase();var t=!1;if(H[e])e=H[e],t=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};var i;return(i=V.rgb.exec(e))?{r:i[1],g:i[2],b:i[3]}:(i=V.rgba.exec(e))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=V.hsl.exec(e))?{h:i[1],s:i[2],l:i[3]}:(i=V.hsla.exec(e))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=V.hsv.exec(e))?{h:i[1],s:i[2],v:i[3]}:(i=V.hex8.exec(e))?{a:A(i[1]),r:T(i[2]),g:T(i[3]),b:T(i[4]),format:t?"name":"hex8"}:(i=V.hex6.exec(e))?{r:T(i[1]),g:T(i[2]),b:T(i[3]),format:t?"name":"hex"}:(i=V.hex3.exec(e))?{r:T(i[1]+""+i[1]),g:T(i[2]+""+i[2]),b:T(i[3]+""+i[3]),format:t?"name":"hex"}:!1}var R=/^[\s,#]+/,F=/\s+$/,N=0,D=Math,W=D.round,U=D.min,L=D.max,j=D.random,z=function G(e,i){if(e=e?e:"",i=i||{},e instanceof G)return e;if(!(this instanceof G))return new G(e,i);var n=t(e);this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=W(100*this._a)/100,this._format=i.format||n.format,this._gradientType=i.gradientType,this._r<1&&(this._r=W(this._r)),this._g<1&&(this._g=W(this._g)),this._b<1&&(this._b=W(this._b)),this._ok=n.ok,this._tc_id=N++};z.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},setAlpha:function(e){return this._a=S(e),this._roundA=W(100*this._a)/100,this},toHsv:function(){var e=r(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=r(this._r,this._g,this._b),t=W(360*e.h),i=W(100*e.s),n=W(100*e.v);return 1==this._a?"hsv("+t+", "+i+"%, "+n+"%)":"hsva("+t+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=n(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=n(this._r,this._g,this._b),t=W(360*e.h),i=W(100*e.s),a=W(100*e.l);return 1==this._a?"hsl("+t+", "+i+"%, "+a+"%)":"hsla("+t+", "+i+"%, "+a+"%, "+this._roundA+")"},toHex:function(e){return s(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return l(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:W(this._r),g:W(this._g),b:W(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+W(this._r)+", "+W(this._g)+", "+W(this._b)+")":"rgba("+W(this._r)+", "+W(this._g)+", "+W(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:W(100*x(this._r,255))+"%",g:W(100*x(this._g,255))+"%",b:W(100*x(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+W(100*x(this._r,255))+"%, "+W(100*x(this._g,255))+"%, "+W(100*x(this._b,255))+"%)":"rgba("+W(100*x(this._r,255))+"%, "+W(100*x(this._g,255))+"%, "+W(100*x(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:B[s(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+l(this._r,this._g,this._b,this._a),i=t,n=this._gradientType?"GradientType = 1, ":"";if(e){var a=z(e);i=a.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=!1,n=this._a<1&&this._a>=0,a=!t&&n&&("hex"===e||"hex6"===e||"hex3"===e||"name"===e);return a?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(i=this.toRgbString()),"prgb"===e&&(i=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(i=this.toHexString()),"hex3"===e&&(i=this.toHexString(!0)),"hex8"===e&&(i=this.toHex8String()),"name"===e&&(i=this.toName()),"hsl"===e&&(i=this.toHslString()),"hsv"===e&&(i=this.toHsvString()),i||this.toHexString())},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(f,arguments)},brighten:function(){return this._applyModification(p,arguments)},darken:function(){return this._applyModification(h,arguments)},desaturate:function(){return this._applyModification(c,arguments)},saturate:function(){return this._applyModification(d,arguments)},greyscale:function(){return this._applyModification(u,arguments)},spin:function(){return this._applyModification(m,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(w,arguments)},complement:function(){return this._applyCombination(g,arguments)},monochromatic:function(){return this._applyCombination($,arguments)},splitcomplement:function(){return this._applyCombination(b,arguments)},triad:function(){return this._applyCombination(v,arguments)},tetrad:function(){return this._applyCombination(y,arguments)}},z.fromRatio=function(e,t){if("object"==typeof e){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]="a"===n?e[n]:I(e[n]));e=i}return z(e,t)},z.equals=function(e,t){return e&&t?z(e).toRgbString()==z(t).toRgbString():!1},z.random=function(){return z.fromRatio({r:j(),g:j(),b:j()})},z.mix=function(e,t,i){i=0===i?0:i||50;var n,a=z(e).toRgb(),r=z(t).toRgb(),o=i/100,s=2*o-1,l=r.a-a.a;n=s*l==-1?s:(s+l)/(1+s*l),n=(n+1)/2;var c=1-n,d={r:r.r*n+a.r*c,g:r.g*n+a.g*c,b:r.b*n+a.b*c,a:r.a*o+a.a*(1-o)};return z(d)},z.readability=function(e,t){var i=z(e),n=z(t),a=i.toRgb(),r=n.toRgb(),o=i.getBrightness(),s=n.getBrightness(),l=Math.max(a.r,r.r)-Math.min(a.r,r.r)+Math.max(a.g,r.g)-Math.min(a.g,r.g)+Math.max(a.b,r.b)-Math.min(a.b,r.b);return{brightness:Math.abs(o-s),color:l}},z.isReadable=function(e,t){var i=z.readability(e,t);return i.brightness>125&&i.color>500},z.mostReadable=function(e,t){for(var i=null,n=0,a=!1,r=0;r<t.length;r++){var o=z.readability(e,t[r]),s=o.brightness>125&&o.color>500,l=3*(o.brightness/125)+o.color/500;(s&&!a||s&&a&&l>n||!s&&!a&&l>n)&&(a=s,n=l,i=z(t[r]))}return i};var H=z.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},B=z.hexNames=_(H),V=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",i="(?:"+t+")|(?:"+e+")",n="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?",a="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";return{rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+n),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();e.tinycolor=z}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})}(window,jQuery);var appModel=new Object,appSettings=new Object,appView=new Object;$(function(){appModel=Backbone.Model.extend({presets:function(){return{}},baseDefaults:function(){return{}},afterMount:function(){},defaults:function(){var e=this.baseDefaults();if(META.default_overrides)for(var t in META.default_overrides)void 0!==this.baseDefaults()[t]&&(e[t]=META.default_overrides[t]);if("wix"==HOST&&(e.pluginWidth="1000px"),"undefined"!=typeof CHAMELEON&&CHAMELEON){this.set({chameleon:!0},{silent:!0});var i=getURLParameter("backgroundColor"),n=getURLParameter("color"),a=!0;i&&n&&tinycolor.readability(n,i).color<100&&(a=!1);for(var r in this.presets()){var o=this.presets()[r],s=getURLParameter(o);(a||"color"!=o&&"backgroundColor"!=o)&&s&&(e[r]=s)}}return e},urlRoot:"/apps/",initialize:function(){this.hasOwnProperty("isPreset")||this.set({isPreset:!0},{silent:!0}),this.setLocals({render_style_only:null}),this.afterInitialize&&this.afterInitialize()},triggerChange:function(){var e=this;debug()("TriggerChange called"),"wix"==HOST&&"undefined"!=typeof APP_SETTINGS?(Wix.Settings.triggerSettingsUpdatedEvent(this.attributes,Wix.Utils.getOrigCompId()),this.setLocals({render_style_only:null})):"weebly"==HOST||"undefined"!=typeof INPAGE&&INPAGE?localStorage.setItem("powr_data_"+e.meta.id,JSON.stringify({content:e.attributes,meta:e.meta})):e.trigger("change")},updateWixStyles:function(){var e=this;"undefined"==typeof WIX_COLOR_CHANGE_TIMER?(e._updateWixStyles(),WIX_COLOR_CHANGE_TIMER=setTimeout(function(){},0)):(clearTimeout(WIX_COLOR_CHANGE_TIMER),WIX_COLOR_CHANGE_TIMER=setTimeout(function(){e._updateWixStyles()},500))},_updateWixStyles:function(){function e(e){return"undefined"!=typeof Wix?(e=e.replace(/^http.+?(static\.wix\.com|static\.wixstatic\.com)\/media\/.+?srz$/i,function(e){return e=e.substring(e.indexOf("media/")+6),e=e.substring(0,e.indexOf(".")+4),e=e.replace(".jpe",".jpeg"),Wix.Utils.Media.getResizedImageUrl(e,1200,1200)}),e=e.replace(/src="http.+?(static\.wix\.com|static\.wixstatic\.com)\/media\/.+?srz"/gi,function(e){return e=e.replace(/"/g,""),e=e.replace("src=",""),e=e.substring(e.indexOf("media/")+6),e=e.substring(0,e.indexOf(".")+4),e=e.replace(".jpe",".jpeg"),'src="'+Wix.Utils.Media.getResizedImageUrl(e,1200,1200)+'"'})):e}var t=this;for(var i in t.attributes){if(i.search("ColorWix")>-1){var n=t.attributes[i];if(null==n||0==n.length)continue;n=n.replace("/","-");var a=i.replace("Wix",""),r=$(".wix-style-reference ."+n).css("color");void 0!=r&&r.length>0&&(t.attributes[a]=r)}if("string"==typeof t.attributes[i])t.attributes[i]=e(t.attributes[i]);else for(var o in t.attributes[i])if("string"==typeof t.attributes[i][o])t.attributes[i][o]=e(t.attributes[i][o]);else for(var s in t.attributes[i][o])if("string"==typeof t.attributes[i][o][s])t.attributes[i][o][s]=e(t.attributes[i][o][s]);else for(var l in t.attributes[i][o][s])if("string"==typeof t.attributes[i][o][s][l])t.attributes[i][o][s][l]=e(t.attributes[i][o][s][l]);else for(var c in t.attributes[i][o][s][l])"string"==typeof t.attributes[i][o][s][l][c]&&(t.attributes[i][o][s][l][c]=e(t.attributes[i][o][s][l][c]))}"undefined"!=typeof APP_VIEW&&(debug()("Rendering view from _updateWixStyles"),APP_VIEW.render())},setLocals:function(e){var t=this.get("locals");void 0==t&&(t={});for(var i in e)t[i]=e[i];this.set({locals:t},{silent:!0})},setPresets:function(){},doSave:function(e){function t(){("wix"==HOST||"weebly"==HOST||e.autoSave)&&(debug()("Save fail. Trying to save again in "+AUTO_SAVE_TIME),"undefined"==typeof AUTO_RESAVE?null:clearTimeout(AUTO_RESAVE),AUTO_RESAVE=setTimeout(function(){i.doSave()
},AUTO_SAVE_TIME))}this.beforeDoSave&&this.beforeDoSave();var i=this;if("undefined"==typeof e&&(e={}),e.settings)var n=e.settWDWDWDWDWDWDings;else var n="undefined"==typeof APP_SETTINGS?null:APP_SETTINGS;if(n){debug()("Saving with settings");{var a=n.$el.find(".saveButton"),r=(n.$el.find(".saveSuccess"),n.$el.find(".saveFailure"));n.$el.find(".saving")}a.toggleButton();var o=new errorHandler(r);o.clearErrors()}("wix"==HOST||"weebly"==HOST||e.autoSave)&&(AUTO_SAVE_TIME="undefined"==typeof AUTO_SAVE_TIME?1e3:1.1*AUTO_SAVE_TIME);var s=jQuery.extend(!0,{},i.attributes),l=s.locals.additionalActions||null;delete s.additionalActions,delete s.locals,delete s.isPreset,delete s.colorPreset,delete s.fontPreset,delete s.designPreset,delete s.designPresetCategory,delete s.passwords;var c={content:JSON.stringify(s),additionalActions:JSON.stringify(l),passwords:JSON.stringify(i.get("passwords")),original_query:originalQuery(),app_type:i.meta.app_type,view_mode:i.meta.view_mode,alias:i.meta.alias,unique_label:i.meta.unique_label};if(void 0!=e.post_params)for(var d in e.post_params)c[d]=e.post_params[d];var u="/apps/"+i.meta.true_id;debug()("posting to url "+u),ajaxController({url:u,data:c,type:"PUT"},function(r){if(debug()("Save response: ",r),r.success)i.meta.saved=!0,debug()("Update success! Model:",i,"Response:",r),i.setLocals({isDirty:!1}),n&&(a.toggleButton(),n.animateSaveButton(),n.updateSaveStatus(),n.updateEmbedCode(),("wix"==HOST||"weebly"==HOST)&&(n.$el.find(".saveStatus .savingStatus").hide(),n.$el.find(".saveStatus .savedStatus").show(),setTimeout(function(){n.$el.find(".saveStatus .savedStatus").fadeOut("fast")},1e3))),this.afterDoSave&&this.afterDoSave(r),e.callback&&e.callback(r);else{if(debug()("UH OH...trouble saving!"),n){for(var s in r.errors)o.addError(r.errors[s]);a.toggleButton(),o.displayErrors()}t()}}.bind(this))}}),appView=Backbone.View.extend({beforeInitialize:function(){},initialize:function(){_.bindAll(this,"template","render","beforeInitialize","afterInitialize","beforeRender","afterRender"),this.beforeInitialize();var e=this;this.setMetaContent(),void 0!=$(window).konami&&($(window).konami({code:[80,38],cheat:function(){debug()("P up detected"),$("#editMe, .adminAppInfo").fadeIn()}}),$(window).konami({code:[80,40],cheat:function(){debug()("P down detected"),$("#editMe, .adminAppInfo").fadeOut()}})),this.turnOnCssWatch(),isWebview()&&this.$el.on("submit","form",function(){debug()("Setting frame to top"),$(this).attr("target","_top")}),this.$el.on("click","a",function(){debug()("Deciding link behavior");var t=e.model.get("linkBehavior");t&&"none"!=t?$(this).data("overwrite-link-behavior")||""==($(this).attr("target")||"")?(debug()("Setting link behavior for "+t),$(this).attr("target",t),$(this).data("overwrite-link-behavior",!0)):debug()("Link behavior",$(this).data("overwrite-link-behavior"),$(this).attr("target")):debug()("No link behavior found")}),this.$el.on("keyup",'.passwordProtection [name="password"]',function(){"undefined"!=typeof PASSWORD_PROTECT_TIMER&&clearTimeout(PASSWORD_PROTECT_TIMER),PASSWORD_PROTECT_TIMER=setTimeout(function(){e.checkPassword()},500)}),$(window).on("orientationchange",function(){window.ORIENTATION_TIMEOUT&&clearTimeout(ORIENTATION_TIMEOUT),e.beforeOrientationChange(),ORIENTATION_TIMEOUT=setTimeout(function(){debug()("Orientation change detected"),e.render(),e.afterOrientationChange()},10)}),"wix"==HOST&&(e.model.updateWixStyles(),$(".wix-style-reference div").on("css-change",function(){debug()("Wix view detects new colors"),e.model.updateWixStyles()}),$(".wix-style-reference div").csswatch({props:"color"}),setTimeout(function(){debug()("Deciding whether to update url"),"site"==VIEW_MODE&&(debug()("View mode is site"),0==e.model.meta.last_viewed_url.length||(new Date).getTime()/1e3-e.model.meta.updated_at>21600?(debug()("Checking for URL update"),Wix.getSiteInfo(function(t){var i=t.url;if(i!=e.model.meta.last_viewed_url){debug()("New URL, posting to server "+i);var n={url:"/apps/"+e.model.meta.id+"/update_url.json",data:{url:i},type:"PUT"};ajaxController(n,function(){})}else debug()("Not a new url, not posting")})):debug()("Not time to update url"))},5e3),META.wix_demo&&e.$el.on("click","a",function(){return!1}),e.$el.on("submit",".paypalForm",function(){if("ecommerce"!=e.model.meta.app_namespace){try{debug()("Posting payment information to PayPal");var t=$(this),i={type:Wix.Activities.Type.ECOMMERCE_CART_CHECKOUT,info:{cartId:e.model.meta.id+"",storeId:e.model.meta.id+"",storeName:t.find('[name="item_name"]').val(),items:[{id:e.model.meta.id,title:t.find('[name="item_name"]').val(),quantity:t.find('[name="quantity"]').val(),price:t.find('[name="amount"]').val(),currency:t.find('[name="currency_code"]').val(),variants:[]}]}},n=function(e){debug()("Wix Posting Activity success: "+e.activityId+", Contact ID: "+e.contactId)},a=function(e){debug()("Wix Posting activity failure:",e)};debug()("Posting wix activity:",i),Wix.Activities.postActivity(i,n,a)}catch(r){debug()("Posting Wix activity failed:",r)}return!0}}));var t=0;setTimeout(function(){e.$el.find(".loadingWrapper").fadeOut("fast",function(){e.render()})},t);var i=(new Date).getTime();if(e.model.on("change",function(){(new Date).getTime()-i>=t&&e.render()}),$("#app-settings").length>0&&e.model.get("passwordProtectOn")&&!e.model.get("locals").passwordProtectSuccess){var n={url:"/apps/"+e.model.meta.id+"/content.json",data:{id:e.model.meta.id,method:"owner"},type:"POST"};ajaxController(n,function(t){if(t.success)for(var i in t.content)"undefined"!=t.content[i]&&e.model.set(i,t.content[i]);e.render()})}setTimeout(function(){(CURRENT_USER||"formBuilder"==e.model.meta.app_namespace||"ecommerce"==e.model.meta.app_namespace)&&loadCrypto()},2e3),function(){var t=$("#testing_tier_tier");t.val(this.model.meta.premium_status),$(document).on("change","#testing_tier_tier",function(){var t=$(this),i=t.val();return ajaxController({url:"/apps/"+e.model.meta.id+"/make-premium",data:{value:i},type:"PUT"},function(e){e.success&&location.reload()}),!1})}.bind(this)(),this.afterInitialize(),function(e,t,i,n,a,r,o){e.GoogleAnalyticsObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,r=t.createElement(i),o=t.getElementsByTagName(i)[0],r.async=1,r.src=n,o.parentNode.insertBefore(r,o)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-86251018-1","auto","powr_apps"),ga("powr_apps.send","pageview","/"+this.model.meta.id),initializeAhoy()},beforeOrientationChange:function(){},afterOrientationChange:function(){},afterInitialize:function(){},hidePowrWaterMark:function(){window.HIDE_WATERMARK_INTERVAL&&clearInterval(window.HIDE_WATERMARK_INTERVAL),window.HIDE_WATERMARK_INTERVAL=setInterval(function(){var e=$(".powrLoaded iframe");$(".powrMark",e.contents()).hide()},1e3),setTimeout(function(){clearInterval(window.HIDE_WATERMARK_INTERVAL)},15e3)},turnOnCssWatch:function(){var e=this;this.$el.csswatch({props:"width, height"}),this.$el.on("css-change",function(){"undefined"!=typeof CSS_CHANGE_TIMER&&clearTimeout(CSS_CHANGE_TIMER),CSS_CHANGE_TIMER=setTimeout(function(){e.fitText(),e.postSizeToSocket()},200)})},turnOffCssWatch:function(){this.$el.off("css-change")},setMetaContent:function(){var e=this.model.meta.app_common_name+" by POWr - "+this.model.meta.id,t=this.model.meta.app_common_name;this.writeMetaContent(e,t)},writeMetaContent:function(e,t,i){e="undefined"!=typeof e&&e.length>0?truncate($("<i>"+e+"</i>").text(),160):this.model.meta.app_common_name,t="undefined"!=typeof t&&t.length>0?truncate($("</i>"+t+"</i>").text(),60):this.model.meta.app_common_name,i="undefined"!=typeof i&&i.length>0?i:pluginIcon(this.model.meta.app_type);var n=document.location.href,a="<title>"+t+"</title>";a+='<meta content="'+e+'" name="description">',a+='<meta content="'+t+'" property="og:title">',a+='<meta content="website" property="og:type">',a+='<meta content="'+n+'" property="og:url">',a+='<meta content="'+i+'" property="og:image">',a+='<meta content="'+e+'" property="og:description">',a+='<meta content="summary" name="twitter:card">',a+='<meta content="'+t+'" name="twitter:title">',a+='<meta content="'+e+'" name="twitter:description">',a+='<meta content="'+i+'" name="twitter:image">',$("head").append(a)},template:function(){var e=this,t="#"+this.model.meta.app_namespace+"Template";if(this.model.get("passwordProtectOn")&&!e.model.get("locals").passwordProtectSuccess)if(e.model.get("locals").skipPassword)e.model.get("locals").afterPasswordCalled||(e.model.setLocals({afterPasswordCalled:!0}),e.afterCorrectPassword());else if($("#passwordProtectionTemplate").length>0)t="#passwordProtectionTemplate";else{var i={url:"/password-modal",type:"GET"};ajaxController(i,function(t){t.success&&(debug()("Password modal response",t),0==$("#passwordProtectionTemplate").length&&($("body").append(t.html),e.model.trigger("change")))}),debug()("Please save and reload this app")}var n=$(t).html();return n},styleTemplate:function(){var e="#"+this.model.meta.app_namespace+"StyleTemplate",t=$(e).html();return t},updateInputFields:function(){this.$el.find("input,textarea,select").length>0&&($.webshims.polyfill("forms"),this.$el.find("input,textarea,select").updatePolyfill("forms"))},beforeRender:function(){},render:function(){this.beforeRender();var e=this,t=this.model;this.$el.toggleClass("noTransition",!0),setTimeout(function(){e.$el.toggleClass("noTransition",!1)},500);var i=this.styleTemplate();if(void 0!=i){var n=_.template(i,{m:t.attributes,meta:t.meta});$("#dynamicStyle").html(n),void 0!=t.get("customCSS")&&t.get("customCSS").length>0&&$("#dynamicStyle").append("<style>"+t.get("customCSS")+"</style>"),void 0!=t.get("customJS")&&t.get("customJS").length>0&&$("#dynamicStyle").append("<script>"+t.get("customJS")+"</script>")}if(1!=this.model.get("locals").render_style_only){var a=this.template(),r=_.template(a,{m:t.attributes,meta:t.meta});this.$el[0].innerHTML=r,this.loadFonts(),this.afterRender(),this.updateInputFields(),this.loadNodeImages(),"free"!=this.model.meta.premium_status&&this.$el.find(".powrMark, .markOfPowr").hide(),this.model.meta.user_has_app&&(this.$el.find(".userHasApp").show(),$(".hovereffectpowrmark").popover({trigger:"hover",delay:{show:0,hide:1200},html:!0})),"bookmark"==this.model.meta.external_id_type&&$("#editMe").hide(),e.fitText(),e.postSizeToSocket()}else this.loadFonts(),e.$el.find(".fitText").css("font-size","").removeData("orig-font-size"),e.fitText(),e.postSizeToSocket();this.model.get("passwordProtectOn")&&!e.model.get("locals").passwordProtectSuccess&&(this.applyPasswordStyle(),e.postSizeToSocket()),this.model.setLocals({render_style_only:null}),"blogger"==this.model.meta.external_id_type&&"free"==this.model.meta.premium_status&&this.$el.find(".usefulContentLink").css("display","inline-block").html("microblog"==this.model.meta.app_namespace||"ecommerce"==this.model.meta.app_namespace||"socialFeed"==this.model.meta.app_namespace?'<ins class="adbladeads" data-cid="28868-1453745347" data-host="web.adblade.com" data-tag-type="4" data-protocol="https" style="display:none"></ins><script async src="https://web.adblade.com/js/ads/async/show.js" type="text/javascript"></script>':'<ins class="adbladeads" data-cid="27501-2708538704" data-host="web.adblade.com" data-tag-type="4" data-protocol="https" style="display:none"></ins><script async src="https://web.adblade.com/js/ads/async/show.js" type="text/javascript"></script>'),$('[data-toggle="tooltip"]').tooltip(),$("[name=notify_url]").val("https://"+document.location.host+"/payment_notification/"+this.model.meta.id)},loadNodeImages:function(){loadNodeImages(this.$el)},checkPassword:function(){debug()("Checking password");var e=this;if(e.model.get("passwordProtectOn")){var t=$(".passwordProtection"),i=$(t).find('input[name="password"]').val(),n=t.find(".checking"),a=t.find(".incorrect"),r=t.find(".correct");if(n.hide(),r.hide(),a.hide(),0==i.length)return;n.show();var o=!window.APP_SETTINGS;debug()("Need to check password with server: "+o);var s=function(){if(debug()("Password is correct"),n.hide(),a.hide(),r.fadeIn(),e.model.setLocals({passwordProtectSuccess:!0}),e.render(),window.APP_SETTINGS){var t=APP_SETTINGS.$el.find(".previewPassword");t.find(".showPasswordPreview").show(),t.find(".hidePasswordPreview").hide()}},l=function(){debug()("Password is incorrect"),n.hide(),a.fadeIn()};if(o){var c={url:"/apps/"+e.model.meta.id+"/content.json",data:{id:e.model.meta.id,password:i,view_mode:"undefined"==typeof VIEW_MODE?"":VIEW_MODE},type:"POST"};ajaxController(c,function(t){if(t.success)if(t.correct){s();for(var i in t.content)"undefined"!=t.content[i]&&e.model.set(i,t.content[i]);e.afterCorrectPassword()}else l();else l()})}else-1!=e.model.get("passwords").map(function(e){return e.password}).indexOf(i)?s():l()}},afterCorrectPassword:function(){},postSizeToSocket:function(){var e=this;if("wix"==HOST)debug()("Setting wix height"),"undefined"!=typeof WIX_HEIGHT_TIMER&&clearTimeout(WIX_HEIGHT_TIMER),WIX_HEIGHT_TIMER=setTimeout(function(){var t=e.$el.outerHeight(!0);Wix.setHeight(t)},200);else{var t=this.$el.outerWidth(!0),i=this.$el.outerHeight(!0);if($("#editMe.design_2").length>0&&"notificationBar"!=e.model.meta.app_namespace&&(i+=$("#editMe.design_2").outerHeight(!0)),void 0!=e.model.get("locals").parent_origin){$(".adWrapper").length>0&&(i+=$(".adWrapper").outerHeight(!0));var n={width:t,height:i,iframe_index:e.model.get("locals").iframe_index};void 0!=e.model.get("locals").postCss&&(n.postCss=e.model.get("locals").postCss),void 0!=e.model.get("locals").postMessage&&(n.postMessage=e.model.get("locals").postMessage);var a={message:"updateSize",data:n};parent.postMessage(JSON.stringify(a),e.model.get("locals").parent_origin)}else"undefined"!=typeof APP_SOCKET&&(debug()("App socket exists"),APP_SOCKET.postMessage(JSON.stringify({action:"updateSize",width:t,height:i})))}},loadFonts:function(){var e=[];for(var t in this.model.attributes){var i=this.model.attributes[t];if(t.search("FontFamily")>-1&&e.push(i),"object"==typeof i)for(var n in i){var a=i[n];if(n.search("FontFamily")>-1&&e.push(a),"object"==typeof a)for(var r in a)r.search("FontFamily")>-1&&e.push(a[r])}}e.length>0&&loadFonts(e)},afterRender:function(){},applyPasswordStyle:function(){this.setStandardBackground($(".passwordProtection"))},setStandardBackground:function(e){if("undefined"==typeof e)var t=this.$el.children();else var t=e;var i=this.model;"none"!=i.get("backgroundShadow")&&t.toggleClass(i.get("backgroundShadow"),!0),t.css(1==i.get("backgroundGradient")?{background:"-webkit-linear-gradient("+i.get("backgroundStartColor")+","+i.get("backgroundEndColor")+")",background:"-o-linear-gradient("+i.get("backgroundStartColor")+","+i.get("backgroundEndColor")+")",background:"-moz-linear-gradient("+i.get("backgroundStartColor")+","+i.get("backgroundEndColor")+")",background:"linear-gradient("+i.get("backgroundStartColor")+","+i.get("backgroundEndColor")+")","border-color":i.get("backgroundBorderColor"),"border-radius":i.get("backgroundBorderRadius"),"border-width":i.get("backgroundBorderWidth"),"border-style":"solid"}:{background:i.get("backgroundColor"),"border-color":i.get("backgroundBorderColor"),"border-radius":i.get("backgroundBorderRadius"),"border-width":i.get("backgroundBorderWidth"),"border-style":"solid"})},setStandardWidth:function(e){e.css("1000px"===this.model.get("pluginWidth")?{maxWidth:"100%"}:{maxWidth:this.model.get("pluginWidth")})},fitText:function(){fitText(this.$el.find(".fitText")),this.afterFitText()},afterFitText:function(){}}),appSettings=Backbone.View.extend({premStatVals:["free","premium","pro","enterprise"],el:"#appSettings",beforeInitialize:function(){},multiSelectImages:function(){return!1},initialize:function(){function e(){i.model.updateWixStyles(),i.handleEvents(),i.render(),i.afterInitialize(),i.loadTemplates()}function t(){$(".wix-style-reference .color-1").css("color")==$(".wix-style-reference .color-2").css("color")&&$(".wix-style-reference .color-2").css("color")==$(".wix-style-reference .primery-1").css("color")&&$(".wix-style-reference .primery-2").css("color")==$(".wix-style-reference .primery-3").css("color")?(debug()("Wix style NOT ready"),setTimeout(function(){t()},100)):(debug()("Wix style ready"),e())}_.bindAll(this,"template","render","saveModel","handleEvents","beforeRender","afterRender","update","afterUpdate","beforeInitialize","afterInitialize","initializeColorPickers","initializeFontPickers","initializeFontSizePickers","initializeSliders","initializeImagePickers"),this.beforeInitialize();var i=this;if("wix"==HOST?("dashboard"==VIEW_MODE?e():t(),this.$el.on("click",".wixAppRep",function(){analyticsEvent("click","Wix App Click",$(this).attr("href"))})):(this.handleEvents(),this.render(),this.afterInitialize()),"undefined"!=typeof WALKTHROUGH_STEPS&&(WALKTHROUGH_MODULE=new walkthroughModule(WALKTHROUGH_STEPS)),$(window).keydown(function(e){return(e.metaKey||e.ctrlKey)&&83==e.keyCode?(debug()("Save keyed!"),i.$el.find(".triggerPublish").first().click(),e.preventDefault(),setTimeout(function(){i.$el.find(".modalPanelClose").first().click()},500),!1):void 0}),this.$el.on("click",".showTemplateInstall",function(){i.$el.find(".templateInstall").fadeIn()}),this.$el.on("click",".hideTemplateInstall",function(){i.$el.find(".templateInstall").fadeOut()}),this.$el.on("click",".relatedApps .fa-times",function(){i.$el.find(".relatedApps").fadeOut(),ajaxController({url:"/user_banners/"+$(this).data("id"),data:{user_id:CURRENT_USER.id},type:"delete"},function(e){e.success})}),$(document).on("click",".triggerHelp",function(){zE.activate();var e=$("#webWidget");return $("#helpCenterBackground").addClass("active"),e.show(),e.css("opacity",1),window.ZENDESK_WATCHER=setInterval(function(){0==e.css("opacity")&&(clearInterval(window.ZENDESK_WATCHER),$("#helpCenterBackground").removeClass("active"),e.hide())},250),!1}),$(document).on("click",".triggerElementModal",function(){$("#elementsModal").modal("show"),$("#elementsModal .selectElement").removeClass("hid"),$("#elementsModal .selectPlugin").addClass("hid"),$("#elementsModal .goBackToElements").addClass("hid"),$("#elementsModal .modal-title").html($(".selectElement").data("title"))}),$(document).on("click","#elementsModal .goBackToElements",function(){$("#elementsModal .selectElement").removeClass("hid"),$("#elementsModal .selectPlugin").addClass("hid"),$("#elementsModal .goBackToElements").addClass("hid"),$("#elementsModal .modal-title").html($(".selectElement").data("title"))}),$(document).on("click",".triggerPublish",function(){return debug()("trigger publish clicked"),i.model.meta.demo_mode?($(".modalPanel").removeClass("show"),$(".publishPanel").addClass("show"),$(".publishLoading").hide(),void $(".publishSuccess").fadeIn()):null==CURRENT_USER?(PUBLISH_ON_SIGN_IN=!0,$("#sign-in-modal").modal("show"),$("#sign-in-modal .saveProgressText").removeClass("hid"),$("#sign-in-modal .tab-content-title").text($("#sign-in-modal .tab-content-title").data("save-work")),$("#sign-in-modal #sign-up-submit").val($("#sign-in-modal .signupbtn").data("save-btn")),$("#sign-in-modal #sign-in-submit").val($("#sign-in-modal .signupbtn").data("save-btn")),$("#sign-in-modal .facebookSignIn .text").text($("#sign-in-modal .facebookSignIn").data("fb-cont")),$("#sign-in-modal .googleSignIn .text").text($("#sign-in-modal .googleSignIn").data("google-cont")),void $("#sign-in-modal .yahooSignIn .text").text($("#sign-in-modal .yahooSignIn").data("yahoo-cont"))):void 0==APP_MODEL.meta.nickname||"Untitled"==APP_MODEL.meta.nickname?(debug()("showing naming modal"),$("#namingModal").modal("show"),CURRENT_USER&&CURRENT_USER.platform&&$(".platform-select-dropdown [data-platform='"+CURRENT_USER.platform+"']").click(),!1):($(".modalPanel").removeClass("show"),$(".upgradePanel").removeClass("show"),$(".publishPanel").addClass("show"),("free"===APP_MODEL.meta.premium_status||APP_MODEL.meta.active_trial===!0)&&($(".triggerPremium").first().click(),$(".modalPanel:not(.right)").removeClass("show"),$(".upgradePanel").addClass("show")),APP_MODEL.doSave({autoSave:!0,callback:function(){$(".loader").hide(),$(".publishLoading").hide(),$(".publishSuccess").fadeIn()}}),void 0)}),this.$el.on("click",".triggerFormBuilderPlus",function(){window.open("https://www.wix.com/app-market/form-builder-plus/overview")}),this.$el.on("click",".modalPanelClose",function(){$(this).closest(".modalPanel").removeClass("show")}),this.$el.on("click",".saveNickname",function(){$("#namingModal .saveNicknameErrors").html();var e=$('#namingModal [name="nickname"]').val(),t=$("#namingModal .platform-select-dropdown-btn").data("platform");return 0==e.length?void $("#namingModal .saveNicknameErrors").html("Please enter a name"):$("#namingModal .platform-select-dropdown-btn").length>0&&!t?void $("#namingModal .saveNicknameErrors").html("Please select a platform"):void ajaxController({url:"/apps/"+APP_MODEL.meta.id+"/update_nickname",data:{nickname:e,platform:t},type:"put",buttonElement:$(this),errorsElement:$("#namingModal .saveNicknameErrors")},function(n){if(n.success){if($("#namingModal").modal("hide"),APP_MODEL.meta.nickname=e,$(".triggerPublish").first().click(),getURLParameter("platform"))var a=getURLParameter("platform");else if(CURRENT_USER&&CURRENT_USER.platform)var a=CURRENT_USER.platform;else var a=t||"html";$("#apps-standalone").length>0&&a&&i.selectPlatform(a)}})}),this.$el.on("keyup",'[name="nickname"]',function(e){13==e.keyCode&&$(".saveNickname").click()}),this.$el.on("click",".publishClose",function(){$(".publishLoading").show(),$(".publishSuccess").hide()}),this.$el.on("click",".toggleSpace",function(){debug()("Toggle space clicked");var e=$(this).parents(".prototype-element").first();e.find(".panel-collapse").slideToggle("fast")}),this.$el.on("click",".langDropdown li",function(){var e=$(this).data("locale"),t=$(this).html(),n=location.search.replace(/locale=[a-zA-Z][a-zA-Z]($|&)/g,"").replace("?","");if("wix"==HOST)i.model.set({viewLocale:e},{silent:!0}),ajaxController({url:"/apps/"+i.model.meta.id+"/update_view_locale.json",data:{view_locale:e,original_query:location.search},type:"PUT"},function(e){e.success&&(Wix.Settings.refreshApp(),i.$el.find(".langSelectedVal").html(t),i.$el.find(".langSelected").click())});else{var a=baseUri()+location.pathname+"?locale="+e+"&"+n;debug()("New url is "+a),window.location.assign(a)}}),this.$el.on("click",".langSelected",function(){i.$el.find(".lang-list").slideToggle(200)}),i.$el.find("#creditCardNumber").on("keyup",function(){var e=$(this).val();debug()("card number input keyup detected"),"4"==e.charAt(0)?(i.$el.find(".cardtype").addClass("visa"),i.$el.find(".defaultCards").css("display","none")):"5"==e.charAt(0)?(i.$el.find(".cardtype").addClass("mastercard"),i.$el.find(".defaultCards").css("display","none")):"6"==e.charAt(0)?(i.$el.find(".cardtype").addClass("discover"),i.$el.find(".defaultCards").css("display","none")):"3"!=e.charAt(0)||"4"!=e.charAt(1)&&"7"!=e.charAt(1)?(i.$el.find(".cardtype").attr("class","cardtype default"),i.$el.find(".defaultCards").css("display","inline-block")):(i.$el.find(".cardtype").addClass("americanexpress"),i.$el.find(".defaultCards").css("display","none"))}),this.$el.on("click","#choosetemplateAccordion .panel-heading",function(){i.loadTemplates()}),this.$el.find("#choosetemplateAccordion").find(".collapsed")[0]&&i.loadTemplates(),this.$el.on("click","#importExistingAccordion .panel-heading",function(){i.loadImports()}),this.$el.on("click",".category",function(){debug()("Category clicked!"),i.$el.find(".category").removeClass("active"),$(this).addClass("active");var e=$(this).data("category");i.$el.find(".templateChoice").parent(".choiceParent").show(),i.$el.find(".templateChoice:not(."+e+")").parent(".choiceParent").hide()}),i.$el.find(".startFromScratch").click(function(){i.$el.find('.tab[data-index="1"]').click()}),this.$el.on("click",".importApp",function(){var e=$(this).data("app-id");e||(e=$(this).data("unique-label")),$(this).find("[name='template']").length>0&&i.model.set({template:$(this).find("[name='template']").val()},{silent:!0});var t=$(this).parents(".importAppBox").find(".success");i.model.get("locals").isDirty||i.model.meta.saved?(confirmModal=$("#confirmModal"),confirmModal.find(".modal-body").html("This will overwrite your current content. Continue?"),confirmModal.modal("show"),confirmModal.find("#okBtn").click(function(){i.importApp(e,{success_el:t})})):i.importApp(e,{success_el:t})}),this.$el.on("click",".syncApp",function(){function e(){i.model.setLocals({renderSettings:!0}),i.model.meta.alias=t,debug()("0: "+i.model.attributes.locals.importsLoaded);var e=jQuery.extend(!0,{},IMPORT_CONTENT[t].content);for(var n in e)"undefined"!=typeof i.model.defaults()[n]&&(i.model.attributes[n]=e[n]);debug()("1: "+i.model.attributes.locals.importsLoaded),i.model.triggerChange(),debug()("2: "+i.model.attributes.locals.importsLoaded),i.initializeSync(),debug()("3: "+i.model.attributes.locals.importsLoaded)}var t=parseInt($(this).data("app-id"));i.model.get("locals").isDirty||i.model.meta.saved?(confirmModal=$("#confirmModal"),confirmModal.find(".modal-body").html("This will overwrite your current content. Continue?"),confirmModal.modal("show"),confirmModal.find("#okBtn").click(e)):e()}),this.$el.on("click",".unSync",function(){i.model.meta.alias=null,i.initializeSync(),i.model.setLocals({isDirty:!0}),i.updateSaveStatus()}),this.$el.on("click",".navContainer .nav-tabs a",function(){return i.model.get("locals").renderSettings?(debug()("Re-rendering settings"),i.model.setLocals({renderSettings:!1,renderTab:$(this).data("index")}),i.render(),i.update()):($(".navContainer .nav-tabs a, .section").removeClass("active"),$(this).addClass("active"),$(this).prevAll().removeClass("active"),$(this).nextAll().removeClass("active"),$(".section").eq($(".navContainer .nav-tabs a").index(this)).addClass("active"),$(".section").css("left","-"+$(".navContainer .nav-tabs a").index(this)+"00%"),0==$(this).data("index")?i.$el.find(".prevSection").hide():i.$el.find(".prevSection").show(),parseInt($(this).data("index"))==$(".navContainer .nav-tabs a").length-1?(i.$el.find(".nextSectionPublishText").show(),setTimeout(function(){i.$el.find(".nextSection").toggleClass("triggerPublish",!0)},0),i.$el.find(".nextSectionText").hide()):(i.$el.find(".nextSectionPublishText").hide(),i.$el.find(".nextSection").toggleClass("triggerPublish",!1),i.$el.find(".nextSectionText").show())),!1}),this.$el.on("click",".removePowrLogo",function(){i.$el.find(".triggerPremium").first().click(),$(this).find(".uilib-checkbox").removeClass("checked")}),this.$el.on("click",".nextSection",function(){var e=parseInt(i.$el.find(".navContainer .nav-tabs .tab.active").last().data("index"));$(i.$el.find(".navContainer .nav-tabs a")[e+1]).click()}),this.$el.on("click",".prevSection",function(){i.$el.find("#choosetemplateAccordion").find(".collapsed")[0]&&i.loadTemplates();var e=parseInt(i.$el.find(".navContainer .nav-tabs .tab.active").last().data("index"));$(i.$el.find(".navContainer .nav-tabs a")[e-1]).click()}),!i.model.meta.saved&&("weebly"==HOST||"undefined"!=typeof INPAGE&&INPAGE)&&CURRENT_USER&&i.saveModel(),$(document).on("click",function(e){if(!($(e.target).parents(".popover").length>0||$(e.target).hasClass(".popover"))){var t=$(e.target).parents(".premium"),i=$(e.target).hasClass("premium")?$(e.target):[],n=$(".premium").not(t[0]).not(i[0]);n.popover("hide"),n.next(".popover").hide()}}),$(document).on("click",function(){$(".tooltip").tooltip("destroy"),$(".tooltip").hide()}),$("#apps-standalone").length>0&&(current_params=location.search.replace(/id=[0-9]+($|&)/,"").replace("?",""),window.history.pushState("object or string","Title","?id="+i.model.meta.true_id+"&"+current_params),$(document).on("change","#platform",function(){debug()("Platform change detected. Val ",$(this).val()),loadTutorial()}),i.selectPlatform(getURLParameter("platform")?getURLParameter("platform"):CURRENT_USER&&CURRENT_USER.platform?CURRENT_USER.platform:"html")),"free"==this.model.meta.premium||this.model.meta.active_trial||setTimeout(function(){adrollEvent("d4046d8c")},5e3),this.model.meta.last_viewed_at){var n=parseInt(new Date(this.model.meta.last_viewed_at).getTime()/1e3),a=parseInt((new Date).getTime()/1e3);86400>n-a&&(debug()("Adroll active"),setTimeout(function(){adrollEvent("69884c2f")},5e3))}if(CURRENT_USER&&CURRENT_USER.email){var r=["hotmail.com","yahoo.com","aol.com","gmail.com"],o=!0;for(var s in r)CURRENT_USER.email.search(s)>-1&&(o=!1);o&&setTimeout(function(){adrollEvent("16116cf5")},5e3)}},selectPlatform:function(e){"weebly-integrated"==e&&(e="weebly"),$(".platform-select-dropdown [data-platform='"+e+"']").click(),$("#platform").val(e).change(),$("#addToSite").css("opacity","1")},importApp:function(e,t){var i=this;i.model.setLocals({renderSettings:!0});var n=jQuery.extend(!0,{},IMPORT_CONTENT[e].content);for(var a in n)"undefined"!=typeof i.model.defaults()[a]&&(i.model.attributes[a]=n[a]);"popup"==i.model.meta.app_namespace&&i.setEditingStatus(),i.model.setLocals({isDirty:!1}),i.model.triggerChange(),"weebly"==HOST&&i.saveModel(),"undefined"!=typeof t&&t.success_el&&flashMessage(t.success_el,3e3)},loadTemplates:function(){var e=this;this.model.get("locals").templatesLoaded||(this.model.setLocals({templatesLoaded:!0}),ajaxController({url:"/apps/"+e.model.meta.app_type+"/templates.json",type:"GET"},function(t){if(t.success){var i="undefined"==typeof IMPORT_CONTENT?{}:IMPORT_CONTENT;$.extend(i,t.templates_data),IMPORT_CONTENT=i,e.model.attributes.chosen_template&&e.$el.find(".templateChoice:contains("+e.model.attributes.chosen_template+")")[0]&&e.$el.find(".templateChoice:contains("+e.model.attributes.chosen_template+")").addClass("selected"),Object.keys(t.templates_data).map(function(e){$(".choiceParent.importApp").each(function(){$(this).attr("value")!==e||$(this).attr("data-unique-label")||$(this).attr("data-unique-label",$(this).attr("value"))})})}else e.model.setLocals({templatesLoaded:!1})}))},loadImports:function(){debug()("Load imports called");var e=this,t=this.model.attributes.locals.importsLoaded;t||ajaxController({url:"/apps/"+this.model.meta.id+"/imports.json",data:{host:HOST},type:"GET"},function(t){if(t.success){e.model.setLocals({importsLoaded:!0}),$(".importExistingContainer").html(t.imports_html);var i="undefined"==typeof IMPORT_CONTENT?{}:IMPORT_CONTENT;$.extend(i,t.import_content),IMPORT_CONTENT=i,e.initializeSync()}else debug()("Setting imports loaded false"),e.model.setLocals({importsLoaded:!1})})},loadNodeImages:function(){loadNodeImages(this.$el)},validateInput:function(e){var t=new errorHandler(e.siblings(".validateErrors"));t.clearErrors();var i=e.val();if(0!=i.length){if(e.hasClass("validateInteger")&&(isNaN(i)||parseInt(Number(i))!=i||isNaN(parseInt(i,10)))&&t.addError("Please enter a valid number."),e.hasClass("validateFloat")&&0==$.isNumeric(i)&&t.addError("Please enter a valid number."),e.hasClass("validatePrice")){var n=e[0].selectionStart,a=e[0].selectionEnd,i=e.val();"."==i[0]&&(i="0"+i),i=(i.match(/[\d\,]+\.?[\d]*/g,"")||[])[0]||"",e.val(i),e[0].setSelectionRange(n,a)}if(e.hasClass("validatePriceWithSign")){var n=e[0].selectionStart,a=e[0].selectionEnd,i=e.val();"."==i[0]&&(i="0"+i),i=(i.match(/-?[\d\,]+\.?[\d]*/g,"")||[])[0]||"",e.val(i),e[0].setSelectionRange(n,a)}if(e.hasClass("validatePercent")&&0==$.isNumeric(i)&&0==$.isNumeric(replaceAll("%","",i))&&t.addError("Please enter a valid percent."),e.hasClass("validateMax")&&i>parseInt(e.data("validateMax"))&&t.addError("Please enter a number less than "+parseInt(e.data("validateMax")).toLocaleString()),e.hasClass("validateMin")&&i<parseFloat(e.data("validateMin"))&&e.val(parseFloat(e.data("validateMin"))),e.hasClass("validateLengthMax")){var r=parseInt(e.data("validateLengthMax"));i.length>r&&(t.addError("Please enter less than "+parseInt(e.data("validateLengthMax")).toLocaleString()+" characters."),e.val(i.substring(0,r)))}if(e.hasClass("validateRound")&&parseInt(Number(i))!=i){var o=Math.floor(i);e.val(parseFloat(o))}e.hasClass("validateUrl")&&(isValidUrl(i)||t.addError("Please enter a valid URL")),t.errors.length>0&&t.displayErrors()}},validateExternalFields:function(e){var t=this,i=function(e){var t=new RegExp(e.data("regex"),"").test(e.find(".actualInput").find("input").val());t?e.find(".exportFieldErrors").slideUp():e.find(".exportFieldErrors").slideDown()};return e?void e.each(function(){i($(this))}):void t.$el.find(".exportField").each(function(){$(this).data("export-listening")||($(this).on("keyup",function(){i($(this))}),$(this).data("export-listening",!0))})},makeSortable:function(e,t,i,n,a){var r=this,o={containment:"parent",appendTo:r.$el,handle:t||".sort",start:function(e,t){if(i){debug()("Sorted start, UI is",t);
var a=n||"50px",r=t.item.height(),o=$(this);t.item.height(r).css({overflow:"hidden"}).animate({height:a},"fast",function(){o.sortable("refreshPositions")}),t.item.siblings(".ui-sortable-placeholder").height(r).animate({height:a},"fast",function(){o.sortable("refreshPositions")})}},stop:function(e,t){if(i){debug()("Sorted start, UI is",t);var a=n||"50px",r=t.item.height("auto").innerHeight();parseInt(a)>r?(debug()("Animating from "+a+" to "+r),t.item.height(parseInt(a)).animate({height:r+"px"},"fast",function(){$(this).height("auto"),$(this).css({overflow:"visible"})})):t.item.css({height:"auto",overflow:"visible"})}},update:function(){r.afterSort(e),r.update(),r.initializeTextControls(!0)}};null==a||(o.axis=a||"y"),this.$el.find(e).sortable(o)},afterSort:function(){},handleEvents:function(){var e=this;this.$el.on("click",".openAnalyticsModal",function(){setTimeout(function(){loadAnalytics()},250)}),this.$el.on("click",".reloadAnalytics",function(){debug()("Reload analytics click detected"),loadAnalytics()}),this.$el.on("click",".accessHeader .powrbutton",function(){$(".accessHeader .powrbutton").toggleClass("secondary",!0),$(this).toggleClass("secondary",!1),$(this).hasClass("clickToEditTrigger")?(e.$el.find(".inviteToEdit").toggleClass("hid",!1),e.$el.find(".inviteToView").toggleClass("hid",!0)):(e.$el.find(".inviteToEdit").toggleClass("hid",!0),e.$el.find(".inviteToView").toggleClass("hid",!1))}),this.$el.on("click",".signIn",function(){$("#sign-in-modal").modal("show"),$("#user_external_query").val(document.location.search.replace("?","")+"&appType="+e.model.meta.app_type)}),this.$el.on("click",".saveButton",function(){debug()("Save button clicked"),"undefined"!=typeof UPDATE_TIMER&&clearTimeout(UPDATE_TIMER),null==CURRENT_USER?(SAVE_ON_SIGN_IN=!0,$("#sign-in-modal").modal("show"),$("#user_external_query").val(document.location.search.replace("?","")+"&appType="+e.model.meta.app_type),$(".signUpTab").addClass("active")):e.saveModel()}),this.$el.on("click",".socialLinks li",function(){var t=encodeURIComponent("https://www.powr.io?r="+CURRENT_USER.id+"&p=10free"),i=encodeURIComponent("https://www.powr.io/share?r="+CURRENT_USER.id+"&p=10free"),n="www.powr.io/plugins/"+e.model.meta.app_slug+"/view?id="+e.model.meta.id+"&mode=page";if($(this).hasClass("facebook"))var a="https://www.facebook.com/sharer/sharer.php?u="+i;if($(this).hasClass("twitter"))var r=encodeURIComponent(n+" I just built my own "+e.model.meta.app_common_name+" app @POWrPlugins. Try it and we both upgrade for free!"),a="https://twitter.com/home?status="+r+"%20"+t;if($(this).hasClass("linkedin"))var a=(encodeURIComponent("I just built a sweet "+e.model.meta.app_common_name+" Plugin with POWr.io"),encodeURIComponent("Try it out and we\u2019ll both upgrade for free!"),"https://www.linkedin.com/shareArticle?mini=true&url="+i+"&title=Free%20POWr%20Plugins!&summary=I%20just%20tried%20out%20POWr%20Plugins%20on%20my%20site!%20%20Free,%20fast,%20and%20fully-customizable%20website%20ingredients%20with%20zero%20code%20required!&source=www.powr.io");if($(this).hasClass("email"))var o=encodeURIComponent("This worked really well"),a=(encodeURIComponent("Hey,")+"%0D%0A%0D%0A"+encodeURIComponent("I just built a sweet "+e.model.meta.app_common_name+" plugin with POWr.io. And I didn\u2019t have to write any code! They\u2019ve got tons of free plugins for any website.")+"%0D%0A%0D%0A"+encodeURIComponent("Give it a try, and we\u2019ll both upgrade for free!")+"%0D%0A%0D%0A"+t+"%0D%0A%0D%0A"+encodeURIComponent("Cheers!"),"mailto:?subject="+o+"&body=I%20just%20built%20a%20sweet%20Comments%20app%20with%20%40POWrPlugins.%20Try%20it%20out%20and%20we%20will%20both%20upgrade%20for%20free%21%20"+i+"&source=www.powr.io");window.open(a)}),this.$el.on("click",".inviteToView li",function(){var t=encodeURIComponent("www.powr.io/plugins/"+e.model.meta.app_slug+"/view?id="+e.model.meta.id+"&mode=page");if($(this).hasClass("facebook"))var i="https://www.facebook.com/sharer/sharer.php?u="+t;if($(this).hasClass("twitter"))var n="Check this out -",i="https://twitter.com/home?status="+n+"%20"+t;if($(this).hasClass("linkedin"))var i="https://www.linkedin.com/shareArticle?mini=true&url="+t;if($(this).hasClass("google"))var i="https://plus.google.com/share?url="+t;if($(this).hasClass("email"))var a=encodeURIComponent("Check this out"),i="mailto:?subject="+a+"&body="+t;window.open(i)}),this.$el.on("submit",".feedbackForm",function(){var t=$(this),i={url:"/feedback.json",data:{feedback:{feedback_type:t.parents(".feedbackWrapper").find('[name="feedbackType"]').val(),feedback:t.find('[name="feedback"]').val(),email:t.find('[name="email"]').val(),app_type:e.model.meta.app_type,app_id:e.model.meta.id,platform:HOST,free_10:!0,src:"wouldnt_recommend"}},type:"POST",buttonElement:t.find(".feedbackSubmit"),successElement:t.find(".feedbackSuccess"),errorsElement:t.find(".feedbackErrors"),flashSuccess:!1};return ajaxController(i,function(e){e.success&&t.find('[name="feedback"]').val("")}),!1}),this.$el.on("click",".navContainer .nav-tabs a",function(){e.$el.scrollTop(0)}),this.$el.on("keyup",".validate",function(){var t=$(this),i=new errorHandler(t.siblings(".validateErrors"));i.clearErrors(),"undefined"!=typeof VALIDATION_TIMER&&clearTimeout(VALIDATION_TIMER),debug()("Validation called"),VALIDATION_TIMER=setTimeout(function(){e.validateInput(t)},500)}),this.$el.on("keyup",".standardSearch",function(){debug()("Keyup clicked");var e=$(this),t=$(this).parents(".standardSearchWrapper"),i=t.find(".standardSearchResults");return e.val().length<3?(i.html(""),!0):("undefined"!=typeof SEARCH_TIMER&&clearTimeout(SEARCH_TIMER),void(SEARCH_TIMER=setTimeout(function(){var t={url:"/standard-search.json",type:"get",data:{q:e.val(),display_style:"app",host:HOST}};ajaxController(t,function(e){debug()("Standard search response: ",e),i.html(e.html)})},500)))}),this.$el.on("blur change keyup","input:not(.preset, .ignore, .forceIgnore), select:not(.preset,.ignore, .forceIgnore), textarea:not(.ignore)",function(){if(e.model.get("locals").render_style_only!==!1&&$(this).data("render-style-only")){debug()("Setting render style only to true"),e.model.setLocals({render_style_only:!0});var t=0}else if(e.model.setLocals({render_style_only:!1}),$.inArray($(this).attr("type"),["text","textarea","email"])>-1)var t=1e3;else if("weebly"==HOST)var t=100;else var t=250;"undefined"!=typeof UPDATE_TIMER&&clearTimeout(UPDATE_TIMER),UPDATE_TIMER=setTimeout(function(){debug()("Change detected"),e.update()},t)}),this.$el.on("click",".add",function(){if("false"===$(this).attr("active"))return!1;if($(this).hasClass("premium")||$(this).hasClass("ignore"))return shakeButton($(".newUpgrade")),!1;if("document"===$(this).attr("data-type")){var t=$("#file-manager-template");"undefined"==typeof FILE_MANAGER&&initialize_manager("file",t,e.model.meta.id,!1),show_file_manager(!0,$(this)),e.update(),e.$el.find("#elementsModal").modal("hide")}else if("image"===$(this).attr("data-type")){var t=$("#file-manager-template");"undefined"==typeof IMAGE_MANAGER&&initialize_manager("image",t,e.model.meta.id,!1),show_image_manager(!0,$(this)),e.update(),e.$el.find("#elementsModal").modal("hide")}else if("choose_plugin"===$(this).attr("data-type"))$("#elementsModal .selectPlugin").removeClass("hid"),$("#elementsModal .goBackToElements").removeClass("hid"),$("#elementsModal .selectElement").addClass("hid"),$("#elementsModal .modal-title").html($("#elementsModal  .selectPlugin").data("title"));else if("radio_image_upload"===$(this).attr("data-type")){var i=$(this).attr("data-namespace"),t=$("#file-manager-template");"undefined"==typeof IMAGE_MANAGER&&initialize_manager("image",t,e.model.meta.id,!1),show_image_manager(!1,$(this),radio_image_upload=!0,i),e.update(),e.$el.find("#elementsModal").modal("hide")}else{var n=$(this);if(".modWrapper"===$(this).data("add-target"))var a=$($(this).data("wrapper"));else if(n.parents(".multiAdd").length>0){var a=n.parents(".multiAdd").prev(".prototype-wrapper");debug()("Multi Add detected. Prototype wrapper is",a)}else var a=n.prev(".prototype-wrapper");a.addPrototype(function(t){debug()("Prototype element added",t),t.find(".innerPanelToggle").click(),t.children(".mediaBar").find(".toggleSpace").click(),e.updatePremiumContent(),e.afterAdd(t,n),e.update(),e.$el.find("#elementsModal").modal("hide"),e.$el.find("#elementsModal .selectElement").removeClass("hid"),e.$el.find("#elementsModal .selectPlugin").addClass("hid"),e.$el.find("#elementsModal .goBackToElements").addClass("hid"),$("#elementsModal .modal-title").html($("#elementsModal  .selectElement").data("title"))})}}),this.deleteHandler(),this.$el.on("click",".duplicate",function(){var t=$(this).parents(".prototype-wrapper").first(),i=$(this).parents(".prototype-element").first(),n=t.siblings(".add");if("wix"==HOST)var a=$(this).parents(".wixSection").first();else var a=$(this).parents(".section").first();if(n.hasClass("premium"))return!1;i.find("input, select, textarea").each(function(){$(this).attr("value",$(this).val())}),t.append(i[0].outerHTML);var r=t.children(".prototype-element").last();r.find("input, select, textarea").each(function(){$(this).val($(this).attr("value"))});var o=t.outerHeight()-150;debug()("New El is ",r,"Scroll el is ",a,"position Top is : "+r.position().top+"; offset is: "+r.offset().top),a.animate({scrollTop:o+"px"}),e.update()}),this.$el.on("click",".panel-title",function(){var e=$(this).parents(".panel").first();e.find(".panel-collapse.collapse").length>0?e.find(".panel-title .fa-minus-square, .panel-title .fa-plus-square").toggleClass("fa-minus-square",!0).toggleClass("fa-plus-square",!1):e.find(".panel-title .fa-minus-square, .panel-title .fa-plus-square").toggleClass("fa-plus-square",!0).toggleClass("fa-minus-square",!1)}),this.$el.on("click",".innerPanelToggle",function(){var e=$(this),t=e.parents(".innerPanel").first(),i=t.find(".innerPanelContent").first(),n=e.find(".fa"),a=e.find(".closeText"),r=e.find(".openText");i.slideToggle(),"open"===e.attr("data-is-open")?(n.toggleClass("fa-minus-square",!0).toggleClass("fa-plus-square",!1),e.attr("data-is-open","closed"),a.hide(),r.show()):(n.toggleClass("fa-plus-square",!0).toggleClass("fa-minus-square",!1),e.attr("data-is-open","open"),a.show(),r.hide())}),0==$("#apps-standalone").length,$(document).on("click",".triggerPremium",function(){if($(".modalPanel:not(.right)").removeClass("show"),$(".upgradePanel").addClass("show"),shopifyAutoSave(APP_MODEL.meta.app_common_name),"wix"==HOST)Wix.Settings.openBillingPage();else{if(window.POWR_PAY_LOADED)return!1;$(".upgradePanel > .modal-panel-body > .loader").show(),triggerPremium()}return!1}),this.$el.on("click",".makeNoticeable",function(){$(this).removeClass("makeNoticeable")}),this.$el.on("click",".colorSelectionContainer .gradientToggle",function(){var e=$(this).parents(".colorSelectionContainer");0==e.find(".gradientToggle input:checked").length?(e.find(".gradientColor").hide(),e.find(".solidColor").show()):(e.find(".gradientColor").show(),e.find(".solidColor").hide())}),this.$el.on("click",".colorSelectionContainer .transparentToggle",function(){var e=$(this).parents(".colorSelectionContainer");e.find(".colorSelector").each(0==e.find(".transparentToggle input:checked").length?function(){var e=$(this).val(),t=tinycolor(e).setAlpha(1).toRgbString();$(this).spectrum("set",t),$(this).val(t)}:function(){var e=$(this).val(),t=tinycolor(e).setAlpha(0).toRgbString();$(this).spectrum("set",t),$(this).val(t)})}),this.$el.on("click",".ratePowr .choice",function(){e.$el.find(".laterBox").hide(),$(this).addClass("picked").siblings(".choice").addClass("notPicked"),e.$el.find(".feedbackSection").fadeIn()}),this.$el.on("click",".resetRatePowr",function(){e.$el.find(".laterBox").show(),e.$el.find(".ratePowr .choice").removeClass("picked").removeClass("notPicked"),e.$el.find(".feedbackSection").fadeOut()}),this.$el.on("click",".multiSelectContainer",function(e){if(!$(this).hasClass("premium")&&e.target.className.match("hide")){$(this).toggleClass("selectedCheckbox");var t=$(this).parents(".multipleSelect").first(),i=t.find(".multiSelectContainer input"),n=i.map(function(){return $(this).prop("checked")?$(this).val():void 0}).toArray().join(",");t.find(".realValue").val(n).change()}}),$(document).on("click",function(t){var i=$(t.target);i.hasClass("mCSB_dragger_bar")||i.hasClass("mCSB_draggerRail")||(i.hasClass("powrSelected")||i.parents(".powrSelected").length>0?(i.parents(".powrSelected").length>0&&(i=i.parents(".powrSelected")),debug()("Has powr selected class"),i.next(".powrDropdown").hasClass("hid")?(e.$el.find(".powrDropdown").toggleClass("hid",!0),i.next(".powrDropdown").toggleClass("hid",!1)):e.$el.find(".powrDropdown").addClass("hid",!1)):e.$el.find(".powrDropdown").addClass("hid",!1))}),this.$el.on("click","#tutorialWidget .app",function(){var t=$(this).find("input").val(),i=$(this).find("input").data("app-slug"),n="<i class='powrIcon icon-"+t+"' data-app-slug='"+i+"'></i>";$(this).parents(".powrOptions").find(".text").html(n),e.$el.find(".powrDropdown").toggleClass("hid",!0)}),this.$el.on("click","#tutorialWidget .platform",function(){var t=$(this).find("input").val(),i="<img src='//s3-us-west-1.amazonaws.com/powr/platforms/"+t+"/logo_70x70.jpg' data-platform='"+t+"'>";$(this).parents(".powrOptions").find(".text").html(i),e.$el.find(".powrDropdown").toggleClass("hid",!0)}),"wix"==HOST?this.$el.on("click",".visitTutorial",function(){var t=e.$el.find("#tutorial_app_type").val(),i=baseUri()+"/tutorials/how-to-add-"+t+"-plugin-to-your-wix-site",n=Math.round(screen.width/3),a=screen.height;window.open(i,"","width="+n+",height="+a+",scrollbars=1")}):this.$el.on("click",".visitTutorial",function(){var t=e.$el.find("#tutorialWidget .powrSelected i").data("app-slug"),i=e.$el.find("#tutorialWidget .powrSelected img").data("platform");if(void 0!=t&&void 0!=i){var n=baseUri()+"/tutorials/how-to-add-"+t+"-plugin-to-your-"+i+"-site",a=Math.round(screen.width/2),r=screen.height;window.open(n,"","width="+a+",height="+r+",scrollbars=1")}}),"wix"==HOST&&$("body").on("click",".x-close-popup",function(){debug()("close wix popup clicked"),$(".popup-modal, .uilib-popup").remove()}),this.$el.on("click",".applyPreset",function(){if(debug()("Design preset change"),0==e.model.get("isPreset"))if("wix"==HOST){var t=Wix.UI.create({ctrl:"Popup",options:{modal:!0,buttonSet:"okCancel",title:"Confirm",content:"This will overwrite your current content. Continue?",fixed:!0,onclose:function(){e.setDesignPresets(),$(".popup-modal, .uilib-popup").remove()}}});$(".uilib-popup .uilib-btn").addClass("ignore"),t.getCtrl().open()}else confirmModal=$("#confirmModal"),confirmModal.find(".modal-body").html("This will overwrite your current content. Continue?"),confirmModal.modal("show"),confirmModal.find("#okBtn").click(function(){e.setDesignPresets()});else e.setDesignPresets()}),this.$el.on("click",".embed",function(){select_all($(this))}),this.$el.on("click",".shareThisTrigger",function(){null==CURRENT_USER?($("#sign-in-modal").modal("show"),$("#user_external_query").val(document.location.search.replace("?","")+"&appType="+META.app_type)):$("#shareThis").modal("show")}),this.$el.on("click",".reviewThisTrigger",function(){e.showReviewModal()}),this.$el.on("click",".reviewLater",function(){e.$el.find("#pleaseReview").modal("hide")}),this.$el.on("click",".reviewNo",function(){e.model.set({reviewStatus:"done"}),setCookie("reviewStatus","done",15),e.update(),e.$el.find("#pleaseReview").modal("hide")}),setTimeout(function(){if(debug()("Entering modal logic"),$("#userNotification").length>0)return debug()("User notification present, showing notification"),void $("#userNotification").modal("show");if(e.model.meta.demo_mode)return void debug()("Demo mode, not showing modal");var t=e.model.get("reviewStatus"),i=e.model.get("reviewPopupTime"),n=!1,a=parseInt(new Date(e.model.meta.created_at).getTime()/1e3),r=parseInt((new Date).getTime()/1e3);if("undefined"!=typeof POPUP_REVIEW_TIME)var o=parseInt(POPUP_REVIEW_TIME);else var o=240;if("done"==getCookie("reviewStatus")||"later"==getCookie("reviewStatus")?(debug()("Review status cookie set, not showing review modal"),n=!1):void 0==t?(debug()("Review status not defined, showing review modal"),n=!0):"later"==t&&void 0!=i&&parseInt(i)<r-432e3&&(debug()("Time to show review popup again, showing modal"),n=!0),debug()("Show modal is "+n),n)if(debug()("Showing modal"),a>r-o){var s=o-(r-a);s=1e3*s,s=Math.max(s,9e4),debug()("App was recently created, showing modal in "+s),setTimeout(function(){e.showReviewModal()},s)}else setTimeout(function(){e.showReviewModal()},9e4)},1e4),this.$el.on("change",'[name="pluginRating"]',function(){debug()("Plugin change detected");var t=parseInt($(this).val());e.updateFeedbackType(1==t?"terrible":3==t?"praise":""),e.model.set("pluginRating",t),sign_in_update()}),"wix"==HOST&&(this.$el.on("click",".premiumButton",function(){Wix.Settings.openBillingPage()}),this.$el.on("click",".uilib-checkbox",function(){if($(this).parents(".wixCheckbox").hasClass("premium")&&"free"==e.model.meta.premium_status);else{$(this).toggleClass("checked");var t=$(this).parents(".wixSetting").find(".checkboxValue");t.prop("checked",$(this).hasClass("checked")),t.trigger("change")}})),"wix"==HOST&&this.$el.on("click",".wixLink",function(){var e=$(this).attr("href");if(void 0==$(this).data("width"))var t=Math.round(screen.width/3);else var t=Math.round(screen.width*parseInt($(this).data("width"))/100);var i=screen.height;return window.open(e,"","width="+t+",height="+i+",scrollbars=1,resizable=1"),!1}),this.$el.on("keyup paste",".parsedVideoWrapper .videoUrl",function(){var t=$(this).parents(".parsedVideoWrapper"),i=$(this).val(),n=parseVideo(i),a="";debug()("Video change detected. Video data is",n),n.valid?(t.find(".videoError").hide(),t.find(".videoId").val(n.id),t.find(".videoProvider").val(n.type),t.find(".videoValid").val(!0),"youtube"==n.type?(a="//img.youtube.com/vi/"+n.id+"/hqdefault.jpg",t.find(".previewUrl").val(a),t.find(".previewImage").attr("src",a),e.update()):"vimeo"==n.type&&$.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+n.id+".json",jsonp:"callback",timeout:1e4,dataType:"jsonp",success:function(e){debug()("Vimeo response:",e),a=e[0].thumbnail_large},error:function(){debug()("Vimeo fail response:"),a="//img.youtube.com/vi/0/0.jpg"},complete:function(){t.find(".previewUrl").val(a),t.find(".previewImage").attr("src",a),e.update()}})):(t.find(".videoError").html("<i class='fa fa-warning'></i> Invalid video url").fadeIn(),t.find(".videoValid").val(!1),t.find(".videoId").val(""),t.find(".videoProvider").val(""),t.find(".previewUrl").val(""),t.find(".previewImage").val(""),e.update())}),this.$el.on("keyup",".urlValidationWrapper",function(){var e=$(this);validateUrl(e)}),this.$el.on("click","#adminTab",function(){e.$el.find(".fitText").removeAttr("style"),setTimeout(function(){e.fitText()},200)}),$(document).on("click",".openAccessModal",function(){if(debug()("Open access modal clicked"),$("#accessModal").modal("show"),null==CURRENT_USER)return void $("#sign-in-modal").modal("show");if(e.$el.find("#accessModal .fa-refresh").length>0){var t={url:"/app_access.json",data:{id:e.model.meta.true_id},type:"GET"};ajaxController(t,function(t){t.success&&(e.$el.find("#accessModal .modal-body").html(t.access_content),e.updateEmbedCode())})}}),this.$el.on("click",".grantAccess",function(){var t={url:"/app_access.json",data:{powr_token:e.model.meta.powr_token,email:e.$el.find(".clientInviteEmail").val(),url:e.$el.find(".clientInviteUrl").val(),note:e.$el.find(".clientInviteNote").val(),id:e.model.meta.true_id},type:"POST",buttonElement:$(this),errorsElement:e.$el.find(".grantAccessErrors"),successElement:e.$el.find(".grantAccessSuccess")};ajaxController(t,function(t){t.success&&(e.$el.find("#accessModal .modal-body").html(t.access_content),e.$el.find(".clickToEditTrigger").click(),e.updateEmbedCode(),setTimeout(function(){e.$el.find(".notification").fadeOut("slow")},3e3))})}),this.$el.on("click",".deleteAccess",function(){var t=confirm("Are you sure you want to revoke this member's access?");if(0==t)return!1;var i={url:"/app_access.json",data:{id:e.model.meta.true_id,user_id:$(this).data("user_id")},type:"DELETE",buttonElement:$(this)};ajaxController(i,function(t){t.success&&(e.$el.find("#accessModal .modal-body").html(t.access_content),e.$el.find(".clickToEditTrigger").click(),e.updateEmbedCode(),setTimeout(function(){e.$el.find(".notification").fadeOut("slow")},3e3))})}),this.$el.on("click",".templateCarousel .item img",function(){e.$el.find(".applyPreset").click()}),this.$el.on("keyup",'input[type="email"]',function(){var t=$(this);"undefined"!=typeof EMAIL_VERIFY_TIMER&&clearTimeout(EMAIL_VERIFY_TIMER),EMAIL_VERIFY_TIMER=setTimeout(function(){e.verifyEmailField(t)},2e3)}),this.$el.on("click",".sendVerificationEmail",function(){$(this).prop("disabled",!0);var e=$(this).closest(".form-element"),t=e.find('input[type="email"]').val();ajaxController({url:"/emails/send_verification.json",data:{email:t},type:"POST"},function(t){t.success&&(e.find(".notVerified").hide(),e.find(".verificationSent").slideDown())})})},verifyEmails:function(e,t){debug()("Verifying emails: ",e),deliverHash(e[0]),ajaxController({url:"/emails/is_verified.json",data:{emails:e},type:"GET"},function(e){e.success&&t(e)})},verifyAllEmailFields:function(){var e=this,t=[];e.$el.find(".emailVerification").children().hide(),e.$el.find(".emailVerification").each(function(){if(!$(this).closest(".prototype-element").hasClass("prototype")){var i=$(this).siblings('input[type="email"]');if(!e.emailFieldIsValid(i)&&i.val().length>0)return void $(this).find(".emailInvalid").fadeIn();var n=i.val();n.length>0&&t.push(n.toLowerCase())}}),0!=t.length&&e.verifyEmails(t,function(t){debug()("Verify emails success:",t),e.$el.find(".emailVerification").each(function(){if(!$(this).closest(".prototype-element").hasClass("prototype")){var e=$(this).siblings('input[type="email"]').val();e&&(e=e.toLowerCase()),t.emails[e]&&t.emails[e].verified?(debug()("Email verified: ",t.emails[e]),$(this).find(".verified").fadeIn()):(debug()("Email not verified: ",t.emails[e]),$(this).find(".notVerified").fadeIn())}})})},emailFieldIsValid:function(e){var t=$.trim(e.val());e.val(t);var i=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return 1==i.test(t)},verifyEmailField:function(e){var t=this,i=e.siblings(".emailVerification");i.children().hide();var n=e.val();if(n){if(!t.emailFieldIsValid(e))return void i.find(".emailInvalid").fadeIn();n=n.toLowerCase(),t.verifyEmails([n],function(e){debug()("Verify emails success:",e),e.emails[n]&&e.emails[n].verified?(debug()("Email verified: ",e.emails[n]),i.find(".verified").fadeIn()):(debug()("Email not verified: ",e.emails[n]),i.find(".notVerified").fadeIn())})}},initializeFlashSales:function(){$(".flashSaleCountdown").each(function(e){function t(e,n,a){if(0!=e.width()&&0!=e.find(".currentNumber .value").filter(function(){return 0!=$(this).html()}).length){var r=$(i.find(".counterElement")[n]),o=r.find(".currentNumberWrapper"),s=r.find(".nextNumberWrapper"),l="swing",d=parseInt(o.find(".value").html()),u=r.closest(".counterParent").data("max");if(!(0==n&&0>d-1)){if(0>d-1){var f=u;t(e,n-1,a)}else var f=d-1;"slideDown"==a?(s.find(".value").html(f),o.animate({top:"-100%"},c,l),s.animate({top:"-100%"},c,l,function(){o.find(".value").html(f),r.find(".currentNumberWrapper, .nextNumberWrapper").css({top:0})})):"countDown"==a&&(o.animate({opacity:.5},c),setTimeout(function(){o.find(".value").html(f),o.animate({opacity:1},c)},c))}}}for(var i=$(this),n=1e3,a=Math.round(parseFloat(i.data("end-time"))-(new Date).valueOf()/1e3),r=function(e){var t=convertSecondsToComponents(e),i=2-t.hours.toString().length,n=Array(i+1).join("0")+t.hours,a=2-t.minutes.toString().length,r=Array(a+1).join("0")+t.minutes,o=2-t.seconds.toString().length,s=Array(o+1).join("0")+t.seconds;return n+r+s}(a),o=r.split(""),s=0;s<o.length;s++){var l=$(i.find(".counterElement")[s]);l.find(".currentNumber .value").html(o[s])}var c=100;"undefined"!=typeof window["FLASH_SALE_INTERVAL"+e]&&clearInterval(window["FLASH_SALE_INTERVAL"+e]),window["FLASH_SALE_INTERVAL"+e]=setInterval(function(){t(i,o.length-1,"countDown")},n)})},initializePasswordProtection:function(){var e=this,t=e.$el.find('input[name="passwordProtectOn"]'),i=e.$el.find(".previewPassword");e.model.get("passwordProtectOn")?t.parents(".password-protection").find(".password-list").show():t.parents(".password-protection").find(".password-list").hide();var n=function(){var i=t.prop("checked");e.model.get("passwordProtectOn")!=i&&e.model.set("passwordProtectOn",i),i?e.$el.find(".password-list").slideDown():e.$el.find(".password-list").slideUp()},a=function(t){var n="none"==i.find(".showPasswordPreview").css("display"),a=!0;a="boolean"==typeof t?t:!n,a?(i.find(".showPasswordPreview").hide(),i.find(".hidePasswordPreview").show()):(i.find(".showPasswordPreview").show(),i.find(".hidePasswordPreview").hide()),e.model.setLocals({skipPassword:!a,passwordProtectSuccess:!1}),e.model.triggerChange()};e.initializePasswordProtection.afterChange=n,e.initializePasswordProtection.previewChange=a,t.on("change",function(){n()}),i.on("change",a),n(),e.model.get("locals").skipPassword?(i.find(".showPasswordPreview").show(),i.find(".hidePasswordPreview").hide()):(i.find(".showPasswordPreview").hide(),i.find(".hidePasswordPreview").show()),i.on("click",function(){a()});for(var r in this.model.get("passwords"))if(this.model.get("passwords").hasOwnProperty(r)){var o=this.$el.find(".passwordsWrapper").addPrototype(null,{speed:"instant"}),s=this.model.get("passwords")[r];o.objectToForm(s)}},showReviewModal:function(){if("block"==$(".powrWalkthrough").css("display"))return void debug()("Walkthrough visible, not showing review modal");debug()("Showing review modal");var e=this,t=parseInt((new Date).getTime()/1e3);e.$el.find("#pleaseReview").modal("show"),e.$el.on("change","[name=pluginRating]",function(){e.model.set({reviewStatus:"done",reviewPopupTime:t}),setCookie("reviewStatus","done",15),e.update(),e.saveModel()}),e.$el.find("#pleaseReview").on("hide.bs.modal",function(){debug()("Close review modal detected"),"done"!=e.model.get("reviewStatus")&&(e.model.set({reviewStatus:"later",reviewPopupTime:t}),setCookie("reviewStatus","later",5),e.update())})},savePasswordData:function(){var e=[];this.$el.find(".passwords:not(.prototype)").each(function(){var t=$(this).formToObject();e.push(t)}),this.model.attributes.passwords=e},deleteHandler:function(){var e=this;this.$el.on("click",".delete",function(){if($(this).closest(".prototype-element").hasClass("slim"))var t=$(this).parents(".prototype-element.slim");else var t=$(this).parents();t.deleteAnimate(function(){e.update(),e.updatePremiumContent()})})},initializePaypalSettings:function(e){var t=function(t){var i=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},n=function(e){return e.charAt(0).toLowerCase()+e.slice(1)};return""==e?n(t):e+i(t)},i=".innerPanel, .panel, .acc-pane, .slim.prototype-element",n='[name="'+t("TrialOn")+'"]',a='[name="'+t("PurchaseType")+'"]',r='[name="'+t("SubscriptionDuration")+'"]',o='[name="'+t("TrialDuration")+'"]',s='[name="'+t("SubscriptionDurationUnits")+'"]',l='[name="'+t("TrialDurationUnits")+'"]',c=function(e){var t=e.parents(i).find(".trialOn");e.prop("checked")?t.slideDown():t.slideUp();var n,a=e.parents(i).find(l).val();switch(a){case"D":n=90;break;case"W":n=52;break;case"M":n=24;break;case"Y":n=5}e.parents(i).find(o).toggleClass("validate validateMax",!0).data("validate-max",n)},d=function(e){var t,n=e.parents(i).find(l).val();switch(n){case"D":t=90;break;case"W":t=52;break;case"M":t=24;break;case"Y":t=5}e.parents(i).find(o).toggleClass("validate validateMax",!0).data("validate-max",t)};window.global_paypal_listeners||(window.global_paypal_listeners=!0,this.$el.on("change",n,function(){c($(this))}),this.$el.on("change",l,function(){d($(this))}),this.$el.on("change",a,function(){u($(this))}),this.$el.on("change",s,function(){f($(this))})),this.$el.find(n).each(function(){c($(this))}),this.$el.find(l).each(function(){d($(this))});var u=function(e){var t=e.val();"Recurring"==t?(e.closest(i).find(".recurringOn").slideDown(),e.closest(i).find(".recurringOff").hide()):(e.closest(i).find(".recurringOn").hide(),e.closest(i).find(".recurringOff").slideDown())},f=function(e){var t,n=e.parents(i).find(s).val();switch(n){case"D":t=90;break;case"W":t=52;break;case"M":t=24;break;case"Y":t=5}e.parents(i).find(r).toggleClass("validate validateMax",!0).data("validate-max",t)};this.$el.find(a).each(function(){u($(this))}),this.$el.find(s).each(function(){f($(this))})},afterAdd:function(){},createConfirmModal:function(e,t){if("wix"==HOST){var i=Wix.UI.create({ctrl:"Popup",options:{modal:!0,buttonSet:"okCancel",title:"Confirm",content:e,fixed:!0,onclose:function(){t(),$(".popup-modal, .uilib-popup").remove()}}});$(".uilib-popup .uilib-btn").addClass("ignore"),i.getCtrl().open()}else{var n=$("#confirmModal");n.find(".modal-body").html(e),n.modal("show"),n.find("#okBtn").click(function(){t()})}},updateFeedbackType:function(e){var t=this,i=$("#feedbackTemplate").html(),n=_.template(i,{feedback_type:e});this.$el.find(".feedbackDetails").html(n).hide().fadeIn("fast",function(){t.updateInputFields()})},alreadyVisitedThings:[],updatePremiumContent:function(){function e(e){var t;if(e.data("upgrade-text")&&window.POPOVER&&"new"==window.POPOVER){t="<div class='quote'>"+e.data("upgrade-text")+"</div>",e.data("upgrade-author")&&(t=t+"<div class='author'>"+e.data("upgrade-author")+"</div>");try{var i=e.data("premium-status");i="enterprise"==i?"Business":capitalizeFirstLetter(i)}catch(n){var i=""}var a="Upgrade to unlock this <b>"+i+"</b> Feature!"}else{t=o[Math.floor(Math.random()*o.length)];var l=e.data();if(l.premiumStatus&&e.hasClass("upgradeMsg")===!1)switch(l.premiumStatus){case"premium":t=o[0];break;case"pro":t=o[1];break;case"enterprise":t=o[2]}else if(l.premiumLimit||e.hasClass("upgradeMsg")===!0)switch(s){case"free":t=o[0];break;case"premium":t=o[1];break;case"pro":t=o[2]}var a=POWr.simpleCopies("upgrade_required")}"wix"===HOST&&-1!=_.indexOf(["premium","pro","enterprise"],s)&&-1!=_.indexOf(["poll","mailingList","contactForm"],r.model.meta.app_type)?(t=o[Math.floor(Math.random()*o.length)],t=t+'<div class="powrbutton success triggerFormBuilderPlus">'+POWr.simpleCopies("get_form_builder_plus")+'<i class="fa fa-arrow-circle-right"></i></div>',a=POWr.simpleCopies("feature_not_available")):t+='<div class="powrbutton upgrade triggerPremium">Upgrade Now <i class="fa fa-arrow-circle-right"></i></div>',e.attr("title",$("<i>"+a+"</i>").text()),e.popover({content:t,title:a,html:!0,placement:function(e,t){return"wix"==HOST?$(t).hasClass("add")?"right":"top":$(t).offset().top<300?"bottom":"top"}})}function t(t){if(t.addClass("premium"),t.find(".premiumImg").show(),t.find("input, textarea, select").toggleClass("ignore",!0),t.is("option")&&t.prop("disabled",!0),t.find('select option, input[type="text"], textarea, input[type="checkbox"], input[type="radio"]').prop("disabled","disabled"),t.data("upgrade-text")&&t.attr("title",t.data("upgrade-text")),".modWrapper"===t.data("add-target")?n(t):e(t),t.hasClass("sliderWrapper"))try{t.find(".slider").slider("disable")}catch(i){}}function i(e){if(e.removeClass("premium"),e.find(".premiumImg").hide(),e.find("input, textarea, select").toggleClass("ignore",!1),e.is("option")&&e.prop("disabled",!1),e.find('select option, input[type="text"], textarea, input[type="checkbox"], input[type="radio"], textarea').prop("disabled",!1),e.tooltip("destroy"),e.popover("destroy"),e.attr("title",e.data("help-text")),".modWrapper"===e.data("add-target")&&a(e),e.hasClass("sliderWrapper"))try{e.find(".slider").slider("enable")}catch(t){}}function n(e){var t=e.closest(".multiAdd").data(s+"-limit");$("#myModalLabel .modal-title").addClass("hid"),$("#myModalLabel .planLimit").html(t),$("#myModalLabel .modal-upgrade").removeClass("hid"),$("#myModalLabel").closest(".modal-header").addClass("scheme-1")}function a(){$("#myModalLabel .modal-title").removeClass("hid"),$("#myModalLabel .modal-upgrade").addClass("hid"),$("#myModalLabel").closest(".modal-header").removeClass("scheme-1")}var r=this,o=[],s=r.model.meta.premium_status,l=["free","premium","pro","enterprise"];o="wix"===HOST&&-1!=_.indexOf(["premium","pro","enterprise"],s)&&-1!=_.indexOf(["poll","mailingList","contactForm"],r.model.meta.app_type)?[POWr.simpleCopies("try_form_builder_plus")]:"wix"===HOST?[POWr.simpleCopies("wix_premium_text_1"),POWr.simpleCopies("premium_text_2"),POWr.simpleCopies("premium_text_3")]:[POWr.simpleCopies("premium_text_1"),POWr.simpleCopies("premium_text_2"),POWr.simpleCopies("premium_text_3")],r.$el.find("[data-premium-status]").each(function(){var e=$(this).data("premium-status");
l.indexOf(e)>l.indexOf(s)?t($(this)):i($(this))}),r.$el.find("[data-free-limit],[data-premium-limit],[data-pro-limit],[data-enterprise-limit]").each(function(){var e=$(this).data(s+"-limit");if(void 0!==e){if(".modWrapper"===$(this).data("add-target"))var n=$(".prototype-wrapper").children(".prototype-element:not(.prototype)").length;else var n=$(this).siblings(".prototype-wrapper").children(".prototype-element:not(.prototype)").length;n>=e?$(this).hasClass("multiAdd")?$(this).find(".add").each(function(){t($(this)),shakeButton($(".newUpgrade"))}):t($(this)):$(this).hasClass("multiAdd")?$(this).find(".add").each(function(){i($(this))}):i($(this))}}),r.initializePopovers(),"free"==s?(r.$el.find(".premiumContent").hide(),r.$el.find(".nonpremiumContent").show(),r.$el.find(".trialAndNonpremiumContent").show(),r.$el.find(".trialContent").hide()):(r.$el.find(".premiumContent").show(),r.$el.find(".nonpremiumContent").hide(),r.model.meta.active_trial?(r.$el.find(".trialContent").show(),r.$el.find(".premiumOnlyContent").hide(),r.$el.find(".trialAndNonpremiumContent").show()):(r.$el.find(".trialContent").hide(),r.$el.find(".premiumOnlyContent").show(),r.$el.find(".trialAndNonpremiumContent").hide()))},checkAddAllowed:function(){},cycleThroughNotifications:function(){var e=this.$el.find(".notificationItem");e.hide();var t=0;!function i(){var n=e.eq(t);n.closest(".notificationItemParent").fadeIn(200).delay(5e3).fadeOut(200),n.fadeIn(200).delay(5e3).fadeOut(200,i),t=++t%e.length}(),navigator.cookieEnabled||this.$el.find(".cookiesDisabled").show()},initializeGradientSettings:function(){this.$el.find(".colorSelectionContainer").each(function(){0==$(this).find(".gradientToggle input:checked").length?($(this).find(".gradientColor").hide(),$(this).find(".solidColor").show()):($(this).find(".gradientColor").show(),$(this).find(".solidColor").hide())})},saveModel:function(){this.model.doSave({settings:this})},animateSaveButton:function(){{var e=this,t=e.$el.find(".saveButton");e.$el.find(".saveSuccess"),e.$el.find(".saveError"),e.$el.find(".saving")}t.removeClass("unsaved"),t.addClass("saving"),t.animate({},1e3,function(){t.removeClass("saving")})},updateEmbedCode:function(){var e=this;if(this.model.meta.saved?(debug()("Model is saved"),e.$el.find(".appUnsaved").fadeOut("fast",function(){e.$el.find(".appSaved").fadeIn("fast")})):(debug()("Model is not saved"),e.$el.find(".appSaved").fadeOut("fast",function(){e.$el.find(".appUnsaved").fadeIn("fast")})),"wix"!=HOST){var t=this.model.meta.id,i=this.model.meta.app_slug,n=this.model.meta.powr_token,a=this.model.meta.unique_label||uniqueLabel(),r="<script src='"+baseUri()+"/powr.js' powr-token='"+n+"'></script>",o='<div class="powr-'+i+'" id='+a+"></div>",s=baseUri()+"/plugins/"+i+"/view/"+t,l=baseUri()+"/plugins/"+i+"/view/"+t,c=l+"?mode=scroll",d=l+"?mode=page";if("undefined"!=typeof APP_VIEW){var u=APP_VIEW.$el.height()+"px",f='<iframe src="'+s+'" style="width:100%;" height="'+u+'" frameborder="0"></iframe>';$(".embedIframe").val(f)}$(".embedScript").val(r),$(".embedDiv").val(o),$(".embedUrl").val(l),$(".embedUrlScroll").val(c),$(".pageEmbedUrl").val(d)}},initializeColorPickers:function(e){var t=this;if("undefined"==typeof e)var e={};var i=setDefault(e.liveUpdate,!0);this.$el.find(".colorSelector").each(function(){var e=$(this);e.spectrum({appendTo:"parent",showAlpha:e.data("alpha"),showInitial:!0,showPalette:!0,showInput:!0,preferredFormat:"hex",clickoutFiresChange:!0,beforeShow:function(e){return debug()("Before show. E and this are",e,this),$(this).parent().hasClass("premium")?($(this).parents(".form-element").popover("show"),!1):void 0},move:function(t){i&&(e.val(t.toRgbString()),e.trigger("change"))},change:function(t){debug()("Change detected in spectrum!"),e.val(t.toRgbString()),e.trigger("change")},hide:function(t){e.val(t.toRgbString()),e.hasClass("solidColorSelector")&&e.data("alpha")&&(0==t.getAlpha()?e.parents(".colorSelectionContainer").find(".transparentToggle input").prop("checked",!0):e.parents(".colorSelectionContainer").find(".transparentToggle input").prop("checked",!1)),e.trigger("change")}}),e.hasClass("solidColorSelector")&&e.data("alpha")&&(0==tinycolor(e.val()).getAlpha()?e.parents(".colorSelectionContainer").find(".transparentToggle input").prop("checked",!0):e.parents(".colorSelectionContainer").find(".transparentToggle input").prop("checked",!1))}),"wix"==HOST&&t.$el.find(".wixColorSelectorWrapper").each(function(){var e=$(this),i=$(this).find(".colorSelectorValue"),n=$(this).find(".colorSelectorValueWix");if(!($(this).find(".uilib-color-box").length>0)){var a=i.attr("name"),r=a;if(t.$el.find("[name='"+a+"']").each(function(e){return $(this)[0]==i[0]?(r=a+"_"+e,!1):void 0}),1==i.data("alpha"))var o=!0,s="ColorPickerWithOpacity";else var o=!1,s="ColorPickerWithOpacity";Wix.UI.create({id:r,ctrl:s,param:!1,model:r,html:"",appendTo:e,options:{startWithColor:i.val()}}),o?e.find(".color-box").after("<span class='opacityLabel'>Opacity</span>"):e.find(".uilib-slider").hide(),Wix.UI.onChange(r,function(e){if(debug()("Wix color picker change detected: ",e),e.color===!1?n.val(""):e.color&&e.color.reference&&n.val(e.color.reference),e.cssColor){var t=tinycolor(e.cssColor).toRgbString();i.val(t),debug()("Css color:",t)}else if(e.rgba){debug()("rgba color:",e.rgba);var t=tinycolor(e.rgba).toRgb();void 0!=e.opacity&&(t.a=e.opacity),t=tinycolor(t).toRgbString(),i.val(t),debug()("computed rgba color:",t)}i.change()})}})},initializeFontPickers:function(){var e=this,t="https://s3-us-west-1.amazonaws.com/powr/images/blank.png",i=[{value:"Basic",x:0,y:-53},{value:"Caudex",x:0,y:-80},{value:"Chelsea Market",x:0,y:-105},{value:"Corben",x:0,y:-128},{value:"Courier New",x:0,y:-157},{value:"EB Garamond",x:0,y:-183},{value:"Enriqueta",x:0,y:-211},{value:"Forum",x:0,y:-239},{value:"Fredericka the Great",x:0,y:-268},{value:"Georgia",x:0,y:-294},{value:"Impact",x:0,y:-320},{value:"Jockey One",x:0,y:-345},{value:"Josefin Slab",x:0,y:-370},{value:"Jura",x:0,y:-394},{value:"Kelly Slab",x:0,y:-420},{value:"Lobster",x:0,y:-444},{value:"Lucida Console",x:0,y:-467},{value:"Lucida Sans Unicode",x:0,y:-493},{value:"Marck Script",x:0,y:-513},{value:"Mr De Haviland",x:0,y:-538},{value:"Niconne",x:0,y:-558},{value:"Noticia Text",x:0,y:-583},{value:"Open Sans",x:0,y:-604},{value:"Overlock",x:0,y:-628},{value:"Palatino Linotype",x:0,y:-648},{value:"Patrick Hand",x:0,y:-668},{value:"Play",x:0,y:-696},{value:"Sarina",x:0,y:-716},{value:"Signika",x:0,y:-742},{value:"Spinnaker",x:0,y:-766},{value:"Times New Roman",x:0,y:-786},{value:"Verdana",x:0,y:-808}];this.$el.find(".fontSelector").each(function(){$(this).autocomplete({appendTo:e.$el,source:i,minLength:0,select:function(e,t){debug()("Font select"),$(e.target).val(t.item.value),$(e.target).blur()},open:function(){$(".ui-autocomplete").append('<li class="ui-menu-item"><a class="text-center" href="//www.powr.io/knowledge-base/using-google-fonts-in-powr-plugins" target="_blank">700 Google Fonts</a></li>')}}).data("uiAutocomplete")._renderItem=function(e,i){return $("<li />").data("item.autocomplete",i).append('<a><img class="fontSprite" src="'+t+'" style="background-position:'+i.x+"px "+i.y+'px;"/></a>').appendTo(e)}}),this.$el.find(".fontSelector").focus(function(){debug()("Focused on selector, searching"),$(this).autocomplete("search","")}),"wix"==HOST&&(this.$el.find(".fontSelector").each(function(){void 0!=$(this).val()&&$(this).val(capitalizeFirstLetter($(this).val().split(",")[0]))}),e.$el.find(".wixFontSelectorWrapper").each(function(){var t=$(this),i=$(this).find(".fontSelector"),n=$(this).find(".fontSelectorWix");if(!(t.find(".dropdown").length>0)){var a=i.attr("name"),r=a;e.$el.find("[name='"+a+"']").each(function(e){return $(this)[0]==i[0]?(r=a+"_"+e,!1):void 0}),Wix.UI.create({id:r,ctrl:"FontPicker",param:!1,model:r,html:"",appendTo:t,options:{}});var o=$(this).find('[data-value-extended = "'+i.val()+'"]');if(o.length>0){var s=o.data("index");Wix.UI.set(r,{value:s})}else $(this).find(".dropdown .selected").html('<div class="option selected">'+i.val()+"</div>");Wix.UI.onChange(r,function(e){debug()("Wix font selector change detected: ",e);var t=e.index,a=e.cssFontFamily;n.val(t),i.val(a),i.change()})}}))},initializeFontSizePickers:function(){var e=this,t=["8px","10px","12px","14px","16px","18px","20px","22px","24px","26px","28px","30px","32px","34px","36px","38px","40px","44px","48px","52px","56px","60px","70px","80px","90px","100px"];this.$el.find(".fontSizeSelector").each(function(){for(var i=parseInt($(this).data("max-size"))||100,n=0;n<t.length;n++)if(parseInt(t[n])>=i){var a=t.slice(0,n+1);break}$(this).autocomplete({appendTo:e.$el,source:a,minLength:0,focus:function(e,t){$(e.target).val(t.item.value),$(e.target).trigger("change")},select:function(e){$(e.target).blur()}})}),this.$el.find(".fontSizeSelector").focus(function(){debug()("Focused on selector, searching"),$(this).autocomplete("search","")}),"wix"==HOST&&e.$el.find(".wixSettingSection .fontSizeWrapper").each(function(){function t(e){debug()("Spinner input change detected. Val: "+e),isNaN(e)&&(e=12),parseInt(e)!=parseInt(n.val())&&(n.val(e+"px"),n.change())}var i=$(this),n=$(this).find(".fontSizeValue"),a=$(this).find(".fontSizeSelectorWix");if(!(a.find("input").length>0)){var r=n.attr("name"),o=r;e.$el.find("[name='"+r+"']").each(function(e){return $(this)[0]==n[0]?(o=r+"_"+e,!1):void 0}),Wix.UI.create({id:o,ctrl:"Spinner",param:!1,model:o,html:"",appendTo:i,options:{value:parseInt(n.val()),minValue:8,maxValue:parseInt(n.data("max-size"))||100,size:"default"}}),i.find(".uilib-spinner input").on("keyup",function(e){var i=e.target.value;t(i)}),Wix.UI.onChange(o,function(e){debug()("Font size change detected: ",e),t(e)})}})},initializeVideoPickers:function(){this.$el.find(".parsedVideoWrapper").each(function(){var e=$(this).find(".previewUrl").val();$(this).find(".previewImage").attr("src",e)})},updateDatetime:function(e){debug()("DatetimeWrapper is ",e);var t=e.find(".dateSelector").datepicker("getDate");debug()("Date var is ",t);var i=e.find(".timeSelector").val();debug()("Datevar: "+t);var n=new Date;n.setFullYear($.datepicker.formatDate("yy",t)),n.setDate(1),n.setMonth(parseInt($.datepicker.formatDate("m",t))-1),n.setDate($.datepicker.formatDate("d",t)),n.setHours(i.substr(0,2)),n.setMinutes(i.substr(3,2)),n.setSeconds(0);var a=e.find(".datetime").data("use-local-time");if(a)var r=n.toLocaleString();else var r=n.toString();e.find(".datetime").val(r)},initializeDateTimePickers:function(){var e=this,t=$.datepicker._gotoToday;$.datepicker._gotoToday=function(e){t.call(this,e),this._selectDate(e),$(e).blur()},this.$el.find(".datetimeWrapper").each(function(){var t=$(this),i=t,n=parseInt(i.find(".datetime").val());if((!n||1e4>n)&&(n=i.find(".datetime").val()),0===n.length)var a=new Date;else var a=new Date(n);var r=a.getHours(),o=a.getMinutes();r=Array(3-r.toString().length).join("0")+r,o=Array(3-o.toString().length).join("0")+o;var s=r+":"+o;debug()("Parsed time is "+s+"; datetime obj is",a),t.find(".dateSelector").datepicker({onSelect:function(){e.updateDatetime(i),e.update()},showButtonPanel:!0}),t.find(".dateSelector").change(function(){e.updateDatetime(i)}),t.find(".dateSelector").datepicker("setDate",a);var l=[{label:"0:00 (12 am)",value:"00:00"},{label:"1:00 (1 am)",value:"01:00"},{label:"2:00 (2 am)",value:"02:00"},{label:"3:00 (3 am)",value:"03:00"},{label:"4:00 (4 am)",value:"04:00"},{label:"5:00 (5 am)",value:"05:00"},{label:"6:00 (6 am)",value:"06:00"},{label:"7:00 (7 am)",value:"07:00"},{label:"8:00 (8 am)",value:"08:00"},{label:"9:00 (9 am)",value:"09:00"},{label:"10:00 (10 am)",value:"10:00"},{label:"11:00 (11 am)",value:"11:00"},{label:"12:00 (12 pm)",value:"12:00"},{label:"13:00 (1 pm)",value:"13:00"},{label:"14:00 (2 pm)",value:"14:00"},{label:"15:00 (3 pm)",value:"15:00"},{label:"16:00 (4 pm)",value:"16:00"},{label:"17:00 (5 pm)",value:"17:00"},{label:"18:00 (6 pm)",value:"18:00"},{label:"19:00 (7 pm)",value:"19:00"},{label:"20:00 (8 pm)",value:"20:00"},{label:"21:00 (9 pm)",value:"21:00"},{label:"22:00 (10 pm)",value:"22:00"},{label:"23:00 (11 pm)",value:"23:00"}];t.find(".timeSelector").autocomplete({appendTo:e.$el,source:l,minLength:0,change:function(){e.updateDatetime(i),e.update()}}),t.find(".timeSelector").val(s),t.find(".timeSelector").focus(function(){debug()("Focused on selector, searching"),$(this).autocomplete("search","")})})},initializeSliders:function(){var e=this;this.$el.find(".sliderWrapper").each(function(){var t=$(this),i=t.find(".slider"),n=t.find(".rangeValue"),a=t.find(".rangeDisplay"),r=t.find(".rangeTextDisplay"),o=i.data("measure"),s=i.data("min");if(i.data("max"))var l=i.data("max");else var c=e.model.meta.premium_status+"-max",l=i.data(c);var d=i.data("step"),u=i.data("update-on-slide"),f=$.trim(n.val().replace(o,"")),p=function(e){"pluginWidth"==n.attr("name")&&1e3==e?(a.val("100%"),r.html("100%")):(a.val(e+o),r.html(e+o))};p(f),i.slider({value:f,min:s,max:l,step:d,animate:!0,range:"min",change:function(e,t){i.slider(i.closest(".form-element").hasClass("premium")?"disable":"enable");var a=parseInt(n.val());t.value==l&&a>l||t.value==s&&s>a||(p(t.value),n.val(t.value+o)),e.originalEvent&&n.change()},slide:function(e,t){i.slider(i.closest(".form-element").hasClass("premium")?"disable":"enable");var a=parseInt(n.val());t.value==l&&a>l||t.value==s&&s>a||(p(t.value),n.val(t.value+o)),u&&n.change()},create:function(){}}),a.on("blur keyup",function(){var e=$.trim(a.val());if("pluginWidth"==n.attr("name")&&"100%"==e){e="1000px";var t=1e3}else var t=e.replace(o,"");n.val("undefined"!=typeof l&&e>l?l:e);var r=i.data("step");i.slider("option","step",1e-4),i.slider("value",t),i.slider("option","step",r),n.trigger("change")})}),"wix"==HOST&&this.$el.find(".wixSlider").each(function(){var t=$(this).find("input"),i=parseFloat(t.data("max"))>3?!0:!1;if($(this).find(".wixSliderElement").remove(),$(this).append('<div class="wixSliderElement"></div>'),t.data("max"))var n=parseFloat(t.data("max"));else var a=e.model.meta.premium_status+"-max",n=parseFloat(t.data(a));$(this).find(".wixSliderElement").Slider({value:parseFloat(t.val()),minValue:parseFloat(t.data("min")),maxValue:n,toolTip:i,width:250,preLabel:"-",postLabel:"+",slide:function(e){if(!isNaN(e)){if(!isNaN(parseFloat(e))&&!isNaN(parseFloat(t.val()))&&parseFloat(e).toFixed(5)==parseFloat(t.val()).toFixed(5))return;t.data("update-on-slide")?(t.val(parseFloat(e)+t.data("measure")),t.change()):("undefined"!=typeof WIX_SLIDER_TIMEOUT&&clearTimeout(WIX_SLIDER_TIMEOUT),WIX_SLIDER_TIMEOUT=setTimeout(function(){t.val(parseFloat(e)+t.data("measure")),t.change()},200))}}})})},afterInitialize:function(){},update:function(){var e=this,t=this.$el.formToObject({ignoreWithParent:".prototype-wrapper",ignoreWithClass:"ignore"});for(var i in t)this.model.get(i)!=t[i]&&("undefined"!=typeof this.model.defaults()[i]||"undefined"!=typeof this.model.defaults()[i.replace("Wix","")])&&(this.model.attributes[i]=t[i]);if(this.savePasswordData(),this.afterUpdate(),this.model.set({isPreset:!1},{silent:!0}),this.model.setLocals({isDirty:!0}),this.updateSaveStatus(),debug()("App settings updated; model is ",this.model),"wix"==HOST||"weebly"==HOST){this.$el.find(".saveStatus .savingStatus").show(),this.$el.find(".saveStatus .savedStatus").hide(),"undefined"==typeof LAST_AUTO_SAVE&&(LAST_AUTO_SAVE=0);var n=(new Date).getTime();n-LAST_AUTO_SAVE>1500?(LAST_AUTO_SAVE=n,e.saveModel()):("undefined"!=typeof AUTO_SAVE_TIMER&&clearTimeout(AUTO_SAVE_TIMER),AUTOSAVE_TIMER=setTimeout(function(){e.saveModel()},1500))}},updateSaveStatus:function(){this.model.get("locals")?this.$el.find(".saveButton").addClass("unsaved"):this.$el.find(".saveButton").removeClass("unsaved")},afterUpdate:function(){},template:function(){var e="#"+this.model.meta.app_namespace+"SettingsTemplate",t=$(e).html();return t},beforeRender:function(){},render:function(){var e=this;"wix"==HOST&&this.$el.find("*[wix-ctrl]").each(function(){var e=$(this);try{Wix.UI.destroy(e,!0)}catch(t){}});var t=this.model.attributes;debug()("App settings rendering; Model is ",t);var i=this.template();this.$el.html(_.template(i,{m:t})),this.$el.objectToForm(t),this.model.meta.alias&&this.$el.find('[name="syncImport"]').prop("checked",!0),this.initializePickers(),this.cycleThroughNotifications(),this.updateEmbedCode(),this.initializePasswordProtection(),this.initializeFlashSales(),this.afterRender(),this.updateInputFields(),sign_in_update(),this.verifyAllEmailFields(),this.updatePremiumContent(),this.fitText(),this.premiumHoverEffect(),this.initializeInnerTabs(),this.initializeNav(),"undefined"!=typeof HIDE_PREMIUM&&"hide"==HIDE_PREMIUM&&this.$el.find(".showFeatures .premiumFeature").hide(),this.model.setLocals({templatesLoaded:!1,importsLoaded:!1}),IMPORT_CONTENT=void 0,"wix"==HOST&&(this.$el.find('[data-tab="admin"]').on("click",function(){loadAnalytics()}),setTimeout(function(){e.model.triggerChange()},0))},afterRender:function(){},fitText:function(){fitText(this.$el.find(".fitText"))},initializeSync:function(){var e=this;if(e.model.meta.alias){var t=e.$el.find(".appSummary"+e.model.meta.alias).html();e.$el.find(".syncContent").html("Currently syncing with "+t),e.$el.find(".importSync").slideDown(),e.$el.find(".importList").hide()}else e.$el.find(".syncContent").html(""),e.$el.find(".importSync").hide(),e.$el.find(".importList").show()},initializeNav:function(){var e=this,t="";if("wix"==HOST)"undefined"!=typeof SUCCESSOMETER_STEPS&&(SUCCESSOMETER=new successometerModule(SUCCESSOMETER_STEPS));else{var i=0;this.$el.find(".section").each(function(){var e=$(this).data("label");t+='<a class="tab nav'+e+'" href="#" data-index="'+i+'"><span class="hide-sm">'+e+"</span></a>",i++}),this.$el.find(".navContainer .nav-tabs").html(t),setTimeout(function(){var t=getURLParameter("tab"),i="."+getURLParameter("trigger"),n="."+getURLParameter("secondTrigger"),a="."+getURLParameter("thirdTrigger");if(t){var r=".nav"+capitalizeFirstLetter(t);e.$el.find(".navContainer .nav-tabs "+r).click()}else void 0!=e.model.get("locals").renderTab?(e.$el.find('.tab[data-index="'+e.model.get("locals").renderTab+'"]').click(),e.model.setLocals({renderTab:void 0})):!e.model.meta.saved&&(-1!=_.indexOf(["popup"],e.model.meta.app_namespace)||e.model.meta.has_importable_apps||this.$el.find(".getStarted .templates").length>0)?e.$el.find('.tab[data-index="0"]').click():e.$el.find('.tab[data-index="1"]').click();i&&e.$el.find(i).click(),n&&setTimeout(function(){e.$el.find(n).click()},500),a&&setTimeout(function(){e.$el.find(a).hide()},500),"undefined"!=typeof SUCCESSOMETER_STEPS&&(SUCCESSOMETER=new successometerModule(SUCCESSOMETER_STEPS))}.bind(this),500);var n=0,a=this.$el.find(".section").length;this.$el.find(".section").each(function(){n>0&&$(this).find(".prevSection").css("display","inline-block").data("target-index",n-1),a-1>n&&$(this).find(".nextSection").css("display","inline-block").data("target-index",n+1),n++})}},initializePickers:function(){this.initializeColorPickers(),this.initializeFontPickers(),this.initializeFontSizePickers(),this.initializeSliders(),this.initializeColorPresets(),this.initializeGradientSettings(),this.initializeTextControls(),this.initializePopovers(),this.initializeDateTimePickers(),this.initializeImagePickers(),this.initializeVideoPickers(),this.initializeValidators(),this.initializeSaveButton(),this.initializeCheckboxes(),this.initializeSync(),"wix"==HOST&&(this.initializeWixDropdowns(),this.initializeWixTabs(),this.initializeWixAccordions(),this.initializeWixCheckboxes(),this.initializeWixAdmin())},initializeWixAdmin:function(){this.$el.find("#admin .acc-pane").hasClass("acc-active")&&(this.$el.find("#admin .acc-pane").removeClass("acc-active"),this.$el.find("#admin .acc-content").css({display:"none",overflow:"visible"}))},updateInputFields:function(){var e=this;$.webshims.polyfill("forms"),this.$el.find("input,textarea,select").updatePolyfill("forms"),this.$el.find(".validate").each(function(){e.validateInput($(this))})},initializeCheckboxes:function(){function e(e){var t=e.siblings(".multiToggleInput"),i=e.data("value"),n=t.val();i!=n&&(t.val(i).change(),e.addClass("active"),e.siblings(".multiToggle").removeClass("active"))}this.$el.find(".powrCheckbox").each(function(){var e=$(this);e.prop("checked")?e.siblings(".switch").toggleClass("on",!0).toggleClass("off",!1):e.siblings(".switch").toggleClass("on",!1).toggleClass("off",!0),e.hasClass("initialized")||(e.addClass("initialized"),e.on("change",function(){var e=$(this);e.parents(".powrToggle").hasClass("premium")&&"free"==self.model.meta.premium_status||(e.prop("checked")?e.siblings(".switch").toggleClass("on",!0).toggleClass("off",!1):e.siblings(".switch").toggleClass("on",!1).toggleClass("off",!0))}))}),this.$el.find(".multiToggleContainer").each(function(){var t=$(this);if(!t.hasClass("initialized")&&0==t.parents(".prototype").length){t.addClass("initialized"),t.on("click",".multiToggle",function(){var t=$(this),i=t.siblings(".multiToggleInput");i.hasClass("premium")||i.closest(".form-element").hasClass("premium")||e(t)});var i=t.find("input").val(),n=t.find('.multiToggle[data-value="'+i+'"]');0==n.length&&(n=t.find(".multiToggle").first()),n.addClass("active")}}),this.$el.find(".customRadioContainer:not(.initialized)").each(function(){var e=$(this);e.addClass("initialized"),e.on("click",function(e){var t=$(this);if(!t.hasClass("premium")){var i=t.find('[type="radio"]').get(0),n=t.parents(".radioImages").first(),a=n.find(".radioImageContainer");a.each(function(){var e=$(this),t=e.find('[type="radio"]').get(0),n=t===i;e.toggleClass("selectedRadio",n)});var r=$(i).attr("name"),o=$(i).val(),s=APP_MODEL.get(r+"Custom");APP_MODEL.set(r+"custom",s.push(o)),APP_MODEL.set(r,o),e.stopPropagation()}})}),this.$el.find('.radioImageContainer [type="radio"]').each(function(){var e=$(this),t=e.parents(".radioImageContainer"),i=e.prop("checked");t.toggleClass("selectedRadio",i),t.hasClass("initialized")||(t.addClass("initialized"),t.on("click",function(){if($this=$(this),!$this.hasClass("premium")){var e=$this.find('[type="radio"]').get(0),t=$this.parents(".radioImages").first(),i=t.find(".radioImageContainer");i.each(function(){var t=$(this),i=t.find('[type="radio"]').get(0),n=i===e;t.toggleClass("selectedRadio",n),t.find('[type="radio"]').prop("checked",n)}),$this.find('[type="radio"]').first().change()}}))})},initializeMultiselectCheckboxes:function(){this.$el.find(".multipleSelect").each(function(){var e=$(this),t=e.find(".realValue").val();t&&t.split(",").forEach(function(t){var i=e.find(".fa-"+t),n=e.find('[value="'+t+'"]');i.length||(i=e.find(t.replace(" ","."))),i.parents(".multiSelectContainer").addClass("selectedCheckbox"),n.prop("checked",!0)})})},initializeTextControl:function(e,t){var i=this;if(!(e.parents(".prototype").length>0||("undefined"==typeof t||0==t)&&e.attr("id"))){var n=e.parent();n.height(n.height()),setTimeout(function(){n.css({height:"auto"})},1e3),e.siblings(".mce-tinymce").remove(),e.show();var a=Math.floor(1e7*Math.random()+1);e.attr("id",a);var r=e.data("height")?parseInt(e.data("height")):100;if("tiny"==e.data("controls-style"))var o=["code bold italic underline removeformat alignleft aligncenter alignright link"],s=!1;else if("small"==e.data("controls-style"))var o=["formatselect forecolor bold italic underline removeformat alignleft aligncenter alignright alignjustify link powrImage code"],s=!1;else var o=["formatselect forecolor bold italic underline removeformat alignleft aligncenter alignright alignjustify bullist numlist link powrImage code"],s=!0;tinymce_editor=tinymce.init({selector:"#"+a,height:r,border:"solid 1px red",statusbar:s,toolbar:o,content_css:"/public-assets/tinymce.css",valid_elements:"+*[*]",setup:function(e){e.on("change keyup",function(){"undefined"!=typeof TINYMCE_TIMER&&clearTimeout(TINYMCE_TIMER),TINYMCE_TIMER=setTimeout(function(){debug()("change event. content: ",t),$(e.targetElm).trigger("change");var t=e.getContent(),n=$(e.targetElm);n.val(t),i.update()},1e3)}),e.on("init",function(){var t=$(e.getDoc()),i=t.find("html");i.css("border","solid 1px white"),i.css("transition-delay","0s, 0s, 0s"),i.css("transition-duration","0.2s, 0.2s, 0.2s"),i.css("transition-property","border, background-color, color"),i.css("transition-timing-function","ease-in-out, ease-in-out, ease-in-out");var n=function(e){var t=$(e.target).parents("html").parent(),i=t.height();return i};$(e.getDoc()).contents().find("body").focus(function(t){$(e.getWin()).bind("resize",function(e){var t=$(e.target.document),i=$(t.find("html")),n=$(e.target).height();i.css("border","solid 1px #63b6ff").css("height",n-2+"px")});var i=$(t.target);i.parent().keydown(function(e){if(13===e.which){var i=n(t);$(t.target).parent().css("height",i+"px")}}),i.parent().css("border","solid 1px #63b6ff").css("height",n(t)-2+"px")}),$(e.getDoc()).contents().find("body").blur(function(e){$(e.target).parent().css("border","solid 1px white")})}),e.addButton("powrImage",{title:"Image",tooltip:"Insert Image",icon:"mce-ico mce-i-image",onclick:function(){if("wix"==HOST){Wix.Settings.openMediaDialog(Wix.Settings.MediaType.IMAGE,!1,function(t){if(debug()("Wix image data from tinymce: ",t),"undefined"==typeof WIX_IMAGE_RESPONSE_LIMITER||!WIX_IMAGE_RESPONSE_LIMITER){WIX_IMAGE_RESPONSE_LIMITER=!0,setTimeout(function(){WIX_IMAGE_RESPONSE_LIMITER=!1},5e3);var i=t.relativeUri,n=Wix.Utils.Media.getResizedImageUrl(i,800,800);e.focus(),e.selection.setContent('<img src="'+n+'">');var a=e.getContent(),r=$(e.targetElm);r.val(a),r.trigger("change")}})}else{if("undefined"==typeof IMAGE_MANAGER){var t=$("#file-manager-template");initialize_manager("image",t,i.model.meta.id,!1)}IMAGE_MANAGER.show(function(t){if(debug()("Response from image manager:",t),t.success){var i=t.images[0].medium_url;e.focus(),e.selection.setContent('<img data-node-image="'+i+'" src="'+i+'">');var n=e.getContent(),a=$(e.targetElm);a.val(n),a.trigger("change")}})}}}),e.on("postrender",function(){})},menubar:!1,plugins:"powrLink colorpicker textcolor code"})}},initializeTextControls:function(e){var t=this;this.$el.find(".textControls").each(function(){t.initializeTextControl($(this),e)})},initializeInnerTabs:function(){},initializeValidators:function(){this.$el.find(".urlValidationWrapper").each(function(){var e=$(this);validateUrl(e)})},initializeWixCheckboxes:function(){var e=this;e.$el.find(".wixCheckbox").each(function(){$(this).find(".checkboxValue").prop("checked")?$(this).find(".uilib-checkbox").toggleClass("checked",!0):$(this).find(".uilib-checkbox").toggleClass("checked",!1)})},initializeWixDropdowns:function(){var e=this;e.$el.find(".wixDropdownWrapper").each(function(){if(!($(this).parents(".prototype").length>0)){var e=($(this),$(this).find(".dropdownValue")),t=$(this).find(".wixElement"),i=e.attr("name"),n=e.data("height")||"auto",a=e.val().length>0?e.val():0;$(this).parents(".prototype-element").length>0&&(i=i+"_"+Math.floor(999999*Math.random()),t.attr("wix-model",i)),Wix.UI.initializePlugin(t[0],{slideTime:50,value:a,height:n}),e.hasClass("ignore")||Wix.UI.onChange(i,function(t){debug()("Wix dropdown change detected: ",t),e.val(t.value),e.trigger("change")})}})},initializeWixTabs:function(){this.$el.find(".uilib-tabs").each(function(){Wix.UI.initializePlugin($(this))})},initializeWixAccordions:function(){this.$el.find("[wix-ctrl='Accordion']").each(function(){Wix.UI.initializePlugin($(this))}),this.$el.find(".acc-active.closed").click()},initializeColorPresets:function(){},initializeImagePickers:function(){var e=this,t=$("#file-manager-template"),i=!1;i="ecommerce"===APP_MODEL.meta.app_type||"digitalDownload"===APP_MODEL.meta.app_type||"fileEmbed"===APP_MODEL.meta.app_type?!0:!1;var n=function(){"undefined"==typeof IMAGE_MANAGER&&initialize_manager("image",t,e.model.meta.id,i)},a=function(){"undefined"==typeof FILE_MANAGER&&initialize_manager("file",t,e.model.meta.id,i)};this.$el.find(".imageInput").each(function(){var e=$(this),t=e.find("input").val();if(t.length>0)e.find(".imagePreview").attr("src",imageThumbUrl(t)),e.find(".addImage i").html(POWr.simpleCopies("replace")),e.find(".imageWrapper").show(),e.find(".noImage").addClass("hid");else{e.find(".addImage i").html(" Add Image");var i=e.find(".addImage");""==i.attr("src")&&e.find(".noImage").removeClass("hid")}}),this.$el.find(".fileInput").each(function(){var e=$(this),t=e.find(".fileName").val();t?(e.find(".existingTitle").html("Current file: "+t),e.find(".addFile i").html(" "+POWr.simpleCopies("replace_file")),e.find(".noImage").addClass("hid")):(e.find(".addFile i").html(" "+POWr.simpleCopies("add_file")),e.find(".noImage").removeClass("hid"))}),this.$el.on("click",".addImage, .noImage",function(t){if(t.stopPropagation(),!$(this).parents(".imageInput").hasClass("premium")){n();var i=$(this),a=i.parents(".imageInput");if("wix"==HOST){var r=i.hasClass("innerImage");Wix.Settings.openMediaDialog(Wix.Settings.MediaType.IMAGE,r,function(t){if(debug()("Wix image data: ",t),"undefined"==typeof WIX_IMAGE_RESPONSE_LIMITER||!WIX_IMAGE_RESPONSE_LIMITER)if(WIX_IMAGE_RESPONSE_LIMITER=!0,setTimeout(function(){WIX_IMAGE_RESPONSE_LIMITER=!1},5e3),i.hasClass("innerImage")){debug()("Handling inner image");for(var n=0;n<t.length;n++){var r=i.data("free-limit");if(debug()("Image el is ",i),debug()("Free limit is "+r+"; count is "+i.parents(".imagesWrapper").find(".images:not(.prototype)").length),n>0&&r&&"free"==e.model.meta.premium&&i.parents(".imagesWrapper").find(".images:not(.prototype)").length>=parseInt(r))debug()("Skipping for ",t[n]);else{if(n>0){var o=i.parents(".imagesWrapper").addPrototype(null,{speed:"instant"});debug()("Wrapperel is ",o),i=o.find(".addImage"),a=o.find(".imageInput")}var s=t[n].relativeUri,l=Wix.Utils.Media.getResizedImageUrl(s,1200,1200);a.find("img").attr("src",l),i.parent(".images").css("background-image","url("+l+")"),i.find("input").val(l),a.find(".imageWrapper input").val(l).trigger("change"),a.find(".imageWrapper").fadeIn("fast"),a.find(".addImage i").html(" Replace"),a.find(".noImage").addClass("hid")}}e.update()}else{var s=t.relativeUri,c=Wix.Utils.Media.getResizedImageUrl(s,1200,1200);a.find("img").attr("src",c),a.find("input").val(c),a.find(".imageWrapper").fadeIn("fast"),a.find(".addImage i").html(" Replace"),a.find(".noImage").addClass("hid"),e.update()}})}else IMAGE_MANAGER.show(function(t){if(t.success)if(i.hasClass("innerImage")){for(var n=0;n<t.images.length;n++){if(n){var r=i.parents(".imagesWrapper").addPrototype(null,{speed:"instant"});i=r.find(".addImage"),a=r.find(".imageInput")}var o=t.images[n].medium_url;a.find("img").attr("src",o),i.parent(".images").css("background-image","url("+o+")"),i.find("input").val(o).trigger("change"),a.find(".imageWrapper input").val(o),a.find(".imageWrapper").fadeIn("fast"),a.find(".addImage i").html(" Replace"),a.find(".noImage").addClass("hid")}e.update()}else{var o=t.images[0].medium_url;a.find("img").attr("src",o),i.parent(".images").css("background-image","url("+o+")"),i.find("input").val(o),a.find(".imageWrapper input").val(o),a.find(".imageWrapper").fadeIn("fast"),a.find(".addImage i").html(" Replace"),a.find(".noImage").addClass("hid"),e.update()}})}}),this.$el.on("click",".addFile",function(){if(CURRENT_USER){"wix"==HOST&&e.update();var t=$(this).closest(".fileInput");a({$clickedFileInput:t}),FILE_MANAGER.show(function(i){if(debug()("Response from file manager:",i),i.success){var n=i.images[0].external_url,a=i.images[0].file_file_name||n.substring(n.lastIndexOf("%2F")+3);t.find(".fileName").val(a),t.find(".fileUrl").val(n),t.find(".existingTitle").html("Current file: "+a).attr("href",n),t.find(".addFile i").html(" "+POWr.simpleCopies("replace_file")),t.find(".noImage").addClass("hid"),e.update()}})}else"wix"==HOST?e.$el.find(".signIn").first().click():$("#sign-in-modal").modal("show")}),this.$el.on("click",".deleteImage",function(){var t=$(this);t.parents(".imageWrapper").slideUp("fast"),t.parents(".imageInput").find("input").val(""),t.parents(".imageInput").find(".addImage i").html(" Add Image"),t.parents(".imageInput").find(".noImage").removeClass("hid"),e.update()})},initializePopovers:function(){return void 0==$(window).popover?void setTimeout(function(){this.initializePopovers()}.bind(this),2e3):(this.$el.find('[data-toggle="tooltip"]').tooltip({html:!0,trigger:"hover",container:"body"}).on("click",function(){var e=this;$(".popover").each(function(){var t=e,i=this;t.$el.find(".popover").each(function(){var e=this,t=e===i;t||$(e).remove()})})}.bind(this)),this.$el.find('[data-toggle="popover"]:not(.admin)').popover({container:"body",html:!0,trigger:"hover",delay:{hide:750}}),this.$el.find(".settingsFooter .admin").popover({html:!0,trigger:"click"}),void this.$el.find(".signInPopover").popover({html:!0,trigger:"hover",delay:{hide:750}}))
},premiumHoverEffect:function(){var e=this,t=$(".callToAction").css("background-color");"free"==e.model.meta.premium_status&&this.$el.find(".premium").hover(function(){$(".callToAction").css("background","#FFF")},function(){$(".callToAction").css("background",t)})},initializeSaveButton:function(){var e=this.$el.find("button.progress-button")[0];void 0!=e&&new ProgressButton(e,{callback:function(e){var t=0,i=setInterval(function(){t=Math.min(t+.1*Math.random(),1),e._setProgress(t),1===t&&(e._stop(1),clearInterval(i))},50)}})}}),_.templateSettings={interpolate:/\{\{=(.+?)\}\}/g,escape:/\{\{-(.+?)\}\}/g,evaluate:/\{\{(.+?)\}\}/g},$(".showCode").prop("readonly",!0),$.webshims.setOptions("basePath","/shims/"),$.webshims.setOptions("waitReady",!1),$(document).ready(function(){$(this).on("click",".chooseFile",function(){return $(".imageUploadInput").click(),!1})})}),FONT_FUDGE_FACTOR=.012,$(window).load(function(){"undefined"!=typeof CURRENT_USER&&CURRENT_USER&&deliverHash(CURRENT_USER.email)}),window.POWr={paypalRedirectUrl:function(e){if("wix"==HOST)var t=baseUri()+"/paramless-mirror/"+encodeURIComponent(urlFormat(e));else var t=urlFormat(e);return t},simpleCopies:function(e){return SIMPLE_COPIES_DICTIONARY[e]||e},updatePackagePrice:function(){if("undefined"==typeof HOST||"wix"!==HOST){var e=$(".paymentFrequency").html(),t=$(".plan.selectedPlan .planHeader").data("plan"),i=$(".plan.selectedPlan .originalTotalPrice").data("price-metrics"),n=$(".isActive.ppListItem").data("frequency");debug()("Updating package price: ",i);var a,r,o,s,l,c,d;if(i){o=i[t].monthly_final_price/100,s=i[t].yearly_monthly_final_price/100,l=i[t].biennially_monthly_final_price/100;var u=0;switch(d=i[t].monthly_original_price/100,$(".discountDefaultAmount").each(function(){$(this).html("monthly"===$(this).data("frequency")&&0!=i[t].monthly_discount_amount?i[t].monthly_discount_amount+"%OFF":"yearly"===$(this).data("frequency")&&0!=i[t].yearly_discount_amount?i[t].yearly_discount_amount+"%OFF":"biennially"===$(this).data("frequency")&&0!=i[t].biennially_discount_amount?i[t].biennially_discount_amount+"%OFF":"yearly"===$(this).data("frequency")&&0===i[t].yearly_discount_amount?"10%OFF":"biennially"===$(this).data("frequency")&&0===i[t].biennially_discount_amount?"20%OFF":"")}),n){case"monthly":r=i[t][n+"_original_price"]/100,discount_price=i[t][n+"_discount_price"]/100,a=i[t][n+"_final_price"]/100,c=i[t][n+"_total_price"]/100,total_summary=i[t][n+"_discount_amount"]>0?i[t][n+"_total_summary"]:"",a>u&&(u=a);break;case"yearly":e=$(".billingFrequency").data("yr"),r=i[t][n+"_original_price"]/100*12,discount_price=i[t][n+"_discount_price"]/100*12,a=i[t][n+"_monthly_final_price"]/100,c=i[t][n+"_total_price"]/100,total_summary=i[t][n+"_discount_amount"]>0?i[t][n+"_total_summary"]:"",a>u&&(u=a);break;case"biennially":e=$(".billingFrequency").data("2yr"),r=i[t][n+"_original_price"]/100*24,discount_price=i[t][n+"_discount_price"]/100*24,a=i[t][n+"_monthly_final_price"]/100,c=i[t][n+"_total_price"]/100,total_summary=i[t][n+"_discount_amount"]>0?i[t][n+"_total_summary"]:"",a>u&&(u=a)}$(".plan.selectedPlan .originalTotalPrice").html("$"+r.toFixed(2)),$(".selectedPlan [data-powr-dollars]").html("$"+Math.floor(u)),$(".selectedPlan [data-powr-cents]").html((u+"").split(".")[1].substr(0,2)),0==discount_price?$(".plan.selectedPlan .discount").slideUp():($(".plan.selectedPlan .discount").slideDown(),$(".plan.selectedPlan .valueOfDiscount").html("- $"+discount_price.toFixed(2))),$(".plan.selectedPlan .totalPrice").html("$"+Math.floor(c)+"."+(c+"").split(".")[1].substr(0,2)+e),$(".plan.selectedPlan .totalSummary").html(total_summary),$(".billingFrequency").html($(".billingFrequency").data("bill")+" "+n),0==discount_price?$(".startingPrice").hide():$(".startingPrice").show(),$(".billingCyclePrice.monthly").html("$"+Math.floor(o)+"."+(o+"").split(".")[1].substr(0,2)+$(".paymentFrequency").html()),$(".billingCyclePrice.yearly").html("$"+Math.floor(s)+"."+(s+"").split(".")[1].substr(0,2)+$(".paymentFrequency").html()),$(".billingCyclePrice.biennially").html("$"+Math.floor(l)+"."+(l+"").split(".")[1].substr(0,2)+$(".paymentFrequency").html())}}}},successometerModule.prototype={initialize:function(){for(var e=this,t=0;t<e.steps.length;t++)$(e.steps[t].target).each(function(){$(this).closest(".form-element").toggleClass("successometer",!0)}),e.createChangeListener(t),e.computeSuccessState(t);$(".navContent, .navDesign, .ui-lib-tab").on("click",function(){debug()("Nav tab clicked"),e.updateTabAlert()}),e.setProgressBar()},createChangeListener:function(e){var t=this;$(document).on("keyup change click",t.steps[e].target,function(){t.computeSuccessState(e)})},updateTabAlert:function(){this.percentageComplete()<100?this.showTabAlert():this.hideTabAlert()},showTabAlert:function(){$('.navConnect, [data-index="1"]').toggleClass("successometerFail",!0)},hideTabAlert:function(){$('.navConnect, [data-index="1"]').toggleClass("successometerFail",!1)},computeSuccessState:function(e){var t=this,i=$(t.steps[e].target);i.each(function(){var i=$(this),n=t.steps[e].validate;"email"==n?i.val().search("@")>-1?t.setSuccessState(i,"Success"):t.setSuccessState(i,"Fail"):"url"==n?isValidUrl(i.val())?t.setSuccessState(i,"Success"):t.setSuccessState(i,"Fail"):i.val().length>0?t.setSuccessState(i,"Success"):t.setSuccessState(i,"Fail")}),t.setProgressBar()},setSuccessState:function(e,t){var i=e.closest(".form-element");debug()("Setting success state to"+t+" for $el and $parent: ",e,i),i.removeClass("successometerSuccess").removeClass("successometerFail").addClass("successometer"+t,!0)},percentageComplete:function(){for(var e=this,t=0,i=0,n=0;n<e.steps.length;n++){if(current_step=e.steps[n],void 0!=current_step.conditionalElement){var a=$(e.steps[current_step.conditionalElement].target).val();if(-1==$.inArray(a,current_step.conditionalValues))continue}var r=$(current_step.target);r.each(function(){var e=$(this),n=e.closest(".form-element");n.hasClass("successometerSuccess")&&(t+=1),i+=1})}return debug()("Successes: "+t+"; Total: "+i),Math.round(100*t/i)},setProgressBar:function(){this.$progressBarContainer&&(this.$progressBarContainer.hasClass("hide")&&this.$progressBarContainer.removeClass("hide").hide().fadeIn(),percentage_complete=this.percentageComplete(),this.$progressBar.css("width",percentage_complete+"%"),100==percentage_complete?(this.$progressTextInProgress.hide(),this.$progressTextSuccess.fadeIn("fast"),this.hideTabAlert()):(this.$progressTextSuccess.hide(),this.$progressTextInProgress.html(percentage_complete+"% Setup").show()))}},walkthroughModule.prototype={initialize:function(){var e=this;this.moveToStep(e.currentStep),this.$walkthroughTriggerNext.on("click",function(){e.currentStep+=1,e.moveToStep(e.currentStep)}),this.$prevButton.on("click",function(){e.currentStep-=1,e.moveToStep(e.currentStep)}),this.$cancelButton.on("click",function(){e.hideWalkthrough()}),this.$scrollListeners.on("scroll",function(){"none"!=e.$walkthrough.css("display")&&(e.hideWalkthrough(!1),setTimeout(function(){var t=e.steps[e.currentStep],i=t.goal&&t.goal.success?t.goal.target:t.target;e.showWalkthrough(i,t.position)},500))})},flashClick:function(e,t){var i=this;if(debug()("Flash click called for element: ",e),0==$(e).length)return debug()("No element found"),void t();var n=$(e).offset().top+$(e).outerHeight(!0)/2-20,a=$(e).offset().left+$(e).outerWidth(!0)/2-20;debug()("Flashing click top: "+n+"; left: "+a),this.$clickwheel.css({left:a,top:n}),this.$clickwheel.fadeIn("fast"),setTimeout(function(){i.$clickwheel.fadeOut("fast"),e.click(),setTimeout(function(){t()},500)},i.transitionTime)},triggerElements:function(e,t){function i(){debug()("Flash next triggered. I = "+a);var r=$(e[a]);n.flashClick(r,function(){a+=1,a<e.length?(debug()("Calling flashnext, i is "+a),i()):t()})}if(debug()("Trigger elements with ",e),void 0==e)return t();var n=this,a=0;i()},showWalkthrough:function(e,t){debug()("Showing walkthrough for position "+t+". Target:",e),this.$walkthrough.show();var i,n="hidden"==$(e).attr("type")?$(e).parent():$(e);switch(t){case"cover":i=($("#appSettings").outerHeight(!0)-this.$walkthrough.outerHeight(!0))/2;break;case"top":i=n.offset().top-this.$walkthrough.outerHeight(!0)-10;break;case"bottom":i=n.offset().top+n.outerHeight()+10}this.$walkthroughArrow.removeClass("top bottom").addClass(t),this.$walkthrough.css({top:i})},hideWalkthrough:function(e){e?this.$walkthrough.fadeOut("fast"):this.$walkthrough.hide()},onGoalSuccess:function(e){debug()("onGoalSuccess triggered. Goal:",e),this.steps[this.currentStep].goal.success=!0,e.successMessage&&this.$text.html(e.successMessage),this.unlistenForGoal(e),e.autoNext&&this.$nextButton.click()},getListenerType:function(e){if($.inArray(e.validate,["email","text"])>-1)var t="keyup";else if("click"==e.validate)var t="click";return t},listenForGoal:function(e){if(void 0!=e){debug()("Listening for goal",e);var t=this;this.goalListener=function(i){function n(){"undefined"!=typeof t.walkthrough_goal_timer&&clearTimeout(t.walkthrough_goal_timer),t.walkthrough_goal_timer=setTimeout(function(){t.onGoalSuccess(e)},500)}debug()("Goal listener function called. This is ",$(this),"e is",i),"email"==e.validate&&$(this).val().search("@")>-1?n():"text"==e.validate&&$(this).val()&&$(this).val().length>0?n():"click"==e.validate&&t.onGoalSuccess(e)},$(e.target).on(this.getListenerType(e),this.goalListener)}},unlistenForGoal:function(e){$(e.target).off(this.getListenerType(e),this.goalListener)},moveToStep:function(e){var t=this,i=this.steps[e];this.steps[this.currentStep].goal&&this.unlistenForGoal(this.steps[this.currentStep].goal),t.hideWalkthrough(),this.$walkthroughSkip.hide(),this.$walkthroughGetStarted.hide(),this.$walkthroughDone.hide(),this.$walkthroughNext.hide(),0==e?(this.$walkthroughGetStarted.show(),this.$walkthroughSkip.show()):e==this.steps.length-1?this.$walkthroughDone.show():this.$walkthroughNext.show(),this.triggerElements(i.triggerElements,function(){t.showWalkthrough(i.target,i.position),i.title?t.$title.html(i.title).show():t.$title.hide(),t.$text.html(i.text),t.listenForGoal(i.goal),t.currentStep=e})}};